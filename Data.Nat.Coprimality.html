<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.Nat.Coprimality</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Coprimality</a>
<a id="121" class="Comment">------------------------------------------------------------------------</a>

<a id="195" class="Symbol">{-#</a> <a id="199" class="Keyword">OPTIONS</a> <a id="207" class="Option">--without-K</a> <a id="219" class="Symbol">#-}</a>

<a id="224" class="Keyword">module</a> <a id="231" href="Data.Nat.Coprimality.html" class="Module">Data.Nat.Coprimality</a> <a id="252" class="Keyword">where</a>

<a id="259" class="Keyword">open</a> <a id="264" class="Keyword">import</a> <a id="271" href="Data.Empty.html" class="Module">Data.Empty</a>
<a id="282" class="Keyword">open</a> <a id="287" class="Keyword">import</a> <a id="294" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="303" class="Keyword">using</a> <a id="309" class="Symbol">(</a><a id="310" href="Data.Fin.Base.html#1070" class="Function">toℕ</a><a id="313" class="Symbol">;</a> <a id="315" href="Data.Fin.Base.html#1839" class="Function">fromℕ≤</a><a id="321" class="Symbol">)</a>
<a id="323" class="Keyword">open</a> <a id="328" class="Keyword">import</a> <a id="335" href="Data.Fin.Properties.html" class="Module">Data.Fin.Properties</a> <a id="355" class="Keyword">using</a> <a id="361" class="Symbol">(</a><a id="362" href="Data.Fin.Properties.html#4192" class="Function">toℕ-fromℕ≤</a><a id="372" class="Symbol">)</a>
<a id="374" class="Keyword">open</a> <a id="379" class="Keyword">import</a> <a id="386" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="395" class="Keyword">open</a> <a id="400" class="Keyword">import</a> <a id="407" href="Data.Nat.Divisibility.html" class="Module">Data.Nat.Divisibility</a>
<a id="429" class="Keyword">open</a> <a id="434" class="Keyword">import</a> <a id="441" href="Data.Nat.GCD.html" class="Module">Data.Nat.GCD</a>
<a id="454" class="Keyword">open</a> <a id="459" class="Keyword">import</a> <a id="466" href="Data.Nat.GCD.Lemmas.html" class="Module">Data.Nat.GCD.Lemmas</a>
<a id="486" class="Keyword">open</a> <a id="491" class="Keyword">import</a> <a id="498" href="Data.Nat.Primality.html" class="Module">Data.Nat.Primality</a>
<a id="517" class="Keyword">open</a> <a id="522" class="Keyword">import</a> <a id="529" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a>
<a id="549" class="Keyword">open</a> <a id="554" class="Keyword">import</a> <a id="561" href="Data.Product.html" class="Module">Data.Product</a> <a id="574" class="Symbol">as</a> <a id="577" class="Module">Prod</a>
<a id="582" class="Keyword">open</a> <a id="587" class="Keyword">import</a> <a id="594" href="Function.html" class="Module">Function</a>
<a id="603" class="Keyword">open</a> <a id="608" class="Keyword">import</a> <a id="615" href="Level.html" class="Module">Level</a> <a id="621" class="Keyword">using</a> <a id="627" class="Symbol">(</a><a id="628" href="Level.html#499" class="Function">0ℓ</a><a id="630" class="Symbol">)</a>
<a id="632" class="Keyword">open</a> <a id="637" class="Keyword">import</a> <a id="644" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="682" class="Symbol">as</a> <a id="685" class="Module">P</a>
  <a id="689" class="Keyword">using</a> <a id="695" class="Symbol">(</a><a id="696" href="Agda.Builtin.Equality.html#83" class="Datatype Operator">_≡_</a><a id="699" class="Symbol">;</a> <a id="701" href="Relation.Binary.PropositionalEquality.Core.html#689" class="Function Operator">_≢_</a><a id="704" class="Symbol">;</a> <a id="706" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="710" class="Symbol">;</a> <a id="712" href="Relation.Binary.PropositionalEquality.html#1127" class="Function">cong</a><a id="716" class="Symbol">;</a> <a id="718" href="Relation.Binary.PropositionalEquality.Core.html#971" class="Function">subst</a><a id="723" class="Symbol">;</a> <a id="725" class="Keyword">module</a> <a id="732" href="Relation.Binary.PropositionalEquality.html#4279" class="Module">≡-Reasoning</a><a id="743" class="Symbol">)</a>
<a id="745" class="Keyword">open</a> <a id="750" class="Keyword">import</a> <a id="757" href="Relation.Nullary.html" class="Module">Relation.Nullary</a>
<a id="774" class="Keyword">open</a> <a id="779" class="Keyword">import</a> <a id="786" href="Relation.Binary.html" class="Module">Relation.Binary</a>

<a id="803" class="Comment">-- Coprime m n is inhabited iff m and n are coprime (relatively</a>
<a id="867" class="Comment">-- prime), i.e. if their only common divisor is 1.</a>

<a id="Coprime"></a><a id="919" href="Data.Nat.Coprimality.html#919" class="Function">Coprime</a> <a id="927" class="Symbol">:</a> <a id="929" href="Relation.Binary.Core.html#969" class="Function">Rel</a> <a id="933" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="935" href="Level.html#499" class="Function">0ℓ</a>
<a id="938" href="Data.Nat.Coprimality.html#919" class="Function">Coprime</a> <a id="946" href="Data.Nat.Coprimality.html#946" class="Bound">m</a> <a id="948" href="Data.Nat.Coprimality.html#948" class="Bound">n</a> <a id="950" class="Symbol">=</a> <a id="952" class="Symbol">∀</a> <a id="954" class="Symbol">{</a><a id="955" href="Data.Nat.Coprimality.html#955" class="Bound">i</a><a id="956" class="Symbol">}</a> <a id="958" class="Symbol">→</a> <a id="960" href="Data.Nat.Coprimality.html#955" class="Bound">i</a> <a id="962" href="Data.Nat.Divisibility.html#1294" class="Record Operator">∣</a> <a id="964" href="Data.Nat.Coprimality.html#946" class="Bound">m</a> <a id="966" href="Data.Product.html#1382" class="Function Operator">×</a> <a id="968" href="Data.Nat.Coprimality.html#955" class="Bound">i</a> <a id="970" href="Data.Nat.Divisibility.html#1294" class="Record Operator">∣</a> <a id="972" href="Data.Nat.Coprimality.html#948" class="Bound">n</a> <a id="974" class="Symbol">→</a> <a id="976" href="Data.Nat.Coprimality.html#955" class="Bound">i</a> <a id="978" href="Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="980" class="Number">1</a>

<a id="983" class="Comment">-- Coprime numbers have 1 as their gcd.</a>

<a id="coprime-gcd"></a><a id="1024" href="Data.Nat.Coprimality.html#1024" class="Function">coprime-gcd</a> <a id="1036" class="Symbol">:</a> <a id="1038" class="Symbol">∀</a> <a id="1040" class="Symbol">{</a><a id="1041" href="Data.Nat.Coprimality.html#1041" class="Bound">m</a> <a id="1043" href="Data.Nat.Coprimality.html#1043" class="Bound">n</a><a id="1044" class="Symbol">}</a> <a id="1046" class="Symbol">→</a> <a id="1048" href="Data.Nat.Coprimality.html#919" class="Function">Coprime</a> <a id="1056" href="Data.Nat.Coprimality.html#1041" class="Bound">m</a> <a id="1058" href="Data.Nat.Coprimality.html#1043" class="Bound">n</a> <a id="1060" class="Symbol">→</a> <a id="1062" href="Data.Nat.GCD.html#923" class="Record">GCD</a> <a id="1066" href="Data.Nat.Coprimality.html#1041" class="Bound">m</a> <a id="1068" href="Data.Nat.Coprimality.html#1043" class="Bound">n</a> <a id="1070" class="Number">1</a>
<a id="1072" href="Data.Nat.Coprimality.html#1024" class="Function">coprime-gcd</a> <a id="1084" class="Symbol">{</a><a id="1085" href="Data.Nat.Coprimality.html#1085" class="Bound">m</a><a id="1086" class="Symbol">}</a> <a id="1088" class="Symbol">{</a><a id="1089" href="Data.Nat.Coprimality.html#1089" class="Bound">n</a><a id="1090" class="Symbol">}</a> <a id="1092" href="Data.Nat.Coprimality.html#1092" class="Bound">c</a> <a id="1094" class="Symbol">=</a> <a id="1096" href="Data.Nat.GCD.html#969" class="InductiveConstructor">GCD.is</a> <a id="1103" class="Symbol">(</a><a id="1104" href="Data.Nat.Divisibility.html#3035" class="Function Operator">1∣</a> <a id="1107" href="Data.Nat.Coprimality.html#1085" class="Bound">m</a> <a id="1109" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1111" href="Data.Nat.Divisibility.html#3035" class="Function Operator">1∣</a> <a id="1114" href="Data.Nat.Coprimality.html#1089" class="Bound">n</a><a id="1115" class="Symbol">)</a> <a id="1117" href="Data.Nat.Coprimality.html#1136" class="Function">greatest</a>
  <a id="1128" class="Keyword">where</a>
  <a id="1136" href="Data.Nat.Coprimality.html#1136" class="Function">greatest</a> <a id="1145" class="Symbol">:</a> <a id="1147" class="Symbol">∀</a> <a id="1149" class="Symbol">{</a><a id="1150" href="Data.Nat.Coprimality.html#1150" class="Bound">d</a><a id="1151" class="Symbol">}</a> <a id="1153" class="Symbol">→</a> <a id="1155" href="Data.Nat.Coprimality.html#1150" class="Bound">d</a> <a id="1157" href="Data.Nat.Divisibility.html#1294" class="Record Operator">∣</a> <a id="1159" href="Data.Nat.Coprimality.html#1085" class="Bound">m</a> <a id="1161" href="Data.Product.html#1382" class="Function Operator">×</a> <a id="1163" href="Data.Nat.Coprimality.html#1150" class="Bound">d</a> <a id="1165" href="Data.Nat.Divisibility.html#1294" class="Record Operator">∣</a> <a id="1167" href="Data.Nat.Coprimality.html#1089" class="Bound">n</a> <a id="1169" class="Symbol">→</a> <a id="1171" href="Data.Nat.Coprimality.html#1150" class="Bound">d</a> <a id="1173" href="Data.Nat.Divisibility.html#1294" class="Record Operator">∣</a> <a id="1175" class="Number">1</a>
  <a id="1179" href="Data.Nat.Coprimality.html#1136" class="Function">greatest</a> <a id="1188" href="Data.Nat.Coprimality.html#1188" class="Bound">cd</a> <a id="1191" class="Keyword">with</a> <a id="1196" href="Data.Nat.Coprimality.html#1092" class="Bound">c</a> <a id="1198" href="Data.Nat.Coprimality.html#1188" class="Bound">cd</a>
  <a id="1203" class="Symbol">...</a> <a id="1207" class="Symbol">|</a> <a id="1209" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="1214" class="Symbol">=</a> <a id="1216" href="Data.Nat.Divisibility.html#3035" class="Function Operator">1∣</a> <a id="1219" class="Number">1</a>

<a id="1222" class="Comment">-- If two numbers have 1 as their gcd, then they are coprime.</a>

<a id="gcd-coprime"></a><a id="1285" href="Data.Nat.Coprimality.html#1285" class="Function">gcd-coprime</a> <a id="1297" class="Symbol">:</a> <a id="1299" class="Symbol">∀</a> <a id="1301" class="Symbol">{</a><a id="1302" href="Data.Nat.Coprimality.html#1302" class="Bound">m</a> <a id="1304" href="Data.Nat.Coprimality.html#1304" class="Bound">n</a><a id="1305" class="Symbol">}</a> <a id="1307" class="Symbol">→</a> <a id="1309" href="Data.Nat.GCD.html#923" class="Record">GCD</a> <a id="1313" href="Data.Nat.Coprimality.html#1302" class="Bound">m</a> <a id="1315" href="Data.Nat.Coprimality.html#1304" class="Bound">n</a> <a id="1317" class="Number">1</a> <a id="1319" class="Symbol">→</a> <a id="1321" href="Data.Nat.Coprimality.html#919" class="Function">Coprime</a> <a id="1329" href="Data.Nat.Coprimality.html#1302" class="Bound">m</a> <a id="1331" href="Data.Nat.Coprimality.html#1304" class="Bound">n</a>
<a id="1333" href="Data.Nat.Coprimality.html#1285" class="Function">gcd-coprime</a> <a id="1345" href="Data.Nat.Coprimality.html#1345" class="Bound">g</a> <a id="1347" href="Data.Nat.Coprimality.html#1347" class="Bound">cd</a> <a id="1350" class="Keyword">with</a> <a id="1355" href="Data.Nat.GCD.html#1201" class="Field">GCD.greatest</a> <a id="1368" href="Data.Nat.Coprimality.html#1345" class="Bound">g</a> <a id="1370" href="Data.Nat.Coprimality.html#1347" class="Bound">cd</a>
<a id="1373" class="Symbol">...</a> <a id="1377" class="Symbol">|</a> <a id="1379" href="Data.Nat.Divisibility.html#1334" class="InductiveConstructor">divides</a> <a id="1387" href="Data.Nat.Coprimality.html#1387" class="Bound">q</a> <a id="1389" href="Data.Nat.Coprimality.html#1389" class="Bound">eq</a> <a id="1392" class="Symbol">=</a> <a id="1394" href="Data.Nat.Properties.html#18888" class="Function">i*j≡1⇒j≡1</a> <a id="1404" href="Data.Nat.Coprimality.html#1387" class="Bound">q</a> <a id="1406" class="Symbol">_</a> <a id="1408" class="Symbol">(</a><a id="1409" href="Relation.Binary.PropositionalEquality.Core.html#867" class="Function">P.sym</a> <a id="1415" href="Data.Nat.Coprimality.html#1389" class="Bound">eq</a><a id="1417" class="Symbol">)</a>

<a id="1420" class="Comment">-- Coprime is decidable.</a>

<a id="1446" class="Keyword">private</a>
  <a id="0≢1"></a><a id="1456" href="Data.Nat.Coprimality.html#1456" class="Function">0≢1</a> <a id="1460" class="Symbol">:</a> <a id="1462" class="Number">0</a> <a id="1464" href="Relation.Binary.PropositionalEquality.Core.html#689" class="Function Operator">≢</a> <a id="1466" class="Number">1</a>
  <a id="1470" href="Data.Nat.Coprimality.html#1456" class="Function">0≢1</a> <a id="1474" class="Symbol">()</a>

  <a id="2+≢1"></a><a id="1480" href="Data.Nat.Coprimality.html#1480" class="Function">2+≢1</a> <a id="1485" class="Symbol">:</a> <a id="1487" class="Symbol">∀</a> <a id="1489" class="Symbol">{</a><a id="1490" href="Data.Nat.Coprimality.html#1490" class="Bound">n</a><a id="1491" class="Symbol">}</a> <a id="1493" class="Symbol">→</a> <a id="1495" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="1499" class="Symbol">(</a><a id="1500" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="1504" href="Data.Nat.Coprimality.html#1490" class="Bound">n</a><a id="1505" class="Symbol">)</a> <a id="1507" href="Relation.Binary.PropositionalEquality.Core.html#689" class="Function Operator">≢</a> <a id="1509" class="Number">1</a>
  <a id="1513" href="Data.Nat.Coprimality.html#1480" class="Function">2+≢1</a> <a id="1518" class="Symbol">()</a>

<a id="coprime?"></a><a id="1522" href="Data.Nat.Coprimality.html#1522" class="Function">coprime?</a> <a id="1531" class="Symbol">:</a> <a id="1533" href="Relation.Binary.Core.html#4715" class="Function">Decidable</a> <a id="1543" href="Data.Nat.Coprimality.html#919" class="Function">Coprime</a>
<a id="1551" href="Data.Nat.Coprimality.html#1522" class="Function">coprime?</a> <a id="1560" href="Data.Nat.Coprimality.html#1560" class="Bound">i</a> <a id="1562" href="Data.Nat.Coprimality.html#1562" class="Bound">j</a> <a id="1564" class="Keyword">with</a> <a id="1569" href="Data.Nat.GCD.html#6079" class="Function">gcd</a> <a id="1573" href="Data.Nat.Coprimality.html#1560" class="Bound">i</a> <a id="1575" href="Data.Nat.Coprimality.html#1562" class="Bound">j</a>
<a id="1577" class="Symbol">...</a> <a id="1581" class="Symbol">|</a> <a id="1583" class="Symbol">(</a><a id="1584" class="Number">0</a>           <a id="1596" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1598" href="Data.Nat.Coprimality.html#1598" class="Bound">g</a><a id="1599" class="Symbol">)</a> <a id="1601" class="Symbol">=</a> <a id="1603" href="Relation.Nullary.html#626" class="InductiveConstructor">no</a>  <a id="1607" class="Symbol">(</a><a id="1608" href="Data.Nat.Coprimality.html#1456" class="Function">0≢1</a>  <a id="1613" href="Function.html#798" class="Function Operator">∘</a> <a id="1615" href="Data.Nat.GCD.html#1291" class="Function">GCD.unique</a> <a id="1626" href="Data.Nat.Coprimality.html#1598" class="Bound">g</a> <a id="1628" href="Function.html#798" class="Function Operator">∘</a> <a id="1630" href="Data.Nat.Coprimality.html#1024" class="Function">coprime-gcd</a><a id="1641" class="Symbol">)</a>
<a id="1643" class="Symbol">...</a> <a id="1647" class="Symbol">|</a> <a id="1649" class="Symbol">(</a><a id="1650" class="Number">1</a>           <a id="1662" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1664" href="Data.Nat.Coprimality.html#1664" class="Bound">g</a><a id="1665" class="Symbol">)</a> <a id="1667" class="Symbol">=</a> <a id="1669" href="Relation.Nullary.html#599" class="InductiveConstructor">yes</a> <a id="1673" class="Symbol">(</a><a id="1674" href="Data.Nat.Coprimality.html#1285" class="Function">gcd-coprime</a> <a id="1686" href="Data.Nat.Coprimality.html#1664" class="Bound">g</a><a id="1687" class="Symbol">)</a>
<a id="1689" class="Symbol">...</a> <a id="1693" class="Symbol">|</a> <a id="1695" class="Symbol">(</a><a id="1696" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="1700" class="Symbol">(</a><a id="1701" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="1705" href="Data.Nat.Coprimality.html#1705" class="Bound">d</a><a id="1706" class="Symbol">)</a> <a id="1708" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1710" href="Data.Nat.Coprimality.html#1710" class="Bound">g</a><a id="1711" class="Symbol">)</a> <a id="1713" class="Symbol">=</a> <a id="1715" href="Relation.Nullary.html#626" class="InductiveConstructor">no</a>  <a id="1719" class="Symbol">(</a><a id="1720" href="Data.Nat.Coprimality.html#1480" class="Function">2+≢1</a> <a id="1725" href="Function.html#798" class="Function Operator">∘</a> <a id="1727" href="Data.Nat.GCD.html#1291" class="Function">GCD.unique</a> <a id="1738" href="Data.Nat.Coprimality.html#1710" class="Bound">g</a> <a id="1740" href="Function.html#798" class="Function Operator">∘</a> <a id="1742" href="Data.Nat.Coprimality.html#1024" class="Function">coprime-gcd</a><a id="1753" class="Symbol">)</a>

<a id="1756" class="Comment">-- The coprimality relation is symmetric.</a>

<a id="sym"></a><a id="1799" href="Data.Nat.Coprimality.html#1799" class="Function">sym</a> <a id="1803" class="Symbol">:</a> <a id="1805" href="Relation.Binary.Core.html#2519" class="Function">Symmetric</a> <a id="1815" href="Data.Nat.Coprimality.html#919" class="Function">Coprime</a>
<a id="1823" href="Data.Nat.Coprimality.html#1799" class="Function">sym</a> <a id="1827" href="Data.Nat.Coprimality.html#1827" class="Bound">c</a> <a id="1829" class="Symbol">=</a> <a id="1831" href="Data.Nat.Coprimality.html#1827" class="Bound">c</a> <a id="1833" href="Function.html#798" class="Function Operator">∘</a> <a id="1835" href="Data.Product.html#2863" class="Function">swap</a>

<a id="1841" class="Comment">-- Everything is coprime to 1.</a>

<a id="1-coprimeTo"></a><a id="1873" href="Data.Nat.Coprimality.html#1873" class="Function">1-coprimeTo</a> <a id="1885" class="Symbol">:</a> <a id="1887" class="Symbol">∀</a> <a id="1889" href="Data.Nat.Coprimality.html#1889" class="Bound">m</a> <a id="1891" class="Symbol">→</a> <a id="1893" href="Data.Nat.Coprimality.html#919" class="Function">Coprime</a> <a id="1901" class="Number">1</a> <a id="1903" href="Data.Nat.Coprimality.html#1889" class="Bound">m</a>
<a id="1905" href="Data.Nat.Coprimality.html#1873" class="Function">1-coprimeTo</a> <a id="1917" href="Data.Nat.Coprimality.html#1917" class="Bound">m</a> <a id="1919" class="Symbol">=</a> <a id="1921" href="Data.Nat.Divisibility.html#3352" class="Function">∣1⇒≡1</a> <a id="1927" href="Function.html#798" class="Function Operator">∘</a> <a id="1929" href="Agda.Builtin.Sigma.html#155" class="Field">proj₁</a>

<a id="1936" class="Comment">-- Nothing except for 1 is coprime to 0.</a>

<a id="0-coprimeTo-1"></a><a id="1978" href="Data.Nat.Coprimality.html#1978" class="Function">0-coprimeTo-1</a> <a id="1992" class="Symbol">:</a> <a id="1994" class="Symbol">∀</a> <a id="1996" class="Symbol">{</a><a id="1997" href="Data.Nat.Coprimality.html#1997" class="Bound">m</a><a id="1998" class="Symbol">}</a> <a id="2000" class="Symbol">→</a> <a id="2002" href="Data.Nat.Coprimality.html#919" class="Function">Coprime</a> <a id="2010" class="Number">0</a> <a id="2012" href="Data.Nat.Coprimality.html#1997" class="Bound">m</a> <a id="2014" class="Symbol">→</a> <a id="2016" href="Data.Nat.Coprimality.html#1997" class="Bound">m</a> <a id="2018" href="Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="2020" class="Number">1</a>
<a id="2022" href="Data.Nat.Coprimality.html#1978" class="Function">0-coprimeTo-1</a> <a id="2036" class="Symbol">{</a><a id="2037" href="Data.Nat.Coprimality.html#2037" class="Bound">m</a><a id="2038" class="Symbol">}</a> <a id="2040" href="Data.Nat.Coprimality.html#2040" class="Bound">c</a> <a id="2042" class="Symbol">=</a> <a id="2044" href="Data.Nat.Coprimality.html#2040" class="Bound">c</a> <a id="2046" class="Symbol">(</a><a id="2047" href="Data.Nat.Coprimality.html#2037" class="Bound">m</a> <a id="2049" href="Data.Nat.Divisibility.html#3093" class="Function Operator">∣0</a> <a id="2052" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2054" href="Data.Nat.Divisibility.html#1858" class="Function">∣-refl</a><a id="2060" class="Symbol">)</a>

<a id="2063" class="Comment">-- If m and n are coprime, then n + m and n are also coprime.</a>

<a id="coprime-+"></a><a id="2126" href="Data.Nat.Coprimality.html#2126" class="Function">coprime-+</a> <a id="2136" class="Symbol">:</a> <a id="2138" class="Symbol">∀</a> <a id="2140" class="Symbol">{</a><a id="2141" href="Data.Nat.Coprimality.html#2141" class="Bound">m</a> <a id="2143" href="Data.Nat.Coprimality.html#2143" class="Bound">n</a><a id="2144" class="Symbol">}</a> <a id="2146" class="Symbol">→</a> <a id="2148" href="Data.Nat.Coprimality.html#919" class="Function">Coprime</a> <a id="2156" href="Data.Nat.Coprimality.html#2141" class="Bound">m</a> <a id="2158" href="Data.Nat.Coprimality.html#2143" class="Bound">n</a> <a id="2160" class="Symbol">→</a> <a id="2162" href="Data.Nat.Coprimality.html#919" class="Function">Coprime</a> <a id="2170" class="Symbol">(</a><a id="2171" href="Data.Nat.Coprimality.html#2143" class="Bound">n</a> <a id="2173" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">+</a> <a id="2175" href="Data.Nat.Coprimality.html#2141" class="Bound">m</a><a id="2176" class="Symbol">)</a> <a id="2178" href="Data.Nat.Coprimality.html#2143" class="Bound">n</a>
<a id="2180" href="Data.Nat.Coprimality.html#2126" class="Function">coprime-+</a> <a id="2190" href="Data.Nat.Coprimality.html#2190" class="Bound">c</a> <a id="2192" class="Symbol">(</a><a id="2193" href="Data.Nat.Coprimality.html#2193" class="Bound">d₁</a> <a id="2196" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2198" href="Data.Nat.Coprimality.html#2198" class="Bound">d₂</a><a id="2200" class="Symbol">)</a> <a id="2202" class="Symbol">=</a> <a id="2204" href="Data.Nat.Coprimality.html#2190" class="Bound">c</a> <a id="2206" class="Symbol">(</a><a id="2207" href="Data.Nat.Divisibility.html#4194" class="Function">∣m+n∣m⇒∣n</a> <a id="2217" href="Data.Nat.Coprimality.html#2193" class="Bound">d₁</a> <a id="2220" href="Data.Nat.Coprimality.html#2198" class="Bound">d₂</a> <a id="2223" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2225" href="Data.Nat.Coprimality.html#2198" class="Bound">d₂</a><a id="2227" class="Symbol">)</a>

<a id="2230" class="Comment">-- If the &quot;gcd&quot; in Bézout&#39;s identity is non-zero, then the &quot;other&quot;</a>
<a id="2297" class="Comment">-- divisors are coprime.</a>

<a id="Bézout-coprime"></a><a id="2323" href="Data.Nat.Coprimality.html#2323" class="Function">Bézout-coprime</a> <a id="2338" class="Symbol">:</a> <a id="2340" class="Symbol">∀</a> <a id="2342" class="Symbol">{</a><a id="2343" href="Data.Nat.Coprimality.html#2343" class="Bound">i</a> <a id="2345" href="Data.Nat.Coprimality.html#2345" class="Bound">j</a> <a id="2347" href="Data.Nat.Coprimality.html#2347" class="Bound">d</a><a id="2348" class="Symbol">}</a> <a id="2350" class="Symbol">→</a>
                 <a id="2369" href="Data.Nat.GCD.html#2784" class="Datatype">Bézout.Identity</a> <a id="2385" class="Symbol">(</a><a id="2386" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="2390" href="Data.Nat.Coprimality.html#2347" class="Bound">d</a><a id="2391" class="Symbol">)</a> <a id="2393" class="Symbol">(</a><a id="2394" href="Data.Nat.Coprimality.html#2343" class="Bound">i</a> <a id="2396" href="Agda.Builtin.Nat.html#433" class="Primitive Operator">*</a> <a id="2398" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="2402" href="Data.Nat.Coprimality.html#2347" class="Bound">d</a><a id="2403" class="Symbol">)</a> <a id="2405" class="Symbol">(</a><a id="2406" href="Data.Nat.Coprimality.html#2345" class="Bound">j</a> <a id="2408" href="Agda.Builtin.Nat.html#433" class="Primitive Operator">*</a> <a id="2410" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="2414" href="Data.Nat.Coprimality.html#2347" class="Bound">d</a><a id="2415" class="Symbol">)</a> <a id="2417" class="Symbol">→</a>
                 <a id="2436" href="Data.Nat.Coprimality.html#919" class="Function">Coprime</a> <a id="2444" href="Data.Nat.Coprimality.html#2343" class="Bound">i</a> <a id="2446" href="Data.Nat.Coprimality.html#2345" class="Bound">j</a>
<a id="2448" href="Data.Nat.Coprimality.html#2323" class="Function">Bézout-coprime</a> <a id="2463" class="Symbol">(</a><a id="2464" href="Data.Nat.GCD.html#2823" class="InductiveConstructor">Bézout.+-</a> <a id="2474" href="Data.Nat.Coprimality.html#2474" class="Bound">x</a> <a id="2476" href="Data.Nat.Coprimality.html#2476" class="Bound">y</a> <a id="2478" href="Data.Nat.Coprimality.html#2478" class="Bound">eq</a><a id="2480" class="Symbol">)</a> <a id="2482" class="Symbol">(</a><a id="2483" href="Data.Nat.Divisibility.html#1334" class="InductiveConstructor">divides</a> <a id="2491" href="Data.Nat.Coprimality.html#2491" class="Bound">q₁</a> <a id="2494" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="2499" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2501" href="Data.Nat.Divisibility.html#1334" class="InductiveConstructor">divides</a> <a id="2509" href="Data.Nat.Coprimality.html#2509" class="Bound">q₂</a> <a id="2512" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="2516" class="Symbol">)</a> <a id="2518" class="Symbol">=</a>
  <a id="2522" href="Data.Nat.GCD.Lemmas.html#5597" class="Function">lem₁₀</a> <a id="2528" href="Data.Nat.Coprimality.html#2476" class="Bound">y</a> <a id="2530" href="Data.Nat.Coprimality.html#2509" class="Bound">q₂</a> <a id="2533" href="Data.Nat.Coprimality.html#2474" class="Bound">x</a> <a id="2535" href="Data.Nat.Coprimality.html#2491" class="Bound">q₁</a> <a id="2538" href="Data.Nat.Coprimality.html#2478" class="Bound">eq</a>
<a id="2541" href="Data.Nat.Coprimality.html#2323" class="Function">Bézout-coprime</a> <a id="2556" class="Symbol">(</a><a id="2557" href="Data.Nat.GCD.html#2886" class="InductiveConstructor">Bézout.-+</a> <a id="2567" href="Data.Nat.Coprimality.html#2567" class="Bound">x</a> <a id="2569" href="Data.Nat.Coprimality.html#2569" class="Bound">y</a> <a id="2571" href="Data.Nat.Coprimality.html#2571" class="Bound">eq</a><a id="2573" class="Symbol">)</a> <a id="2575" class="Symbol">(</a><a id="2576" href="Data.Nat.Divisibility.html#1334" class="InductiveConstructor">divides</a> <a id="2584" href="Data.Nat.Coprimality.html#2584" class="Bound">q₁</a> <a id="2587" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="2592" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2594" href="Data.Nat.Divisibility.html#1334" class="InductiveConstructor">divides</a> <a id="2602" href="Data.Nat.Coprimality.html#2602" class="Bound">q₂</a> <a id="2605" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="2609" class="Symbol">)</a> <a id="2611" class="Symbol">=</a>
  <a id="2615" href="Data.Nat.GCD.Lemmas.html#5597" class="Function">lem₁₀</a> <a id="2621" href="Data.Nat.Coprimality.html#2567" class="Bound">x</a> <a id="2623" href="Data.Nat.Coprimality.html#2584" class="Bound">q₁</a> <a id="2626" href="Data.Nat.Coprimality.html#2569" class="Bound">y</a> <a id="2628" href="Data.Nat.Coprimality.html#2602" class="Bound">q₂</a> <a id="2631" href="Data.Nat.Coprimality.html#2571" class="Bound">eq</a>

<a id="2635" class="Comment">-- Coprime numbers satisfy Bézout&#39;s identity.</a>

<a id="coprime-Bézout"></a><a id="2682" href="Data.Nat.Coprimality.html#2682" class="Function">coprime-Bézout</a> <a id="2697" class="Symbol">:</a> <a id="2699" class="Symbol">∀</a> <a id="2701" class="Symbol">{</a><a id="2702" href="Data.Nat.Coprimality.html#2702" class="Bound">i</a> <a id="2704" href="Data.Nat.Coprimality.html#2704" class="Bound">j</a><a id="2705" class="Symbol">}</a> <a id="2707" class="Symbol">→</a> <a id="2709" href="Data.Nat.Coprimality.html#919" class="Function">Coprime</a> <a id="2717" href="Data.Nat.Coprimality.html#2702" class="Bound">i</a> <a id="2719" href="Data.Nat.Coprimality.html#2704" class="Bound">j</a> <a id="2721" class="Symbol">→</a> <a id="2723" href="Data.Nat.GCD.html#2784" class="Datatype">Bézout.Identity</a> <a id="2739" class="Number">1</a> <a id="2741" href="Data.Nat.Coprimality.html#2702" class="Bound">i</a> <a id="2743" href="Data.Nat.Coprimality.html#2704" class="Bound">j</a>
<a id="2745" href="Data.Nat.Coprimality.html#2682" class="Function">coprime-Bézout</a> <a id="2760" class="Symbol">=</a> <a id="2762" href="Data.Nat.GCD.html#5887" class="Function">Bézout.identity</a> <a id="2778" href="Function.html#798" class="Function Operator">∘</a> <a id="2780" href="Data.Nat.Coprimality.html#1024" class="Function">coprime-gcd</a>

<a id="2793" class="Comment">-- If i divides jk and is coprime to j, then it divides k.</a>

<a id="coprime-divisor"></a><a id="2853" href="Data.Nat.Coprimality.html#2853" class="Function">coprime-divisor</a> <a id="2869" class="Symbol">:</a> <a id="2871" class="Symbol">∀</a> <a id="2873" class="Symbol">{</a><a id="2874" href="Data.Nat.Coprimality.html#2874" class="Bound">k</a> <a id="2876" href="Data.Nat.Coprimality.html#2876" class="Bound">i</a> <a id="2878" href="Data.Nat.Coprimality.html#2878" class="Bound">j</a><a id="2879" class="Symbol">}</a> <a id="2881" class="Symbol">→</a> <a id="2883" href="Data.Nat.Coprimality.html#919" class="Function">Coprime</a> <a id="2891" href="Data.Nat.Coprimality.html#2876" class="Bound">i</a> <a id="2893" href="Data.Nat.Coprimality.html#2878" class="Bound">j</a> <a id="2895" class="Symbol">→</a> <a id="2897" href="Data.Nat.Coprimality.html#2876" class="Bound">i</a> <a id="2899" href="Data.Nat.Divisibility.html#1294" class="Record Operator">∣</a> <a id="2901" href="Data.Nat.Coprimality.html#2878" class="Bound">j</a> <a id="2903" href="Agda.Builtin.Nat.html#433" class="Primitive Operator">*</a> <a id="2905" href="Data.Nat.Coprimality.html#2874" class="Bound">k</a> <a id="2907" class="Symbol">→</a> <a id="2909" href="Data.Nat.Coprimality.html#2876" class="Bound">i</a> <a id="2911" href="Data.Nat.Divisibility.html#1294" class="Record Operator">∣</a> <a id="2913" href="Data.Nat.Coprimality.html#2874" class="Bound">k</a>
<a id="2915" href="Data.Nat.Coprimality.html#2853" class="Function">coprime-divisor</a> <a id="2931" class="Symbol">{</a><a id="2932" href="Data.Nat.Coprimality.html#2932" class="Bound">k</a><a id="2933" class="Symbol">}</a> <a id="2935" href="Data.Nat.Coprimality.html#2935" class="Bound">c</a> <a id="2937" class="Symbol">(</a><a id="2938" href="Data.Nat.Divisibility.html#1334" class="InductiveConstructor">divides</a> <a id="2946" href="Data.Nat.Coprimality.html#2946" class="Bound">q</a> <a id="2948" href="Data.Nat.Coprimality.html#2948" class="Bound">eq′</a><a id="2951" class="Symbol">)</a> <a id="2953" class="Keyword">with</a> <a id="2958" href="Data.Nat.Coprimality.html#2682" class="Function">coprime-Bézout</a> <a id="2973" href="Data.Nat.Coprimality.html#2935" class="Bound">c</a>
<a id="2975" class="Symbol">...</a> <a id="2979" class="Symbol">|</a> <a id="2981" href="Data.Nat.GCD.html#2823" class="InductiveConstructor">Bézout.+-</a> <a id="2991" href="Data.Nat.Coprimality.html#2991" class="Bound">x</a> <a id="2993" href="Data.Nat.Coprimality.html#2993" class="Bound">y</a> <a id="2995" href="Data.Nat.Coprimality.html#2995" class="Bound">eq</a> <a id="2998" class="Symbol">=</a> <a id="3000" href="Data.Nat.Divisibility.html#1334" class="InductiveConstructor">divides</a> <a id="3008" class="Symbol">(</a><a id="3009" href="Data.Nat.Coprimality.html#2991" class="Bound">x</a> <a id="3011" href="Agda.Builtin.Nat.html#433" class="Primitive Operator">*</a> <a id="3013" class="Bound">k</a> <a id="3015" href="Agda.Builtin.Nat.html#320" class="Primitive Operator">∸</a> <a id="3017" href="Data.Nat.Coprimality.html#2993" class="Bound">y</a> <a id="3019" href="Agda.Builtin.Nat.html#433" class="Primitive Operator">*</a> <a id="3021" class="Bound">q</a><a id="3022" class="Symbol">)</a> <a id="3024" class="Symbol">(</a><a id="3025" href="Data.Nat.GCD.Lemmas.html#4128" class="Function">lem₈</a> <a id="3030" href="Data.Nat.Coprimality.html#2991" class="Bound">x</a> <a id="3032" href="Data.Nat.Coprimality.html#2993" class="Bound">y</a> <a id="3034" href="Data.Nat.Coprimality.html#2995" class="Bound">eq</a> <a id="3037" class="Bound">eq′</a><a id="3040" class="Symbol">)</a>
<a id="3042" class="Symbol">...</a> <a id="3046" class="Symbol">|</a> <a id="3048" href="Data.Nat.GCD.html#2886" class="InductiveConstructor">Bézout.-+</a> <a id="3058" href="Data.Nat.Coprimality.html#3058" class="Bound">x</a> <a id="3060" href="Data.Nat.Coprimality.html#3060" class="Bound">y</a> <a id="3062" href="Data.Nat.Coprimality.html#3062" class="Bound">eq</a> <a id="3065" class="Symbol">=</a> <a id="3067" href="Data.Nat.Divisibility.html#1334" class="InductiveConstructor">divides</a> <a id="3075" class="Symbol">(</a><a id="3076" href="Data.Nat.Coprimality.html#3060" class="Bound">y</a> <a id="3078" href="Agda.Builtin.Nat.html#433" class="Primitive Operator">*</a> <a id="3080" class="Bound">q</a> <a id="3082" href="Agda.Builtin.Nat.html#320" class="Primitive Operator">∸</a> <a id="3084" href="Data.Nat.Coprimality.html#3058" class="Bound">x</a> <a id="3086" href="Agda.Builtin.Nat.html#433" class="Primitive Operator">*</a> <a id="3088" class="Bound">k</a><a id="3089" class="Symbol">)</a> <a id="3091" class="Symbol">(</a><a id="3092" href="Data.Nat.GCD.Lemmas.html#4954" class="Function">lem₉</a> <a id="3097" href="Data.Nat.Coprimality.html#3058" class="Bound">x</a> <a id="3099" href="Data.Nat.Coprimality.html#3060" class="Bound">y</a> <a id="3101" href="Data.Nat.Coprimality.html#3062" class="Bound">eq</a> <a id="3104" class="Bound">eq′</a><a id="3107" class="Symbol">)</a>

<a id="3110" class="Comment">-- If d is a common divisor of mk and nk, and m and n are coprime,</a>
<a id="3177" class="Comment">-- then d divides k.</a>

<a id="coprime-factors"></a><a id="3199" href="Data.Nat.Coprimality.html#3199" class="Function">coprime-factors</a> <a id="3215" class="Symbol">:</a> <a id="3217" class="Symbol">∀</a> <a id="3219" class="Symbol">{</a><a id="3220" href="Data.Nat.Coprimality.html#3220" class="Bound">d</a> <a id="3222" href="Data.Nat.Coprimality.html#3222" class="Bound">m</a> <a id="3224" href="Data.Nat.Coprimality.html#3224" class="Bound">n</a> <a id="3226" href="Data.Nat.Coprimality.html#3226" class="Bound">k</a><a id="3227" class="Symbol">}</a> <a id="3229" class="Symbol">→</a>
                  <a id="3249" href="Data.Nat.Coprimality.html#919" class="Function">Coprime</a> <a id="3257" href="Data.Nat.Coprimality.html#3222" class="Bound">m</a> <a id="3259" href="Data.Nat.Coprimality.html#3224" class="Bound">n</a> <a id="3261" class="Symbol">→</a> <a id="3263" href="Data.Nat.Coprimality.html#3220" class="Bound">d</a> <a id="3265" href="Data.Nat.Divisibility.html#1294" class="Record Operator">∣</a> <a id="3267" href="Data.Nat.Coprimality.html#3222" class="Bound">m</a> <a id="3269" href="Agda.Builtin.Nat.html#433" class="Primitive Operator">*</a> <a id="3271" href="Data.Nat.Coprimality.html#3226" class="Bound">k</a> <a id="3273" href="Data.Product.html#1382" class="Function Operator">×</a> <a id="3275" href="Data.Nat.Coprimality.html#3220" class="Bound">d</a> <a id="3277" href="Data.Nat.Divisibility.html#1294" class="Record Operator">∣</a> <a id="3279" href="Data.Nat.Coprimality.html#3224" class="Bound">n</a> <a id="3281" href="Agda.Builtin.Nat.html#433" class="Primitive Operator">*</a> <a id="3283" href="Data.Nat.Coprimality.html#3226" class="Bound">k</a> <a id="3285" class="Symbol">→</a> <a id="3287" href="Data.Nat.Coprimality.html#3220" class="Bound">d</a> <a id="3289" href="Data.Nat.Divisibility.html#1294" class="Record Operator">∣</a> <a id="3291" href="Data.Nat.Coprimality.html#3226" class="Bound">k</a>
<a id="3293" href="Data.Nat.Coprimality.html#3199" class="Function">coprime-factors</a> <a id="3309" href="Data.Nat.Coprimality.html#3309" class="Bound">c</a> <a id="3311" class="Symbol">(</a><a id="3312" href="Data.Nat.Divisibility.html#1334" class="InductiveConstructor">divides</a> <a id="3320" href="Data.Nat.Coprimality.html#3320" class="Bound">q₁</a> <a id="3323" href="Data.Nat.Coprimality.html#3323" class="Bound">eq₁</a> <a id="3327" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="3329" href="Data.Nat.Divisibility.html#1334" class="InductiveConstructor">divides</a> <a id="3337" href="Data.Nat.Coprimality.html#3337" class="Bound">q₂</a> <a id="3340" href="Data.Nat.Coprimality.html#3340" class="Bound">eq₂</a><a id="3343" class="Symbol">)</a> <a id="3345" class="Keyword">with</a> <a id="3350" href="Data.Nat.Coprimality.html#2682" class="Function">coprime-Bézout</a> <a id="3365" href="Data.Nat.Coprimality.html#3309" class="Bound">c</a>
<a id="3367" class="Symbol">...</a> <a id="3371" class="Symbol">|</a> <a id="3373" href="Data.Nat.GCD.html#2823" class="InductiveConstructor">Bézout.+-</a> <a id="3383" href="Data.Nat.Coprimality.html#3383" class="Bound">x</a> <a id="3385" href="Data.Nat.Coprimality.html#3385" class="Bound">y</a> <a id="3387" href="Data.Nat.Coprimality.html#3387" class="Bound">eq</a> <a id="3390" class="Symbol">=</a> <a id="3392" href="Data.Nat.Divisibility.html#1334" class="InductiveConstructor">divides</a> <a id="3400" class="Symbol">(</a><a id="3401" href="Data.Nat.Coprimality.html#3383" class="Bound">x</a> <a id="3403" href="Agda.Builtin.Nat.html#433" class="Primitive Operator">*</a> <a id="3405" class="Bound">q₁</a> <a id="3408" href="Agda.Builtin.Nat.html#320" class="Primitive Operator">∸</a> <a id="3410" href="Data.Nat.Coprimality.html#3385" class="Bound">y</a> <a id="3412" href="Agda.Builtin.Nat.html#433" class="Primitive Operator">*</a> <a id="3414" class="Bound">q₂</a><a id="3416" class="Symbol">)</a> <a id="3418" class="Symbol">(</a><a id="3419" href="Data.Nat.GCD.Lemmas.html#6372" class="Function">lem₁₁</a> <a id="3425" href="Data.Nat.Coprimality.html#3383" class="Bound">x</a> <a id="3427" href="Data.Nat.Coprimality.html#3385" class="Bound">y</a> <a id="3429" href="Data.Nat.Coprimality.html#3387" class="Bound">eq</a> <a id="3432" class="Bound">eq₁</a> <a id="3436" class="Bound">eq₂</a><a id="3439" class="Symbol">)</a>
<a id="3441" class="Symbol">...</a> <a id="3445" class="Symbol">|</a> <a id="3447" href="Data.Nat.GCD.html#2886" class="InductiveConstructor">Bézout.-+</a> <a id="3457" href="Data.Nat.Coprimality.html#3457" class="Bound">x</a> <a id="3459" href="Data.Nat.Coprimality.html#3459" class="Bound">y</a> <a id="3461" href="Data.Nat.Coprimality.html#3461" class="Bound">eq</a> <a id="3464" class="Symbol">=</a> <a id="3466" href="Data.Nat.Divisibility.html#1334" class="InductiveConstructor">divides</a> <a id="3474" class="Symbol">(</a><a id="3475" href="Data.Nat.Coprimality.html#3459" class="Bound">y</a> <a id="3477" href="Agda.Builtin.Nat.html#433" class="Primitive Operator">*</a> <a id="3479" class="Bound">q₂</a> <a id="3482" href="Agda.Builtin.Nat.html#320" class="Primitive Operator">∸</a> <a id="3484" href="Data.Nat.Coprimality.html#3457" class="Bound">x</a> <a id="3486" href="Agda.Builtin.Nat.html#433" class="Primitive Operator">*</a> <a id="3488" class="Bound">q₁</a><a id="3490" class="Symbol">)</a> <a id="3492" class="Symbol">(</a><a id="3493" href="Data.Nat.GCD.Lemmas.html#6372" class="Function">lem₁₁</a> <a id="3499" href="Data.Nat.Coprimality.html#3459" class="Bound">y</a> <a id="3501" href="Data.Nat.Coprimality.html#3457" class="Bound">x</a> <a id="3503" href="Data.Nat.Coprimality.html#3461" class="Bound">eq</a> <a id="3506" class="Bound">eq₂</a> <a id="3510" class="Bound">eq₁</a><a id="3513" class="Symbol">)</a>

<a id="3516" class="Comment">-- A variant of GCD.</a>

<a id="3538" class="Keyword">data</a> <a id="GCD′"></a><a id="3543" href="Data.Nat.Coprimality.html#3543" class="Datatype">GCD′</a> <a id="3548" class="Symbol">:</a> <a id="3550" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="3552" class="Symbol">→</a> <a id="3554" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="3556" class="Symbol">→</a> <a id="3558" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="3560" class="Symbol">→</a> <a id="3562" class="PrimitiveType">Set</a> <a id="3566" class="Keyword">where</a>
  <a id="GCD′.gcd-*"></a><a id="3574" href="Data.Nat.Coprimality.html#3574" class="InductiveConstructor">gcd-*</a> <a id="3580" class="Symbol">:</a> <a id="3582" class="Symbol">∀</a> <a id="3584" class="Symbol">{</a><a id="3585" href="Data.Nat.Coprimality.html#3585" class="Bound">d</a><a id="3586" class="Symbol">}</a> <a id="3588" href="Data.Nat.Coprimality.html#3588" class="Bound">q₁</a> <a id="3591" href="Data.Nat.Coprimality.html#3591" class="Bound">q₂</a> <a id="3594" class="Symbol">(</a><a id="3595" href="Data.Nat.Coprimality.html#3595" class="Bound">c</a> <a id="3597" class="Symbol">:</a> <a id="3599" href="Data.Nat.Coprimality.html#919" class="Function">Coprime</a> <a id="3607" href="Data.Nat.Coprimality.html#3588" class="Bound">q₁</a> <a id="3610" href="Data.Nat.Coprimality.html#3591" class="Bound">q₂</a><a id="3612" class="Symbol">)</a> <a id="3614" class="Symbol">→</a>
          <a id="3626" href="Data.Nat.Coprimality.html#3543" class="Datatype">GCD′</a> <a id="3631" class="Symbol">(</a><a id="3632" href="Data.Nat.Coprimality.html#3588" class="Bound">q₁</a> <a id="3635" href="Agda.Builtin.Nat.html#433" class="Primitive Operator">*</a> <a id="3637" href="Data.Nat.Coprimality.html#3585" class="Bound">d</a><a id="3638" class="Symbol">)</a> <a id="3640" class="Symbol">(</a><a id="3641" href="Data.Nat.Coprimality.html#3591" class="Bound">q₂</a> <a id="3644" href="Agda.Builtin.Nat.html#433" class="Primitive Operator">*</a> <a id="3646" href="Data.Nat.Coprimality.html#3585" class="Bound">d</a><a id="3647" class="Symbol">)</a> <a id="3649" href="Data.Nat.Coprimality.html#3585" class="Bound">d</a>

<a id="3652" class="Comment">-- The two definitions are equivalent.</a>

<a id="gcd-gcd′"></a><a id="3692" href="Data.Nat.Coprimality.html#3692" class="Function">gcd-gcd′</a> <a id="3701" class="Symbol">:</a> <a id="3703" class="Symbol">∀</a> <a id="3705" class="Symbol">{</a><a id="3706" href="Data.Nat.Coprimality.html#3706" class="Bound">d</a> <a id="3708" href="Data.Nat.Coprimality.html#3708" class="Bound">m</a> <a id="3710" href="Data.Nat.Coprimality.html#3710" class="Bound">n</a><a id="3711" class="Symbol">}</a> <a id="3713" class="Symbol">→</a> <a id="3715" href="Data.Nat.GCD.html#923" class="Record">GCD</a> <a id="3719" href="Data.Nat.Coprimality.html#3708" class="Bound">m</a> <a id="3721" href="Data.Nat.Coprimality.html#3710" class="Bound">n</a> <a id="3723" href="Data.Nat.Coprimality.html#3706" class="Bound">d</a> <a id="3725" class="Symbol">→</a> <a id="3727" href="Data.Nat.Coprimality.html#3543" class="Datatype">GCD′</a> <a id="3732" href="Data.Nat.Coprimality.html#3708" class="Bound">m</a> <a id="3734" href="Data.Nat.Coprimality.html#3710" class="Bound">n</a> <a id="3736" href="Data.Nat.Coprimality.html#3706" class="Bound">d</a>
<a id="3738" href="Data.Nat.Coprimality.html#3692" class="Function">gcd-gcd′</a>         <a id="3755" href="Data.Nat.Coprimality.html#3755" class="Bound">g</a> <a id="3757" class="Keyword">with</a> <a id="3762" href="Data.Nat.GCD.html#1026" class="Field">GCD.commonDivisor</a> <a id="3780" href="Data.Nat.Coprimality.html#3755" class="Bound">g</a>
<a id="3782" href="Data.Nat.Coprimality.html#3692" class="Function">gcd-gcd′</a> <a id="3791" class="Symbol">{</a><a id="3792" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a><a id="3796" class="Symbol">}</a>  <a id="3799" href="Data.Nat.Coprimality.html#3799" class="Bound">g</a> <a id="3801" class="Symbol">|</a> <a id="3803" class="Symbol">(</a><a id="3804" href="Data.Nat.Divisibility.html#1334" class="InductiveConstructor">divides</a> <a id="3812" href="Data.Nat.Coprimality.html#3812" class="Bound">q₁</a> <a id="3815" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="3820" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="3822" href="Data.Nat.Divisibility.html#1334" class="InductiveConstructor">divides</a> <a id="3830" href="Data.Nat.Coprimality.html#3830" class="Bound">q₂</a> <a id="3833" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="3837" class="Symbol">)</a>
  <a id="3841" class="Keyword">with</a> <a id="3846" href="Data.Nat.Coprimality.html#3812" class="Bound">q₁</a> <a id="3849" href="Agda.Builtin.Nat.html#433" class="Primitive Operator">*</a> <a id="3851" class="Number">0</a> <a id="3853" class="Symbol">|</a> <a id="3855" href="Data.Nat.Properties.html#15349" class="Function">*-comm</a> <a id="3862" class="Number">0</a> <a id="3864" href="Data.Nat.Coprimality.html#3812" class="Bound">q₁</a> <a id="3867" class="Symbol">|</a> <a id="3869" href="Data.Nat.Coprimality.html#3830" class="Bound">q₂</a> <a id="3872" href="Agda.Builtin.Nat.html#433" class="Primitive Operator">*</a> <a id="3874" class="Number">0</a> <a id="3876" class="Symbol">|</a> <a id="3878" href="Data.Nat.Properties.html#15349" class="Function">*-comm</a> <a id="3885" class="Number">0</a> <a id="3887" href="Data.Nat.Coprimality.html#3830" class="Bound">q₂</a>
<a id="3890" class="Symbol">...</a> <a id="3894" class="Symbol">|</a> <a id="3896" class="DottedPattern Symbol">.</a><a id="3897" class="DottedPattern Number">0</a> <a id="3899" class="Symbol">|</a> <a id="3901" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="3906" class="Symbol">|</a> <a id="3908" class="DottedPattern Symbol">.</a><a id="3909" class="DottedPattern Number">0</a> <a id="3911" class="Symbol">|</a> <a id="3913" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="3918" class="Symbol">=</a> <a id="3920" href="Data.Nat.Coprimality.html#3574" class="InductiveConstructor">gcd-*</a> <a id="3926" class="Number">1</a> <a id="3928" class="Number">1</a> <a id="3930" class="Symbol">(</a><a id="3931" href="Data.Nat.Coprimality.html#1873" class="Function">1-coprimeTo</a> <a id="3943" class="Number">1</a><a id="3944" class="Symbol">)</a>
<a id="3946" href="Data.Nat.Coprimality.html#3692" class="Function">gcd-gcd′</a> <a id="3955" class="Symbol">{</a><a id="3956" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="3960" href="Data.Nat.Coprimality.html#3960" class="Bound">d</a><a id="3961" class="Symbol">}</a> <a id="3963" href="Data.Nat.Coprimality.html#3963" class="Bound">g</a> <a id="3965" class="Symbol">|</a> <a id="3967" class="Symbol">(</a><a id="3968" href="Data.Nat.Divisibility.html#1334" class="InductiveConstructor">divides</a> <a id="3976" href="Data.Nat.Coprimality.html#3976" class="Bound">q₁</a> <a id="3979" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="3984" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="3986" href="Data.Nat.Divisibility.html#1334" class="InductiveConstructor">divides</a> <a id="3994" href="Data.Nat.Coprimality.html#3994" class="Bound">q₂</a> <a id="3997" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="4001" class="Symbol">)</a> <a id="4003" class="Symbol">=</a>
  <a id="4007" href="Data.Nat.Coprimality.html#3574" class="InductiveConstructor">gcd-*</a> <a id="4013" href="Data.Nat.Coprimality.html#3976" class="Bound">q₁</a> <a id="4016" href="Data.Nat.Coprimality.html#3994" class="Bound">q₂</a> <a id="4019" class="Symbol">(</a><a id="4020" href="Data.Nat.Coprimality.html#2323" class="Function">Bézout-coprime</a> <a id="4035" class="Symbol">(</a><a id="4036" href="Data.Nat.GCD.html#5887" class="Function">Bézout.identity</a> <a id="4052" href="Data.Nat.Coprimality.html#3963" class="Bound">g</a><a id="4053" class="Symbol">))</a>

<a id="gcd′-gcd"></a><a id="4057" href="Data.Nat.Coprimality.html#4057" class="Function">gcd′-gcd</a> <a id="4066" class="Symbol">:</a> <a id="4068" class="Symbol">∀</a> <a id="4070" class="Symbol">{</a><a id="4071" href="Data.Nat.Coprimality.html#4071" class="Bound">m</a> <a id="4073" href="Data.Nat.Coprimality.html#4073" class="Bound">n</a> <a id="4075" href="Data.Nat.Coprimality.html#4075" class="Bound">d</a><a id="4076" class="Symbol">}</a> <a id="4078" class="Symbol">→</a> <a id="4080" href="Data.Nat.Coprimality.html#3543" class="Datatype">GCD′</a> <a id="4085" href="Data.Nat.Coprimality.html#4071" class="Bound">m</a> <a id="4087" href="Data.Nat.Coprimality.html#4073" class="Bound">n</a> <a id="4089" href="Data.Nat.Coprimality.html#4075" class="Bound">d</a> <a id="4091" class="Symbol">→</a> <a id="4093" href="Data.Nat.GCD.html#923" class="Record">GCD</a> <a id="4097" href="Data.Nat.Coprimality.html#4071" class="Bound">m</a> <a id="4099" href="Data.Nat.Coprimality.html#4073" class="Bound">n</a> <a id="4101" href="Data.Nat.Coprimality.html#4075" class="Bound">d</a>
<a id="4103" href="Data.Nat.Coprimality.html#4057" class="Function">gcd′-gcd</a> <a id="4112" class="Symbol">(</a><a id="4113" href="Data.Nat.Coprimality.html#3574" class="InductiveConstructor">gcd-*</a> <a id="4119" href="Data.Nat.Coprimality.html#4119" class="Bound">q₁</a> <a id="4122" href="Data.Nat.Coprimality.html#4122" class="Bound">q₂</a> <a id="4125" href="Data.Nat.Coprimality.html#4125" class="Bound">c</a><a id="4126" class="Symbol">)</a> <a id="4128" class="Symbol">=</a> <a id="4130" href="Data.Nat.GCD.html#969" class="InductiveConstructor">GCD.is</a> <a id="4137" class="Symbol">(</a><a id="4138" href="Data.Nat.Divisibility.html#3168" class="Function">n∣m*n</a> <a id="4144" href="Data.Nat.Coprimality.html#4119" class="Bound">q₁</a> <a id="4147" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="4149" href="Data.Nat.Divisibility.html#3168" class="Function">n∣m*n</a> <a id="4155" href="Data.Nat.Coprimality.html#4122" class="Bound">q₂</a><a id="4157" class="Symbol">)</a> <a id="4159" class="Symbol">(</a><a id="4160" href="Data.Nat.Coprimality.html#3199" class="Function">coprime-factors</a> <a id="4176" href="Data.Nat.Coprimality.html#4125" class="Bound">c</a><a id="4177" class="Symbol">)</a>

<a id="4180" class="Comment">-- Calculates (the alternative representation of) the gcd of the</a>
<a id="4245" class="Comment">-- arguments.</a>

<a id="gcd′"></a><a id="4260" href="Data.Nat.Coprimality.html#4260" class="Function">gcd′</a> <a id="4265" class="Symbol">:</a> <a id="4267" class="Symbol">∀</a> <a id="4269" href="Data.Nat.Coprimality.html#4269" class="Bound">m</a> <a id="4271" href="Data.Nat.Coprimality.html#4271" class="Bound">n</a> <a id="4273" class="Symbol">→</a> <a id="4275" href="Data.Product.html#910" class="Function">∃</a> <a id="4277" class="Symbol">λ</a> <a id="4279" href="Data.Nat.Coprimality.html#4279" class="Bound">d</a> <a id="4281" class="Symbol">→</a> <a id="4283" href="Data.Nat.Coprimality.html#3543" class="Datatype">GCD′</a> <a id="4288" href="Data.Nat.Coprimality.html#4269" class="Bound">m</a> <a id="4290" href="Data.Nat.Coprimality.html#4271" class="Bound">n</a> <a id="4292" href="Data.Nat.Coprimality.html#4279" class="Bound">d</a>
<a id="4294" href="Data.Nat.Coprimality.html#4260" class="Function">gcd′</a> <a id="4299" href="Data.Nat.Coprimality.html#4299" class="Bound">m</a> <a id="4301" href="Data.Nat.Coprimality.html#4301" class="Bound">n</a> <a id="4303" class="Symbol">=</a> <a id="4305" href="Data.Product.html#2183" class="Function">Prod.map</a> <a id="4314" href="Function.html#1097" class="Function">id</a> <a id="4317" href="Data.Nat.Coprimality.html#3692" class="Function">gcd-gcd′</a> <a id="4326" class="Symbol">(</a><a id="4327" href="Data.Nat.GCD.html#6079" class="Function">gcd</a> <a id="4331" href="Data.Nat.Coprimality.html#4299" class="Bound">m</a> <a id="4333" href="Data.Nat.Coprimality.html#4301" class="Bound">n</a><a id="4334" class="Symbol">)</a>

<a id="4337" class="Comment">-- Primality implies coprimality.</a>

<a id="prime⇒coprime"></a><a id="4372" href="Data.Nat.Coprimality.html#4372" class="Function">prime⇒coprime</a> <a id="4386" class="Symbol">:</a> <a id="4388" class="Symbol">∀</a> <a id="4390" href="Data.Nat.Coprimality.html#4390" class="Bound">m</a> <a id="4392" class="Symbol">→</a> <a id="4394" href="Data.Nat.Primality.html#689" class="Function">Prime</a> <a id="4400" href="Data.Nat.Coprimality.html#4390" class="Bound">m</a> <a id="4402" class="Symbol">→</a>
                <a id="4420" class="Symbol">∀</a> <a id="4422" href="Data.Nat.Coprimality.html#4422" class="Bound">n</a> <a id="4424" class="Symbol">→</a> <a id="4426" class="Number">0</a> <a id="4428" href="Data.Nat.Base.html#984" class="Function Operator">&lt;</a> <a id="4430" href="Data.Nat.Coprimality.html#4422" class="Bound">n</a> <a id="4432" class="Symbol">→</a> <a id="4434" href="Data.Nat.Coprimality.html#4422" class="Bound">n</a> <a id="4436" href="Data.Nat.Base.html#984" class="Function Operator">&lt;</a> <a id="4438" href="Data.Nat.Coprimality.html#4390" class="Bound">m</a> <a id="4440" class="Symbol">→</a> <a id="4442" href="Data.Nat.Coprimality.html#919" class="Function">Coprime</a> <a id="4450" href="Data.Nat.Coprimality.html#4390" class="Bound">m</a> <a id="4452" href="Data.Nat.Coprimality.html#4422" class="Bound">n</a>
<a id="4454" href="Data.Nat.Coprimality.html#4372" class="Function">prime⇒coprime</a> <a id="4468" class="Number">0</a>             <a id="4482" class="Symbol">()</a> <a id="4485" class="Symbol">_</a> <a id="4487" class="Symbol">_</a>  <a id="4490" class="Symbol">_</a>     <a id="4496" class="Symbol">_</a>
<a id="4498" href="Data.Nat.Coprimality.html#4372" class="Function">prime⇒coprime</a> <a id="4512" class="Number">1</a>             <a id="4526" class="Symbol">()</a> <a id="4529" class="Symbol">_</a> <a id="4531" class="Symbol">_</a>  <a id="4534" class="Symbol">_</a>     <a id="4540" class="Symbol">_</a>
<a id="4542" href="Data.Nat.Coprimality.html#4372" class="Function">prime⇒coprime</a> <a id="4556" class="Symbol">(</a><a id="4557" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="4561" class="Symbol">(</a><a id="4562" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="4566" href="Data.Nat.Coprimality.html#4566" class="Bound">m</a><a id="4567" class="Symbol">))</a> <a id="4570" class="Symbol">_</a>  <a id="4573" class="Number">0</a> <a id="4575" class="Symbol">()</a> <a id="4578" class="Symbol">_</a>     <a id="4584" class="Symbol">_</a>
<a id="4586" href="Data.Nat.Coprimality.html#4372" class="CatchallClause Function">prime⇒coprime</a><a id="4599" class="CatchallClause"> </a><a id="4600" class="CatchallClause Symbol">(</a><a id="4601" href="Agda.Builtin.Nat.html#128" class="CatchallClause InductiveConstructor">suc</a><a id="4604" class="CatchallClause"> </a><a id="4605" class="CatchallClause Symbol">(</a><a id="4606" href="Agda.Builtin.Nat.html#128" class="CatchallClause InductiveConstructor">suc</a><a id="4609" class="CatchallClause"> </a><a id="4610" href="Data.Nat.Coprimality.html#4610" class="CatchallClause Bound">m</a><a id="4611" class="CatchallClause Symbol">))</a><a id="4613" class="CatchallClause"> </a><a id="4614" class="CatchallClause Symbol">_</a><a id="4615" class="CatchallClause">  </a><a id="4617" class="CatchallClause Symbol">_</a><a id="4618" class="CatchallClause"> </a><a id="4619" class="CatchallClause Symbol">_</a><a id="4620" class="CatchallClause">  </a><a id="4622" class="CatchallClause Symbol">_</a><a id="4623" class="CatchallClause"> </a><a id="4624" class="CatchallClause Symbol">{</a><a id="4625" class="CatchallClause Number">1</a><a id="4626" class="CatchallClause Symbol">}</a><a id="4627" class="CatchallClause"> </a><a id="4628" class="CatchallClause Symbol">_</a>                       <a id="4652" class="Symbol">=</a> <a id="4654" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="4659" href="Data.Nat.Coprimality.html#4372" class="CatchallClause Function">prime⇒coprime</a><a id="4672" class="CatchallClause"> </a><a id="4673" class="CatchallClause Symbol">(</a><a id="4674" href="Agda.Builtin.Nat.html#128" class="CatchallClause InductiveConstructor">suc</a><a id="4677" class="CatchallClause"> </a><a id="4678" class="CatchallClause Symbol">(</a><a id="4679" href="Agda.Builtin.Nat.html#128" class="CatchallClause InductiveConstructor">suc</a><a id="4682" class="CatchallClause"> </a><a id="4683" href="Data.Nat.Coprimality.html#4683" class="CatchallClause Bound">m</a><a id="4684" class="CatchallClause Symbol">))</a><a id="4686" class="CatchallClause"> </a><a id="4687" href="Data.Nat.Coprimality.html#4687" class="CatchallClause Bound">p</a><a id="4688" class="CatchallClause">  </a><a id="4690" class="CatchallClause Symbol">_</a><a id="4691" class="CatchallClause"> </a><a id="4692" class="CatchallClause Symbol">_</a><a id="4693" class="CatchallClause">  </a><a id="4695" class="CatchallClause Symbol">_</a><a id="4696" class="CatchallClause"> </a><a id="4697" class="CatchallClause Symbol">{</a><a id="4698" class="CatchallClause Number">0</a><a id="4699" class="CatchallClause Symbol">}</a><a id="4700" class="CatchallClause"> </a><a id="4701" class="CatchallClause Symbol">(</a><a id="4702" href="Data.Nat.Divisibility.html#1334" class="CatchallClause InductiveConstructor">divides</a><a id="4709" class="CatchallClause"> </a><a id="4710" href="Data.Nat.Coprimality.html#4710" class="CatchallClause Bound">q</a><a id="4711" class="CatchallClause"> </a><a id="4712" href="Data.Nat.Coprimality.html#4712" class="CatchallClause Bound">2+m≡q*0</a><a id="4719" class="CatchallClause"> </a><a id="4720" href="Agda.Builtin.Sigma.html#139" class="CatchallClause InductiveConstructor Operator">,</a><a id="4721" class="CatchallClause"> </a><a id="4722" class="CatchallClause Symbol">_)</a> <a id="4725" class="Symbol">=</a>
  <a id="4729" href="Data.Empty.html#389" class="Function">⊥-elim</a> <a id="4736" href="Function.html#1920" class="Function Operator">$</a> <a id="4738" href="Data.Nat.Properties.html#11628" class="Function">i+1+j≢i</a> <a id="4746" class="Number">0</a> <a id="4748" class="Symbol">(</a><a id="4749" href="Relation.Binary.PropositionalEquality.html#4373" class="Function Operator">begin</a>
    <a id="4759" class="Number">2</a> <a id="4761" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">+</a> <a id="4763" href="Data.Nat.Coprimality.html#4683" class="Bound">m</a>  <a id="4766" href="Relation.Binary.PropositionalEquality.html#4490" class="Function Operator">≡⟨</a> <a id="4769" href="Data.Nat.Coprimality.html#4712" class="Bound">2+m≡q*0</a> <a id="4777" href="Relation.Binary.PropositionalEquality.html#4490" class="Function Operator">⟩</a>
    <a id="4783" href="Data.Nat.Coprimality.html#4710" class="Bound">q</a> <a id="4785" href="Agda.Builtin.Nat.html#433" class="Primitive Operator">*</a> <a id="4787" class="Number">0</a>  <a id="4790" href="Relation.Binary.PropositionalEquality.html#4490" class="Function Operator">≡⟨</a> <a id="4793" href="Data.Nat.Properties.html#15223" class="Function">*-zeroʳ</a> <a id="4801" href="Data.Nat.Coprimality.html#4710" class="Bound">q</a> <a id="4803" href="Relation.Binary.PropositionalEquality.html#4490" class="Function Operator">⟩</a>
    <a id="4809" class="Number">0</a>      <a id="4816" href="Relation.Binary.PropositionalEquality.html#4575" class="Function Operator">∎</a><a id="4817" class="Symbol">)</a>
  <a id="4821" class="Keyword">where</a> <a id="4827" class="Keyword">open</a> <a id="4832" href="Relation.Binary.PropositionalEquality.html#4279" class="Module">≡-Reasoning</a>
<a id="4844" href="Data.Nat.Coprimality.html#4372" class="Function">prime⇒coprime</a> <a id="4858" class="Symbol">(</a><a id="4859" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="4863" class="Symbol">(</a><a id="4864" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="4868" href="Data.Nat.Coprimality.html#4868" class="Bound">m</a><a id="4869" class="Symbol">))</a> <a id="4872" href="Data.Nat.Coprimality.html#4872" class="Bound">p</a> <a id="4874" class="Symbol">(</a><a id="4875" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="4879" href="Data.Nat.Coprimality.html#4879" class="Bound">n</a><a id="4880" class="Symbol">)</a> <a id="4882" class="Symbol">_</a> <a id="4884" href="Data.Nat.Coprimality.html#4884" class="Bound">1+n&lt;2+m</a> <a id="4892" class="Symbol">{</a><a id="4893" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="4897" class="Symbol">(</a><a id="4898" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="4902" href="Data.Nat.Coprimality.html#4902" class="Bound">i</a><a id="4903" class="Symbol">)}</a>
              <a id="4920" class="Symbol">(</a><a id="4921" href="Data.Nat.Coprimality.html#4921" class="Bound">2+i∣2+m</a> <a id="4929" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="4931" href="Data.Nat.Coprimality.html#4931" class="Bound">2+i∣1+n</a><a id="4938" class="Symbol">)</a> <a id="4940" class="Symbol">=</a>
  <a id="4944" href="Data.Empty.html#389" class="Function">⊥-elim</a> <a id="4951" class="Symbol">(</a><a id="4952" href="Data.Nat.Coprimality.html#4872" class="Bound">p</a> <a id="4954" class="Symbol">_</a> <a id="4956" href="Data.Nat.Coprimality.html#5121" class="Function">2+i′∣2+m</a><a id="4964" class="Symbol">)</a>
  <a id="4968" class="Keyword">where</a>
  <a id="4976" href="Data.Nat.Coprimality.html#4976" class="Function">i&lt;m</a> <a id="4980" class="Symbol">:</a> <a id="4982" href="Data.Nat.Coprimality.html#4902" class="Bound">i</a> <a id="4984" href="Data.Nat.Base.html#984" class="Function Operator">&lt;</a> <a id="4986" href="Data.Nat.Coprimality.html#4868" class="Bound">m</a>
  <a id="4990" href="Data.Nat.Coprimality.html#4976" class="Function">i&lt;m</a> <a id="4994" class="Symbol">=</a> <a id="4996" href="Data.Nat.Properties.html#1961" class="Function">≤-pred</a> <a id="5003" href="Function.html#1920" class="Function Operator">$</a> <a id="5005" href="Data.Nat.Properties.html#1961" class="Function">≤-pred</a> <a id="5012" class="Symbol">(</a><a id="5013" href="Relation.Binary.PreorderReasoning.html#1257" class="Function Operator">begin</a>
    <a id="5023" class="Number">3</a> <a id="5025" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">+</a> <a id="5027" href="Data.Nat.Coprimality.html#4902" class="Bound">i</a>  <a id="5030" href="Relation.Binary.PreorderReasoning.html#1323" class="Function Operator">≤⟨</a> <a id="5033" href="Data.Nat.Base.html#939" class="InductiveConstructor">s≤s</a> <a id="5037" class="Symbol">(</a><a id="5038" href="Data.Nat.Divisibility.html#1566" class="Function">∣⇒≤</a> <a id="5042" href="Data.Nat.Coprimality.html#4931" class="Bound">2+i∣1+n</a><a id="5049" class="Symbol">)</a> <a id="5051" href="Relation.Binary.PreorderReasoning.html#1323" class="Function Operator">⟩</a>
    <a id="5057" class="Number">2</a> <a id="5059" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">+</a> <a id="5061" href="Data.Nat.Coprimality.html#4879" class="Bound">n</a>  <a id="5064" href="Relation.Binary.PreorderReasoning.html#1323" class="Function Operator">≤⟨</a> <a id="5067" href="Data.Nat.Coprimality.html#4884" class="Bound">1+n&lt;2+m</a> <a id="5075" href="Relation.Binary.PreorderReasoning.html#1323" class="Function Operator">⟩</a>
    <a id="5081" class="Number">2</a> <a id="5083" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">+</a> <a id="5085" href="Data.Nat.Coprimality.html#4868" class="Bound">m</a>  <a id="5088" href="Relation.Binary.PreorderReasoning.html#1710" class="Function Operator">∎</a><a id="5089" class="Symbol">)</a>
    <a id="5095" class="Keyword">where</a> <a id="5101" class="Keyword">open</a> <a id="5106" href="Data.Nat.Properties.html#40915" class="Module">≤-Reasoning</a>

  <a id="5121" href="Data.Nat.Coprimality.html#5121" class="Function">2+i′∣2+m</a> <a id="5130" class="Symbol">:</a> <a id="5132" class="Number">2</a> <a id="5134" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">+</a> <a id="5136" href="Data.Fin.Base.html#1070" class="Function">toℕ</a> <a id="5140" class="Symbol">(</a><a id="5141" href="Data.Fin.Base.html#1839" class="Function">fromℕ≤</a> <a id="5148" href="Data.Nat.Coprimality.html#4976" class="Function">i&lt;m</a><a id="5151" class="Symbol">)</a> <a id="5153" href="Data.Nat.Divisibility.html#1294" class="Record Operator">∣</a> <a id="5155" class="Number">2</a> <a id="5157" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">+</a> <a id="5159" href="Data.Nat.Coprimality.html#4868" class="Bound">m</a>
  <a id="5163" href="Data.Nat.Coprimality.html#5121" class="Function">2+i′∣2+m</a> <a id="5172" class="Symbol">=</a> <a id="5174" href="Relation.Binary.PropositionalEquality.Core.html#971" class="Function">subst</a> <a id="5180" class="Symbol">(</a><a id="5181" href="Data.Nat.Divisibility.html#1294" class="Record Operator">_∣</a> <a id="5184" class="Number">2</a> <a id="5186" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">+</a> <a id="5188" href="Data.Nat.Coprimality.html#4868" class="Bound">m</a><a id="5189" class="Symbol">)</a>
    <a id="5195" class="Symbol">(</a><a id="5196" href="Relation.Binary.PropositionalEquality.Core.html#867" class="Function">P.sym</a> <a id="5202" class="Symbol">(</a><a id="5203" href="Relation.Binary.PropositionalEquality.html#1127" class="Function">cong</a> <a id="5208" class="Symbol">(</a><a id="5209" class="Number">2</a> <a id="5211" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">+_</a><a id="5213" class="Symbol">)</a> <a id="5215" class="Symbol">(</a><a id="5216" href="Data.Fin.Properties.html#4192" class="Function">toℕ-fromℕ≤</a> <a id="5227" href="Data.Nat.Coprimality.html#4976" class="Function">i&lt;m</a><a id="5230" class="Symbol">)))</a>
    <a id="5238" href="Data.Nat.Coprimality.html#4921" class="Bound">2+i∣2+m</a>
</pre></body></html>