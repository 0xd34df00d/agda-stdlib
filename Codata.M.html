<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Codata.M</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- M-types (the dual of W-types)</a>
<a id="139" class="Comment">------------------------------------------------------------------------</a>

<a id="213" class="Symbol">{-#</a> <a id="217" class="Keyword">OPTIONS</a> <a id="225" class="Option">--without-K</a> <a id="237" class="Option">--safe</a> <a id="244" class="Symbol">#-}</a>

<a id="249" class="Keyword">module</a> <a id="256" href="Codata.M.html" class="Module">Codata.M</a> <a id="265" class="Keyword">where</a>

<a id="272" class="Keyword">open</a> <a id="277" class="Keyword">import</a> <a id="284" href="Size.html" class="Module">Size</a>
<a id="289" class="Keyword">open</a> <a id="294" class="Keyword">import</a> <a id="301" href="Level.html" class="Module">Level</a>
<a id="307" class="Keyword">open</a> <a id="312" class="Keyword">import</a> <a id="319" href="Codata.Thunk.html" class="Module">Codata.Thunk</a> <a id="332" class="Keyword">using</a> <a id="338" class="Symbol">(</a><a id="339" href="Codata.Thunk.html#454" class="Record">Thunk</a><a id="344" class="Symbol">;</a> <a id="346" href="Codata.Thunk.html#530" class="Field">force</a><a id="351" class="Symbol">)</a>
<a id="353" class="Keyword">open</a> <a id="358" class="Keyword">import</a> <a id="365" href="Data.Product.html" class="Module">Data.Product</a> <a id="378" class="Keyword">hiding</a> <a id="385" class="Symbol">(</a><a id="386" href="Data.Product.html#2190" class="Function">map</a><a id="389" class="Symbol">)</a>
<a id="391" class="Keyword">open</a> <a id="396" class="Keyword">import</a> <a id="403" href="Data.Container.Core.html" class="Module">Data.Container.Core</a>
<a id="423" class="Keyword">import</a> <a id="430" href="Data.Container.html" class="Module">Data.Container</a> <a id="445" class="Symbol">as</a> <a id="448" class="Module">C</a>

<a id="451" class="Keyword">data</a> <a id="M"></a><a id="456" href="Codata.M.html#456" class="Datatype">M</a> <a id="458" class="Symbol">{</a><a id="459" href="Codata.M.html#459" class="Bound">s</a> <a id="461" href="Codata.M.html#461" class="Bound">p</a><a id="462" class="Symbol">}</a> <a id="464" class="Symbol">(</a><a id="465" href="Codata.M.html#465" class="Bound">C</a> <a id="467" class="Symbol">:</a> <a id="469" href="Data.Container.Core.html#422" class="Record">Container</a> <a id="479" href="Codata.M.html#459" class="Bound">s</a> <a id="481" href="Codata.M.html#461" class="Bound">p</a><a id="482" class="Symbol">)</a> <a id="484" class="Symbol">(</a><a id="485" href="Codata.M.html#485" class="Bound">i</a> <a id="487" class="Symbol">:</a> <a id="489" href="Agda.Builtin.Size.html#114" class="Postulate">Size</a><a id="493" class="Symbol">)</a> <a id="495" class="Symbol">:</a> <a id="497" class="PrimitiveType">Set</a> <a id="501" class="Symbol">(</a><a id="502" href="Codata.M.html#459" class="Bound">s</a> <a id="504" href="Agda.Primitive.html#657" class="Primitive Operator">⊔</a> <a id="506" href="Codata.M.html#461" class="Bound">p</a><a id="507" class="Symbol">)</a> <a id="509" class="Keyword">where</a>
  <a id="M.inf"></a><a id="517" href="Codata.M.html#517" class="InductiveConstructor">inf</a> <a id="521" class="Symbol">:</a> <a id="523" href="Data.Container.Core.html#612" class="Function Operator">⟦</a> <a id="525" href="Codata.M.html#465" class="Bound">C</a> <a id="527" href="Data.Container.Core.html#612" class="Function Operator">⟧</a> <a id="529" class="Symbol">(</a><a id="530" href="Codata.Thunk.html#454" class="Record">Thunk</a> <a id="536" class="Symbol">(</a><a id="537" href="Codata.M.html#456" class="Datatype">M</a> <a id="539" href="Codata.M.html#465" class="Bound">C</a><a id="540" class="Symbol">)</a> <a id="542" href="Codata.M.html#485" class="Bound">i</a><a id="543" class="Symbol">)</a> <a id="545" class="Symbol">→</a> <a id="547" href="Codata.M.html#456" class="Datatype">M</a> <a id="549" href="Codata.M.html#465" class="Bound">C</a> <a id="551" href="Codata.M.html#485" class="Bound">i</a>

<a id="554" class="Keyword">module</a> <a id="561" href="Codata.M.html#561" class="Module">_</a> <a id="563" class="Symbol">{</a><a id="564" href="Codata.M.html#564" class="Bound">s</a> <a id="566" href="Codata.M.html#566" class="Bound">p</a><a id="567" class="Symbol">}</a> <a id="569" class="Symbol">{</a><a id="570" href="Codata.M.html#570" class="Bound">C</a> <a id="572" class="Symbol">:</a> <a id="574" href="Data.Container.Core.html#422" class="Record">Container</a> <a id="584" href="Codata.M.html#564" class="Bound">s</a> <a id="586" href="Codata.M.html#566" class="Bound">p</a><a id="587" class="Symbol">}</a> <a id="589" class="Symbol">(</a><a id="590" class="Keyword">open</a> <a id="595" href="Data.Container.Core.html#422" class="Module">Container</a> <a id="605" href="Codata.M.html#570" class="Bound">C</a><a id="606" class="Symbol">)</a> <a id="608" class="Keyword">where</a>

  <a id="617" href="Codata.M.html#617" class="Function">head</a> <a id="622" class="Symbol">:</a> <a id="624" class="Symbol">∀</a> <a id="626" class="Symbol">{</a><a id="627" href="Codata.M.html#627" class="Bound">i</a><a id="628" class="Symbol">}</a> <a id="630" class="Symbol">→</a> <a id="632" href="Codata.M.html#456" class="Datatype">M</a> <a id="634" href="Codata.M.html#570" class="Bound">C</a> <a id="636" href="Codata.M.html#627" class="Bound">i</a> <a id="638" class="Symbol">→</a> <a id="640" href="Data.Container.Core.html#502" class="Field">Shape</a>
  <a id="648" href="Codata.M.html#617" class="Function">head</a> <a id="653" class="Symbol">(</a><a id="654" href="Codata.M.html#517" class="InductiveConstructor">inf</a> <a id="658" class="Symbol">(</a><a id="659" href="Codata.M.html#659" class="Bound">x</a> <a id="661" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="663" href="Codata.M.html#663" class="Bound">f</a><a id="664" class="Symbol">))</a> <a id="667" class="Symbol">=</a> <a id="669" href="Codata.M.html#659" class="Bound">x</a>

  <a id="674" href="Codata.M.html#674" class="Function">tail</a> <a id="679" class="Symbol">:</a> <a id="681" class="Symbol">(</a><a id="682" href="Codata.M.html#682" class="Bound">x</a> <a id="684" class="Symbol">:</a> <a id="686" href="Codata.M.html#456" class="Datatype">M</a> <a id="688" href="Codata.M.html#570" class="Bound">C</a> <a id="690" href="Agda.Builtin.Size.html#210" class="Postulate">∞</a><a id="691" class="Symbol">)</a> <a id="693" class="Symbol">→</a> <a id="695" href="Data.Container.Core.html#523" class="Field">Position</a> <a id="704" class="Symbol">(</a><a id="705" href="Codata.M.html#617" class="Function">head</a> <a id="710" href="Codata.M.html#682" class="Bound">x</a><a id="711" class="Symbol">)</a> <a id="713" class="Symbol">→</a> <a id="715" href="Codata.M.html#456" class="Datatype">M</a> <a id="717" href="Codata.M.html#570" class="Bound">C</a> <a id="719" href="Agda.Builtin.Size.html#210" class="Postulate">∞</a>
  <a id="723" href="Codata.M.html#674" class="Function">tail</a> <a id="728" class="Symbol">(</a><a id="729" href="Codata.M.html#517" class="InductiveConstructor">inf</a> <a id="733" class="Symbol">(</a><a id="734" href="Codata.M.html#734" class="Bound">x</a> <a id="736" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="738" href="Codata.M.html#738" class="Bound">f</a><a id="739" class="Symbol">))</a> <a id="742" class="Symbol">=</a> <a id="744" class="Symbol">λ</a> <a id="746" href="Codata.M.html#746" class="Bound">p</a> <a id="748" class="Symbol">→</a> <a id="750" href="Codata.M.html#738" class="Bound">f</a> <a id="752" href="Codata.M.html#746" class="Bound">p</a> <a id="754" class="Symbol">.</a><a id="755" href="Codata.Thunk.html#530" class="Field">force</a>

<a id="762" class="Comment">-- map</a>

<a id="770" class="Keyword">module</a> <a id="777" href="Codata.M.html#777" class="Module">_</a> <a id="779" class="Symbol">{</a><a id="780" href="Codata.M.html#780" class="Bound">s₁</a> <a id="783" href="Codata.M.html#783" class="Bound">s₂</a> <a id="786" href="Codata.M.html#786" class="Bound">p₁</a> <a id="789" href="Codata.M.html#789" class="Bound">p₂</a><a id="791" class="Symbol">}</a> <a id="793" class="Symbol">{</a><a id="794" href="Codata.M.html#794" class="Bound">C₁</a> <a id="797" class="Symbol">:</a> <a id="799" href="Data.Container.Core.html#422" class="Record">Container</a> <a id="809" href="Codata.M.html#780" class="Bound">s₁</a> <a id="812" href="Codata.M.html#786" class="Bound">p₁</a><a id="814" class="Symbol">}</a> <a id="816" class="Symbol">{</a><a id="817" href="Codata.M.html#817" class="Bound">C₂</a> <a id="820" class="Symbol">:</a> <a id="822" href="Data.Container.Core.html#422" class="Record">Container</a> <a id="832" href="Codata.M.html#783" class="Bound">s₂</a> <a id="835" href="Codata.M.html#789" class="Bound">p₂</a><a id="837" class="Symbol">}</a>
         <a id="848" class="Symbol">(</a><a id="849" href="Codata.M.html#849" class="Bound">m</a> <a id="851" class="Symbol">:</a> <a id="853" href="Codata.M.html#794" class="Bound">C₁</a> <a id="856" href="Data.Container.Core.html#756" class="Record Operator">⇒</a> <a id="858" href="Codata.M.html#817" class="Bound">C₂</a><a id="860" class="Symbol">)</a> <a id="862" class="Keyword">where</a>

  <a id="871" href="Codata.M.html#871" class="Function">map</a> <a id="875" class="Symbol">:</a> <a id="877" class="Symbol">∀</a> <a id="879" class="Symbol">{</a><a id="880" href="Codata.M.html#880" class="Bound">i</a><a id="881" class="Symbol">}</a> <a id="883" class="Symbol">→</a> <a id="885" href="Codata.M.html#456" class="Datatype">M</a> <a id="887" href="Codata.M.html#794" class="Bound">C₁</a> <a id="890" href="Codata.M.html#880" class="Bound">i</a> <a id="892" class="Symbol">→</a> <a id="894" href="Codata.M.html#456" class="Datatype">M</a> <a id="896" href="Codata.M.html#817" class="Bound">C₂</a> <a id="899" href="Codata.M.html#880" class="Bound">i</a>
  <a id="903" href="Codata.M.html#871" class="Function">map</a> <a id="907" class="Symbol">(</a><a id="908" href="Codata.M.html#517" class="InductiveConstructor">inf</a> <a id="912" href="Codata.M.html#912" class="Bound">t</a><a id="913" class="Symbol">)</a> <a id="915" class="Symbol">=</a> <a id="917" href="Codata.M.html#517" class="InductiveConstructor">inf</a> <a id="921" class="Symbol">(</a><a id="922" href="Data.Container.Core.html#1029" class="Function Operator">⟪</a> <a id="924" href="Codata.M.html#849" class="Bound">m</a> <a id="926" href="Data.Container.Core.html#1029" class="Function Operator">⟫</a> <a id="928" class="Symbol">(</a><a id="929" href="Data.Container.html#2706" class="Function">C.map</a> <a id="935" class="Symbol">(λ</a> <a id="938" href="Codata.M.html#938" class="Bound">t</a> <a id="940" class="Symbol">→</a> <a id="942" class="Symbol">λ</a> <a id="944" class="Keyword">where</a> <a id="950" class="Symbol">.</a><a id="951" href="Codata.Thunk.html#530" class="Field">force</a> <a id="957" class="Symbol">→</a> <a id="959" href="Codata.M.html#871" class="Function">map</a> <a id="963" class="Symbol">(</a><a id="964" href="Codata.M.html#938" class="Bound">t</a> <a id="966" class="Symbol">.</a><a id="967" href="Codata.Thunk.html#530" class="Field">force</a><a id="972" class="Symbol">))</a> <a id="975" href="Codata.M.html#912" class="Bound">t</a><a id="976" class="Symbol">))</a>

<a id="980" class="Comment">-- unfold</a>

<a id="991" class="Keyword">module</a> <a id="998" href="Codata.M.html#998" class="Module">_</a> <a id="1000" class="Symbol">{</a><a id="1001" href="Codata.M.html#1001" class="Bound">s</a> <a id="1003" href="Codata.M.html#1003" class="Bound">p</a> <a id="1005" href="Codata.M.html#1005" class="Bound">ℓ</a><a id="1006" class="Symbol">}</a> <a id="1008" class="Symbol">{</a><a id="1009" href="Codata.M.html#1009" class="Bound">C</a> <a id="1011" class="Symbol">:</a> <a id="1013" href="Data.Container.Core.html#422" class="Record">Container</a> <a id="1023" href="Codata.M.html#1001" class="Bound">s</a> <a id="1025" href="Codata.M.html#1003" class="Bound">p</a><a id="1026" class="Symbol">}</a> <a id="1028" class="Symbol">(</a><a id="1029" class="Keyword">open</a> <a id="1034" href="Data.Container.Core.html#422" class="Module">Container</a> <a id="1044" href="Codata.M.html#1009" class="Bound">C</a><a id="1045" class="Symbol">)</a>
         <a id="1056" class="Symbol">{</a><a id="1057" href="Codata.M.html#1057" class="Bound">S</a> <a id="1059" class="Symbol">:</a> <a id="1061" class="PrimitiveType">Set</a> <a id="1065" href="Codata.M.html#1005" class="Bound">ℓ</a><a id="1066" class="Symbol">}</a> <a id="1068" class="Symbol">(</a><a id="1069" href="Codata.M.html#1069" class="Bound">alg</a> <a id="1073" class="Symbol">:</a> <a id="1075" href="Codata.M.html#1057" class="Bound">S</a> <a id="1077" class="Symbol">→</a> <a id="1079" href="Data.Container.Core.html#612" class="Function Operator">⟦</a> <a id="1081" href="Codata.M.html#1009" class="Bound">C</a> <a id="1083" href="Data.Container.Core.html#612" class="Function Operator">⟧</a> <a id="1085" href="Codata.M.html#1057" class="Bound">S</a><a id="1086" class="Symbol">)</a> <a id="1088" class="Keyword">where</a>

  <a id="1097" href="Codata.M.html#1097" class="Function">unfold</a> <a id="1104" class="Symbol">:</a> <a id="1106" href="Codata.M.html#1057" class="Bound">S</a> <a id="1108" class="Symbol">→</a> <a id="1110" class="Symbol">∀</a> <a id="1112" class="Symbol">{</a><a id="1113" href="Codata.M.html#1113" class="Bound">i</a><a id="1114" class="Symbol">}</a> <a id="1116" class="Symbol">→</a> <a id="1118" href="Codata.M.html#456" class="Datatype">M</a> <a id="1120" href="Codata.M.html#1009" class="Bound">C</a> <a id="1122" href="Codata.M.html#1113" class="Bound">i</a>
  <a id="1126" href="Codata.M.html#1097" class="Function">unfold</a> <a id="1133" href="Codata.M.html#1133" class="Bound">seed</a> <a id="1138" class="Symbol">=</a> <a id="1140" class="Keyword">let</a> <a id="1144" class="Symbol">(</a><a id="1145" href="Codata.M.html#1145" class="Bound">x</a> <a id="1147" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1149" href="Codata.M.html#1149" class="Bound">next</a><a id="1153" class="Symbol">)</a> <a id="1155" class="Symbol">=</a> <a id="1157" href="Codata.M.html#1069" class="Bound">alg</a> <a id="1161" href="Codata.M.html#1133" class="Bound">seed</a> <a id="1166" class="Keyword">in</a>
                <a id="1185" href="Codata.M.html#517" class="InductiveConstructor">inf</a> <a id="1189" class="Symbol">(</a><a id="1190" href="Codata.M.html#1145" class="Bound">x</a> <a id="1192" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1194" class="Symbol">λ</a> <a id="1196" href="Codata.M.html#1196" class="Bound">p</a> <a id="1198" class="Symbol">→</a> <a id="1200" class="Symbol">λ</a> <a id="1202" class="Keyword">where</a> <a id="1208" class="Symbol">.</a><a id="1209" href="Codata.Thunk.html#530" class="Field">force</a> <a id="1215" class="Symbol">→</a> <a id="1217" href="Codata.M.html#1097" class="Function">unfold</a> <a id="1224" class="Symbol">(</a><a id="1225" href="Codata.M.html#1149" class="Bound">next</a> <a id="1230" href="Codata.M.html#1196" class="Bound">p</a><a id="1231" class="Symbol">))</a>


<a id="1236" class="Comment">------------------------------------------------------------------------</a>
<a id="1309" class="Comment">-- Legacy</a>

<a id="1320" class="Keyword">open</a> <a id="1325" class="Keyword">import</a> <a id="1332" href="Codata.Musical.Notation.html" class="Module">Codata.Musical.Notation</a> <a id="1356" class="Keyword">using</a> <a id="1362" class="Symbol">(</a><a id="1363" href="Agda.Builtin.Coinduction.html#164" class="Field">♭</a><a id="1364" class="Symbol">;</a> <a id="1366" href="Agda.Builtin.Coinduction.html#129" class="CoinductiveConstructor Operator">♯_</a><a id="1368" class="Symbol">)</a>
<a id="1370" class="Keyword">import</a> <a id="1377" href="Codata.Musical.M.html" class="Module">Codata.Musical.M</a> <a id="1394" class="Symbol">as</a> <a id="1397" class="Module">M</a>

<a id="1400" class="Keyword">module</a> <a id="1407" href="Codata.M.html#1407" class="Module">_</a> <a id="1409" class="Symbol">{</a><a id="1410" href="Codata.M.html#1410" class="Bound">s</a> <a id="1412" href="Codata.M.html#1412" class="Bound">p</a><a id="1413" class="Symbol">}</a> <a id="1415" class="Symbol">{</a><a id="1416" href="Codata.M.html#1416" class="Bound">C</a> <a id="1418" class="Symbol">:</a> <a id="1420" href="Data.Container.Core.html#422" class="Record">Container</a> <a id="1430" href="Codata.M.html#1410" class="Bound">s</a> <a id="1432" href="Codata.M.html#1412" class="Bound">p</a><a id="1433" class="Symbol">}</a> <a id="1435" class="Keyword">where</a>

  <a id="1444" href="Codata.M.html#1444" class="Function">fromMusical</a> <a id="1456" class="Symbol">:</a> <a id="1458" class="Symbol">∀</a> <a id="1460" class="Symbol">{</a><a id="1461" href="Codata.M.html#1461" class="Bound">i</a><a id="1462" class="Symbol">}</a> <a id="1464" class="Symbol">→</a> <a id="1466" href="Codata.Musical.M.html#437" class="Datatype">M.M</a> <a id="1470" href="Codata.M.html#1416" class="Bound">C</a> <a id="1472" class="Symbol">→</a> <a id="1474" href="Codata.M.html#456" class="Datatype">M</a> <a id="1476" href="Codata.M.html#1416" class="Bound">C</a> <a id="1478" href="Codata.M.html#1461" class="Bound">i</a>
  <a id="1482" href="Codata.M.html#1444" class="Function">fromMusical</a> <a id="1494" class="Symbol">(</a><a id="1495" href="Codata.Musical.M.html#487" class="InductiveConstructor">M.inf</a> <a id="1501" href="Codata.M.html#1501" class="Bound">t</a><a id="1502" class="Symbol">)</a> <a id="1504" class="Symbol">=</a> <a id="1506" href="Codata.M.html#517" class="InductiveConstructor">inf</a> <a id="1510" class="Symbol">(</a><a id="1511" href="Data.Container.html#2706" class="Function">C.map</a> <a id="1517" href="Codata.M.html#1534" class="Function">rec</a> <a id="1521" href="Codata.M.html#1501" class="Bound">t</a><a id="1522" class="Symbol">)</a> <a id="1524" class="Keyword">where</a>
    <a id="1534" href="Codata.M.html#1534" class="Function">rec</a> <a id="1538" class="Symbol">=</a> <a id="1540" class="Symbol">λ</a> <a id="1542" href="Codata.M.html#1542" class="Bound">x</a> <a id="1544" class="Symbol">→</a> <a id="1546" class="Symbol">λ</a> <a id="1548" class="Keyword">where</a> <a id="1554" class="Symbol">.</a><a id="1555" href="Codata.Thunk.html#530" class="Field">force</a> <a id="1561" class="Symbol">→</a> <a id="1563" href="Codata.M.html#1444" class="Function">fromMusical</a> <a id="1575" class="Symbol">(</a><a id="1576" href="Agda.Builtin.Coinduction.html#164" class="Field">♭</a> <a id="1578" href="Codata.M.html#1542" class="Bound">x</a><a id="1579" class="Symbol">)</a>

  <a id="1584" href="Codata.M.html#1584" class="Function">toMusical</a> <a id="1594" class="Symbol">:</a> <a id="1596" href="Codata.M.html#456" class="Datatype">M</a> <a id="1598" href="Codata.M.html#1416" class="Bound">C</a> <a id="1600" href="Agda.Builtin.Size.html#210" class="Postulate">∞</a> <a id="1602" class="Symbol">→</a> <a id="1604" href="Codata.Musical.M.html#437" class="Datatype">M.M</a> <a id="1608" href="Codata.M.html#1416" class="Bound">C</a>
  <a id="1612" href="Codata.M.html#1584" class="Function">toMusical</a> <a id="1622" class="Symbol">(</a><a id="1623" href="Codata.M.html#517" class="InductiveConstructor">inf</a> <a id="1627" class="Symbol">(</a><a id="1628" href="Codata.M.html#1628" class="Bound">s</a> <a id="1630" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1632" href="Codata.M.html#1632" class="Bound">f</a><a id="1633" class="Symbol">))</a> <a id="1636" class="Symbol">=</a> <a id="1638" href="Codata.Musical.M.html#487" class="InductiveConstructor">M.inf</a> <a id="1644" class="Symbol">(</a><a id="1645" href="Codata.M.html#1628" class="Bound">s</a> <a id="1647" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1649" class="Symbol">λ</a> <a id="1651" href="Codata.M.html#1651" class="Bound">p</a> <a id="1653" class="Symbol">→</a> <a id="1655" href="Agda.Builtin.Coinduction.html#129" class="CoinductiveConstructor Operator">♯</a> <a id="1657" href="Codata.M.html#1584" class="Function">toMusical</a> <a id="1667" class="Symbol">(</a><a id="1668" href="Codata.M.html#1632" class="Bound">f</a> <a id="1670" href="Codata.M.html#1651" class="Bound">p</a> <a id="1672" class="Symbol">.</a><a id="1673" href="Codata.Thunk.html#530" class="Field">force</a><a id="1678" class="Symbol">))</a>
</pre></body></html>