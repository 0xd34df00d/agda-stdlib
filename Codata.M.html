<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Codata.M</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- M-types (the dual of W-types)</a>
<a id="139" class="Comment">------------------------------------------------------------------------</a>

<a id="213" class="Symbol">{-#</a> <a id="217" class="Keyword">OPTIONS</a> <a id="225" class="Option">--without-K</a> <a id="237" class="Symbol">#-}</a>

<a id="242" class="Keyword">module</a> <a id="249" href="Codata.M.html" class="Module">Codata.M</a> <a id="258" class="Keyword">where</a>

<a id="265" class="Keyword">open</a> <a id="270" class="Keyword">import</a> <a id="277" href="Size.html" class="Module">Size</a>
<a id="282" class="Keyword">open</a> <a id="287" class="Keyword">import</a> <a id="294" href="Level.html" class="Module">Level</a>
<a id="300" class="Keyword">open</a> <a id="305" class="Keyword">import</a> <a id="312" href="Codata.Thunk.html" class="Module">Codata.Thunk</a> <a id="325" class="Keyword">using</a> <a id="331" class="Symbol">(</a><a id="332" href="Codata.Thunk.html#447" class="Record">Thunk</a><a id="337" class="Symbol">;</a> <a id="339" href="Codata.Thunk.html#523" class="Field">force</a><a id="344" class="Symbol">)</a>
<a id="346" class="Keyword">open</a> <a id="351" class="Keyword">import</a> <a id="358" href="Data.Product.html" class="Module">Data.Product</a> <a id="371" class="Keyword">hiding</a> <a id="378" class="Symbol">(</a><a id="379" href="Data.Product.html#2183" class="Function">map</a><a id="382" class="Symbol">)</a>
<a id="384" class="Keyword">open</a> <a id="389" class="Keyword">import</a> <a id="396" href="Data.Container.Core.html" class="Module">Data.Container.Core</a>
<a id="416" class="Keyword">import</a> <a id="423" href="Data.Container.html" class="Module">Data.Container</a> <a id="438" class="Symbol">as</a> <a id="441" class="Module">C</a>

<a id="444" class="Keyword">data</a> <a id="M"></a><a id="449" href="Codata.M.html#449" class="Datatype">M</a> <a id="451" class="Symbol">{</a><a id="452" href="Codata.M.html#452" class="Bound">s</a> <a id="454" href="Codata.M.html#454" class="Bound">p</a><a id="455" class="Symbol">}</a> <a id="457" class="Symbol">(</a><a id="458" href="Codata.M.html#458" class="Bound">C</a> <a id="460" class="Symbol">:</a> <a id="462" href="Data.Container.Core.html#415" class="Record">Container</a> <a id="472" href="Codata.M.html#452" class="Bound">s</a> <a id="474" href="Codata.M.html#454" class="Bound">p</a><a id="475" class="Symbol">)</a> <a id="477" class="Symbol">(</a><a id="478" href="Codata.M.html#478" class="Bound">i</a> <a id="480" class="Symbol">:</a> <a id="482" href="Agda.Builtin.Size.html#114" class="Postulate">Size</a><a id="486" class="Symbol">)</a> <a id="488" class="Symbol">:</a> <a id="490" class="PrimitiveType">Set</a> <a id="494" class="Symbol">(</a><a id="495" href="Codata.M.html#452" class="Bound">s</a> <a id="497" href="Agda.Primitive.html#657" class="Primitive Operator">⊔</a> <a id="499" href="Codata.M.html#454" class="Bound">p</a><a id="500" class="Symbol">)</a> <a id="502" class="Keyword">where</a>
  <a id="M.inf"></a><a id="510" href="Codata.M.html#510" class="InductiveConstructor">inf</a> <a id="514" class="Symbol">:</a> <a id="516" href="Data.Container.Core.html#605" class="Function Operator">⟦</a> <a id="518" href="Codata.M.html#458" class="Bound">C</a> <a id="520" href="Data.Container.Core.html#605" class="Function Operator">⟧</a> <a id="522" class="Symbol">(</a><a id="523" href="Codata.Thunk.html#447" class="Record">Thunk</a> <a id="529" class="Symbol">(</a><a id="530" href="Codata.M.html#449" class="Datatype">M</a> <a id="532" href="Codata.M.html#458" class="Bound">C</a><a id="533" class="Symbol">)</a> <a id="535" href="Codata.M.html#478" class="Bound">i</a><a id="536" class="Symbol">)</a> <a id="538" class="Symbol">→</a> <a id="540" href="Codata.M.html#449" class="Datatype">M</a> <a id="542" href="Codata.M.html#458" class="Bound">C</a> <a id="544" href="Codata.M.html#478" class="Bound">i</a>

<a id="547" class="Keyword">module</a> <a id="554" href="Codata.M.html#554" class="Module">_</a> <a id="556" class="Symbol">{</a><a id="557" href="Codata.M.html#557" class="Bound">s</a> <a id="559" href="Codata.M.html#559" class="Bound">p</a><a id="560" class="Symbol">}</a> <a id="562" class="Symbol">{</a><a id="563" href="Codata.M.html#563" class="Bound">C</a> <a id="565" class="Symbol">:</a> <a id="567" href="Data.Container.Core.html#415" class="Record">Container</a> <a id="577" href="Codata.M.html#557" class="Bound">s</a> <a id="579" href="Codata.M.html#559" class="Bound">p</a><a id="580" class="Symbol">}</a> <a id="582" class="Symbol">(</a><a id="583" class="Keyword">open</a> <a id="588" href="Data.Container.Core.html#415" class="Module">Container</a> <a id="598" href="Codata.M.html#563" class="Bound">C</a><a id="599" class="Symbol">)</a> <a id="601" class="Keyword">where</a>

  <a id="610" href="Codata.M.html#610" class="Function">head</a> <a id="615" class="Symbol">:</a> <a id="617" class="Symbol">∀</a> <a id="619" class="Symbol">{</a><a id="620" href="Codata.M.html#620" class="Bound">i</a><a id="621" class="Symbol">}</a> <a id="623" class="Symbol">→</a> <a id="625" href="Codata.M.html#449" class="Datatype">M</a> <a id="627" href="Codata.M.html#563" class="Bound">C</a> <a id="629" href="Codata.M.html#620" class="Bound">i</a> <a id="631" class="Symbol">→</a> <a id="633" href="Data.Container.Core.html#495" class="Field">Shape</a>
  <a id="641" href="Codata.M.html#610" class="Function">head</a> <a id="646" class="Symbol">(</a><a id="647" href="Codata.M.html#510" class="InductiveConstructor">inf</a> <a id="651" class="Symbol">(</a><a id="652" href="Codata.M.html#652" class="Bound">x</a> <a id="654" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="656" href="Codata.M.html#656" class="Bound">f</a><a id="657" class="Symbol">))</a> <a id="660" class="Symbol">=</a> <a id="662" href="Codata.M.html#652" class="Bound">x</a>

  <a id="667" href="Codata.M.html#667" class="Function">tail</a> <a id="672" class="Symbol">:</a> <a id="674" class="Symbol">(</a><a id="675" href="Codata.M.html#675" class="Bound">x</a> <a id="677" class="Symbol">:</a> <a id="679" href="Codata.M.html#449" class="Datatype">M</a> <a id="681" href="Codata.M.html#563" class="Bound">C</a> <a id="683" href="Agda.Builtin.Size.html#210" class="Postulate">∞</a><a id="684" class="Symbol">)</a> <a id="686" class="Symbol">→</a> <a id="688" href="Data.Container.Core.html#516" class="Field">Position</a> <a id="697" class="Symbol">(</a><a id="698" href="Codata.M.html#610" class="Function">head</a> <a id="703" href="Codata.M.html#675" class="Bound">x</a><a id="704" class="Symbol">)</a> <a id="706" class="Symbol">→</a> <a id="708" href="Codata.M.html#449" class="Datatype">M</a> <a id="710" href="Codata.M.html#563" class="Bound">C</a> <a id="712" href="Agda.Builtin.Size.html#210" class="Postulate">∞</a>
  <a id="716" href="Codata.M.html#667" class="Function">tail</a> <a id="721" class="Symbol">(</a><a id="722" href="Codata.M.html#510" class="InductiveConstructor">inf</a> <a id="726" class="Symbol">(</a><a id="727" href="Codata.M.html#727" class="Bound">x</a> <a id="729" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="731" href="Codata.M.html#731" class="Bound">f</a><a id="732" class="Symbol">))</a> <a id="735" class="Symbol">=</a> <a id="737" class="Symbol">λ</a> <a id="739" href="Codata.M.html#739" class="Bound">p</a> <a id="741" class="Symbol">→</a> <a id="743" href="Codata.M.html#731" class="Bound">f</a> <a id="745" href="Codata.M.html#739" class="Bound">p</a> <a id="747" class="Symbol">.</a><a id="748" href="Codata.Thunk.html#523" class="Field">force</a>

<a id="755" class="Comment">-- map</a>

<a id="763" class="Keyword">module</a> <a id="770" href="Codata.M.html#770" class="Module">_</a> <a id="772" class="Symbol">{</a><a id="773" href="Codata.M.html#773" class="Bound">s₁</a> <a id="776" href="Codata.M.html#776" class="Bound">s₂</a> <a id="779" href="Codata.M.html#779" class="Bound">p₁</a> <a id="782" href="Codata.M.html#782" class="Bound">p₂</a><a id="784" class="Symbol">}</a> <a id="786" class="Symbol">{</a><a id="787" href="Codata.M.html#787" class="Bound">C₁</a> <a id="790" class="Symbol">:</a> <a id="792" href="Data.Container.Core.html#415" class="Record">Container</a> <a id="802" href="Codata.M.html#773" class="Bound">s₁</a> <a id="805" href="Codata.M.html#779" class="Bound">p₁</a><a id="807" class="Symbol">}</a> <a id="809" class="Symbol">{</a><a id="810" href="Codata.M.html#810" class="Bound">C₂</a> <a id="813" class="Symbol">:</a> <a id="815" href="Data.Container.Core.html#415" class="Record">Container</a> <a id="825" href="Codata.M.html#776" class="Bound">s₂</a> <a id="828" href="Codata.M.html#782" class="Bound">p₂</a><a id="830" class="Symbol">}</a>
         <a id="841" class="Symbol">(</a><a id="842" href="Codata.M.html#842" class="Bound">m</a> <a id="844" class="Symbol">:</a> <a id="846" href="Codata.M.html#787" class="Bound">C₁</a> <a id="849" href="Data.Container.Core.html#749" class="Record Operator">⇒</a> <a id="851" href="Codata.M.html#810" class="Bound">C₂</a><a id="853" class="Symbol">)</a> <a id="855" class="Keyword">where</a>

  <a id="864" href="Codata.M.html#864" class="Function">map</a> <a id="868" class="Symbol">:</a> <a id="870" class="Symbol">∀</a> <a id="872" class="Symbol">{</a><a id="873" href="Codata.M.html#873" class="Bound">i</a><a id="874" class="Symbol">}</a> <a id="876" class="Symbol">→</a> <a id="878" href="Codata.M.html#449" class="Datatype">M</a> <a id="880" href="Codata.M.html#787" class="Bound">C₁</a> <a id="883" href="Codata.M.html#873" class="Bound">i</a> <a id="885" class="Symbol">→</a> <a id="887" href="Codata.M.html#449" class="Datatype">M</a> <a id="889" href="Codata.M.html#810" class="Bound">C₂</a> <a id="892" href="Codata.M.html#873" class="Bound">i</a>
  <a id="896" href="Codata.M.html#864" class="Function">map</a> <a id="900" class="Symbol">(</a><a id="901" href="Codata.M.html#510" class="InductiveConstructor">inf</a> <a id="905" href="Codata.M.html#905" class="Bound">t</a><a id="906" class="Symbol">)</a> <a id="908" class="Symbol">=</a> <a id="910" href="Codata.M.html#510" class="InductiveConstructor">inf</a> <a id="914" class="Symbol">(</a><a id="915" href="Data.Container.Core.html#1022" class="Function Operator">⟪</a> <a id="917" href="Codata.M.html#842" class="Bound">m</a> <a id="919" href="Data.Container.Core.html#1022" class="Function Operator">⟫</a> <a id="921" class="Symbol">(</a><a id="922" href="Data.Container.html#2699" class="Function">C.map</a> <a id="928" class="Symbol">(λ</a> <a id="931" href="Codata.M.html#931" class="Bound">t</a> <a id="933" class="Symbol">→</a> <a id="935" class="Symbol">λ</a> <a id="937" class="Keyword">where</a> <a id="943" class="Symbol">.</a><a id="944" href="Codata.Thunk.html#523" class="Field">force</a> <a id="950" class="Symbol">→</a> <a id="952" href="Codata.M.html#864" class="Function">map</a> <a id="956" class="Symbol">(</a><a id="957" href="Codata.M.html#931" class="Bound">t</a> <a id="959" class="Symbol">.</a><a id="960" href="Codata.Thunk.html#523" class="Field">force</a><a id="965" class="Symbol">))</a> <a id="968" href="Codata.M.html#905" class="Bound">t</a><a id="969" class="Symbol">))</a>

<a id="973" class="Comment">-- unfold</a>

<a id="984" class="Keyword">module</a> <a id="991" href="Codata.M.html#991" class="Module">_</a> <a id="993" class="Symbol">{</a><a id="994" href="Codata.M.html#994" class="Bound">s</a> <a id="996" href="Codata.M.html#996" class="Bound">p</a> <a id="998" href="Codata.M.html#998" class="Bound">ℓ</a><a id="999" class="Symbol">}</a> <a id="1001" class="Symbol">{</a><a id="1002" href="Codata.M.html#1002" class="Bound">C</a> <a id="1004" class="Symbol">:</a> <a id="1006" href="Data.Container.Core.html#415" class="Record">Container</a> <a id="1016" href="Codata.M.html#994" class="Bound">s</a> <a id="1018" href="Codata.M.html#996" class="Bound">p</a><a id="1019" class="Symbol">}</a> <a id="1021" class="Symbol">(</a><a id="1022" class="Keyword">open</a> <a id="1027" href="Data.Container.Core.html#415" class="Module">Container</a> <a id="1037" href="Codata.M.html#1002" class="Bound">C</a><a id="1038" class="Symbol">)</a>
         <a id="1049" class="Symbol">{</a><a id="1050" href="Codata.M.html#1050" class="Bound">S</a> <a id="1052" class="Symbol">:</a> <a id="1054" class="PrimitiveType">Set</a> <a id="1058" href="Codata.M.html#998" class="Bound">ℓ</a><a id="1059" class="Symbol">}</a> <a id="1061" class="Symbol">(</a><a id="1062" href="Codata.M.html#1062" class="Bound">alg</a> <a id="1066" class="Symbol">:</a> <a id="1068" href="Codata.M.html#1050" class="Bound">S</a> <a id="1070" class="Symbol">→</a> <a id="1072" href="Data.Container.Core.html#605" class="Function Operator">⟦</a> <a id="1074" href="Codata.M.html#1002" class="Bound">C</a> <a id="1076" href="Data.Container.Core.html#605" class="Function Operator">⟧</a> <a id="1078" href="Codata.M.html#1050" class="Bound">S</a><a id="1079" class="Symbol">)</a> <a id="1081" class="Keyword">where</a>

  <a id="1090" href="Codata.M.html#1090" class="Function">unfold</a> <a id="1097" class="Symbol">:</a> <a id="1099" href="Codata.M.html#1050" class="Bound">S</a> <a id="1101" class="Symbol">→</a> <a id="1103" class="Symbol">∀</a> <a id="1105" class="Symbol">{</a><a id="1106" href="Codata.M.html#1106" class="Bound">i</a><a id="1107" class="Symbol">}</a> <a id="1109" class="Symbol">→</a> <a id="1111" href="Codata.M.html#449" class="Datatype">M</a> <a id="1113" href="Codata.M.html#1002" class="Bound">C</a> <a id="1115" href="Codata.M.html#1106" class="Bound">i</a>
  <a id="1119" href="Codata.M.html#1090" class="Function">unfold</a> <a id="1126" href="Codata.M.html#1126" class="Bound">seed</a> <a id="1131" class="Symbol">=</a> <a id="1133" class="Keyword">let</a> <a id="1137" class="Symbol">(</a><a id="1138" href="Codata.M.html#1138" class="Bound">x</a> <a id="1140" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1142" href="Codata.M.html#1142" class="Bound">next</a><a id="1146" class="Symbol">)</a> <a id="1148" class="Symbol">=</a> <a id="1150" href="Codata.M.html#1062" class="Bound">alg</a> <a id="1154" href="Codata.M.html#1126" class="Bound">seed</a> <a id="1159" class="Keyword">in</a>
                <a id="1178" href="Codata.M.html#510" class="InductiveConstructor">inf</a> <a id="1182" class="Symbol">(</a><a id="1183" href="Codata.M.html#1138" class="Bound">x</a> <a id="1185" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1187" class="Symbol">λ</a> <a id="1189" href="Codata.M.html#1189" class="Bound">p</a> <a id="1191" class="Symbol">→</a> <a id="1193" class="Symbol">λ</a> <a id="1195" class="Keyword">where</a> <a id="1201" class="Symbol">.</a><a id="1202" href="Codata.Thunk.html#523" class="Field">force</a> <a id="1208" class="Symbol">→</a> <a id="1210" href="Codata.M.html#1090" class="Function">unfold</a> <a id="1217" class="Symbol">(</a><a id="1218" href="Codata.M.html#1142" class="Bound">next</a> <a id="1223" href="Codata.M.html#1189" class="Bound">p</a><a id="1224" class="Symbol">))</a>


<a id="1229" class="Comment">------------------------------------------------------------------------</a>
<a id="1302" class="Comment">-- Legacy</a>

<a id="1313" class="Keyword">open</a> <a id="1318" class="Keyword">import</a> <a id="1325" href="Codata.Musical.Notation.html" class="Module">Codata.Musical.Notation</a> <a id="1349" class="Keyword">using</a> <a id="1355" class="Symbol">(</a><a id="1356" href="Agda.Builtin.Coinduction.html#164" class="Field">♭</a><a id="1357" class="Symbol">;</a> <a id="1359" href="Agda.Builtin.Coinduction.html#129" class="CoinductiveConstructor Operator">♯_</a><a id="1361" class="Symbol">)</a>
<a id="1363" class="Keyword">import</a> <a id="1370" href="Codata.Musical.M.html" class="Module">Codata.Musical.M</a> <a id="1387" class="Symbol">as</a> <a id="1390" class="Module">M</a>

<a id="1393" class="Keyword">module</a> <a id="1400" href="Codata.M.html#1400" class="Module">_</a> <a id="1402" class="Symbol">{</a><a id="1403" href="Codata.M.html#1403" class="Bound">s</a> <a id="1405" href="Codata.M.html#1405" class="Bound">p</a><a id="1406" class="Symbol">}</a> <a id="1408" class="Symbol">{</a><a id="1409" href="Codata.M.html#1409" class="Bound">C</a> <a id="1411" class="Symbol">:</a> <a id="1413" href="Data.Container.Core.html#415" class="Record">Container</a> <a id="1423" href="Codata.M.html#1403" class="Bound">s</a> <a id="1425" href="Codata.M.html#1405" class="Bound">p</a><a id="1426" class="Symbol">}</a> <a id="1428" class="Keyword">where</a>

  <a id="1437" href="Codata.M.html#1437" class="Function">fromMusical</a> <a id="1449" class="Symbol">:</a> <a id="1451" class="Symbol">∀</a> <a id="1453" class="Symbol">{</a><a id="1454" href="Codata.M.html#1454" class="Bound">i</a><a id="1455" class="Symbol">}</a> <a id="1457" class="Symbol">→</a> <a id="1459" href="Codata.Musical.M.html#430" class="Datatype">M.M</a> <a id="1463" href="Codata.M.html#1409" class="Bound">C</a> <a id="1465" class="Symbol">→</a> <a id="1467" href="Codata.M.html#449" class="Datatype">M</a> <a id="1469" href="Codata.M.html#1409" class="Bound">C</a> <a id="1471" href="Codata.M.html#1454" class="Bound">i</a>
  <a id="1475" href="Codata.M.html#1437" class="Function">fromMusical</a> <a id="1487" class="Symbol">(</a><a id="1488" href="Codata.Musical.M.html#480" class="InductiveConstructor">M.inf</a> <a id="1494" href="Codata.M.html#1494" class="Bound">t</a><a id="1495" class="Symbol">)</a> <a id="1497" class="Symbol">=</a> <a id="1499" href="Codata.M.html#510" class="InductiveConstructor">inf</a> <a id="1503" class="Symbol">(</a><a id="1504" href="Data.Container.html#2699" class="Function">C.map</a> <a id="1510" href="Codata.M.html#1527" class="Function">rec</a> <a id="1514" href="Codata.M.html#1494" class="Bound">t</a><a id="1515" class="Symbol">)</a> <a id="1517" class="Keyword">where</a>
    <a id="1527" href="Codata.M.html#1527" class="Function">rec</a> <a id="1531" class="Symbol">=</a> <a id="1533" class="Symbol">λ</a> <a id="1535" href="Codata.M.html#1535" class="Bound">x</a> <a id="1537" class="Symbol">→</a> <a id="1539" class="Symbol">λ</a> <a id="1541" class="Keyword">where</a> <a id="1547" class="Symbol">.</a><a id="1548" href="Codata.Thunk.html#523" class="Field">force</a> <a id="1554" class="Symbol">→</a> <a id="1556" href="Codata.M.html#1437" class="Function">fromMusical</a> <a id="1568" class="Symbol">(</a><a id="1569" href="Agda.Builtin.Coinduction.html#164" class="Field">♭</a> <a id="1571" href="Codata.M.html#1535" class="Bound">x</a><a id="1572" class="Symbol">)</a>

  <a id="1577" href="Codata.M.html#1577" class="Function">toMusical</a> <a id="1587" class="Symbol">:</a> <a id="1589" href="Codata.M.html#449" class="Datatype">M</a> <a id="1591" href="Codata.M.html#1409" class="Bound">C</a> <a id="1593" href="Agda.Builtin.Size.html#210" class="Postulate">∞</a> <a id="1595" class="Symbol">→</a> <a id="1597" href="Codata.Musical.M.html#430" class="Datatype">M.M</a> <a id="1601" href="Codata.M.html#1409" class="Bound">C</a>
  <a id="1605" href="Codata.M.html#1577" class="Function">toMusical</a> <a id="1615" class="Symbol">(</a><a id="1616" href="Codata.M.html#510" class="InductiveConstructor">inf</a> <a id="1620" class="Symbol">(</a><a id="1621" href="Codata.M.html#1621" class="Bound">s</a> <a id="1623" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1625" href="Codata.M.html#1625" class="Bound">f</a><a id="1626" class="Symbol">))</a> <a id="1629" class="Symbol">=</a> <a id="1631" href="Codata.Musical.M.html#480" class="InductiveConstructor">M.inf</a> <a id="1637" class="Symbol">(</a><a id="1638" href="Codata.M.html#1621" class="Bound">s</a> <a id="1640" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1642" class="Symbol">λ</a> <a id="1644" href="Codata.M.html#1644" class="Bound">p</a> <a id="1646" class="Symbol">→</a> <a id="1648" href="Agda.Builtin.Coinduction.html#129" class="CoinductiveConstructor Operator">♯</a> <a id="1650" href="Codata.M.html#1577" class="Function">toMusical</a> <a id="1660" class="Symbol">(</a><a id="1661" href="Codata.M.html#1625" class="Bound">f</a> <a id="1663" href="Codata.M.html#1644" class="Bound">p</a> <a id="1665" class="Symbol">.</a><a id="1666" href="Codata.Thunk.html#523" class="Field">force</a><a id="1671" class="Symbol">))</a>
</pre></body></html>