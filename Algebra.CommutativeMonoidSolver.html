<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Algebra.CommutativeMonoidSolver</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Solver for equations in commutative monoids</a>
<a id="153" class="Comment">--</a>
<a id="156" class="Comment">-- Adapted from Algebra.Monoid-solver</a>
<a id="194" class="Comment">------------------------------------------------------------------------</a>

<a id="268" class="Keyword">open</a> <a id="273" class="Keyword">import</a> <a id="280" href="Algebra.html" class="Module">Algebra</a>

<a id="289" class="Keyword">open</a> <a id="294" class="Keyword">import</a> <a id="301" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="310" class="Keyword">using</a> <a id="316" class="Symbol">(</a><a id="317" href="Data.Fin.html#923" class="Datatype">Fin</a><a id="320" class="Symbol">;</a> <a id="322" href="Data.Fin.html#945" class="InductiveConstructor">zero</a><a id="326" class="Symbol">;</a> <a id="328" href="Data.Fin.html#976" class="InductiveConstructor">suc</a><a id="331" class="Symbol">)</a>
<a id="333" class="Keyword">open</a> <a id="338" class="Keyword">import</a> <a id="345" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="356" class="Symbol">as</a> <a id="359" class="Module">Maybe</a>
  <a id="367" class="Keyword">using</a> <a id="373" class="Symbol">(</a><a id="374" href="Data.Maybe.Base.html#335" class="Datatype">Maybe</a><a id="379" class="Symbol">;</a> <a id="381" href="Data.Maybe.Base.html#1217" class="Function">decToMaybe</a><a id="391" class="Symbol">;</a> <a id="393" href="Data.Maybe.Base.html#1736" class="Function">From-just</a><a id="402" class="Symbol">;</a> <a id="404" href="Data.Maybe.Base.html#1840" class="Function">from-just</a><a id="413" class="Symbol">)</a>
<a id="415" class="Keyword">open</a> <a id="420" class="Keyword">import</a> <a id="427" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="441" class="Symbol">as</a> <a id="444" class="Module">ℕ</a> <a id="446" class="Keyword">using</a> <a id="452" class="Symbol">(</a><a id="453" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="454" class="Symbol">;</a> <a id="456" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a><a id="460" class="Symbol">;</a> <a id="462" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a><a id="465" class="Symbol">;</a> <a id="467" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">_+_</a><a id="470" class="Symbol">)</a>
<a id="472" class="Keyword">open</a> <a id="477" class="Keyword">import</a> <a id="484" href="Data.Nat.GeneralisedArithmetic.html" class="Module">Data.Nat.GeneralisedArithmetic</a> <a id="515" class="Keyword">using</a> <a id="521" class="Symbol">(</a><a id="522" href="Data.Nat.GeneralisedArithmetic.html#472" class="Function">fold</a><a id="526" class="Symbol">)</a>
<a id="528" class="Keyword">open</a> <a id="533" class="Keyword">import</a> <a id="540" href="Data.Product.html" class="Module">Data.Product</a> <a id="553" class="Keyword">using</a> <a id="559" class="Symbol">(</a><a id="560" href="Data.Product.html#1329" class="Function Operator">_×_</a><a id="563" class="Symbol">;</a> <a id="565" href="Data.Product.html#559" class="Field">proj₁</a><a id="570" class="Symbol">;</a> <a id="572" href="Data.Product.html#573" class="Field">proj₂</a><a id="577" class="Symbol">;</a> <a id="579" href="Data.Product.html#3102" class="Function">uncurry</a><a id="586" class="Symbol">)</a>
<a id="588" class="Keyword">open</a> <a id="593" class="Keyword">import</a> <a id="600" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="609" class="Keyword">using</a> <a id="615" class="Symbol">(</a><a id="616" href="Data.Vec.html#638" class="Datatype">Vec</a><a id="619" class="Symbol">;</a> <a id="621" href="Data.Vec.html#678" class="InductiveConstructor">[]</a><a id="623" class="Symbol">;</a> <a id="625" href="Data.Vec.html#697" class="InductiveConstructor Operator">_∷_</a><a id="628" class="Symbol">;</a> <a id="630" href="Data.Vec.html#6482" class="Function">lookup</a><a id="636" class="Symbol">;</a> <a id="638" href="Data.Vec.html#1783" class="Function">replicate</a><a id="647" class="Symbol">)</a>

<a id="650" class="Keyword">open</a> <a id="655" class="Keyword">import</a> <a id="662" href="Function.html" class="Module">Function</a> <a id="671" class="Keyword">using</a> <a id="677" class="Symbol">(</a><a id="678" href="Function.html#748" class="Function Operator">_∘_</a><a id="681" class="Symbol">)</a>

<a id="684" class="Keyword">import</a> <a id="691" href="Relation.Binary.EqReasoning.html" class="Module">Relation.Binary.EqReasoning</a>  <a id="720" class="Symbol">as</a> <a id="723" class="Module">EqReasoning</a>
<a id="735" class="Keyword">import</a> <a id="742" href="Relation.Binary.Reflection.html" class="Module">Relation.Binary.Reflection</a>   <a id="771" class="Symbol">as</a> <a id="774" class="Module">Reflection</a>
<a id="785" class="Keyword">import</a> <a id="792" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a>   <a id="821" class="Symbol">as</a> <a id="824" class="Module">Dec</a>
<a id="828" class="Keyword">import</a> <a id="835" href="Data.Vec.Relation.Pointwise.html" class="Module">Data.Vec.Relation.Pointwise</a> <a id="863" class="Symbol">as</a> <a id="866" class="Module">Pointwise</a>

<a id="877" class="Keyword">open</a> <a id="882" class="Keyword">import</a> <a id="889" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="927" class="Symbol">as</a> <a id="930" class="Module">P</a> <a id="932" class="Keyword">using</a> <a id="938" class="Symbol">(</a><a id="939" href="Agda.Builtin.Equality.html#83" class="Datatype Operator">_≡_</a><a id="942" class="Symbol">;</a> <a id="944" href="Relation.Binary.PropositionalEquality.html#1599" class="Function">decSetoid</a><a id="953" class="Symbol">)</a>
<a id="955" class="Keyword">open</a> <a id="960" class="Keyword">import</a> <a id="967" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="984" class="Keyword">using</a> <a id="990" class="Symbol">(</a><a id="991" href="Relation.Nullary.html#484" class="Datatype">Dec</a><a id="994" class="Symbol">)</a>

<a id="997" class="Keyword">module</a> <a id="1004" href="Algebra.CommutativeMonoidSolver.html" class="Module">Algebra.CommutativeMonoidSolver</a> <a id="1036" class="Symbol">{</a><a id="1037" href="Algebra.CommutativeMonoidSolver.html#1037" class="Bound">m₁</a> <a id="1040" href="Algebra.CommutativeMonoidSolver.html#1040" class="Bound">m₂</a><a id="1042" class="Symbol">}</a> <a id="1044" class="Symbol">(</a><a id="1045" href="Algebra.CommutativeMonoidSolver.html#1045" class="Bound">M</a> <a id="1047" class="Symbol">:</a> <a id="1049" href="Algebra.html#1511" class="Record">CommutativeMonoid</a> <a id="1067" href="Algebra.CommutativeMonoidSolver.html#1037" class="Bound">m₁</a> <a id="1070" href="Algebra.CommutativeMonoidSolver.html#1040" class="Bound">m₂</a><a id="1072" class="Symbol">)</a> <a id="1074" class="Keyword">where</a>

<a id="1081" class="Keyword">open</a> <a id="1086" href="Algebra.html#1511" class="Module">CommutativeMonoid</a> <a id="1104" href="Algebra.CommutativeMonoidSolver.html#1045" class="Bound">M</a>
<a id="1106" class="Keyword">open</a> <a id="1111" href="Relation.Binary.EqReasoning.html" class="Module">EqReasoning</a> <a id="1123" href="Algebra.Structures.html#887" class="Function">setoid</a>

<a id="1131" class="Comment">------------------------------------------------------------------------</a>
<a id="1204" class="Comment">-- Monoid expressions</a>

<a id="1227" class="Comment">-- There is one constructor for every operation, plus one for</a>
<a id="1289" class="Comment">-- variables; there may be at most n variables.</a>

<a id="1338" class="Keyword">infixr</a> <a id="1345" class="Number">5</a> <a id="1347" href="Algebra.CommutativeMonoidSolver.html#1436" class="InductiveConstructor Operator">_⊕_</a>
<a id="1351" class="Keyword">infixr</a> <a id="1358" class="Number">10</a> <a id="1361" href="Algebra.CommutativeMonoidSolver.html#2411" class="Function Operator">_•_</a>

<a id="1366" class="Keyword">data</a> <a id="1371" href="Algebra.CommutativeMonoidSolver.html#1371" class="Datatype">Expr</a> <a id="1376" class="Symbol">(</a><a id="1377" href="Algebra.CommutativeMonoidSolver.html#1377" class="Bound">n</a> <a id="1379" class="Symbol">:</a> <a id="1381" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="1382" class="Symbol">)</a> <a id="1384" class="Symbol">:</a> <a id="1386" class="PrimitiveType">Set</a> <a id="1390" class="Keyword">where</a>
  <a id="1398" href="Algebra.CommutativeMonoidSolver.html#1398" class="InductiveConstructor">var</a> <a id="1402" class="Symbol">:</a> <a id="1404" href="Data.Fin.html#923" class="Datatype">Fin</a> <a id="1408" href="Algebra.CommutativeMonoidSolver.html#1377" class="Bound">n</a> <a id="1410" class="Symbol">→</a> <a id="1412" href="Algebra.CommutativeMonoidSolver.html#1371" class="Datatype">Expr</a> <a id="1417" href="Algebra.CommutativeMonoidSolver.html#1377" class="Bound">n</a>
  <a id="1421" href="Algebra.CommutativeMonoidSolver.html#1421" class="InductiveConstructor">id</a>  <a id="1425" class="Symbol">:</a> <a id="1427" href="Algebra.CommutativeMonoidSolver.html#1371" class="Datatype">Expr</a> <a id="1432" href="Algebra.CommutativeMonoidSolver.html#1377" class="Bound">n</a>
  <a id="1436" href="Algebra.CommutativeMonoidSolver.html#1436" class="InductiveConstructor Operator">_⊕_</a> <a id="1440" class="Symbol">:</a> <a id="1442" href="Algebra.CommutativeMonoidSolver.html#1371" class="Datatype">Expr</a> <a id="1447" href="Algebra.CommutativeMonoidSolver.html#1377" class="Bound">n</a> <a id="1449" class="Symbol">→</a> <a id="1451" href="Algebra.CommutativeMonoidSolver.html#1371" class="Datatype">Expr</a> <a id="1456" href="Algebra.CommutativeMonoidSolver.html#1377" class="Bound">n</a> <a id="1458" class="Symbol">→</a> <a id="1460" href="Algebra.CommutativeMonoidSolver.html#1371" class="Datatype">Expr</a> <a id="1465" href="Algebra.CommutativeMonoidSolver.html#1377" class="Bound">n</a>

<a id="1468" class="Comment">-- An environment contains one value for every variable.</a>

<a id="1526" href="Algebra.CommutativeMonoidSolver.html#1526" class="Function">Env</a> <a id="1530" class="Symbol">:</a> <a id="1532" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="1534" class="Symbol">→</a> <a id="1536" class="PrimitiveType">Set</a> <a id="1540" class="Symbol">_</a>
<a id="1542" href="Algebra.CommutativeMonoidSolver.html#1526" class="Function">Env</a> <a id="1546" href="Algebra.CommutativeMonoidSolver.html#1546" class="Bound">n</a> <a id="1548" class="Symbol">=</a> <a id="1550" href="Data.Vec.html#638" class="Datatype">Vec</a> <a id="1554" href="Algebra.html#1601" class="Field">Carrier</a> <a id="1562" href="Algebra.CommutativeMonoidSolver.html#1546" class="Bound">n</a>

<a id="1565" class="Comment">-- The semantics of an expression is a function from an environment to</a>
<a id="1636" class="Comment">-- a value.</a>

<a id="1649" href="Algebra.CommutativeMonoidSolver.html#1649" class="Function Operator">⟦_⟧</a> <a id="1653" class="Symbol">:</a> <a id="1655" class="Symbol">∀</a> <a id="1657" class="Symbol">{</a><a id="1658" href="Algebra.CommutativeMonoidSolver.html#1658" class="Bound">n</a><a id="1659" class="Symbol">}</a> <a id="1661" class="Symbol">→</a> <a id="1663" href="Algebra.CommutativeMonoidSolver.html#1371" class="Datatype">Expr</a> <a id="1668" href="Algebra.CommutativeMonoidSolver.html#1658" class="Bound">n</a> <a id="1670" class="Symbol">→</a> <a id="1672" href="Algebra.CommutativeMonoidSolver.html#1526" class="Function">Env</a> <a id="1676" href="Algebra.CommutativeMonoidSolver.html#1658" class="Bound">n</a> <a id="1678" class="Symbol">→</a> <a id="1680" href="Algebra.html#1601" class="Field">Carrier</a>
<a id="1688" href="Algebra.CommutativeMonoidSolver.html#1649" class="Function Operator">⟦</a> <a id="1690" href="Algebra.CommutativeMonoidSolver.html#1398" class="InductiveConstructor">var</a> <a id="1694" href="Algebra.CommutativeMonoidSolver.html#1694" class="Bound">x</a>   <a id="1698" href="Algebra.CommutativeMonoidSolver.html#1649" class="Function Operator">⟧</a> <a id="1700" href="Algebra.CommutativeMonoidSolver.html#1700" class="Bound">ρ</a> <a id="1702" class="Symbol">=</a> <a id="1704" href="Data.Vec.html#6482" class="Function">lookup</a> <a id="1711" href="Algebra.CommutativeMonoidSolver.html#1694" class="Bound">x</a> <a id="1713" href="Algebra.CommutativeMonoidSolver.html#1700" class="Bound">ρ</a>
<a id="1715" href="Algebra.CommutativeMonoidSolver.html#1649" class="Function Operator">⟦</a> <a id="1717" href="Algebra.CommutativeMonoidSolver.html#1421" class="InductiveConstructor">id</a>      <a id="1725" href="Algebra.CommutativeMonoidSolver.html#1649" class="Function Operator">⟧</a> <a id="1727" href="Algebra.CommutativeMonoidSolver.html#1727" class="Bound">ρ</a> <a id="1729" class="Symbol">=</a> <a id="1731" href="Algebra.html#1711" class="Field">ε</a>
<a id="1733" href="Algebra.CommutativeMonoidSolver.html#1649" class="Function Operator">⟦</a> <a id="1735" href="Algebra.CommutativeMonoidSolver.html#1735" class="Bound">e₁</a> <a id="1738" href="Algebra.CommutativeMonoidSolver.html#1436" class="InductiveConstructor Operator">⊕</a> <a id="1740" href="Algebra.CommutativeMonoidSolver.html#1740" class="Bound">e₂</a> <a id="1743" href="Algebra.CommutativeMonoidSolver.html#1649" class="Function Operator">⟧</a> <a id="1745" href="Algebra.CommutativeMonoidSolver.html#1745" class="Bound">ρ</a> <a id="1747" class="Symbol">=</a> <a id="1749" href="Algebra.CommutativeMonoidSolver.html#1649" class="Function Operator">⟦</a> <a id="1751" href="Algebra.CommutativeMonoidSolver.html#1735" class="Bound">e₁</a> <a id="1754" href="Algebra.CommutativeMonoidSolver.html#1649" class="Function Operator">⟧</a> <a id="1756" href="Algebra.CommutativeMonoidSolver.html#1745" class="Bound">ρ</a> <a id="1758" href="Algebra.html#1673" class="Field Operator">∙</a> <a id="1760" href="Algebra.CommutativeMonoidSolver.html#1649" class="Function Operator">⟦</a> <a id="1762" href="Algebra.CommutativeMonoidSolver.html#1740" class="Bound">e₂</a> <a id="1765" href="Algebra.CommutativeMonoidSolver.html#1649" class="Function Operator">⟧</a> <a id="1767" href="Algebra.CommutativeMonoidSolver.html#1745" class="Bound">ρ</a>

<a id="1770" class="Comment">------------------------------------------------------------------------</a>
<a id="1843" class="Comment">-- Normal forms</a>

<a id="1860" class="Comment">-- A normal form is a vector of multiplicities (a bag).</a>

<a id="1917" href="Algebra.CommutativeMonoidSolver.html#1917" class="Function">Normal</a> <a id="1924" class="Symbol">:</a> <a id="1926" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="1928" class="Symbol">→</a> <a id="1930" class="PrimitiveType">Set</a>
<a id="1934" href="Algebra.CommutativeMonoidSolver.html#1917" class="Function">Normal</a> <a id="1941" href="Algebra.CommutativeMonoidSolver.html#1941" class="Bound">n</a> <a id="1943" class="Symbol">=</a> <a id="1945" href="Data.Vec.html#638" class="Datatype">Vec</a> <a id="1949" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="1951" href="Algebra.CommutativeMonoidSolver.html#1941" class="Bound">n</a>

<a id="1954" class="Comment">-- The semantics of a normal form.</a>

<a id="1990" href="Algebra.CommutativeMonoidSolver.html#1990" class="Function Operator">⟦_⟧⇓</a> <a id="1995" class="Symbol">:</a> <a id="1997" class="Symbol">∀</a> <a id="1999" class="Symbol">{</a><a id="2000" href="Algebra.CommutativeMonoidSolver.html#2000" class="Bound">n</a><a id="2001" class="Symbol">}</a> <a id="2003" class="Symbol">→</a> <a id="2005" href="Algebra.CommutativeMonoidSolver.html#1917" class="Function">Normal</a> <a id="2012" href="Algebra.CommutativeMonoidSolver.html#2000" class="Bound">n</a> <a id="2014" class="Symbol">→</a> <a id="2016" href="Algebra.CommutativeMonoidSolver.html#1526" class="Function">Env</a> <a id="2020" href="Algebra.CommutativeMonoidSolver.html#2000" class="Bound">n</a> <a id="2022" class="Symbol">→</a> <a id="2024" href="Algebra.html#1601" class="Field">Carrier</a>
<a id="2032" href="Algebra.CommutativeMonoidSolver.html#1990" class="Function Operator">⟦</a> <a id="2034" href="Data.Vec.html#678" class="InductiveConstructor">[]</a>    <a id="2040" href="Algebra.CommutativeMonoidSolver.html#1990" class="Function Operator">⟧⇓</a> <a id="2043" class="Symbol">_</a> <a id="2045" class="Symbol">=</a> <a id="2047" href="Algebra.html#1711" class="Field">ε</a>
<a id="2049" href="Algebra.CommutativeMonoidSolver.html#1990" class="Function Operator">⟦</a> <a id="2051" href="Algebra.CommutativeMonoidSolver.html#2051" class="Bound">n</a> <a id="2053" href="Data.Vec.html#697" class="InductiveConstructor Operator">∷</a> <a id="2055" href="Algebra.CommutativeMonoidSolver.html#2055" class="Bound">v</a> <a id="2057" href="Algebra.CommutativeMonoidSolver.html#1990" class="Function Operator">⟧⇓</a> <a id="2060" class="Symbol">(</a><a id="2061" href="Algebra.CommutativeMonoidSolver.html#2061" class="Bound">a</a> <a id="2063" href="Data.Vec.html#697" class="InductiveConstructor Operator">∷</a> <a id="2065" href="Algebra.CommutativeMonoidSolver.html#2065" class="Bound">ρ</a><a id="2066" class="Symbol">)</a> <a id="2068" class="Symbol">=</a> <a id="2070" href="Data.Nat.GeneralisedArithmetic.html#472" class="Function">fold</a> <a id="2075" class="Symbol">(</a><a id="2076" href="Algebra.CommutativeMonoidSolver.html#1990" class="Function Operator">⟦</a> <a id="2078" href="Algebra.CommutativeMonoidSolver.html#2055" class="Bound">v</a> <a id="2080" href="Algebra.CommutativeMonoidSolver.html#1990" class="Function Operator">⟧⇓</a> <a id="2083" href="Algebra.CommutativeMonoidSolver.html#2065" class="Bound">ρ</a><a id="2084" class="Symbol">)</a> <a id="2086" class="Symbol">(λ</a> <a id="2089" href="Algebra.CommutativeMonoidSolver.html#2089" class="Bound">b</a> <a id="2091" class="Symbol">→</a> <a id="2093" href="Algebra.CommutativeMonoidSolver.html#2061" class="Bound">a</a> <a id="2095" href="Algebra.html#1673" class="Field Operator">∙</a> <a id="2097" href="Algebra.CommutativeMonoidSolver.html#2089" class="Bound">b</a><a id="2098" class="Symbol">)</a> <a id="2100" href="Algebra.CommutativeMonoidSolver.html#2051" class="Bound">n</a>

<a id="2103" class="Comment">------------------------------------------------------------------------</a>
<a id="2176" class="Comment">-- Constructions on normal forms</a>

<a id="2210" class="Comment">-- The empty bag.</a>

<a id="2229" href="Algebra.CommutativeMonoidSolver.html#2229" class="Function">empty</a> <a id="2235" class="Symbol">:</a> <a id="2237" class="Symbol">∀{</a><a id="2239" href="Algebra.CommutativeMonoidSolver.html#2239" class="Bound">n</a><a id="2240" class="Symbol">}</a> <a id="2242" class="Symbol">→</a> <a id="2244" href="Algebra.CommutativeMonoidSolver.html#1917" class="Function">Normal</a> <a id="2251" href="Algebra.CommutativeMonoidSolver.html#2239" class="Bound">n</a>
<a id="2253" href="Algebra.CommutativeMonoidSolver.html#2229" class="Function">empty</a> <a id="2259" class="Symbol">=</a> <a id="2261" href="Data.Vec.html#1783" class="Function">replicate</a> <a id="2271" class="Number">0</a>

<a id="2274" class="Comment">-- A singleton bag.</a>

<a id="2295" href="Algebra.CommutativeMonoidSolver.html#2295" class="Function">sg</a> <a id="2298" class="Symbol">:</a> <a id="2300" class="Symbol">∀{</a><a id="2302" href="Algebra.CommutativeMonoidSolver.html#2302" class="Bound">n</a><a id="2303" class="Symbol">}</a> <a id="2305" class="Symbol">(</a><a id="2306" href="Algebra.CommutativeMonoidSolver.html#2306" class="Bound">i</a> <a id="2308" class="Symbol">:</a> <a id="2310" href="Data.Fin.html#923" class="Datatype">Fin</a> <a id="2314" href="Algebra.CommutativeMonoidSolver.html#2302" class="Bound">n</a><a id="2315" class="Symbol">)</a> <a id="2317" class="Symbol">→</a> <a id="2319" href="Algebra.CommutativeMonoidSolver.html#1917" class="Function">Normal</a> <a id="2326" href="Algebra.CommutativeMonoidSolver.html#2302" class="Bound">n</a>
<a id="2328" href="Algebra.CommutativeMonoidSolver.html#2295" class="Function">sg</a> <a id="2331" href="Data.Fin.html#945" class="InductiveConstructor">zero</a>    <a id="2339" class="Symbol">=</a> <a id="2341" class="Number">1</a> <a id="2343" href="Data.Vec.html#697" class="InductiveConstructor Operator">∷</a> <a id="2345" href="Algebra.CommutativeMonoidSolver.html#2229" class="Function">empty</a>
<a id="2351" href="Algebra.CommutativeMonoidSolver.html#2295" class="Function">sg</a> <a id="2354" class="Symbol">(</a><a id="2355" href="Data.Fin.html#976" class="InductiveConstructor">suc</a> <a id="2359" href="Algebra.CommutativeMonoidSolver.html#2359" class="Bound">i</a><a id="2360" class="Symbol">)</a> <a id="2362" class="Symbol">=</a> <a id="2364" class="Number">0</a> <a id="2366" href="Data.Vec.html#697" class="InductiveConstructor Operator">∷</a> <a id="2368" href="Algebra.CommutativeMonoidSolver.html#2295" class="Function">sg</a> <a id="2371" href="Algebra.CommutativeMonoidSolver.html#2359" class="Bound">i</a>

<a id="2374" class="Comment">-- The composition of normal forms.</a>

<a id="2411" href="Algebra.CommutativeMonoidSolver.html#2411" class="Function Operator">_•_</a>  <a id="2416" class="Symbol">:</a> <a id="2418" class="Symbol">∀{</a><a id="2420" href="Algebra.CommutativeMonoidSolver.html#2420" class="Bound">n</a><a id="2421" class="Symbol">}</a> <a id="2423" class="Symbol">(</a><a id="2424" href="Algebra.CommutativeMonoidSolver.html#2424" class="Bound">v</a> <a id="2426" href="Algebra.CommutativeMonoidSolver.html#2426" class="Bound">w</a> <a id="2428" class="Symbol">:</a> <a id="2430" href="Algebra.CommutativeMonoidSolver.html#1917" class="Function">Normal</a> <a id="2437" href="Algebra.CommutativeMonoidSolver.html#2420" class="Bound">n</a><a id="2438" class="Symbol">)</a> <a id="2440" class="Symbol">→</a> <a id="2442" href="Algebra.CommutativeMonoidSolver.html#1917" class="Function">Normal</a> <a id="2449" href="Algebra.CommutativeMonoidSolver.html#2420" class="Bound">n</a>
<a id="2451" href="Data.Vec.html#678" class="InductiveConstructor">[]</a>      <a id="2459" href="Algebra.CommutativeMonoidSolver.html#2411" class="Function Operator">•</a> <a id="2461" href="Data.Vec.html#678" class="InductiveConstructor">[]</a>      <a id="2469" class="Symbol">=</a> <a id="2471" href="Data.Vec.html#678" class="InductiveConstructor">[]</a>
<a id="2474" class="Symbol">(</a><a id="2475" href="Algebra.CommutativeMonoidSolver.html#2475" class="Bound">l</a> <a id="2477" href="Data.Vec.html#697" class="InductiveConstructor Operator">∷</a> <a id="2479" href="Algebra.CommutativeMonoidSolver.html#2479" class="Bound">v</a><a id="2480" class="Symbol">)</a> <a id="2482" href="Algebra.CommutativeMonoidSolver.html#2411" class="Function Operator">•</a> <a id="2484" class="Symbol">(</a><a id="2485" href="Algebra.CommutativeMonoidSolver.html#2485" class="Bound">m</a> <a id="2487" href="Data.Vec.html#697" class="InductiveConstructor Operator">∷</a> <a id="2489" href="Algebra.CommutativeMonoidSolver.html#2489" class="Bound">w</a><a id="2490" class="Symbol">)</a> <a id="2492" class="Symbol">=</a> <a id="2494" href="Algebra.CommutativeMonoidSolver.html#2475" class="Bound">l</a> <a id="2496" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">+</a> <a id="2498" href="Algebra.CommutativeMonoidSolver.html#2485" class="Bound">m</a> <a id="2500" href="Data.Vec.html#697" class="InductiveConstructor Operator">∷</a> <a id="2502" href="Algebra.CommutativeMonoidSolver.html#2479" class="Bound">v</a> <a id="2504" href="Algebra.CommutativeMonoidSolver.html#2411" class="Function Operator">•</a> <a id="2506" href="Algebra.CommutativeMonoidSolver.html#2489" class="Bound">w</a>

<a id="2509" class="Comment">------------------------------------------------------------------------</a>
<a id="2582" class="Comment">-- Correctness of the constructions on normal forms</a>

<a id="2635" class="Comment">-- The empty bag stands for the unit ε.</a>

<a id="2676" href="Algebra.CommutativeMonoidSolver.html#2676" class="Function">empty-correct</a> <a id="2690" class="Symbol">:</a> <a id="2692" class="Symbol">∀{</a><a id="2694" href="Algebra.CommutativeMonoidSolver.html#2694" class="Bound">n</a><a id="2695" class="Symbol">}</a> <a id="2697" class="Symbol">(</a><a id="2698" href="Algebra.CommutativeMonoidSolver.html#2698" class="Bound">ρ</a> <a id="2700" class="Symbol">:</a> <a id="2702" href="Algebra.CommutativeMonoidSolver.html#1526" class="Function">Env</a> <a id="2706" href="Algebra.CommutativeMonoidSolver.html#2694" class="Bound">n</a><a id="2707" class="Symbol">)</a> <a id="2709" class="Symbol">→</a> <a id="2711" href="Algebra.CommutativeMonoidSolver.html#1990" class="Function Operator">⟦</a> <a id="2713" href="Algebra.CommutativeMonoidSolver.html#2229" class="Function">empty</a> <a id="2719" href="Algebra.CommutativeMonoidSolver.html#1990" class="Function Operator">⟧⇓</a> <a id="2722" href="Algebra.CommutativeMonoidSolver.html#2698" class="Bound">ρ</a> <a id="2724" href="Algebra.html#1633" class="Field Operator">≈</a> <a id="2726" href="Algebra.html#1711" class="Field">ε</a>
<a id="2728" href="Algebra.CommutativeMonoidSolver.html#2676" class="Function">empty-correct</a> <a id="2742" href="Data.Vec.html#678" class="InductiveConstructor">[]</a> <a id="2745" class="Symbol">=</a> <a id="2747" href="Relation.Binary.Core.html#4934" class="Function">refl</a>
<a id="2752" href="Algebra.CommutativeMonoidSolver.html#2676" class="Function">empty-correct</a> <a id="2766" class="Symbol">(</a><a id="2767" href="Algebra.CommutativeMonoidSolver.html#2767" class="Bound">a</a> <a id="2769" href="Data.Vec.html#697" class="InductiveConstructor Operator">∷</a> <a id="2771" href="Algebra.CommutativeMonoidSolver.html#2771" class="Bound">ρ</a><a id="2772" class="Symbol">)</a> <a id="2774" class="Symbol">=</a> <a id="2776" href="Algebra.CommutativeMonoidSolver.html#2676" class="Function">empty-correct</a> <a id="2790" href="Algebra.CommutativeMonoidSolver.html#2771" class="Bound">ρ</a>

<a id="2793" class="Comment">-- The singleton bag stands for a single variable.</a>

<a id="2845" href="Algebra.CommutativeMonoidSolver.html#2845" class="Function">sg-correct</a> <a id="2856" class="Symbol">:</a> <a id="2858" class="Symbol">∀{</a><a id="2860" href="Algebra.CommutativeMonoidSolver.html#2860" class="Bound">n</a><a id="2861" class="Symbol">}</a> <a id="2863" class="Symbol">(</a><a id="2864" href="Algebra.CommutativeMonoidSolver.html#2864" class="Bound">x</a> <a id="2866" class="Symbol">:</a> <a id="2868" href="Data.Fin.html#923" class="Datatype">Fin</a> <a id="2872" href="Algebra.CommutativeMonoidSolver.html#2860" class="Bound">n</a><a id="2873" class="Symbol">)</a> <a id="2875" class="Symbol">(</a><a id="2876" href="Algebra.CommutativeMonoidSolver.html#2876" class="Bound">ρ</a> <a id="2878" class="Symbol">:</a> <a id="2880" href="Algebra.CommutativeMonoidSolver.html#1526" class="Function">Env</a> <a id="2884" href="Algebra.CommutativeMonoidSolver.html#2860" class="Bound">n</a><a id="2885" class="Symbol">)</a> <a id="2887" class="Symbol">→</a>  <a id="2890" href="Algebra.CommutativeMonoidSolver.html#1990" class="Function Operator">⟦</a> <a id="2892" href="Algebra.CommutativeMonoidSolver.html#2295" class="Function">sg</a> <a id="2895" href="Algebra.CommutativeMonoidSolver.html#2864" class="Bound">x</a> <a id="2897" href="Algebra.CommutativeMonoidSolver.html#1990" class="Function Operator">⟧⇓</a> <a id="2900" href="Algebra.CommutativeMonoidSolver.html#2876" class="Bound">ρ</a> <a id="2902" href="Algebra.html#1633" class="Field Operator">≈</a> <a id="2904" href="Data.Vec.html#6482" class="Function">lookup</a> <a id="2911" href="Algebra.CommutativeMonoidSolver.html#2864" class="Bound">x</a> <a id="2913" href="Algebra.CommutativeMonoidSolver.html#2876" class="Bound">ρ</a>
<a id="2915" href="Algebra.CommutativeMonoidSolver.html#2845" class="Function">sg-correct</a> <a id="2926" href="Data.Fin.html#945" class="InductiveConstructor">zero</a> <a id="2931" class="Symbol">(</a><a id="2932" href="Algebra.CommutativeMonoidSolver.html#2932" class="Bound">x</a> <a id="2934" href="Data.Vec.html#697" class="InductiveConstructor Operator">∷</a> <a id="2936" href="Algebra.CommutativeMonoidSolver.html#2936" class="Bound">ρ</a><a id="2937" class="Symbol">)</a> <a id="2939" class="Symbol">=</a> <a id="2941" href="Relation.Binary.PreorderReasoning.html#1154" class="Function Operator">begin</a>
    <a id="2951" href="Algebra.CommutativeMonoidSolver.html#2932" class="Bound">x</a> <a id="2953" href="Algebra.html#1673" class="Field Operator">∙</a> <a id="2955" href="Algebra.CommutativeMonoidSolver.html#1990" class="Function Operator">⟦</a> <a id="2957" href="Algebra.CommutativeMonoidSolver.html#2229" class="Function">empty</a> <a id="2963" href="Algebra.CommutativeMonoidSolver.html#1990" class="Function Operator">⟧⇓</a> <a id="2966" href="Algebra.CommutativeMonoidSolver.html#2936" class="Bound">ρ</a>   <a id="2970" href="Relation.Binary.PreorderReasoning.html#1220" class="Function Operator">≈⟨</a> <a id="2973" href="Algebra.Structures.html#845" class="Function">∙-cong</a> <a id="2980" href="Relation.Binary.Core.html#4934" class="Function">refl</a> <a id="2985" class="Symbol">(</a><a id="2986" href="Algebra.CommutativeMonoidSolver.html#2676" class="Function">empty-correct</a> <a id="3000" href="Algebra.CommutativeMonoidSolver.html#2936" class="Bound">ρ</a><a id="3001" class="Symbol">)</a> <a id="3003" href="Relation.Binary.PreorderReasoning.html#1220" class="Function Operator">⟩</a>
    <a id="3009" href="Algebra.CommutativeMonoidSolver.html#2932" class="Bound">x</a> <a id="3011" href="Algebra.html#1673" class="Field Operator">∙</a> <a id="3013" href="Algebra.html#1711" class="Field">ε</a>              <a id="3028" href="Relation.Binary.PreorderReasoning.html#1220" class="Function Operator">≈⟨</a> <a id="3031" href="Data.Product.html#573" class="Field">proj₂</a> <a id="3037" href="Algebra.Structures.html#1561" class="Function">identity</a> <a id="3046" class="Symbol">_</a> <a id="3048" href="Relation.Binary.PreorderReasoning.html#1220" class="Function Operator">⟩</a>
    <a id="3054" href="Algebra.CommutativeMonoidSolver.html#2932" class="Bound">x</a>                  <a id="3073" href="Relation.Binary.PreorderReasoning.html#1519" class="Function Operator">∎</a>
<a id="3075" href="Algebra.CommutativeMonoidSolver.html#2845" class="Function">sg-correct</a> <a id="3086" class="Symbol">(</a><a id="3087" href="Data.Fin.html#976" class="InductiveConstructor">suc</a> <a id="3091" href="Algebra.CommutativeMonoidSolver.html#3091" class="Bound">x</a><a id="3092" class="Symbol">)</a> <a id="3094" class="Symbol">(</a><a id="3095" href="Algebra.CommutativeMonoidSolver.html#3095" class="Bound">m</a> <a id="3097" href="Data.Vec.html#697" class="InductiveConstructor Operator">∷</a> <a id="3099" href="Algebra.CommutativeMonoidSolver.html#3099" class="Bound">ρ</a><a id="3100" class="Symbol">)</a> <a id="3102" class="Symbol">=</a> <a id="3104" href="Algebra.CommutativeMonoidSolver.html#2845" class="Function">sg-correct</a> <a id="3115" href="Algebra.CommutativeMonoidSolver.html#3091" class="Bound">x</a> <a id="3117" href="Algebra.CommutativeMonoidSolver.html#3099" class="Bound">ρ</a>

<a id="3120" class="Comment">-- Normal form composition corresponds to the composition of the monoid.</a>

<a id="3194" href="Algebra.CommutativeMonoidSolver.html#3194" class="Function">comp-correct</a> <a id="3207" class="Symbol">:</a> <a id="3209" class="Symbol">∀</a> <a id="3211" class="Symbol">{</a><a id="3212" href="Algebra.CommutativeMonoidSolver.html#3212" class="Bound">n</a><a id="3213" class="Symbol">}</a> <a id="3215" class="Symbol">(</a><a id="3216" href="Algebra.CommutativeMonoidSolver.html#3216" class="Bound">v</a> <a id="3218" href="Algebra.CommutativeMonoidSolver.html#3218" class="Bound">w</a> <a id="3220" class="Symbol">:</a> <a id="3222" href="Algebra.CommutativeMonoidSolver.html#1917" class="Function">Normal</a> <a id="3229" href="Algebra.CommutativeMonoidSolver.html#3212" class="Bound">n</a><a id="3230" class="Symbol">)</a> <a id="3232" class="Symbol">(</a><a id="3233" href="Algebra.CommutativeMonoidSolver.html#3233" class="Bound">ρ</a> <a id="3235" class="Symbol">:</a> <a id="3237" href="Algebra.CommutativeMonoidSolver.html#1526" class="Function">Env</a> <a id="3241" href="Algebra.CommutativeMonoidSolver.html#3212" class="Bound">n</a><a id="3242" class="Symbol">)</a> <a id="3244" class="Symbol">→</a>
              <a id="3260" href="Algebra.CommutativeMonoidSolver.html#1990" class="Function Operator">⟦</a> <a id="3262" href="Algebra.CommutativeMonoidSolver.html#3216" class="Bound">v</a> <a id="3264" href="Algebra.CommutativeMonoidSolver.html#2411" class="Function Operator">•</a> <a id="3266" href="Algebra.CommutativeMonoidSolver.html#3218" class="Bound">w</a> <a id="3268" href="Algebra.CommutativeMonoidSolver.html#1990" class="Function Operator">⟧⇓</a> <a id="3271" href="Algebra.CommutativeMonoidSolver.html#3233" class="Bound">ρ</a> <a id="3273" href="Algebra.html#1633" class="Field Operator">≈</a> <a id="3275" class="Symbol">(</a><a id="3276" href="Algebra.CommutativeMonoidSolver.html#1990" class="Function Operator">⟦</a> <a id="3278" href="Algebra.CommutativeMonoidSolver.html#3216" class="Bound">v</a> <a id="3280" href="Algebra.CommutativeMonoidSolver.html#1990" class="Function Operator">⟧⇓</a> <a id="3283" href="Algebra.CommutativeMonoidSolver.html#3233" class="Bound">ρ</a> <a id="3285" href="Algebra.html#1673" class="Field Operator">∙</a> <a id="3287" href="Algebra.CommutativeMonoidSolver.html#1990" class="Function Operator">⟦</a> <a id="3289" href="Algebra.CommutativeMonoidSolver.html#3218" class="Bound">w</a> <a id="3291" href="Algebra.CommutativeMonoidSolver.html#1990" class="Function Operator">⟧⇓</a> <a id="3294" href="Algebra.CommutativeMonoidSolver.html#3233" class="Bound">ρ</a><a id="3295" class="Symbol">)</a>
<a id="3297" href="Algebra.CommutativeMonoidSolver.html#3194" class="Function">comp-correct</a> <a id="3310" href="Data.Vec.html#678" class="InductiveConstructor">[]</a> <a id="3313" href="Data.Vec.html#678" class="InductiveConstructor">[]</a> <a id="3316" href="Algebra.CommutativeMonoidSolver.html#3316" class="Bound">ρ</a> <a id="3318" class="Symbol">=</a>  <a id="3321" href="Relation.Binary.Core.html#4960" class="Function">sym</a> <a id="3325" class="Symbol">(</a><a id="3326" href="Data.Product.html#559" class="Field">proj₁</a> <a id="3332" href="Algebra.Structures.html#1561" class="Function">identity</a> <a id="3341" class="Symbol">_)</a>
<a id="3344" href="Algebra.CommutativeMonoidSolver.html#3194" class="Function">comp-correct</a> <a id="3357" class="Symbol">(</a><a id="3358" href="Algebra.CommutativeMonoidSolver.html#3358" class="Bound">l</a> <a id="3360" href="Data.Vec.html#697" class="InductiveConstructor Operator">∷</a> <a id="3362" href="Algebra.CommutativeMonoidSolver.html#3362" class="Bound">v</a><a id="3363" class="Symbol">)</a> <a id="3365" class="Symbol">(</a><a id="3366" href="Algebra.CommutativeMonoidSolver.html#3366" class="Bound">m</a> <a id="3368" href="Data.Vec.html#697" class="InductiveConstructor Operator">∷</a> <a id="3370" href="Algebra.CommutativeMonoidSolver.html#3370" class="Bound">w</a><a id="3371" class="Symbol">)</a> <a id="3373" class="Symbol">(</a><a id="3374" href="Algebra.CommutativeMonoidSolver.html#3374" class="Bound">a</a> <a id="3376" href="Data.Vec.html#697" class="InductiveConstructor Operator">∷</a> <a id="3378" href="Algebra.CommutativeMonoidSolver.html#3378" class="Bound">ρ</a><a id="3379" class="Symbol">)</a> <a id="3381" class="Symbol">=</a> <a id="3383" href="Algebra.CommutativeMonoidSolver.html#3654" class="Function">lemma</a> <a id="3389" href="Algebra.CommutativeMonoidSolver.html#3358" class="Bound">l</a> <a id="3391" href="Algebra.CommutativeMonoidSolver.html#3366" class="Bound">m</a> <a id="3393" class="Symbol">(</a><a id="3394" href="Algebra.CommutativeMonoidSolver.html#3194" class="Function">comp-correct</a> <a id="3407" href="Algebra.CommutativeMonoidSolver.html#3362" class="Bound">v</a> <a id="3409" href="Algebra.CommutativeMonoidSolver.html#3370" class="Bound">w</a> <a id="3411" href="Algebra.CommutativeMonoidSolver.html#3378" class="Bound">ρ</a><a id="3412" class="Symbol">)</a>
  <a id="3416" class="Keyword">where</a>
    <a id="3426" href="Algebra.CommutativeMonoidSolver.html#3426" class="Function">flip12</a> <a id="3433" class="Symbol">:</a> <a id="3435" class="Symbol">∀</a> <a id="3437" href="Algebra.CommutativeMonoidSolver.html#3437" class="Bound">a</a> <a id="3439" href="Algebra.CommutativeMonoidSolver.html#3439" class="Bound">b</a> <a id="3441" href="Algebra.CommutativeMonoidSolver.html#3441" class="Bound">c</a> <a id="3443" class="Symbol">→</a> <a id="3445" href="Algebra.CommutativeMonoidSolver.html#3437" class="Bound">a</a> <a id="3447" href="Algebra.html#1673" class="Field Operator">∙</a> <a id="3449" class="Symbol">(</a><a id="3450" href="Algebra.CommutativeMonoidSolver.html#3439" class="Bound">b</a> <a id="3452" href="Algebra.html#1673" class="Field Operator">∙</a> <a id="3454" href="Algebra.CommutativeMonoidSolver.html#3441" class="Bound">c</a><a id="3455" class="Symbol">)</a> <a id="3457" href="Algebra.html#1633" class="Field Operator">≈</a> <a id="3459" href="Algebra.CommutativeMonoidSolver.html#3439" class="Bound">b</a> <a id="3461" href="Algebra.html#1673" class="Field Operator">∙</a> <a id="3463" class="Symbol">(</a><a id="3464" href="Algebra.CommutativeMonoidSolver.html#3437" class="Bound">a</a> <a id="3466" href="Algebra.html#1673" class="Field Operator">∙</a> <a id="3468" href="Algebra.CommutativeMonoidSolver.html#3441" class="Bound">c</a><a id="3469" class="Symbol">)</a>
    <a id="3475" href="Algebra.CommutativeMonoidSolver.html#3426" class="Function">flip12</a> <a id="3482" href="Algebra.CommutativeMonoidSolver.html#3482" class="Bound">a</a> <a id="3484" href="Algebra.CommutativeMonoidSolver.html#3484" class="Bound">b</a> <a id="3486" href="Algebra.CommutativeMonoidSolver.html#3486" class="Bound">c</a> <a id="3488" class="Symbol">=</a> <a id="3490" href="Relation.Binary.PreorderReasoning.html#1154" class="Function Operator">begin</a>
        <a id="3504" href="Algebra.CommutativeMonoidSolver.html#3482" class="Bound">a</a> <a id="3506" href="Algebra.html#1673" class="Field Operator">∙</a> <a id="3508" class="Symbol">(</a><a id="3509" href="Algebra.CommutativeMonoidSolver.html#3484" class="Bound">b</a> <a id="3511" href="Algebra.html#1673" class="Field Operator">∙</a> <a id="3513" href="Algebra.CommutativeMonoidSolver.html#3486" class="Bound">c</a><a id="3514" class="Symbol">)</a>  <a id="3517" href="Relation.Binary.PreorderReasoning.html#1220" class="Function Operator">≈⟨</a> <a id="3520" href="Relation.Binary.Core.html#4960" class="Function">sym</a> <a id="3524" class="Symbol">(</a><a id="3525" href="Algebra.Structures.html#811" class="Function">assoc</a> <a id="3531" class="Symbol">_</a> <a id="3533" class="Symbol">_</a> <a id="3535" class="Symbol">_)</a> <a id="3538" href="Relation.Binary.PreorderReasoning.html#1220" class="Function Operator">⟩</a>
        <a id="3548" class="Symbol">(</a><a id="3549" href="Algebra.CommutativeMonoidSolver.html#3482" class="Bound">a</a> <a id="3551" href="Algebra.html#1673" class="Field Operator">∙</a> <a id="3553" href="Algebra.CommutativeMonoidSolver.html#3484" class="Bound">b</a><a id="3554" class="Symbol">)</a> <a id="3556" href="Algebra.html#1673" class="Field Operator">∙</a> <a id="3558" href="Algebra.CommutativeMonoidSolver.html#3486" class="Bound">c</a>  <a id="3561" href="Relation.Binary.PreorderReasoning.html#1220" class="Function Operator">≈⟨</a> <a id="3564" href="Algebra.Structures.html#845" class="Function">∙-cong</a> <a id="3571" class="Symbol">(</a><a id="3572" href="Algebra.Structures.html#1489" class="Function">comm</a> <a id="3577" class="Symbol">_</a> <a id="3579" class="Symbol">_)</a> <a id="3582" href="Relation.Binary.Core.html#4934" class="Function">refl</a> <a id="3587" href="Relation.Binary.PreorderReasoning.html#1220" class="Function Operator">⟩</a>
        <a id="3597" class="Symbol">(</a><a id="3598" href="Algebra.CommutativeMonoidSolver.html#3484" class="Bound">b</a> <a id="3600" href="Algebra.html#1673" class="Field Operator">∙</a> <a id="3602" href="Algebra.CommutativeMonoidSolver.html#3482" class="Bound">a</a><a id="3603" class="Symbol">)</a> <a id="3605" href="Algebra.html#1673" class="Field Operator">∙</a> <a id="3607" href="Algebra.CommutativeMonoidSolver.html#3486" class="Bound">c</a>  <a id="3610" href="Relation.Binary.PreorderReasoning.html#1220" class="Function Operator">≈⟨</a> <a id="3613" href="Algebra.Structures.html#811" class="Function">assoc</a> <a id="3619" class="Symbol">_</a> <a id="3621" class="Symbol">_</a> <a id="3623" class="Symbol">_</a> <a id="3625" href="Relation.Binary.PreorderReasoning.html#1220" class="Function Operator">⟩</a>
        <a id="3635" href="Algebra.CommutativeMonoidSolver.html#3484" class="Bound">b</a> <a id="3637" href="Algebra.html#1673" class="Field Operator">∙</a> <a id="3639" class="Symbol">(</a><a id="3640" href="Algebra.CommutativeMonoidSolver.html#3482" class="Bound">a</a> <a id="3642" href="Algebra.html#1673" class="Field Operator">∙</a> <a id="3644" href="Algebra.CommutativeMonoidSolver.html#3486" class="Bound">c</a><a id="3645" class="Symbol">)</a>  <a id="3648" href="Relation.Binary.PreorderReasoning.html#1519" class="Function Operator">∎</a>
    <a id="3654" href="Algebra.CommutativeMonoidSolver.html#3654" class="Function">lemma</a> <a id="3660" class="Symbol">:</a> <a id="3662" class="Symbol">∀</a> <a id="3664" href="Algebra.CommutativeMonoidSolver.html#3664" class="Bound">l</a> <a id="3666" href="Algebra.CommutativeMonoidSolver.html#3666" class="Bound">m</a> <a id="3668" class="Symbol">{</a><a id="3669" href="Algebra.CommutativeMonoidSolver.html#3669" class="Bound">d</a> <a id="3671" href="Algebra.CommutativeMonoidSolver.html#3671" class="Bound">b</a> <a id="3673" href="Algebra.CommutativeMonoidSolver.html#3673" class="Bound">c</a><a id="3674" class="Symbol">}</a> <a id="3676" class="Symbol">(</a><a id="3677" href="Algebra.CommutativeMonoidSolver.html#3677" class="Bound">p</a> <a id="3679" class="Symbol">:</a> <a id="3681" href="Algebra.CommutativeMonoidSolver.html#3669" class="Bound">d</a> <a id="3683" href="Algebra.html#1633" class="Field Operator">≈</a> <a id="3685" href="Algebra.CommutativeMonoidSolver.html#3671" class="Bound">b</a> <a id="3687" href="Algebra.html#1673" class="Field Operator">∙</a> <a id="3689" href="Algebra.CommutativeMonoidSolver.html#3673" class="Bound">c</a><a id="3690" class="Symbol">)</a> <a id="3692" class="Symbol">→</a>
      <a id="3700" href="Data.Nat.GeneralisedArithmetic.html#472" class="Function">fold</a> <a id="3705" href="Algebra.CommutativeMonoidSolver.html#3669" class="Bound">d</a> <a id="3707" class="Symbol">(</a><a id="3708" href="Algebra.CommutativeMonoidSolver.html#3374" class="Bound">a</a> <a id="3710" href="Algebra.html#1673" class="Field Operator">∙_</a><a id="3712" class="Symbol">)</a> <a id="3714" class="Symbol">(</a><a id="3715" href="Algebra.CommutativeMonoidSolver.html#3664" class="Bound">l</a> <a id="3717" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">+</a> <a id="3719" href="Algebra.CommutativeMonoidSolver.html#3666" class="Bound">m</a><a id="3720" class="Symbol">)</a> <a id="3722" href="Algebra.html#1633" class="Field Operator">≈</a> <a id="3724" href="Data.Nat.GeneralisedArithmetic.html#472" class="Function">fold</a> <a id="3729" href="Algebra.CommutativeMonoidSolver.html#3671" class="Bound">b</a> <a id="3731" class="Symbol">(</a><a id="3732" href="Algebra.CommutativeMonoidSolver.html#3374" class="Bound">a</a> <a id="3734" href="Algebra.html#1673" class="Field Operator">∙_</a><a id="3736" class="Symbol">)</a> <a id="3738" href="Algebra.CommutativeMonoidSolver.html#3664" class="Bound">l</a> <a id="3740" href="Algebra.html#1673" class="Field Operator">∙</a> <a id="3742" href="Data.Nat.GeneralisedArithmetic.html#472" class="Function">fold</a> <a id="3747" href="Algebra.CommutativeMonoidSolver.html#3673" class="Bound">c</a> <a id="3749" class="Symbol">(</a><a id="3750" href="Algebra.CommutativeMonoidSolver.html#3374" class="Bound">a</a> <a id="3752" href="Algebra.html#1673" class="Field Operator">∙_</a><a id="3754" class="Symbol">)</a> <a id="3756" href="Algebra.CommutativeMonoidSolver.html#3666" class="Bound">m</a>
    <a id="3762" href="Algebra.CommutativeMonoidSolver.html#3654" class="Function">lemma</a> <a id="3768" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a> <a id="3773" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a> <a id="3778" href="Algebra.CommutativeMonoidSolver.html#3778" class="Bound">p</a> <a id="3780" class="Symbol">=</a> <a id="3782" href="Algebra.CommutativeMonoidSolver.html#3778" class="Bound">p</a>
    <a id="3788" href="Algebra.CommutativeMonoidSolver.html#3654" class="Function">lemma</a> <a id="3794" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a> <a id="3799" class="Symbol">(</a><a id="3800" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="3804" href="Algebra.CommutativeMonoidSolver.html#3804" class="Bound">m</a><a id="3805" class="Symbol">)</a> <a id="3807" href="Algebra.CommutativeMonoidSolver.html#3807" class="Bound">p</a> <a id="3809" class="Symbol">=</a> <a id="3811" href="Relation.Binary.Core.html#4986" class="Function">trans</a> <a id="3817" class="Symbol">(</a><a id="3818" href="Algebra.Structures.html#845" class="Function">∙-cong</a> <a id="3825" href="Relation.Binary.Core.html#4934" class="Function">refl</a> <a id="3830" class="Symbol">(</a><a id="3831" href="Algebra.CommutativeMonoidSolver.html#3654" class="Function">lemma</a> <a id="3837" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a> <a id="3842" href="Algebra.CommutativeMonoidSolver.html#3804" class="Bound">m</a> <a id="3844" href="Algebra.CommutativeMonoidSolver.html#3807" class="Bound">p</a><a id="3845" class="Symbol">))</a> <a id="3848" class="Symbol">(</a><a id="3849" href="Algebra.CommutativeMonoidSolver.html#3426" class="Function">flip12</a> <a id="3856" class="Symbol">_</a> <a id="3858" class="Symbol">_</a> <a id="3860" class="Symbol">_)</a>
    <a id="3867" href="Algebra.CommutativeMonoidSolver.html#3654" class="Function">lemma</a> <a id="3873" class="Symbol">(</a><a id="3874" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="3878" href="Algebra.CommutativeMonoidSolver.html#3878" class="Bound">l</a><a id="3879" class="Symbol">)</a> <a id="3881" href="Algebra.CommutativeMonoidSolver.html#3881" class="Bound">m</a> <a id="3883" href="Algebra.CommutativeMonoidSolver.html#3883" class="Bound">p</a> <a id="3885" class="Symbol">=</a> <a id="3887" href="Relation.Binary.Core.html#4986" class="Function">trans</a> <a id="3893" class="Symbol">(</a><a id="3894" href="Algebra.Structures.html#845" class="Function">∙-cong</a> <a id="3901" href="Relation.Binary.Core.html#4934" class="Function">refl</a> <a id="3906" class="Symbol">(</a><a id="3907" href="Algebra.CommutativeMonoidSolver.html#3654" class="Function">lemma</a> <a id="3913" href="Algebra.CommutativeMonoidSolver.html#3878" class="Bound">l</a> <a id="3915" href="Algebra.CommutativeMonoidSolver.html#3881" class="Bound">m</a> <a id="3917" href="Algebra.CommutativeMonoidSolver.html#3883" class="Bound">p</a><a id="3918" class="Symbol">))</a> <a id="3921" class="Symbol">(</a><a id="3922" href="Relation.Binary.Core.html#4960" class="Function">sym</a> <a id="3926" class="Symbol">(</a><a id="3927" href="Algebra.Structures.html#811" class="Function">assoc</a> <a id="3933" href="Algebra.CommutativeMonoidSolver.html#3374" class="Bound">a</a> <a id="3935" class="Symbol">_</a> <a id="3937" class="Symbol">_))</a>

<a id="3942" class="Comment">------------------------------------------------------------------------</a>
<a id="4015" class="Comment">-- Normalization</a>

<a id="4033" class="Comment">-- A normaliser.</a>

<a id="4051" href="Algebra.CommutativeMonoidSolver.html#4051" class="Function">normalise</a> <a id="4061" class="Symbol">:</a> <a id="4063" class="Symbol">∀</a> <a id="4065" class="Symbol">{</a><a id="4066" href="Algebra.CommutativeMonoidSolver.html#4066" class="Bound">n</a><a id="4067" class="Symbol">}</a> <a id="4069" class="Symbol">→</a> <a id="4071" href="Algebra.CommutativeMonoidSolver.html#1371" class="Datatype">Expr</a> <a id="4076" href="Algebra.CommutativeMonoidSolver.html#4066" class="Bound">n</a> <a id="4078" class="Symbol">→</a> <a id="4080" href="Algebra.CommutativeMonoidSolver.html#1917" class="Function">Normal</a> <a id="4087" href="Algebra.CommutativeMonoidSolver.html#4066" class="Bound">n</a>
<a id="4089" href="Algebra.CommutativeMonoidSolver.html#4051" class="Function">normalise</a> <a id="4099" class="Symbol">(</a><a id="4100" href="Algebra.CommutativeMonoidSolver.html#1398" class="InductiveConstructor">var</a> <a id="4104" href="Algebra.CommutativeMonoidSolver.html#4104" class="Bound">x</a><a id="4105" class="Symbol">)</a>   <a id="4109" class="Symbol">=</a> <a id="4111" href="Algebra.CommutativeMonoidSolver.html#2295" class="Function">sg</a> <a id="4114" href="Algebra.CommutativeMonoidSolver.html#4104" class="Bound">x</a>
<a id="4116" href="Algebra.CommutativeMonoidSolver.html#4051" class="Function">normalise</a> <a id="4126" href="Algebra.CommutativeMonoidSolver.html#1421" class="InductiveConstructor">id</a>        <a id="4136" class="Symbol">=</a> <a id="4138" href="Algebra.CommutativeMonoidSolver.html#2229" class="Function">empty</a>
<a id="4144" href="Algebra.CommutativeMonoidSolver.html#4051" class="Function">normalise</a> <a id="4154" class="Symbol">(</a><a id="4155" href="Algebra.CommutativeMonoidSolver.html#4155" class="Bound">e₁</a> <a id="4158" href="Algebra.CommutativeMonoidSolver.html#1436" class="InductiveConstructor Operator">⊕</a> <a id="4160" href="Algebra.CommutativeMonoidSolver.html#4160" class="Bound">e₂</a><a id="4162" class="Symbol">)</a> <a id="4164" class="Symbol">=</a> <a id="4166" href="Algebra.CommutativeMonoidSolver.html#4051" class="Function">normalise</a> <a id="4176" href="Algebra.CommutativeMonoidSolver.html#4155" class="Bound">e₁</a> <a id="4179" href="Algebra.CommutativeMonoidSolver.html#2411" class="Function Operator">•</a> <a id="4181" href="Algebra.CommutativeMonoidSolver.html#4051" class="Function">normalise</a> <a id="4191" href="Algebra.CommutativeMonoidSolver.html#4160" class="Bound">e₂</a>

<a id="4195" class="Comment">-- The normaliser preserves the semantics of the expression.</a>

<a id="4257" href="Algebra.CommutativeMonoidSolver.html#4257" class="Function">normalise-correct</a> <a id="4275" class="Symbol">:</a> <a id="4277" class="Symbol">∀</a> <a id="4279" class="Symbol">{</a><a id="4280" href="Algebra.CommutativeMonoidSolver.html#4280" class="Bound">n</a><a id="4281" class="Symbol">}</a> <a id="4283" class="Symbol">(</a><a id="4284" href="Algebra.CommutativeMonoidSolver.html#4284" class="Bound">e</a> <a id="4286" class="Symbol">:</a> <a id="4288" href="Algebra.CommutativeMonoidSolver.html#1371" class="Datatype">Expr</a> <a id="4293" href="Algebra.CommutativeMonoidSolver.html#4280" class="Bound">n</a><a id="4294" class="Symbol">)</a> <a id="4296" class="Symbol">(</a><a id="4297" href="Algebra.CommutativeMonoidSolver.html#4297" class="Bound">ρ</a> <a id="4299" class="Symbol">:</a> <a id="4301" href="Algebra.CommutativeMonoidSolver.html#1526" class="Function">Env</a> <a id="4305" href="Algebra.CommutativeMonoidSolver.html#4280" class="Bound">n</a><a id="4306" class="Symbol">)</a> <a id="4308" class="Symbol">→</a>
    <a id="4314" href="Algebra.CommutativeMonoidSolver.html#1990" class="Function Operator">⟦</a> <a id="4316" href="Algebra.CommutativeMonoidSolver.html#4051" class="Function">normalise</a> <a id="4326" href="Algebra.CommutativeMonoidSolver.html#4284" class="Bound">e</a> <a id="4328" href="Algebra.CommutativeMonoidSolver.html#1990" class="Function Operator">⟧⇓</a> <a id="4331" href="Algebra.CommutativeMonoidSolver.html#4297" class="Bound">ρ</a> <a id="4333" href="Algebra.html#1633" class="Field Operator">≈</a> <a id="4335" href="Algebra.CommutativeMonoidSolver.html#1649" class="Function Operator">⟦</a> <a id="4337" href="Algebra.CommutativeMonoidSolver.html#4284" class="Bound">e</a> <a id="4339" href="Algebra.CommutativeMonoidSolver.html#1649" class="Function Operator">⟧</a> <a id="4341" href="Algebra.CommutativeMonoidSolver.html#4297" class="Bound">ρ</a>
<a id="4343" href="Algebra.CommutativeMonoidSolver.html#4257" class="Function">normalise-correct</a> <a id="4361" class="Symbol">(</a><a id="4362" href="Algebra.CommutativeMonoidSolver.html#1398" class="InductiveConstructor">var</a> <a id="4366" href="Algebra.CommutativeMonoidSolver.html#4366" class="Bound">x</a><a id="4367" class="Symbol">)</a>   <a id="4371" href="Algebra.CommutativeMonoidSolver.html#4371" class="Bound">ρ</a> <a id="4373" class="Symbol">=</a> <a id="4375" href="Algebra.CommutativeMonoidSolver.html#2845" class="Function">sg-correct</a> <a id="4386" href="Algebra.CommutativeMonoidSolver.html#4366" class="Bound">x</a> <a id="4388" href="Algebra.CommutativeMonoidSolver.html#4371" class="Bound">ρ</a>
<a id="4390" href="Algebra.CommutativeMonoidSolver.html#4257" class="Function">normalise-correct</a> <a id="4408" href="Algebra.CommutativeMonoidSolver.html#1421" class="InductiveConstructor">id</a>        <a id="4418" href="Algebra.CommutativeMonoidSolver.html#4418" class="Bound">ρ</a> <a id="4420" class="Symbol">=</a> <a id="4422" href="Algebra.CommutativeMonoidSolver.html#2676" class="Function">empty-correct</a> <a id="4436" href="Algebra.CommutativeMonoidSolver.html#4418" class="Bound">ρ</a>
<a id="4438" href="Algebra.CommutativeMonoidSolver.html#4257" class="Function">normalise-correct</a> <a id="4456" class="Symbol">(</a><a id="4457" href="Algebra.CommutativeMonoidSolver.html#4457" class="Bound">e₁</a> <a id="4460" href="Algebra.CommutativeMonoidSolver.html#1436" class="InductiveConstructor Operator">⊕</a> <a id="4462" href="Algebra.CommutativeMonoidSolver.html#4462" class="Bound">e₂</a><a id="4464" class="Symbol">)</a> <a id="4466" href="Algebra.CommutativeMonoidSolver.html#4466" class="Bound">ρ</a> <a id="4468" class="Symbol">=</a>  <a id="4471" href="Relation.Binary.PreorderReasoning.html#1154" class="Function Operator">begin</a>

    <a id="4482" href="Algebra.CommutativeMonoidSolver.html#1990" class="Function Operator">⟦</a> <a id="4484" href="Algebra.CommutativeMonoidSolver.html#4051" class="Function">normalise</a> <a id="4494" href="Algebra.CommutativeMonoidSolver.html#4457" class="Bound">e₁</a> <a id="4497" href="Algebra.CommutativeMonoidSolver.html#2411" class="Function Operator">•</a> <a id="4499" href="Algebra.CommutativeMonoidSolver.html#4051" class="Function">normalise</a> <a id="4509" href="Algebra.CommutativeMonoidSolver.html#4462" class="Bound">e₂</a> <a id="4512" href="Algebra.CommutativeMonoidSolver.html#1990" class="Function Operator">⟧⇓</a> <a id="4515" href="Algebra.CommutativeMonoidSolver.html#4466" class="Bound">ρ</a>

  <a id="4520" href="Relation.Binary.PreorderReasoning.html#1220" class="Function Operator">≈⟨</a> <a id="4523" href="Algebra.CommutativeMonoidSolver.html#3194" class="Function">comp-correct</a> <a id="4536" class="Symbol">(</a><a id="4537" href="Algebra.CommutativeMonoidSolver.html#4051" class="Function">normalise</a> <a id="4547" href="Algebra.CommutativeMonoidSolver.html#4457" class="Bound">e₁</a><a id="4549" class="Symbol">)</a> <a id="4551" class="Symbol">(</a><a id="4552" href="Algebra.CommutativeMonoidSolver.html#4051" class="Function">normalise</a> <a id="4562" href="Algebra.CommutativeMonoidSolver.html#4462" class="Bound">e₂</a><a id="4564" class="Symbol">)</a> <a id="4566" href="Algebra.CommutativeMonoidSolver.html#4466" class="Bound">ρ</a> <a id="4568" href="Relation.Binary.PreorderReasoning.html#1220" class="Function Operator">⟩</a>

    <a id="4575" href="Algebra.CommutativeMonoidSolver.html#1990" class="Function Operator">⟦</a> <a id="4577" href="Algebra.CommutativeMonoidSolver.html#4051" class="Function">normalise</a> <a id="4587" href="Algebra.CommutativeMonoidSolver.html#4457" class="Bound">e₁</a> <a id="4590" href="Algebra.CommutativeMonoidSolver.html#1990" class="Function Operator">⟧⇓</a> <a id="4593" href="Algebra.CommutativeMonoidSolver.html#4466" class="Bound">ρ</a> <a id="4595" href="Algebra.html#1673" class="Field Operator">∙</a> <a id="4597" href="Algebra.CommutativeMonoidSolver.html#1990" class="Function Operator">⟦</a> <a id="4599" href="Algebra.CommutativeMonoidSolver.html#4051" class="Function">normalise</a> <a id="4609" href="Algebra.CommutativeMonoidSolver.html#4462" class="Bound">e₂</a> <a id="4612" href="Algebra.CommutativeMonoidSolver.html#1990" class="Function Operator">⟧⇓</a> <a id="4615" href="Algebra.CommutativeMonoidSolver.html#4466" class="Bound">ρ</a>

  <a id="4620" href="Relation.Binary.PreorderReasoning.html#1220" class="Function Operator">≈⟨</a> <a id="4623" href="Algebra.Structures.html#845" class="Function">∙-cong</a> <a id="4630" class="Symbol">(</a><a id="4631" href="Algebra.CommutativeMonoidSolver.html#4257" class="Function">normalise-correct</a> <a id="4649" href="Algebra.CommutativeMonoidSolver.html#4457" class="Bound">e₁</a> <a id="4652" href="Algebra.CommutativeMonoidSolver.html#4466" class="Bound">ρ</a><a id="4653" class="Symbol">)</a> <a id="4655" class="Symbol">(</a><a id="4656" href="Algebra.CommutativeMonoidSolver.html#4257" class="Function">normalise-correct</a> <a id="4674" href="Algebra.CommutativeMonoidSolver.html#4462" class="Bound">e₂</a> <a id="4677" href="Algebra.CommutativeMonoidSolver.html#4466" class="Bound">ρ</a><a id="4678" class="Symbol">)</a> <a id="4680" href="Relation.Binary.PreorderReasoning.html#1220" class="Function Operator">⟩</a>

    <a id="4687" href="Algebra.CommutativeMonoidSolver.html#1649" class="Function Operator">⟦</a> <a id="4689" href="Algebra.CommutativeMonoidSolver.html#4457" class="Bound">e₁</a> <a id="4692" href="Algebra.CommutativeMonoidSolver.html#1649" class="Function Operator">⟧</a> <a id="4694" href="Algebra.CommutativeMonoidSolver.html#4466" class="Bound">ρ</a> <a id="4696" href="Algebra.html#1673" class="Field Operator">∙</a> <a id="4698" href="Algebra.CommutativeMonoidSolver.html#1649" class="Function Operator">⟦</a> <a id="4700" href="Algebra.CommutativeMonoidSolver.html#4462" class="Bound">e₂</a> <a id="4703" href="Algebra.CommutativeMonoidSolver.html#1649" class="Function Operator">⟧</a> <a id="4705" href="Algebra.CommutativeMonoidSolver.html#4466" class="Bound">ρ</a>
  <a id="4709" href="Relation.Binary.PreorderReasoning.html#1519" class="Function Operator">∎</a>

<a id="4712" class="Comment">------------------------------------------------------------------------</a>
<a id="4785" class="Comment">-- &quot;Tactics&quot;</a>

<a id="4799" class="Keyword">open</a> <a id="4804" class="Keyword">module</a> <a id="4811" href="Algebra.CommutativeMonoidSolver.html#4811" class="Module">R</a> <a id="4813" class="Symbol">=</a> <a id="4815" href="Relation.Binary.Reflection.html" class="Module">Reflection</a>
                  <a id="4844" href="Algebra.Structures.html#887" class="Function">setoid</a> <a id="4851" href="Algebra.CommutativeMonoidSolver.html#1398" class="InductiveConstructor">var</a> <a id="4855" href="Algebra.CommutativeMonoidSolver.html#1649" class="Function Operator">⟦_⟧</a> <a id="4859" class="Symbol">(</a><a id="4860" href="Algebra.CommutativeMonoidSolver.html#1990" class="Function Operator">⟦_⟧⇓</a> <a id="4865" href="Function.html#748" class="Function Operator">∘</a> <a id="4867" href="Algebra.CommutativeMonoidSolver.html#4051" class="Function">normalise</a><a id="4876" class="Symbol">)</a> <a id="4878" href="Algebra.CommutativeMonoidSolver.html#4257" class="Function">normalise-correct</a>
  <a id="4898" class="Keyword">public</a> <a id="4905" class="Keyword">using</a> <a id="4911" class="Symbol">(</a><a id="4912" href="Relation.Binary.Reflection.html#2382" class="Function">solve</a><a id="4917" class="Symbol">;</a> <a id="4919" href="Relation.Binary.Reflection.html#3491" class="Function Operator">_⊜_</a><a id="4922" class="Symbol">)</a>

<a id="4925" class="Comment">-- We can decide if two normal forms are /syntactically/ equal.</a>

<a id="4990" class="Keyword">infix</a> <a id="4996" class="Number">5</a> <a id="4998" href="Algebra.CommutativeMonoidSolver.html#5003" class="Function Operator">_≟_</a>

<a id="5003" href="Algebra.CommutativeMonoidSolver.html#5003" class="Function Operator">_≟_</a> <a id="5007" class="Symbol">:</a> <a id="5009" class="Symbol">∀</a> <a id="5011" class="Symbol">{</a><a id="5012" href="Algebra.CommutativeMonoidSolver.html#5012" class="Bound">n</a><a id="5013" class="Symbol">}</a> <a id="5015" class="Symbol">(</a><a id="5016" href="Algebra.CommutativeMonoidSolver.html#5016" class="Bound">nf₁</a> <a id="5020" href="Algebra.CommutativeMonoidSolver.html#5020" class="Bound">nf₂</a> <a id="5024" class="Symbol">:</a> <a id="5026" href="Algebra.CommutativeMonoidSolver.html#1917" class="Function">Normal</a> <a id="5033" href="Algebra.CommutativeMonoidSolver.html#5012" class="Bound">n</a><a id="5034" class="Symbol">)</a> <a id="5036" class="Symbol">→</a> <a id="5038" href="Relation.Nullary.html#484" class="Datatype">Dec</a> <a id="5042" class="Symbol">(</a><a id="5043" href="Algebra.CommutativeMonoidSolver.html#5016" class="Bound">nf₁</a> <a id="5047" href="Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="5049" href="Algebra.CommutativeMonoidSolver.html#5020" class="Bound">nf₂</a><a id="5052" class="Symbol">)</a>
<a id="5054" href="Algebra.CommutativeMonoidSolver.html#5054" class="Bound">nf₁</a> <a id="5058" href="Algebra.CommutativeMonoidSolver.html#5003" class="Function Operator">≟</a> <a id="5060" href="Algebra.CommutativeMonoidSolver.html#5060" class="Bound">nf₂</a> <a id="5064" class="Symbol">=</a> <a id="5066" href="Relation.Nullary.Decidable.html#1632" class="Function">Dec.map</a> <a id="5074" href="Data.Vec.Relation.Pointwise.html#4349" class="Function">Pointwise-≡</a> <a id="5086" class="Symbol">(</a><a id="5087" href="Data.Vec.Relation.Pointwise.html#3782" class="Function">decidable</a> <a id="5097" href="Data.Nat.Base.html#2869" class="Function Operator">ℕ._≟_</a> <a id="5103" href="Algebra.CommutativeMonoidSolver.html#5054" class="Bound">nf₁</a> <a id="5107" href="Algebra.CommutativeMonoidSolver.html#5060" class="Bound">nf₂</a><a id="5110" class="Symbol">)</a>
  <a id="5114" class="Keyword">where</a> <a id="5120" class="Keyword">open</a> <a id="5125" href="Data.Vec.Relation.Pointwise.html" class="Module">Pointwise</a>

<a id="5136" class="Comment">-- We can also give a sound, but not necessarily complete, procedure</a>
<a id="5205" class="Comment">-- for determining if two expressions have the same semantics.</a>

<a id="5269" href="Algebra.CommutativeMonoidSolver.html#5269" class="Function">prove′</a> <a id="5276" class="Symbol">:</a> <a id="5278" class="Symbol">∀</a> <a id="5280" class="Symbol">{</a><a id="5281" href="Algebra.CommutativeMonoidSolver.html#5281" class="Bound">n</a><a id="5282" class="Symbol">}</a> <a id="5284" class="Symbol">(</a><a id="5285" href="Algebra.CommutativeMonoidSolver.html#5285" class="Bound">e₁</a> <a id="5288" href="Algebra.CommutativeMonoidSolver.html#5288" class="Bound">e₂</a> <a id="5291" class="Symbol">:</a> <a id="5293" href="Algebra.CommutativeMonoidSolver.html#1371" class="Datatype">Expr</a> <a id="5298" href="Algebra.CommutativeMonoidSolver.html#5281" class="Bound">n</a><a id="5299" class="Symbol">)</a> <a id="5301" class="Symbol">→</a> <a id="5303" href="Data.Maybe.Base.html#335" class="Datatype">Maybe</a> <a id="5309" class="Symbol">(∀</a> <a id="5312" href="Algebra.CommutativeMonoidSolver.html#5312" class="Bound">ρ</a> <a id="5314" class="Symbol">→</a> <a id="5316" href="Algebra.CommutativeMonoidSolver.html#1649" class="Function Operator">⟦</a> <a id="5318" href="Algebra.CommutativeMonoidSolver.html#5285" class="Bound">e₁</a> <a id="5321" href="Algebra.CommutativeMonoidSolver.html#1649" class="Function Operator">⟧</a> <a id="5323" href="Algebra.CommutativeMonoidSolver.html#5312" class="Bound">ρ</a> <a id="5325" href="Algebra.html#1633" class="Field Operator">≈</a> <a id="5327" href="Algebra.CommutativeMonoidSolver.html#1649" class="Function Operator">⟦</a> <a id="5329" href="Algebra.CommutativeMonoidSolver.html#5288" class="Bound">e₂</a> <a id="5332" href="Algebra.CommutativeMonoidSolver.html#1649" class="Function Operator">⟧</a> <a id="5334" href="Algebra.CommutativeMonoidSolver.html#5312" class="Bound">ρ</a><a id="5335" class="Symbol">)</a>
<a id="5337" href="Algebra.CommutativeMonoidSolver.html#5269" class="Function">prove′</a> <a id="5344" href="Algebra.CommutativeMonoidSolver.html#5344" class="Bound">e₁</a> <a id="5347" href="Algebra.CommutativeMonoidSolver.html#5347" class="Bound">e₂</a> <a id="5350" class="Symbol">=</a>
  <a id="5354" href="Data.Maybe.Base.html#1971" class="Function">Maybe.map</a> <a id="5364" href="Algebra.CommutativeMonoidSolver.html#5423" class="Function">lemma</a> <a id="5370" class="Symbol">(</a><a id="5371" href="Data.Maybe.Base.html#1217" class="Function">decToMaybe</a> <a id="5382" class="Symbol">(</a><a id="5383" href="Algebra.CommutativeMonoidSolver.html#4051" class="Function">normalise</a> <a id="5393" href="Algebra.CommutativeMonoidSolver.html#5344" class="Bound">e₁</a> <a id="5396" href="Algebra.CommutativeMonoidSolver.html#5003" class="Function Operator">≟</a> <a id="5398" href="Algebra.CommutativeMonoidSolver.html#4051" class="Function">normalise</a> <a id="5408" href="Algebra.CommutativeMonoidSolver.html#5347" class="Bound">e₂</a><a id="5410" class="Symbol">))</a>
  <a id="5415" class="Keyword">where</a>
  <a id="5423" href="Algebra.CommutativeMonoidSolver.html#5423" class="Function">lemma</a> <a id="5429" class="Symbol">:</a> <a id="5431" href="Algebra.CommutativeMonoidSolver.html#4051" class="Function">normalise</a> <a id="5441" href="Algebra.CommutativeMonoidSolver.html#5344" class="Bound">e₁</a> <a id="5444" href="Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="5446" href="Algebra.CommutativeMonoidSolver.html#4051" class="Function">normalise</a> <a id="5456" href="Algebra.CommutativeMonoidSolver.html#5347" class="Bound">e₂</a> <a id="5459" class="Symbol">→</a> <a id="5461" class="Symbol">∀</a> <a id="5463" href="Algebra.CommutativeMonoidSolver.html#5463" class="Bound">ρ</a> <a id="5465" class="Symbol">→</a> <a id="5467" href="Algebra.CommutativeMonoidSolver.html#1649" class="Function Operator">⟦</a> <a id="5469" href="Algebra.CommutativeMonoidSolver.html#5344" class="Bound">e₁</a> <a id="5472" href="Algebra.CommutativeMonoidSolver.html#1649" class="Function Operator">⟧</a> <a id="5474" href="Algebra.CommutativeMonoidSolver.html#5463" class="Bound">ρ</a> <a id="5476" href="Algebra.html#1633" class="Field Operator">≈</a> <a id="5478" href="Algebra.CommutativeMonoidSolver.html#1649" class="Function Operator">⟦</a> <a id="5480" href="Algebra.CommutativeMonoidSolver.html#5347" class="Bound">e₂</a> <a id="5483" href="Algebra.CommutativeMonoidSolver.html#1649" class="Function Operator">⟧</a> <a id="5485" href="Algebra.CommutativeMonoidSolver.html#5463" class="Bound">ρ</a>
  <a id="5489" href="Algebra.CommutativeMonoidSolver.html#5423" class="Function">lemma</a> <a id="5495" href="Algebra.CommutativeMonoidSolver.html#5495" class="Bound">eq</a> <a id="5498" href="Algebra.CommutativeMonoidSolver.html#5498" class="Bound">ρ</a> <a id="5500" class="Symbol">=</a>
    <a id="5506" href="Relation.Binary.Reflection.html#1696" class="Function">R.prove</a> <a id="5514" href="Algebra.CommutativeMonoidSolver.html#5498" class="Bound">ρ</a> <a id="5516" href="Algebra.CommutativeMonoidSolver.html#5344" class="Bound">e₁</a> <a id="5519" href="Algebra.CommutativeMonoidSolver.html#5347" class="Bound">e₂</a> <a id="5522" class="Symbol">(</a><a id="5523" href="Relation.Binary.PreorderReasoning.html#1154" class="Function Operator">begin</a>
      <a id="5535" href="Algebra.CommutativeMonoidSolver.html#1990" class="Function Operator">⟦</a> <a id="5537" href="Algebra.CommutativeMonoidSolver.html#4051" class="Function">normalise</a> <a id="5547" href="Algebra.CommutativeMonoidSolver.html#5344" class="Bound">e₁</a> <a id="5550" href="Algebra.CommutativeMonoidSolver.html#1990" class="Function Operator">⟧⇓</a> <a id="5553" href="Algebra.CommutativeMonoidSolver.html#5498" class="Bound">ρ</a>  <a id="5556" href="Relation.Binary.PreorderReasoning.html#1329" class="Function Operator">≡⟨</a> <a id="5559" href="Relation.Binary.PropositionalEquality.html#1076" class="Function">P.cong</a> <a id="5566" class="Symbol">(λ</a> <a id="5569" href="Algebra.CommutativeMonoidSolver.html#5569" class="Bound">e</a> <a id="5571" class="Symbol">→</a> <a id="5573" href="Algebra.CommutativeMonoidSolver.html#1990" class="Function Operator">⟦</a> <a id="5575" href="Algebra.CommutativeMonoidSolver.html#5569" class="Bound">e</a> <a id="5577" href="Algebra.CommutativeMonoidSolver.html#1990" class="Function Operator">⟧⇓</a> <a id="5580" href="Algebra.CommutativeMonoidSolver.html#5498" class="Bound">ρ</a><a id="5581" class="Symbol">)</a> <a id="5583" href="Algebra.CommutativeMonoidSolver.html#5495" class="Bound">eq</a> <a id="5586" href="Relation.Binary.PreorderReasoning.html#1329" class="Function Operator">⟩</a>
      <a id="5594" href="Algebra.CommutativeMonoidSolver.html#1990" class="Function Operator">⟦</a> <a id="5596" href="Algebra.CommutativeMonoidSolver.html#4051" class="Function">normalise</a> <a id="5606" href="Algebra.CommutativeMonoidSolver.html#5347" class="Bound">e₂</a> <a id="5609" href="Algebra.CommutativeMonoidSolver.html#1990" class="Function Operator">⟧⇓</a> <a id="5612" href="Algebra.CommutativeMonoidSolver.html#5498" class="Bound">ρ</a>  <a id="5615" href="Relation.Binary.PreorderReasoning.html#1519" class="Function Operator">∎</a><a id="5616" class="Symbol">)</a>

<a id="5619" class="Comment">-- This procedure can be combined with from-just.</a>

<a id="5670" href="Algebra.CommutativeMonoidSolver.html#5670" class="Function">prove</a> <a id="5676" class="Symbol">:</a> <a id="5678" class="Symbol">∀</a> <a id="5680" href="Algebra.CommutativeMonoidSolver.html#5680" class="Bound">n</a> <a id="5682" class="Symbol">(</a><a id="5683" href="Algebra.CommutativeMonoidSolver.html#5683" class="Bound">e₁</a> <a id="5686" href="Algebra.CommutativeMonoidSolver.html#5686" class="Bound">e₂</a> <a id="5689" class="Symbol">:</a> <a id="5691" href="Algebra.CommutativeMonoidSolver.html#1371" class="Datatype">Expr</a> <a id="5696" href="Algebra.CommutativeMonoidSolver.html#5680" class="Bound">n</a><a id="5697" class="Symbol">)</a> <a id="5699" class="Symbol">→</a>
  <a id="5703" href="Data.Maybe.Base.html#1736" class="Function">From-just</a> <a id="5713" class="Symbol">(∀</a> <a id="5716" href="Algebra.CommutativeMonoidSolver.html#5716" class="Bound">ρ</a> <a id="5718" class="Symbol">→</a> <a id="5720" href="Algebra.CommutativeMonoidSolver.html#1649" class="Function Operator">⟦</a> <a id="5722" href="Algebra.CommutativeMonoidSolver.html#5683" class="Bound">e₁</a> <a id="5725" href="Algebra.CommutativeMonoidSolver.html#1649" class="Function Operator">⟧</a> <a id="5727" href="Algebra.CommutativeMonoidSolver.html#5716" class="Bound">ρ</a> <a id="5729" href="Algebra.html#1633" class="Field Operator">≈</a> <a id="5731" href="Algebra.CommutativeMonoidSolver.html#1649" class="Function Operator">⟦</a> <a id="5733" href="Algebra.CommutativeMonoidSolver.html#5686" class="Bound">e₂</a> <a id="5736" href="Algebra.CommutativeMonoidSolver.html#1649" class="Function Operator">⟧</a> <a id="5738" href="Algebra.CommutativeMonoidSolver.html#5716" class="Bound">ρ</a><a id="5739" class="Symbol">)</a> <a id="5741" class="Symbol">(</a><a id="5742" href="Algebra.CommutativeMonoidSolver.html#5269" class="Function">prove′</a>  <a id="5750" href="Algebra.CommutativeMonoidSolver.html#5683" class="Bound">e₁</a> <a id="5753" href="Algebra.CommutativeMonoidSolver.html#5686" class="Bound">e₂</a><a id="5755" class="Symbol">)</a>
<a id="5757" href="Algebra.CommutativeMonoidSolver.html#5670" class="Function">prove</a> <a id="5763" class="Symbol">_</a> <a id="5765" href="Algebra.CommutativeMonoidSolver.html#5765" class="Bound">e₁</a> <a id="5768" href="Algebra.CommutativeMonoidSolver.html#5768" class="Bound">e₂</a> <a id="5771" class="Symbol">=</a> <a id="5773" href="Data.Maybe.Base.html#1840" class="Function">from-just</a> <a id="5783" class="Symbol">(</a><a id="5784" href="Algebra.CommutativeMonoidSolver.html#5269" class="Function">prove′</a> <a id="5791" href="Algebra.CommutativeMonoidSolver.html#5765" class="Bound">e₁</a> <a id="5794" href="Algebra.CommutativeMonoidSolver.html#5768" class="Bound">e₂</a><a id="5796" class="Symbol">)</a>

<a id="5799" class="Comment">-- prove : ∀ n (es : Expr n × Expr n) →</a>
<a id="5839" class="Comment">--         From-just (∀ ρ → ⟦ proj₁ es ⟧ ρ ≈ ⟦ proj₂ es ⟧ ρ)</a>
<a id="5900" class="Comment">--                   (uncurry prove′ es)</a>
<a id="5941" class="Comment">-- prove _ = from-just ∘ uncurry prove′</a>
</pre></body></html>