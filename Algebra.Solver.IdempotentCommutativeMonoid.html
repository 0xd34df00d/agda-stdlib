<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Algebra.Solver.IdempotentCommutativeMonoid</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Solver for equations in commutative monoids</a>
<a id="153" class="Comment">--</a>
<a id="156" class="Comment">-- Adapted from Algebra.Monoid-solver</a>
<a id="194" class="Comment">------------------------------------------------------------------------</a>

<a id="268" class="Keyword">open</a> <a id="273" class="Keyword">import</a> <a id="280" href="Algebra.html" class="Module">Algebra</a>

<a id="289" class="Keyword">open</a> <a id="294" class="Keyword">import</a> <a id="301" href="Data.Bool.html" class="Module">Data.Bool</a> <a id="311" class="Symbol">as</a> <a id="314" class="Module">Bool</a> <a id="319" class="Keyword">using</a> <a id="325" class="Symbol">(</a><a id="326" href="Agda.Builtin.Bool.html#67" class="Datatype">Bool</a><a id="330" class="Symbol">;</a> <a id="332" href="Agda.Builtin.Bool.html#92" class="InductiveConstructor">true</a><a id="336" class="Symbol">;</a> <a id="338" href="Agda.Builtin.Bool.html#86" class="InductiveConstructor">false</a><a id="343" class="Symbol">;</a> <a id="345" href="Data.Bool.Base.html#798" class="Function Operator">if_then_else_</a><a id="358" class="Symbol">;</a> <a id="360" href="Data.Bool.Base.html#964" class="Function Operator">_∨_</a><a id="363" class="Symbol">)</a>
<a id="365" class="Keyword">open</a> <a id="370" class="Keyword">import</a> <a id="377" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="386" class="Keyword">using</a> <a id="392" class="Symbol">(</a><a id="393" href="Data.Fin.Base.html#915" class="Datatype">Fin</a><a id="396" class="Symbol">;</a> <a id="398" href="Data.Fin.Base.html#937" class="InductiveConstructor">zero</a><a id="402" class="Symbol">;</a> <a id="404" href="Data.Fin.Base.html#968" class="InductiveConstructor">suc</a><a id="407" class="Symbol">)</a>
<a id="409" class="Keyword">open</a> <a id="414" class="Keyword">import</a> <a id="421" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="432" class="Symbol">as</a> <a id="435" class="Module">Maybe</a>
  <a id="443" class="Keyword">using</a> <a id="449" class="Symbol">(</a><a id="450" href="Data.Maybe.Base.html#674" class="Datatype">Maybe</a><a id="455" class="Symbol">;</a> <a id="457" href="Data.Maybe.Base.html#1249" class="Function">decToMaybe</a><a id="467" class="Symbol">;</a> <a id="469" href="Data.Maybe.Base.html#1900" class="Function">From-just</a><a id="478" class="Symbol">;</a> <a id="480" href="Data.Maybe.Base.html#1988" class="Function">from-just</a><a id="489" class="Symbol">)</a>
<a id="491" class="Keyword">open</a> <a id="496" class="Keyword">import</a> <a id="503" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="517" class="Symbol">as</a> <a id="520" class="Module">ℕ</a> <a id="522" class="Keyword">using</a> <a id="528" class="Symbol">(</a><a id="529" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="530" class="Symbol">;</a> <a id="532" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a><a id="536" class="Symbol">;</a> <a id="538" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a><a id="541" class="Symbol">;</a> <a id="543" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">_+_</a><a id="546" class="Symbol">)</a>
<a id="548" class="Keyword">open</a> <a id="553" class="Keyword">import</a> <a id="560" href="Data.Product.html" class="Module">Data.Product</a> <a id="573" class="Keyword">using</a> <a id="579" class="Symbol">(</a><a id="580" href="Data.Product.html#1353" class="Function Operator">_×_</a><a id="583" class="Symbol">;</a> <a id="585" href="Data.Product.html#3464" class="Function">uncurry</a><a id="592" class="Symbol">)</a>
<a id="594" class="Keyword">open</a> <a id="599" class="Keyword">import</a> <a id="606" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="615" class="Keyword">using</a> <a id="621" class="Symbol">(</a><a id="622" href="Data.Vec.html#737" class="Datatype">Vec</a><a id="625" class="Symbol">;</a> <a id="627" href="Data.Vec.html#777" class="InductiveConstructor">[]</a><a id="629" class="Symbol">;</a> <a id="631" href="Data.Vec.html#796" class="InductiveConstructor Operator">_∷_</a><a id="634" class="Symbol">;</a> <a id="636" href="Data.Vec.html#1343" class="Function">lookup</a><a id="642" class="Symbol">;</a> <a id="644" href="Data.Vec.html#5447" class="Function">replicate</a><a id="653" class="Symbol">)</a>

<a id="656" class="Keyword">open</a> <a id="661" class="Keyword">import</a> <a id="668" href="Function.html" class="Module">Function</a> <a id="677" class="Keyword">using</a> <a id="683" class="Symbol">(</a><a id="684" href="Function.html#769" class="Function Operator">_∘_</a><a id="687" class="Symbol">)</a>

<a id="690" class="Keyword">import</a> <a id="697" href="Relation.Binary.EqReasoning.html" class="Module">Relation.Binary.EqReasoning</a> <a id="725" class="Symbol">as</a> <a id="728" class="Module">EqReasoning</a>
<a id="740" class="Keyword">import</a> <a id="747" href="Relation.Binary.Reflection.html" class="Module">Relation.Binary.Reflection</a>  <a id="775" class="Symbol">as</a> <a id="778" class="Module">Reflection</a>
<a id="789" class="Keyword">import</a> <a id="796" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a>  <a id="824" class="Symbol">as</a> <a id="827" class="Module">Dec</a>
<a id="831" class="Keyword">import</a> <a id="838" href="Data.Vec.Relation.Pointwise.Inductive.html" class="Module">Data.Vec.Relation.Pointwise.Inductive</a> <a id="876" class="Symbol">as</a> <a id="879" class="Module">Pointwise</a>

<a id="890" class="Keyword">open</a> <a id="895" class="Keyword">import</a> <a id="902" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="940" class="Symbol">as</a> <a id="943" class="Module">P</a> <a id="945" class="Keyword">using</a> <a id="951" class="Symbol">(</a><a id="952" href="Agda.Builtin.Equality.html#83" class="Datatype Operator">_≡_</a><a id="955" class="Symbol">;</a> <a id="957" href="Relation.Binary.PropositionalEquality.html#1693" class="Function">decSetoid</a><a id="966" class="Symbol">)</a>
<a id="968" class="Keyword">open</a> <a id="973" class="Keyword">import</a> <a id="980" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="997" class="Keyword">using</a> <a id="1003" class="Symbol">(</a><a id="1004" href="Relation.Nullary.html#534" class="Datatype">Dec</a><a id="1007" class="Symbol">)</a>

<a id="1010" class="Keyword">module</a> <a id="1017" href="Algebra.Solver.IdempotentCommutativeMonoid.html" class="Module">Algebra.Solver.IdempotentCommutativeMonoid</a>
  <a id="1062" class="Symbol">{</a><a id="1063" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1063" class="Bound">m₁</a> <a id="1066" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1066" class="Bound">m₂</a><a id="1068" class="Symbol">}</a> <a id="1070" class="Symbol">(</a><a id="1071" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1071" class="Bound">M</a> <a id="1073" class="Symbol">:</a> <a id="1075" href="Algebra.html#2633" class="Record">IdempotentCommutativeMonoid</a> <a id="1103" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1063" class="Bound">m₁</a> <a id="1106" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1066" class="Bound">m₂</a><a id="1108" class="Symbol">)</a> <a id="1110" class="Keyword">where</a>

<a id="1117" class="Keyword">open</a> <a id="1122" href="Algebra.html#2633" class="Module">IdempotentCommutativeMonoid</a> <a id="1150" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1071" class="Bound">M</a>
<a id="1152" class="Keyword">open</a> <a id="1157" href="Relation.Binary.EqReasoning.html" class="Module">EqReasoning</a> <a id="1169" href="Algebra.Structures.html#904" class="Function">setoid</a>

<a id="1177" class="Comment">------------------------------------------------------------------------</a>
<a id="1250" class="Comment">-- Monoid expressions</a>

<a id="1273" class="Comment">-- There is one constructor for every operation, plus one for</a>
<a id="1335" class="Comment">-- variables; there may be at most n variables.</a>

<a id="1384" class="Keyword">infixr</a> <a id="1391" class="Number">5</a> <a id="1393" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1482" class="InductiveConstructor Operator">_⊕_</a>
<a id="1397" class="Keyword">infixr</a> <a id="1404" class="Number">10</a> <a id="1407" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2470" class="Function Operator">_•_</a>

<a id="1412" class="Keyword">data</a> <a id="Expr"></a><a id="1417" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1417" class="Datatype">Expr</a> <a id="1422" class="Symbol">(</a><a id="1423" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1423" class="Bound">n</a> <a id="1425" class="Symbol">:</a> <a id="1427" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="1428" class="Symbol">)</a> <a id="1430" class="Symbol">:</a> <a id="1432" class="PrimitiveType">Set</a> <a id="1436" class="Keyword">where</a>
  <a id="Expr.var"></a><a id="1444" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1444" class="InductiveConstructor">var</a> <a id="1448" class="Symbol">:</a> <a id="1450" href="Data.Fin.Base.html#915" class="Datatype">Fin</a> <a id="1454" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1423" class="Bound">n</a> <a id="1456" class="Symbol">→</a> <a id="1458" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1417" class="Datatype">Expr</a> <a id="1463" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1423" class="Bound">n</a>
  <a id="Expr.id"></a><a id="1467" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1467" class="InductiveConstructor">id</a>  <a id="1471" class="Symbol">:</a> <a id="1473" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1417" class="Datatype">Expr</a> <a id="1478" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1423" class="Bound">n</a>
  <a id="Expr._⊕_"></a><a id="1482" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1482" class="InductiveConstructor Operator">_⊕_</a> <a id="1486" class="Symbol">:</a> <a id="1488" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1417" class="Datatype">Expr</a> <a id="1493" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1423" class="Bound">n</a> <a id="1495" class="Symbol">→</a> <a id="1497" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1417" class="Datatype">Expr</a> <a id="1502" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1423" class="Bound">n</a> <a id="1504" class="Symbol">→</a> <a id="1506" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1417" class="Datatype">Expr</a> <a id="1511" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1423" class="Bound">n</a>

<a id="1514" class="Comment">-- An environment contains one value for every variable.</a>

<a id="Env"></a><a id="1572" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1572" class="Function">Env</a> <a id="1576" class="Symbol">:</a> <a id="1578" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="1580" class="Symbol">→</a> <a id="1582" class="PrimitiveType">Set</a> <a id="1586" class="Symbol">_</a>
<a id="1588" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1572" class="Function">Env</a> <a id="1592" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1592" class="Bound">n</a> <a id="1594" class="Symbol">=</a> <a id="1596" href="Data.Vec.html#737" class="Datatype">Vec</a> <a id="1600" href="Algebra.html#2733" class="Field">Carrier</a> <a id="1608" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1592" class="Bound">n</a>

<a id="1611" class="Comment">-- The semantics of an expression is a function from an environment to</a>
<a id="1682" class="Comment">-- a value.</a>

<a id="⟦_⟧"></a><a id="1695" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1695" class="Function Operator">⟦_⟧</a> <a id="1699" class="Symbol">:</a> <a id="1701" class="Symbol">∀</a> <a id="1703" class="Symbol">{</a><a id="1704" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1704" class="Bound">n</a><a id="1705" class="Symbol">}</a> <a id="1707" class="Symbol">→</a> <a id="1709" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1417" class="Datatype">Expr</a> <a id="1714" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1704" class="Bound">n</a> <a id="1716" class="Symbol">→</a> <a id="1718" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1572" class="Function">Env</a> <a id="1722" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1704" class="Bound">n</a> <a id="1724" class="Symbol">→</a> <a id="1726" href="Algebra.html#2733" class="Field">Carrier</a>
<a id="1734" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1695" class="Function Operator">⟦</a> <a id="1736" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1444" class="InductiveConstructor">var</a> <a id="1740" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1740" class="Bound">x</a>   <a id="1744" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1695" class="Function Operator">⟧</a> <a id="1746" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1746" class="Bound">ρ</a> <a id="1748" class="Symbol">=</a> <a id="1750" href="Data.Vec.html#1343" class="Function">lookup</a> <a id="1757" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1740" class="Bound">x</a> <a id="1759" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1746" class="Bound">ρ</a>
<a id="1761" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1695" class="Function Operator">⟦</a> <a id="1763" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1467" class="InductiveConstructor">id</a>      <a id="1771" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1695" class="Function Operator">⟧</a> <a id="1773" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1773" class="Bound">ρ</a> <a id="1775" class="Symbol">=</a> <a id="1777" href="Algebra.html#2873" class="Field">ε</a>
<a id="1779" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1695" class="Function Operator">⟦</a> <a id="1781" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1781" class="Bound">e₁</a> <a id="1784" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1482" class="InductiveConstructor Operator">⊕</a> <a id="1786" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1786" class="Bound">e₂</a> <a id="1789" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1695" class="Function Operator">⟧</a> <a id="1791" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1791" class="Bound">ρ</a> <a id="1793" class="Symbol">=</a> <a id="1795" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1695" class="Function Operator">⟦</a> <a id="1797" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1781" class="Bound">e₁</a> <a id="1800" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1695" class="Function Operator">⟧</a> <a id="1802" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1791" class="Bound">ρ</a> <a id="1804" href="Algebra.html#2825" class="Field Operator">∙</a> <a id="1806" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1695" class="Function Operator">⟦</a> <a id="1808" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1786" class="Bound">e₂</a> <a id="1811" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1695" class="Function Operator">⟧</a> <a id="1813" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1791" class="Bound">ρ</a>

<a id="1816" class="Comment">------------------------------------------------------------------------</a>
<a id="1889" class="Comment">-- Normal forms</a>

<a id="1906" class="Comment">-- A normal form is a vector of bits (a set).</a>

<a id="Normal"></a><a id="1953" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1953" class="Function">Normal</a> <a id="1960" class="Symbol">:</a> <a id="1962" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="1964" class="Symbol">→</a> <a id="1966" class="PrimitiveType">Set</a>
<a id="1970" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1953" class="Function">Normal</a> <a id="1977" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1977" class="Bound">n</a> <a id="1979" class="Symbol">=</a> <a id="1981" href="Data.Vec.html#737" class="Datatype">Vec</a> <a id="1985" href="Agda.Builtin.Bool.html#67" class="Datatype">Bool</a> <a id="1990" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1977" class="Bound">n</a>

<a id="1993" class="Comment">-- The semantics of a normal form.</a>

<a id="⟦_⟧⇓"></a><a id="2029" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2029" class="Function Operator">⟦_⟧⇓</a> <a id="2034" class="Symbol">:</a> <a id="2036" class="Symbol">∀</a> <a id="2038" class="Symbol">{</a><a id="2039" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2039" class="Bound">n</a><a id="2040" class="Symbol">}</a> <a id="2042" class="Symbol">→</a> <a id="2044" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1953" class="Function">Normal</a> <a id="2051" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2039" class="Bound">n</a> <a id="2053" class="Symbol">→</a> <a id="2055" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1572" class="Function">Env</a> <a id="2059" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2039" class="Bound">n</a> <a id="2061" class="Symbol">→</a> <a id="2063" href="Algebra.html#2733" class="Field">Carrier</a>
<a id="2071" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2029" class="Function Operator">⟦</a> <a id="2073" href="Data.Vec.html#777" class="InductiveConstructor">[]</a>    <a id="2079" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2029" class="Function Operator">⟧⇓</a> <a id="2082" class="Symbol">_</a> <a id="2084" class="Symbol">=</a> <a id="2086" href="Algebra.html#2873" class="Field">ε</a>
<a id="2088" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2029" class="Function Operator">⟦</a> <a id="2090" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2090" class="Bound">b</a> <a id="2092" href="Data.Vec.html#796" class="InductiveConstructor Operator">∷</a> <a id="2094" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2094" class="Bound">v</a> <a id="2096" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2029" class="Function Operator">⟧⇓</a> <a id="2099" class="Symbol">(</a><a id="2100" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2100" class="Bound">a</a> <a id="2102" href="Data.Vec.html#796" class="InductiveConstructor Operator">∷</a> <a id="2104" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2104" class="Bound">ρ</a><a id="2105" class="Symbol">)</a> <a id="2107" class="Symbol">=</a> <a id="2109" href="Data.Bool.Base.html#798" class="Function Operator">if</a> <a id="2112" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2090" class="Bound">b</a> <a id="2114" href="Data.Bool.Base.html#798" class="Function Operator">then</a> <a id="2119" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2100" class="Bound">a</a> <a id="2121" href="Algebra.html#2825" class="Field Operator">∙</a> <a id="2123" class="Symbol">(</a><a id="2124" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2029" class="Function Operator">⟦</a> <a id="2126" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2094" class="Bound">v</a> <a id="2128" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2029" class="Function Operator">⟧⇓</a> <a id="2131" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2104" class="Bound">ρ</a><a id="2132" class="Symbol">)</a> <a id="2134" href="Data.Bool.Base.html#798" class="Function Operator">else</a> <a id="2139" class="Symbol">(</a><a id="2140" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2029" class="Function Operator">⟦</a> <a id="2142" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2094" class="Bound">v</a> <a id="2144" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2029" class="Function Operator">⟧⇓</a> <a id="2147" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2104" class="Bound">ρ</a><a id="2148" class="Symbol">)</a>

<a id="2151" class="Comment">------------------------------------------------------------------------</a>
<a id="2224" class="Comment">-- Constructions on normal forms</a>

<a id="2258" class="Comment">-- The empty bag.</a>

<a id="empty"></a><a id="2277" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2277" class="Function">empty</a> <a id="2283" class="Symbol">:</a> <a id="2285" class="Symbol">∀{</a><a id="2287" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2287" class="Bound">n</a><a id="2288" class="Symbol">}</a> <a id="2290" class="Symbol">→</a> <a id="2292" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1953" class="Function">Normal</a> <a id="2299" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2287" class="Bound">n</a>
<a id="2301" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2277" class="Function">empty</a> <a id="2307" class="Symbol">=</a> <a id="2309" href="Data.Vec.html#5447" class="Function">replicate</a> <a id="2319" href="Agda.Builtin.Bool.html#86" class="InductiveConstructor">false</a>

<a id="2326" class="Comment">-- A singleton bag.</a>

<a id="sg"></a><a id="2347" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2347" class="Function">sg</a> <a id="2350" class="Symbol">:</a> <a id="2352" class="Symbol">∀{</a><a id="2354" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2354" class="Bound">n</a><a id="2355" class="Symbol">}</a> <a id="2357" class="Symbol">(</a><a id="2358" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2358" class="Bound">i</a> <a id="2360" class="Symbol">:</a> <a id="2362" href="Data.Fin.Base.html#915" class="Datatype">Fin</a> <a id="2366" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2354" class="Bound">n</a><a id="2367" class="Symbol">)</a> <a id="2369" class="Symbol">→</a> <a id="2371" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1953" class="Function">Normal</a> <a id="2378" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2354" class="Bound">n</a>
<a id="2380" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2347" class="Function">sg</a> <a id="2383" href="Data.Fin.Base.html#937" class="InductiveConstructor">zero</a>    <a id="2391" class="Symbol">=</a> <a id="2393" href="Agda.Builtin.Bool.html#92" class="InductiveConstructor">true</a> <a id="2398" href="Data.Vec.html#796" class="InductiveConstructor Operator">∷</a> <a id="2400" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2277" class="Function">empty</a>
<a id="2406" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2347" class="Function">sg</a> <a id="2409" class="Symbol">(</a><a id="2410" href="Data.Fin.Base.html#968" class="InductiveConstructor">suc</a> <a id="2414" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2414" class="Bound">i</a><a id="2415" class="Symbol">)</a> <a id="2417" class="Symbol">=</a> <a id="2419" href="Agda.Builtin.Bool.html#86" class="InductiveConstructor">false</a> <a id="2425" href="Data.Vec.html#796" class="InductiveConstructor Operator">∷</a> <a id="2427" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2347" class="Function">sg</a> <a id="2430" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2414" class="Bound">i</a>

<a id="2433" class="Comment">-- The composition of normal forms.</a>

<a id="_•_"></a><a id="2470" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2470" class="Function Operator">_•_</a>  <a id="2475" class="Symbol">:</a> <a id="2477" class="Symbol">∀{</a><a id="2479" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2479" class="Bound">n</a><a id="2480" class="Symbol">}</a> <a id="2482" class="Symbol">(</a><a id="2483" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2483" class="Bound">v</a> <a id="2485" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2485" class="Bound">w</a> <a id="2487" class="Symbol">:</a> <a id="2489" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1953" class="Function">Normal</a> <a id="2496" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2479" class="Bound">n</a><a id="2497" class="Symbol">)</a> <a id="2499" class="Symbol">→</a> <a id="2501" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1953" class="Function">Normal</a> <a id="2508" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2479" class="Bound">n</a>
<a id="2510" href="Data.Vec.html#777" class="InductiveConstructor">[]</a>      <a id="2518" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2470" class="Function Operator">•</a> <a id="2520" href="Data.Vec.html#777" class="InductiveConstructor">[]</a>      <a id="2528" class="Symbol">=</a> <a id="2530" href="Data.Vec.html#777" class="InductiveConstructor">[]</a>
<a id="2533" class="Symbol">(</a><a id="2534" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2534" class="Bound">l</a> <a id="2536" href="Data.Vec.html#796" class="InductiveConstructor Operator">∷</a> <a id="2538" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2538" class="Bound">v</a><a id="2539" class="Symbol">)</a> <a id="2541" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2470" class="Function Operator">•</a> <a id="2543" class="Symbol">(</a><a id="2544" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2544" class="Bound">m</a> <a id="2546" href="Data.Vec.html#796" class="InductiveConstructor Operator">∷</a> <a id="2548" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2548" class="Bound">w</a><a id="2549" class="Symbol">)</a> <a id="2551" class="Symbol">=</a> <a id="2553" class="Symbol">(</a><a id="2554" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2534" class="Bound">l</a> <a id="2556" href="Data.Bool.Base.html#964" class="Function Operator">∨</a> <a id="2558" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2544" class="Bound">m</a><a id="2559" class="Symbol">)</a> <a id="2561" href="Data.Vec.html#796" class="InductiveConstructor Operator">∷</a> <a id="2563" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2538" class="Bound">v</a> <a id="2565" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2470" class="Function Operator">•</a> <a id="2567" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2548" class="Bound">w</a>

<a id="2570" class="Comment">------------------------------------------------------------------------</a>
<a id="2643" class="Comment">-- Correctness of the constructions on normal forms</a>

<a id="2696" class="Comment">-- The empty bag stands for the unit ε.</a>

<a id="empty-correct"></a><a id="2737" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2737" class="Function">empty-correct</a> <a id="2751" class="Symbol">:</a> <a id="2753" class="Symbol">∀{</a><a id="2755" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2755" class="Bound">n</a><a id="2756" class="Symbol">}</a> <a id="2758" class="Symbol">(</a><a id="2759" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2759" class="Bound">ρ</a> <a id="2761" class="Symbol">:</a> <a id="2763" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1572" class="Function">Env</a> <a id="2767" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2755" class="Bound">n</a><a id="2768" class="Symbol">)</a> <a id="2770" class="Symbol">→</a> <a id="2772" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2029" class="Function Operator">⟦</a> <a id="2774" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2277" class="Function">empty</a> <a id="2780" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2029" class="Function Operator">⟧⇓</a> <a id="2783" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2759" class="Bound">ρ</a> <a id="2785" href="Algebra.html#2775" class="Field Operator">≈</a> <a id="2787" href="Algebra.html#2873" class="Field">ε</a>
<a id="2789" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2737" class="Function">empty-correct</a> <a id="2803" href="Data.Vec.html#777" class="InductiveConstructor">[]</a> <a id="2806" class="Symbol">=</a> <a id="2808" href="Relation.Binary.Core.html#5446" class="Function">refl</a>
<a id="2813" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2737" class="Function">empty-correct</a> <a id="2827" class="Symbol">(</a><a id="2828" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2828" class="Bound">a</a> <a id="2830" href="Data.Vec.html#796" class="InductiveConstructor Operator">∷</a> <a id="2832" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2832" class="Bound">ρ</a><a id="2833" class="Symbol">)</a> <a id="2835" class="Symbol">=</a> <a id="2837" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2737" class="Function">empty-correct</a> <a id="2851" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2832" class="Bound">ρ</a>

<a id="2854" class="Comment">-- The singleton bag stands for a single variable.</a>

<a id="sg-correct"></a><a id="2906" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2906" class="Function">sg-correct</a> <a id="2917" class="Symbol">:</a> <a id="2919" class="Symbol">∀{</a><a id="2921" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2921" class="Bound">n</a><a id="2922" class="Symbol">}</a> <a id="2924" class="Symbol">(</a><a id="2925" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2925" class="Bound">x</a> <a id="2927" class="Symbol">:</a> <a id="2929" href="Data.Fin.Base.html#915" class="Datatype">Fin</a> <a id="2933" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2921" class="Bound">n</a><a id="2934" class="Symbol">)</a> <a id="2936" class="Symbol">(</a><a id="2937" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2937" class="Bound">ρ</a> <a id="2939" class="Symbol">:</a> <a id="2941" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1572" class="Function">Env</a> <a id="2945" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2921" class="Bound">n</a><a id="2946" class="Symbol">)</a> <a id="2948" class="Symbol">→</a>  <a id="2951" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2029" class="Function Operator">⟦</a> <a id="2953" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2347" class="Function">sg</a> <a id="2956" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2925" class="Bound">x</a> <a id="2958" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2029" class="Function Operator">⟧⇓</a> <a id="2961" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2937" class="Bound">ρ</a> <a id="2963" href="Algebra.html#2775" class="Field Operator">≈</a> <a id="2965" href="Data.Vec.html#1343" class="Function">lookup</a> <a id="2972" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2925" class="Bound">x</a> <a id="2974" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2937" class="Bound">ρ</a>
<a id="2976" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2906" class="Function">sg-correct</a> <a id="2987" href="Data.Fin.Base.html#937" class="InductiveConstructor">zero</a> <a id="2992" class="Symbol">(</a><a id="2993" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2993" class="Bound">x</a> <a id="2995" href="Data.Vec.html#796" class="InductiveConstructor Operator">∷</a> <a id="2997" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2997" class="Bound">ρ</a><a id="2998" class="Symbol">)</a> <a id="3000" class="Symbol">=</a> <a id="3002" href="Relation.Binary.PreorderReasoning.html#1228" class="Function Operator">begin</a>
    <a id="3012" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2993" class="Bound">x</a> <a id="3014" href="Algebra.html#2825" class="Field Operator">∙</a> <a id="3016" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2029" class="Function Operator">⟦</a> <a id="3018" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2277" class="Function">empty</a> <a id="3024" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2029" class="Function Operator">⟧⇓</a> <a id="3027" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2997" class="Bound">ρ</a>   <a id="3031" href="Relation.Binary.PreorderReasoning.html#1294" class="Function Operator">≈⟨</a> <a id="3034" href="Algebra.Structures.html#872" class="Function">∙-cong</a> <a id="3041" href="Relation.Binary.Core.html#5446" class="Function">refl</a> <a id="3046" class="Symbol">(</a><a id="3047" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2737" class="Function">empty-correct</a> <a id="3061" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2997" class="Bound">ρ</a><a id="3062" class="Symbol">)</a> <a id="3064" href="Relation.Binary.PreorderReasoning.html#1294" class="Function Operator">⟩</a>
    <a id="3070" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2993" class="Bound">x</a> <a id="3072" href="Algebra.html#2825" class="Field Operator">∙</a> <a id="3074" href="Algebra.html#2873" class="Field">ε</a>              <a id="3089" href="Relation.Binary.PreorderReasoning.html#1294" class="Function Operator">≈⟨</a> <a id="3092" href="Algebra.Structures.html#1838" class="Function">identityʳ</a> <a id="3102" class="Symbol">_</a> <a id="3104" href="Relation.Binary.PreorderReasoning.html#1294" class="Function Operator">⟩</a>
    <a id="3110" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2993" class="Bound">x</a>                  <a id="3129" href="Relation.Binary.PreorderReasoning.html#1681" class="Function Operator">∎</a>
<a id="3131" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2906" class="Function">sg-correct</a> <a id="3142" class="Symbol">(</a><a id="3143" href="Data.Fin.Base.html#968" class="InductiveConstructor">suc</a> <a id="3147" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3147" class="Bound">x</a><a id="3148" class="Symbol">)</a> <a id="3150" class="Symbol">(</a><a id="3151" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3151" class="Bound">m</a> <a id="3153" href="Data.Vec.html#796" class="InductiveConstructor Operator">∷</a> <a id="3155" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3155" class="Bound">ρ</a><a id="3156" class="Symbol">)</a> <a id="3158" class="Symbol">=</a> <a id="3160" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2906" class="Function">sg-correct</a> <a id="3171" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3147" class="Bound">x</a> <a id="3173" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3155" class="Bound">ρ</a>

<a id="3176" class="Comment">-- Normal form composition corresponds to the composition of the monoid.</a>

<a id="flip12"></a><a id="3250" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3250" class="Function">flip12</a> <a id="3257" class="Symbol">:</a> <a id="3259" class="Symbol">∀</a> <a id="3261" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3261" class="Bound">a</a> <a id="3263" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3263" class="Bound">b</a> <a id="3265" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3265" class="Bound">c</a> <a id="3267" class="Symbol">→</a> <a id="3269" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3261" class="Bound">a</a> <a id="3271" href="Algebra.html#2825" class="Field Operator">∙</a> <a id="3273" class="Symbol">(</a><a id="3274" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3263" class="Bound">b</a> <a id="3276" href="Algebra.html#2825" class="Field Operator">∙</a> <a id="3278" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3265" class="Bound">c</a><a id="3279" class="Symbol">)</a> <a id="3281" href="Algebra.html#2775" class="Field Operator">≈</a> <a id="3283" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3263" class="Bound">b</a> <a id="3285" href="Algebra.html#2825" class="Field Operator">∙</a> <a id="3287" class="Symbol">(</a><a id="3288" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3261" class="Bound">a</a> <a id="3290" href="Algebra.html#2825" class="Field Operator">∙</a> <a id="3292" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3265" class="Bound">c</a><a id="3293" class="Symbol">)</a>
<a id="3295" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3250" class="Function">flip12</a> <a id="3302" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3302" class="Bound">a</a> <a id="3304" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3304" class="Bound">b</a> <a id="3306" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3306" class="Bound">c</a> <a id="3308" class="Symbol">=</a> <a id="3310" href="Relation.Binary.PreorderReasoning.html#1228" class="Function Operator">begin</a>
    <a id="3320" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3302" class="Bound">a</a> <a id="3322" href="Algebra.html#2825" class="Field Operator">∙</a> <a id="3324" class="Symbol">(</a><a id="3325" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3304" class="Bound">b</a> <a id="3327" href="Algebra.html#2825" class="Field Operator">∙</a> <a id="3329" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3306" class="Bound">c</a><a id="3330" class="Symbol">)</a>  <a id="3333" href="Relation.Binary.PreorderReasoning.html#1294" class="Function Operator">≈⟨</a> <a id="3336" href="Relation.Binary.Core.html#5472" class="Function">sym</a> <a id="3340" class="Symbol">(</a><a id="3341" href="Algebra.Structures.html#838" class="Function">assoc</a> <a id="3347" class="Symbol">_</a> <a id="3349" class="Symbol">_</a> <a id="3351" class="Symbol">_)</a> <a id="3354" href="Relation.Binary.PreorderReasoning.html#1294" class="Function Operator">⟩</a>
    <a id="3360" class="Symbol">(</a><a id="3361" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3302" class="Bound">a</a> <a id="3363" href="Algebra.html#2825" class="Field Operator">∙</a> <a id="3365" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3304" class="Bound">b</a><a id="3366" class="Symbol">)</a> <a id="3368" href="Algebra.html#2825" class="Field Operator">∙</a> <a id="3370" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3306" class="Bound">c</a>  <a id="3373" href="Relation.Binary.PreorderReasoning.html#1294" class="Function Operator">≈⟨</a> <a id="3376" href="Algebra.Structures.html#872" class="Function">∙-cong</a> <a id="3383" class="Symbol">(</a><a id="3384" href="Algebra.Structures.html#1768" class="Function">comm</a> <a id="3389" class="Symbol">_</a> <a id="3391" class="Symbol">_)</a> <a id="3394" href="Relation.Binary.Core.html#5446" class="Function">refl</a> <a id="3399" href="Relation.Binary.PreorderReasoning.html#1294" class="Function Operator">⟩</a>
    <a id="3405" class="Symbol">(</a><a id="3406" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3304" class="Bound">b</a> <a id="3408" href="Algebra.html#2825" class="Field Operator">∙</a> <a id="3410" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3302" class="Bound">a</a><a id="3411" class="Symbol">)</a> <a id="3413" href="Algebra.html#2825" class="Field Operator">∙</a> <a id="3415" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3306" class="Bound">c</a>  <a id="3418" href="Relation.Binary.PreorderReasoning.html#1294" class="Function Operator">≈⟨</a> <a id="3421" href="Algebra.Structures.html#838" class="Function">assoc</a> <a id="3427" class="Symbol">_</a> <a id="3429" class="Symbol">_</a> <a id="3431" class="Symbol">_</a> <a id="3433" href="Relation.Binary.PreorderReasoning.html#1294" class="Function Operator">⟩</a>
    <a id="3439" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3304" class="Bound">b</a> <a id="3441" href="Algebra.html#2825" class="Field Operator">∙</a> <a id="3443" class="Symbol">(</a><a id="3444" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3302" class="Bound">a</a> <a id="3446" href="Algebra.html#2825" class="Field Operator">∙</a> <a id="3448" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3306" class="Bound">c</a><a id="3449" class="Symbol">)</a>  <a id="3452" href="Relation.Binary.PreorderReasoning.html#1681" class="Function Operator">∎</a>

<a id="distr"></a><a id="3455" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3455" class="Function">distr</a> <a id="3461" class="Symbol">:</a> <a id="3463" class="Symbol">∀</a> <a id="3465" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3465" class="Bound">a</a> <a id="3467" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3467" class="Bound">b</a> <a id="3469" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3469" class="Bound">c</a> <a id="3471" class="Symbol">→</a> <a id="3473" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3465" class="Bound">a</a> <a id="3475" href="Algebra.html#2825" class="Field Operator">∙</a> <a id="3477" class="Symbol">(</a><a id="3478" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3467" class="Bound">b</a> <a id="3480" href="Algebra.html#2825" class="Field Operator">∙</a> <a id="3482" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3469" class="Bound">c</a><a id="3483" class="Symbol">)</a> <a id="3485" href="Algebra.html#2775" class="Field Operator">≈</a> <a id="3487" class="Symbol">(</a><a id="3488" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3465" class="Bound">a</a> <a id="3490" href="Algebra.html#2825" class="Field Operator">∙</a> <a id="3492" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3467" class="Bound">b</a><a id="3493" class="Symbol">)</a> <a id="3495" href="Algebra.html#2825" class="Field Operator">∙</a> <a id="3497" class="Symbol">(</a><a id="3498" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3465" class="Bound">a</a> <a id="3500" href="Algebra.html#2825" class="Field Operator">∙</a> <a id="3502" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3469" class="Bound">c</a><a id="3503" class="Symbol">)</a>
<a id="3505" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3455" class="Function">distr</a> <a id="3511" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3511" class="Bound">a</a> <a id="3513" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3513" class="Bound">b</a> <a id="3515" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3515" class="Bound">c</a> <a id="3517" class="Symbol">=</a> <a id="3519" href="Relation.Binary.PreorderReasoning.html#1228" class="Function Operator">begin</a>
    <a id="3529" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3511" class="Bound">a</a> <a id="3531" href="Algebra.html#2825" class="Field Operator">∙</a> <a id="3533" class="Symbol">(</a><a id="3534" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3513" class="Bound">b</a> <a id="3536" href="Algebra.html#2825" class="Field Operator">∙</a> <a id="3538" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3515" class="Bound">c</a><a id="3539" class="Symbol">)</a>  <a id="3542" href="Relation.Binary.PreorderReasoning.html#1294" class="Function Operator">≈⟨</a> <a id="3545" href="Algebra.Structures.html#872" class="Function">∙-cong</a> <a id="3552" class="Symbol">(</a><a id="3553" href="Relation.Binary.Core.html#5472" class="Function">sym</a> <a id="3557" class="Symbol">(</a><a id="3558" href="Algebra.Structures.html#2285" class="Function">idem</a> <a id="3563" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3511" class="Bound">a</a><a id="3564" class="Symbol">))</a> <a id="3567" href="Relation.Binary.Core.html#5446" class="Function">refl</a> <a id="3572" href="Relation.Binary.PreorderReasoning.html#1294" class="Function Operator">⟩</a>
    <a id="3578" class="Symbol">(</a><a id="3579" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3511" class="Bound">a</a> <a id="3581" href="Algebra.html#2825" class="Field Operator">∙</a> <a id="3583" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3511" class="Bound">a</a><a id="3584" class="Symbol">)</a> <a id="3586" href="Algebra.html#2825" class="Field Operator">∙</a> <a id="3588" class="Symbol">(</a><a id="3589" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3513" class="Bound">b</a> <a id="3591" href="Algebra.html#2825" class="Field Operator">∙</a> <a id="3593" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3515" class="Bound">c</a><a id="3594" class="Symbol">)</a>  <a id="3597" href="Relation.Binary.PreorderReasoning.html#1294" class="Function Operator">≈⟨</a> <a id="3600" href="Algebra.Structures.html#838" class="Function">assoc</a> <a id="3606" class="Symbol">_</a> <a id="3608" class="Symbol">_</a> <a id="3610" class="Symbol">_</a> <a id="3612" href="Relation.Binary.PreorderReasoning.html#1294" class="Function Operator">⟩</a>
    <a id="3618" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3511" class="Bound">a</a> <a id="3620" href="Algebra.html#2825" class="Field Operator">∙</a> <a id="3622" class="Symbol">(</a><a id="3623" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3511" class="Bound">a</a> <a id="3625" href="Algebra.html#2825" class="Field Operator">∙</a> <a id="3627" class="Symbol">(</a><a id="3628" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3513" class="Bound">b</a> <a id="3630" href="Algebra.html#2825" class="Field Operator">∙</a> <a id="3632" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3515" class="Bound">c</a><a id="3633" class="Symbol">))</a>  <a id="3637" href="Relation.Binary.PreorderReasoning.html#1294" class="Function Operator">≈⟨</a> <a id="3640" href="Algebra.Structures.html#872" class="Function">∙-cong</a> <a id="3647" href="Relation.Binary.Core.html#5446" class="Function">refl</a> <a id="3652" class="Symbol">(</a><a id="3653" href="Relation.Binary.Core.html#5472" class="Function">sym</a> <a id="3657" class="Symbol">(</a><a id="3658" href="Algebra.Structures.html#838" class="Function">assoc</a> <a id="3664" class="Symbol">_</a> <a id="3666" class="Symbol">_</a> <a id="3668" class="Symbol">_))</a> <a id="3672" href="Relation.Binary.PreorderReasoning.html#1294" class="Function Operator">⟩</a>
    <a id="3678" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3511" class="Bound">a</a> <a id="3680" href="Algebra.html#2825" class="Field Operator">∙</a> <a id="3682" class="Symbol">((</a><a id="3684" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3511" class="Bound">a</a> <a id="3686" href="Algebra.html#2825" class="Field Operator">∙</a> <a id="3688" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3513" class="Bound">b</a><a id="3689" class="Symbol">)</a> <a id="3691" href="Algebra.html#2825" class="Field Operator">∙</a> <a id="3693" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3515" class="Bound">c</a><a id="3694" class="Symbol">)</a>  <a id="3697" href="Relation.Binary.PreorderReasoning.html#1294" class="Function Operator">≈⟨</a> <a id="3700" href="Algebra.Structures.html#872" class="Function">∙-cong</a> <a id="3707" href="Relation.Binary.Core.html#5446" class="Function">refl</a> <a id="3712" class="Symbol">(</a><a id="3713" href="Algebra.Structures.html#872" class="Function">∙-cong</a> <a id="3720" class="Symbol">(</a><a id="3721" href="Algebra.Structures.html#1768" class="Function">comm</a> <a id="3726" class="Symbol">_</a> <a id="3728" class="Symbol">_)</a> <a id="3731" href="Relation.Binary.Core.html#5446" class="Function">refl</a><a id="3735" class="Symbol">)</a> <a id="3737" href="Relation.Binary.PreorderReasoning.html#1294" class="Function Operator">⟩</a>
    <a id="3743" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3511" class="Bound">a</a> <a id="3745" href="Algebra.html#2825" class="Field Operator">∙</a> <a id="3747" class="Symbol">((</a><a id="3749" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3513" class="Bound">b</a> <a id="3751" href="Algebra.html#2825" class="Field Operator">∙</a> <a id="3753" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3511" class="Bound">a</a><a id="3754" class="Symbol">)</a> <a id="3756" href="Algebra.html#2825" class="Field Operator">∙</a> <a id="3758" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3515" class="Bound">c</a><a id="3759" class="Symbol">)</a>  <a id="3762" href="Relation.Binary.PreorderReasoning.html#1294" class="Function Operator">≈⟨</a> <a id="3765" href="Algebra.Structures.html#872" class="Function">∙-cong</a> <a id="3772" href="Relation.Binary.Core.html#5446" class="Function">refl</a> <a id="3777" class="Symbol">(</a><a id="3778" href="Algebra.Structures.html#838" class="Function">assoc</a> <a id="3784" class="Symbol">_</a> <a id="3786" class="Symbol">_</a> <a id="3788" class="Symbol">_)</a> <a id="3791" href="Relation.Binary.PreorderReasoning.html#1294" class="Function Operator">⟩</a>
    <a id="3797" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3511" class="Bound">a</a> <a id="3799" href="Algebra.html#2825" class="Field Operator">∙</a> <a id="3801" class="Symbol">(</a><a id="3802" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3513" class="Bound">b</a> <a id="3804" href="Algebra.html#2825" class="Field Operator">∙</a> <a id="3806" class="Symbol">(</a><a id="3807" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3511" class="Bound">a</a> <a id="3809" href="Algebra.html#2825" class="Field Operator">∙</a> <a id="3811" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3515" class="Bound">c</a><a id="3812" class="Symbol">))</a>  <a id="3816" href="Relation.Binary.PreorderReasoning.html#1294" class="Function Operator">≈⟨</a> <a id="3819" href="Relation.Binary.Core.html#5472" class="Function">sym</a> <a id="3823" class="Symbol">(</a><a id="3824" href="Algebra.Structures.html#838" class="Function">assoc</a> <a id="3830" class="Symbol">_</a> <a id="3832" class="Symbol">_</a> <a id="3834" class="Symbol">_)</a> <a id="3837" href="Relation.Binary.PreorderReasoning.html#1294" class="Function Operator">⟩</a>
    <a id="3843" class="Symbol">(</a><a id="3844" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3511" class="Bound">a</a> <a id="3846" href="Algebra.html#2825" class="Field Operator">∙</a> <a id="3848" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3513" class="Bound">b</a><a id="3849" class="Symbol">)</a> <a id="3851" href="Algebra.html#2825" class="Field Operator">∙</a> <a id="3853" class="Symbol">(</a><a id="3854" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3511" class="Bound">a</a> <a id="3856" href="Algebra.html#2825" class="Field Operator">∙</a> <a id="3858" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3515" class="Bound">c</a><a id="3859" class="Symbol">)</a>  <a id="3862" href="Relation.Binary.PreorderReasoning.html#1681" class="Function Operator">∎</a>

<a id="comp-correct"></a><a id="3865" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3865" class="Function">comp-correct</a> <a id="3878" class="Symbol">:</a> <a id="3880" class="Symbol">∀</a> <a id="3882" class="Symbol">{</a><a id="3883" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3883" class="Bound">n</a><a id="3884" class="Symbol">}</a> <a id="3886" class="Symbol">(</a><a id="3887" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3887" class="Bound">v</a> <a id="3889" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3889" class="Bound">w</a> <a id="3891" class="Symbol">:</a> <a id="3893" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1953" class="Function">Normal</a> <a id="3900" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3883" class="Bound">n</a><a id="3901" class="Symbol">)</a> <a id="3903" class="Symbol">(</a><a id="3904" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3904" class="Bound">ρ</a> <a id="3906" class="Symbol">:</a> <a id="3908" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1572" class="Function">Env</a> <a id="3912" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3883" class="Bound">n</a><a id="3913" class="Symbol">)</a> <a id="3915" class="Symbol">→</a>
              <a id="3931" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2029" class="Function Operator">⟦</a> <a id="3933" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3887" class="Bound">v</a> <a id="3935" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2470" class="Function Operator">•</a> <a id="3937" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3889" class="Bound">w</a> <a id="3939" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2029" class="Function Operator">⟧⇓</a> <a id="3942" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3904" class="Bound">ρ</a> <a id="3944" href="Algebra.html#2775" class="Field Operator">≈</a> <a id="3946" class="Symbol">(</a><a id="3947" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2029" class="Function Operator">⟦</a> <a id="3949" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3887" class="Bound">v</a> <a id="3951" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2029" class="Function Operator">⟧⇓</a> <a id="3954" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3904" class="Bound">ρ</a> <a id="3956" href="Algebra.html#2825" class="Field Operator">∙</a> <a id="3958" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2029" class="Function Operator">⟦</a> <a id="3960" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3889" class="Bound">w</a> <a id="3962" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2029" class="Function Operator">⟧⇓</a> <a id="3965" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3904" class="Bound">ρ</a><a id="3966" class="Symbol">)</a>
<a id="3968" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3865" class="Function">comp-correct</a> <a id="3981" href="Data.Vec.html#777" class="InductiveConstructor">[]</a> <a id="3984" href="Data.Vec.html#777" class="InductiveConstructor">[]</a> <a id="3987" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3987" class="Bound">ρ</a> <a id="3989" class="Symbol">=</a> <a id="3991" href="Relation.Binary.Core.html#5472" class="Function">sym</a> <a id="3995" class="Symbol">(</a><a id="3996" href="Algebra.Structures.html#1733" class="Function">identityˡ</a> <a id="4006" class="Symbol">_)</a>
<a id="4009" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3865" class="Function">comp-correct</a> <a id="4022" class="Symbol">(</a><a id="4023" href="Agda.Builtin.Bool.html#92" class="InductiveConstructor">true</a> <a id="4028" href="Data.Vec.html#796" class="InductiveConstructor Operator">∷</a> <a id="4030" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4030" class="Bound">v</a><a id="4031" class="Symbol">)</a> <a id="4033" class="Symbol">(</a><a id="4034" href="Agda.Builtin.Bool.html#92" class="InductiveConstructor">true</a> <a id="4039" href="Data.Vec.html#796" class="InductiveConstructor Operator">∷</a> <a id="4041" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4041" class="Bound">w</a><a id="4042" class="Symbol">)</a> <a id="4044" class="Symbol">(</a><a id="4045" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4045" class="Bound">a</a> <a id="4047" href="Data.Vec.html#796" class="InductiveConstructor Operator">∷</a> <a id="4049" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4049" class="Bound">ρ</a><a id="4050" class="Symbol">)</a> <a id="4052" class="Symbol">=</a>
  <a id="4056" href="Relation.Binary.Core.html#5498" class="Function">trans</a> <a id="4062" class="Symbol">(</a><a id="4063" href="Algebra.Structures.html#872" class="Function">∙-cong</a> <a id="4070" href="Relation.Binary.Core.html#5446" class="Function">refl</a> <a id="4075" class="Symbol">(</a><a id="4076" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3865" class="Function">comp-correct</a> <a id="4089" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4030" class="Bound">v</a> <a id="4091" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4041" class="Bound">w</a> <a id="4093" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4049" class="Bound">ρ</a><a id="4094" class="Symbol">))</a> <a id="4097" class="Symbol">(</a><a id="4098" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3455" class="Function">distr</a> <a id="4104" class="Symbol">_</a> <a id="4106" class="Symbol">_</a> <a id="4108" class="Symbol">_)</a>
<a id="4111" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3865" class="Function">comp-correct</a> <a id="4124" class="Symbol">(</a><a id="4125" href="Agda.Builtin.Bool.html#92" class="InductiveConstructor">true</a> <a id="4130" href="Data.Vec.html#796" class="InductiveConstructor Operator">∷</a> <a id="4132" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4132" class="Bound">v</a><a id="4133" class="Symbol">)</a> <a id="4135" class="Symbol">(</a><a id="4136" href="Agda.Builtin.Bool.html#86" class="InductiveConstructor">false</a> <a id="4142" href="Data.Vec.html#796" class="InductiveConstructor Operator">∷</a> <a id="4144" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4144" class="Bound">w</a><a id="4145" class="Symbol">)</a> <a id="4147" class="Symbol">(</a><a id="4148" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4148" class="Bound">a</a> <a id="4150" href="Data.Vec.html#796" class="InductiveConstructor Operator">∷</a> <a id="4152" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4152" class="Bound">ρ</a><a id="4153" class="Symbol">)</a> <a id="4155" class="Symbol">=</a>
  <a id="4159" href="Relation.Binary.Core.html#5498" class="Function">trans</a> <a id="4165" class="Symbol">(</a><a id="4166" href="Algebra.Structures.html#872" class="Function">∙-cong</a> <a id="4173" href="Relation.Binary.Core.html#5446" class="Function">refl</a> <a id="4178" class="Symbol">(</a><a id="4179" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3865" class="Function">comp-correct</a> <a id="4192" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4132" class="Bound">v</a> <a id="4194" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4144" class="Bound">w</a> <a id="4196" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4152" class="Bound">ρ</a><a id="4197" class="Symbol">))</a> <a id="4200" class="Symbol">(</a><a id="4201" href="Relation.Binary.Core.html#5472" class="Function">sym</a> <a id="4205" class="Symbol">(</a><a id="4206" href="Algebra.Structures.html#838" class="Function">assoc</a> <a id="4212" class="Symbol">_</a> <a id="4214" class="Symbol">_</a> <a id="4216" class="Symbol">_))</a>
<a id="4220" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3865" class="Function">comp-correct</a> <a id="4233" class="Symbol">(</a><a id="4234" href="Agda.Builtin.Bool.html#86" class="InductiveConstructor">false</a> <a id="4240" href="Data.Vec.html#796" class="InductiveConstructor Operator">∷</a> <a id="4242" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4242" class="Bound">v</a><a id="4243" class="Symbol">)</a> <a id="4245" class="Symbol">(</a><a id="4246" href="Agda.Builtin.Bool.html#92" class="InductiveConstructor">true</a> <a id="4251" href="Data.Vec.html#796" class="InductiveConstructor Operator">∷</a> <a id="4253" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4253" class="Bound">w</a><a id="4254" class="Symbol">)</a> <a id="4256" class="Symbol">(</a><a id="4257" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4257" class="Bound">a</a> <a id="4259" href="Data.Vec.html#796" class="InductiveConstructor Operator">∷</a> <a id="4261" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4261" class="Bound">ρ</a><a id="4262" class="Symbol">)</a> <a id="4264" class="Symbol">=</a>
  <a id="4268" href="Relation.Binary.Core.html#5498" class="Function">trans</a> <a id="4274" class="Symbol">(</a><a id="4275" href="Algebra.Structures.html#872" class="Function">∙-cong</a> <a id="4282" href="Relation.Binary.Core.html#5446" class="Function">refl</a> <a id="4287" class="Symbol">(</a><a id="4288" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3865" class="Function">comp-correct</a> <a id="4301" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4242" class="Bound">v</a> <a id="4303" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4253" class="Bound">w</a> <a id="4305" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4261" class="Bound">ρ</a><a id="4306" class="Symbol">))</a> <a id="4309" class="Symbol">(</a><a id="4310" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3250" class="Function">flip12</a> <a id="4317" class="Symbol">_</a> <a id="4319" class="Symbol">_</a> <a id="4321" class="Symbol">_)</a>
<a id="4324" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3865" class="Function">comp-correct</a> <a id="4337" class="Symbol">(</a><a id="4338" href="Agda.Builtin.Bool.html#86" class="InductiveConstructor">false</a> <a id="4344" href="Data.Vec.html#796" class="InductiveConstructor Operator">∷</a> <a id="4346" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4346" class="Bound">v</a><a id="4347" class="Symbol">)</a> <a id="4349" class="Symbol">(</a><a id="4350" href="Agda.Builtin.Bool.html#86" class="InductiveConstructor">false</a> <a id="4356" href="Data.Vec.html#796" class="InductiveConstructor Operator">∷</a> <a id="4358" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4358" class="Bound">w</a><a id="4359" class="Symbol">)</a> <a id="4361" class="Symbol">(</a><a id="4362" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4362" class="Bound">a</a> <a id="4364" href="Data.Vec.html#796" class="InductiveConstructor Operator">∷</a> <a id="4366" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4366" class="Bound">ρ</a><a id="4367" class="Symbol">)</a> <a id="4369" class="Symbol">=</a>
  <a id="4373" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3865" class="Function">comp-correct</a> <a id="4386" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4346" class="Bound">v</a> <a id="4388" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4358" class="Bound">w</a> <a id="4390" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4366" class="Bound">ρ</a>

<a id="4393" class="Comment">------------------------------------------------------------------------</a>
<a id="4466" class="Comment">-- Normalization</a>

<a id="4484" class="Comment">-- A normaliser.</a>

<a id="normalise"></a><a id="4502" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4502" class="Function">normalise</a> <a id="4512" class="Symbol">:</a> <a id="4514" class="Symbol">∀</a> <a id="4516" class="Symbol">{</a><a id="4517" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4517" class="Bound">n</a><a id="4518" class="Symbol">}</a> <a id="4520" class="Symbol">→</a> <a id="4522" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1417" class="Datatype">Expr</a> <a id="4527" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4517" class="Bound">n</a> <a id="4529" class="Symbol">→</a> <a id="4531" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1953" class="Function">Normal</a> <a id="4538" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4517" class="Bound">n</a>
<a id="4540" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4502" class="Function">normalise</a> <a id="4550" class="Symbol">(</a><a id="4551" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1444" class="InductiveConstructor">var</a> <a id="4555" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4555" class="Bound">x</a><a id="4556" class="Symbol">)</a>   <a id="4560" class="Symbol">=</a> <a id="4562" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2347" class="Function">sg</a> <a id="4565" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4555" class="Bound">x</a>
<a id="4567" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4502" class="Function">normalise</a> <a id="4577" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1467" class="InductiveConstructor">id</a>        <a id="4587" class="Symbol">=</a> <a id="4589" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2277" class="Function">empty</a>
<a id="4595" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4502" class="Function">normalise</a> <a id="4605" class="Symbol">(</a><a id="4606" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4606" class="Bound">e₁</a> <a id="4609" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1482" class="InductiveConstructor Operator">⊕</a> <a id="4611" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4611" class="Bound">e₂</a><a id="4613" class="Symbol">)</a> <a id="4615" class="Symbol">=</a> <a id="4617" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4502" class="Function">normalise</a> <a id="4627" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4606" class="Bound">e₁</a> <a id="4630" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2470" class="Function Operator">•</a> <a id="4632" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4502" class="Function">normalise</a> <a id="4642" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4611" class="Bound">e₂</a>

<a id="4646" class="Comment">-- The normaliser preserves the semantics of the expression.</a>

<a id="normalise-correct"></a><a id="4708" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4708" class="Function">normalise-correct</a> <a id="4726" class="Symbol">:</a> <a id="4728" class="Symbol">∀</a> <a id="4730" class="Symbol">{</a><a id="4731" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4731" class="Bound">n</a><a id="4732" class="Symbol">}</a> <a id="4734" class="Symbol">(</a><a id="4735" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4735" class="Bound">e</a> <a id="4737" class="Symbol">:</a> <a id="4739" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1417" class="Datatype">Expr</a> <a id="4744" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4731" class="Bound">n</a><a id="4745" class="Symbol">)</a> <a id="4747" class="Symbol">(</a><a id="4748" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4748" class="Bound">ρ</a> <a id="4750" class="Symbol">:</a> <a id="4752" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1572" class="Function">Env</a> <a id="4756" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4731" class="Bound">n</a><a id="4757" class="Symbol">)</a> <a id="4759" class="Symbol">→</a>
    <a id="4765" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2029" class="Function Operator">⟦</a> <a id="4767" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4502" class="Function">normalise</a> <a id="4777" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4735" class="Bound">e</a> <a id="4779" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2029" class="Function Operator">⟧⇓</a> <a id="4782" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4748" class="Bound">ρ</a> <a id="4784" href="Algebra.html#2775" class="Field Operator">≈</a> <a id="4786" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1695" class="Function Operator">⟦</a> <a id="4788" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4735" class="Bound">e</a> <a id="4790" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1695" class="Function Operator">⟧</a> <a id="4792" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4748" class="Bound">ρ</a>
<a id="4794" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4708" class="Function">normalise-correct</a> <a id="4812" class="Symbol">(</a><a id="4813" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1444" class="InductiveConstructor">var</a> <a id="4817" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4817" class="Bound">x</a><a id="4818" class="Symbol">)</a>   <a id="4822" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4822" class="Bound">ρ</a> <a id="4824" class="Symbol">=</a> <a id="4826" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2906" class="Function">sg-correct</a> <a id="4837" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4817" class="Bound">x</a> <a id="4839" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4822" class="Bound">ρ</a>
<a id="4841" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4708" class="Function">normalise-correct</a> <a id="4859" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1467" class="InductiveConstructor">id</a>        <a id="4869" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4869" class="Bound">ρ</a> <a id="4871" class="Symbol">=</a> <a id="4873" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2737" class="Function">empty-correct</a> <a id="4887" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4869" class="Bound">ρ</a>
<a id="4889" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4708" class="Function">normalise-correct</a> <a id="4907" class="Symbol">(</a><a id="4908" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4908" class="Bound">e₁</a> <a id="4911" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1482" class="InductiveConstructor Operator">⊕</a> <a id="4913" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4913" class="Bound">e₂</a><a id="4915" class="Symbol">)</a> <a id="4917" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4917" class="Bound">ρ</a> <a id="4919" class="Symbol">=</a>  <a id="4922" href="Relation.Binary.PreorderReasoning.html#1228" class="Function Operator">begin</a>

    <a id="4933" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2029" class="Function Operator">⟦</a> <a id="4935" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4502" class="Function">normalise</a> <a id="4945" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4908" class="Bound">e₁</a> <a id="4948" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2470" class="Function Operator">•</a> <a id="4950" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4502" class="Function">normalise</a> <a id="4960" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4913" class="Bound">e₂</a> <a id="4963" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2029" class="Function Operator">⟧⇓</a> <a id="4966" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4917" class="Bound">ρ</a>

  <a id="4971" href="Relation.Binary.PreorderReasoning.html#1294" class="Function Operator">≈⟨</a> <a id="4974" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3865" class="Function">comp-correct</a> <a id="4987" class="Symbol">(</a><a id="4988" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4502" class="Function">normalise</a> <a id="4998" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4908" class="Bound">e₁</a><a id="5000" class="Symbol">)</a> <a id="5002" class="Symbol">(</a><a id="5003" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4502" class="Function">normalise</a> <a id="5013" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4913" class="Bound">e₂</a><a id="5015" class="Symbol">)</a> <a id="5017" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4917" class="Bound">ρ</a> <a id="5019" href="Relation.Binary.PreorderReasoning.html#1294" class="Function Operator">⟩</a>

    <a id="5026" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2029" class="Function Operator">⟦</a> <a id="5028" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4502" class="Function">normalise</a> <a id="5038" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4908" class="Bound">e₁</a> <a id="5041" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2029" class="Function Operator">⟧⇓</a> <a id="5044" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4917" class="Bound">ρ</a> <a id="5046" href="Algebra.html#2825" class="Field Operator">∙</a> <a id="5048" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2029" class="Function Operator">⟦</a> <a id="5050" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4502" class="Function">normalise</a> <a id="5060" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4913" class="Bound">e₂</a> <a id="5063" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2029" class="Function Operator">⟧⇓</a> <a id="5066" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4917" class="Bound">ρ</a>

  <a id="5071" href="Relation.Binary.PreorderReasoning.html#1294" class="Function Operator">≈⟨</a> <a id="5074" href="Algebra.Structures.html#872" class="Function">∙-cong</a> <a id="5081" class="Symbol">(</a><a id="5082" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4708" class="Function">normalise-correct</a> <a id="5100" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4908" class="Bound">e₁</a> <a id="5103" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4917" class="Bound">ρ</a><a id="5104" class="Symbol">)</a> <a id="5106" class="Symbol">(</a><a id="5107" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4708" class="Function">normalise-correct</a> <a id="5125" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4913" class="Bound">e₂</a> <a id="5128" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4917" class="Bound">ρ</a><a id="5129" class="Symbol">)</a> <a id="5131" href="Relation.Binary.PreorderReasoning.html#1294" class="Function Operator">⟩</a>

    <a id="5138" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1695" class="Function Operator">⟦</a> <a id="5140" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4908" class="Bound">e₁</a> <a id="5143" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1695" class="Function Operator">⟧</a> <a id="5145" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4917" class="Bound">ρ</a> <a id="5147" href="Algebra.html#2825" class="Field Operator">∙</a> <a id="5149" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1695" class="Function Operator">⟦</a> <a id="5151" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4913" class="Bound">e₂</a> <a id="5154" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1695" class="Function Operator">⟧</a> <a id="5156" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4917" class="Bound">ρ</a>
  <a id="5160" href="Relation.Binary.PreorderReasoning.html#1681" class="Function Operator">∎</a>

<a id="5163" class="Comment">------------------------------------------------------------------------</a>
<a id="5236" class="Comment">-- &quot;Tactics&quot;</a>

<a id="5250" class="Keyword">open</a> <a id="5255" class="Keyword">module</a> <a id="R"></a><a id="5262" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5262" class="Module">R</a> <a id="5264" class="Symbol">=</a> <a id="5266" href="Relation.Binary.Reflection.html" class="Module">Reflection</a>
                  <a id="5295" href="Algebra.Structures.html#904" class="Function">setoid</a> <a id="5302" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1444" class="InductiveConstructor">var</a> <a id="5306" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1695" class="Function Operator">⟦_⟧</a> <a id="5310" class="Symbol">(</a><a id="5311" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2029" class="Function Operator">⟦_⟧⇓</a> <a id="5316" href="Function.html#769" class="Function Operator">∘</a> <a id="5318" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4502" class="Function">normalise</a><a id="5327" class="Symbol">)</a> <a id="5329" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4708" class="Function">normalise-correct</a>
  <a id="5349" class="Keyword">public</a> <a id="5356" class="Keyword">using</a> <a id="5362" class="Symbol">(</a><a id="5363" href="Relation.Binary.Reflection.html#2382" class="Function">solve</a><a id="5368" class="Symbol">;</a> <a id="5370" href="Relation.Binary.Reflection.html#3491" class="Function Operator">_⊜_</a><a id="5373" class="Symbol">)</a>

<a id="5376" class="Comment">-- We can decide if two normal forms are /syntactically/ equal.</a>

<a id="5441" class="Keyword">infix</a> <a id="5447" class="Number">5</a> <a id="5449" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5454" class="Function Operator">_≟_</a>

<a id="_≟_"></a><a id="5454" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5454" class="Function Operator">_≟_</a> <a id="5458" class="Symbol">:</a> <a id="5460" class="Symbol">∀</a> <a id="5462" class="Symbol">{</a><a id="5463" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5463" class="Bound">n</a><a id="5464" class="Symbol">}</a> <a id="5466" class="Symbol">(</a><a id="5467" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5467" class="Bound">nf₁</a> <a id="5471" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5471" class="Bound">nf₂</a> <a id="5475" class="Symbol">:</a> <a id="5477" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1953" class="Function">Normal</a> <a id="5484" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5463" class="Bound">n</a><a id="5485" class="Symbol">)</a> <a id="5487" class="Symbol">→</a> <a id="5489" href="Relation.Nullary.html#534" class="Datatype">Dec</a> <a id="5493" class="Symbol">(</a><a id="5494" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5467" class="Bound">nf₁</a> <a id="5498" href="Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="5500" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5471" class="Bound">nf₂</a><a id="5503" class="Symbol">)</a>
<a id="5505" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5505" class="Bound">nf₁</a> <a id="5509" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5454" class="Function Operator">≟</a> <a id="5511" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5511" class="Bound">nf₂</a> <a id="5515" class="Symbol">=</a> <a id="5517" href="Relation.Nullary.Decidable.html#1632" class="Function">Dec.map</a> <a id="5525" href="Data.Vec.Relation.Pointwise.Inductive.html#9072" class="Function">Pointwise-≡↔≡</a> <a id="5539" class="Symbol">(</a><a id="5540" href="Data.Vec.Relation.Pointwise.Inductive.html#3166" class="Function">decidable</a> <a id="5550" href="Data.Bool.Properties.html#948" class="Function Operator">Bool._≟_</a> <a id="5559" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5505" class="Bound">nf₁</a> <a id="5563" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5511" class="Bound">nf₂</a><a id="5566" class="Symbol">)</a>
  <a id="5570" class="Keyword">where</a> <a id="5576" class="Keyword">open</a> <a id="5581" href="Data.Vec.Relation.Pointwise.Inductive.html" class="Module">Pointwise</a>

<a id="5592" class="Comment">-- We can also give a sound, but not necessarily complete, procedure</a>
<a id="5661" class="Comment">-- for determining if two expressions have the same semantics.</a>

<a id="prove′"></a><a id="5725" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5725" class="Function">prove′</a> <a id="5732" class="Symbol">:</a> <a id="5734" class="Symbol">∀</a> <a id="5736" class="Symbol">{</a><a id="5737" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5737" class="Bound">n</a><a id="5738" class="Symbol">}</a> <a id="5740" class="Symbol">(</a><a id="5741" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5741" class="Bound">e₁</a> <a id="5744" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5744" class="Bound">e₂</a> <a id="5747" class="Symbol">:</a> <a id="5749" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1417" class="Datatype">Expr</a> <a id="5754" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5737" class="Bound">n</a><a id="5755" class="Symbol">)</a> <a id="5757" class="Symbol">→</a> <a id="5759" href="Data.Maybe.Base.html#674" class="Datatype">Maybe</a> <a id="5765" class="Symbol">(∀</a> <a id="5768" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5768" class="Bound">ρ</a> <a id="5770" class="Symbol">→</a> <a id="5772" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1695" class="Function Operator">⟦</a> <a id="5774" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5741" class="Bound">e₁</a> <a id="5777" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1695" class="Function Operator">⟧</a> <a id="5779" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5768" class="Bound">ρ</a> <a id="5781" href="Algebra.html#2775" class="Field Operator">≈</a> <a id="5783" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1695" class="Function Operator">⟦</a> <a id="5785" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5744" class="Bound">e₂</a> <a id="5788" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1695" class="Function Operator">⟧</a> <a id="5790" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5768" class="Bound">ρ</a><a id="5791" class="Symbol">)</a>
<a id="5793" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5725" class="Function">prove′</a> <a id="5800" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5800" class="Bound">e₁</a> <a id="5803" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5803" class="Bound">e₂</a> <a id="5806" class="Symbol">=</a>
  <a id="5810" href="Data.Maybe.Base.html#2103" class="Function">Maybe.map</a> <a id="5820" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5879" class="Function">lemma</a> <a id="5826" class="Symbol">(</a><a id="5827" href="Data.Maybe.Base.html#1249" class="Function">decToMaybe</a> <a id="5838" class="Symbol">(</a><a id="5839" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4502" class="Function">normalise</a> <a id="5849" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5800" class="Bound">e₁</a> <a id="5852" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5454" class="Function Operator">≟</a> <a id="5854" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4502" class="Function">normalise</a> <a id="5864" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5803" class="Bound">e₂</a><a id="5866" class="Symbol">))</a>
  <a id="5871" class="Keyword">where</a>
  <a id="5879" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5879" class="Function">lemma</a> <a id="5885" class="Symbol">:</a> <a id="5887" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4502" class="Function">normalise</a> <a id="5897" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5800" class="Bound">e₁</a> <a id="5900" href="Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="5902" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4502" class="Function">normalise</a> <a id="5912" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5803" class="Bound">e₂</a> <a id="5915" class="Symbol">→</a> <a id="5917" class="Symbol">∀</a> <a id="5919" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5919" class="Bound">ρ</a> <a id="5921" class="Symbol">→</a> <a id="5923" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1695" class="Function Operator">⟦</a> <a id="5925" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5800" class="Bound">e₁</a> <a id="5928" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1695" class="Function Operator">⟧</a> <a id="5930" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5919" class="Bound">ρ</a> <a id="5932" href="Algebra.html#2775" class="Field Operator">≈</a> <a id="5934" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1695" class="Function Operator">⟦</a> <a id="5936" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5803" class="Bound">e₂</a> <a id="5939" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1695" class="Function Operator">⟧</a> <a id="5941" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5919" class="Bound">ρ</a>
  <a id="5945" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5879" class="Function">lemma</a> <a id="5951" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5951" class="Bound">eq</a> <a id="5954" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5954" class="Bound">ρ</a> <a id="5956" class="Symbol">=</a>
    <a id="5962" href="Relation.Binary.Reflection.html#1696" class="Function">R.prove</a> <a id="5970" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5954" class="Bound">ρ</a> <a id="5972" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5800" class="Bound">e₁</a> <a id="5975" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5803" class="Bound">e₂</a> <a id="5978" class="Symbol">(</a><a id="5979" href="Relation.Binary.PreorderReasoning.html#1228" class="Function Operator">begin</a>
      <a id="5991" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2029" class="Function Operator">⟦</a> <a id="5993" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4502" class="Function">normalise</a> <a id="6003" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5800" class="Bound">e₁</a> <a id="6006" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2029" class="Function Operator">⟧⇓</a> <a id="6009" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5954" class="Bound">ρ</a>  <a id="6012" href="Relation.Binary.PreorderReasoning.html#1524" class="Function Operator">≡⟨</a> <a id="6015" href="Relation.Binary.PropositionalEquality.html#1170" class="Function">P.cong</a> <a id="6022" class="Symbol">(λ</a> <a id="6025" href="Algebra.Solver.IdempotentCommutativeMonoid.html#6025" class="Bound">e</a> <a id="6027" class="Symbol">→</a> <a id="6029" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2029" class="Function Operator">⟦</a> <a id="6031" href="Algebra.Solver.IdempotentCommutativeMonoid.html#6025" class="Bound">e</a> <a id="6033" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2029" class="Function Operator">⟧⇓</a> <a id="6036" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5954" class="Bound">ρ</a><a id="6037" class="Symbol">)</a> <a id="6039" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5951" class="Bound">eq</a> <a id="6042" href="Relation.Binary.PreorderReasoning.html#1524" class="Function Operator">⟩</a>
      <a id="6050" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2029" class="Function Operator">⟦</a> <a id="6052" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4502" class="Function">normalise</a> <a id="6062" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5803" class="Bound">e₂</a> <a id="6065" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2029" class="Function Operator">⟧⇓</a> <a id="6068" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5954" class="Bound">ρ</a>  <a id="6071" href="Relation.Binary.PreorderReasoning.html#1681" class="Function Operator">∎</a><a id="6072" class="Symbol">)</a>

<a id="6075" class="Comment">-- This procedure can be combined with from-just.</a>

<a id="prove"></a><a id="6126" href="Algebra.Solver.IdempotentCommutativeMonoid.html#6126" class="Function">prove</a> <a id="6132" class="Symbol">:</a> <a id="6134" class="Symbol">∀</a> <a id="6136" href="Algebra.Solver.IdempotentCommutativeMonoid.html#6136" class="Bound">n</a> <a id="6138" class="Symbol">(</a><a id="6139" href="Algebra.Solver.IdempotentCommutativeMonoid.html#6139" class="Bound">e₁</a> <a id="6142" href="Algebra.Solver.IdempotentCommutativeMonoid.html#6142" class="Bound">e₂</a> <a id="6145" class="Symbol">:</a> <a id="6147" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1417" class="Datatype">Expr</a> <a id="6152" href="Algebra.Solver.IdempotentCommutativeMonoid.html#6136" class="Bound">n</a><a id="6153" class="Symbol">)</a> <a id="6155" class="Symbol">→</a> <a id="6157" href="Data.Maybe.Base.html#1900" class="Function">From-just</a> <a id="6167" class="Symbol">(</a><a id="6168" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5725" class="Function">prove′</a> <a id="6175" href="Algebra.Solver.IdempotentCommutativeMonoid.html#6139" class="Bound">e₁</a> <a id="6178" href="Algebra.Solver.IdempotentCommutativeMonoid.html#6142" class="Bound">e₂</a><a id="6180" class="Symbol">)</a>
<a id="6182" href="Algebra.Solver.IdempotentCommutativeMonoid.html#6126" class="Function">prove</a> <a id="6188" class="Symbol">_</a> <a id="6190" href="Algebra.Solver.IdempotentCommutativeMonoid.html#6190" class="Bound">e₁</a> <a id="6193" href="Algebra.Solver.IdempotentCommutativeMonoid.html#6193" class="Bound">e₂</a> <a id="6196" class="Symbol">=</a> <a id="6198" href="Data.Maybe.Base.html#1988" class="Function">from-just</a> <a id="6208" class="Symbol">(</a><a id="6209" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5725" class="Function">prove′</a> <a id="6216" href="Algebra.Solver.IdempotentCommutativeMonoid.html#6190" class="Bound">e₁</a> <a id="6219" href="Algebra.Solver.IdempotentCommutativeMonoid.html#6193" class="Bound">e₂</a><a id="6221" class="Symbol">)</a>

<a id="6224" class="Comment">-- prove : ∀ n (es : Expr n × Expr n) →</a>
<a id="6264" class="Comment">--         From-just (uncurry prove′ es)</a>
<a id="6305" class="Comment">-- prove _ = from-just ∘ uncurry prove′</a>

<a id="6346" class="Comment">-- -}</a>
</pre></body></html>