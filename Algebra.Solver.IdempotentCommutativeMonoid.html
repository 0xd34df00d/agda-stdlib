<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Algebra.Solver.IdempotentCommutativeMonoid</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Solver for equations in commutative monoids</a>
<a id="153" class="Comment">--</a>
<a id="156" class="Comment">-- Adapted from Algebra.Monoid-solver</a>
<a id="194" class="Comment">------------------------------------------------------------------------</a>

<a id="268" class="Symbol">{-#</a> <a id="272" class="Keyword">OPTIONS</a> <a id="280" class="Option">--without-K</a> <a id="292" class="Option">--safe</a> <a id="299" class="Symbol">#-}</a>

<a id="304" class="Keyword">open</a> <a id="309" class="Keyword">import</a> <a id="316" href="Algebra.html" class="Module">Algebra</a>

<a id="325" class="Keyword">open</a> <a id="330" class="Keyword">import</a> <a id="337" href="Data.Bool.html" class="Module">Data.Bool</a> <a id="347" class="Symbol">as</a> <a id="350" class="Module">Bool</a> <a id="355" class="Keyword">using</a> <a id="361" class="Symbol">(</a><a id="362" href="Agda.Builtin.Bool.html#67" class="Datatype">Bool</a><a id="366" class="Symbol">;</a> <a id="368" href="Agda.Builtin.Bool.html#92" class="InductiveConstructor">true</a><a id="372" class="Symbol">;</a> <a id="374" href="Agda.Builtin.Bool.html#86" class="InductiveConstructor">false</a><a id="379" class="Symbol">;</a> <a id="381" href="Data.Bool.Base.html#835" class="Function Operator">if_then_else_</a><a id="394" class="Symbol">;</a> <a id="396" href="Data.Bool.Base.html#1001" class="Function Operator">_∨_</a><a id="399" class="Symbol">)</a>
<a id="401" class="Keyword">open</a> <a id="406" class="Keyword">import</a> <a id="413" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="422" class="Keyword">using</a> <a id="428" class="Symbol">(</a><a id="429" href="Data.Fin.Base.html#951" class="Datatype">Fin</a><a id="432" class="Symbol">;</a> <a id="434" href="Data.Fin.Base.html#973" class="InductiveConstructor">zero</a><a id="438" class="Symbol">;</a> <a id="440" href="Data.Fin.Base.html#1004" class="InductiveConstructor">suc</a><a id="443" class="Symbol">)</a>
<a id="445" class="Keyword">open</a> <a id="450" class="Keyword">import</a> <a id="457" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="468" class="Symbol">as</a> <a id="471" class="Module">Maybe</a>
  <a id="479" class="Keyword">using</a> <a id="485" class="Symbol">(</a><a id="486" href="Data.Maybe.Base.html#710" class="Datatype">Maybe</a><a id="491" class="Symbol">;</a> <a id="493" href="Data.Maybe.Base.html#1285" class="Function">decToMaybe</a><a id="503" class="Symbol">;</a> <a id="505" href="Data.Maybe.Base.html#1936" class="Function">From-just</a><a id="514" class="Symbol">;</a> <a id="516" href="Data.Maybe.Base.html#2024" class="Function">from-just</a><a id="525" class="Symbol">)</a>
<a id="527" class="Keyword">open</a> <a id="532" class="Keyword">import</a> <a id="539" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="553" class="Symbol">as</a> <a id="556" class="Module">ℕ</a> <a id="558" class="Keyword">using</a> <a id="564" class="Symbol">(</a><a id="565" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="566" class="Symbol">;</a> <a id="568" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a><a id="572" class="Symbol">;</a> <a id="574" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a><a id="577" class="Symbol">;</a> <a id="579" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">_+_</a><a id="582" class="Symbol">)</a>
<a id="584" class="Keyword">open</a> <a id="589" class="Keyword">import</a> <a id="596" href="Data.Product.html" class="Module">Data.Product</a> <a id="609" class="Keyword">using</a> <a id="615" class="Symbol">(</a><a id="616" href="Data.Product.html#1389" class="Function Operator">_×_</a><a id="619" class="Symbol">;</a> <a id="621" href="Data.Product.html#3500" class="Function">uncurry</a><a id="628" class="Symbol">)</a>
<a id="630" class="Keyword">open</a> <a id="635" class="Keyword">import</a> <a id="642" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="651" class="Keyword">using</a> <a id="657" class="Symbol">(</a><a id="658" href="Data.Vec.html#773" class="Datatype">Vec</a><a id="661" class="Symbol">;</a> <a id="663" href="Data.Vec.html#813" class="InductiveConstructor">[]</a><a id="665" class="Symbol">;</a> <a id="667" href="Data.Vec.html#832" class="InductiveConstructor Operator">_∷_</a><a id="670" class="Symbol">;</a> <a id="672" href="Data.Vec.html#1379" class="Function">lookup</a><a id="678" class="Symbol">;</a> <a id="680" href="Data.Vec.html#5840" class="Function">replicate</a><a id="689" class="Symbol">)</a>

<a id="692" class="Keyword">open</a> <a id="697" class="Keyword">import</a> <a id="704" href="Function.html" class="Module">Function</a> <a id="713" class="Keyword">using</a> <a id="719" class="Symbol">(</a><a id="720" href="Function.html#805" class="Function Operator">_∘_</a><a id="723" class="Symbol">)</a>

<a id="726" class="Keyword">import</a> <a id="733" href="Relation.Binary.Reasoning.Setoid.html" class="Module">Relation.Binary.Reasoning.Setoid</a>  <a id="767" class="Symbol">as</a> <a id="770" class="Module">EqReasoning</a>
<a id="782" class="Keyword">import</a> <a id="789" href="Relation.Binary.Reflection.html" class="Module">Relation.Binary.Reflection</a>            <a id="827" class="Symbol">as</a> <a id="830" class="Module">Reflection</a>
<a id="841" class="Keyword">import</a> <a id="848" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a>            <a id="886" class="Symbol">as</a> <a id="889" class="Module">Dec</a>
<a id="893" class="Keyword">import</a> <a id="900" href="Data.Vec.Relation.Pointwise.Inductive.html" class="Module">Data.Vec.Relation.Pointwise.Inductive</a> <a id="938" class="Symbol">as</a> <a id="941" class="Module">Pointwise</a>

<a id="952" class="Keyword">open</a> <a id="957" class="Keyword">import</a> <a id="964" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="1002" class="Symbol">as</a> <a id="1005" class="Module">P</a> <a id="1007" class="Keyword">using</a> <a id="1013" class="Symbol">(</a><a id="1014" href="Agda.Builtin.Equality.html#83" class="Datatype Operator">_≡_</a><a id="1017" class="Symbol">;</a> <a id="1019" href="Relation.Binary.PropositionalEquality.html#1657" class="Function">decSetoid</a><a id="1028" class="Symbol">)</a>
<a id="1030" class="Keyword">open</a> <a id="1035" class="Keyword">import</a> <a id="1042" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="1059" class="Keyword">using</a> <a id="1065" class="Symbol">(</a><a id="1066" href="Relation.Nullary.html#570" class="Datatype">Dec</a><a id="1069" class="Symbol">)</a>

<a id="1072" class="Keyword">module</a> <a id="1079" href="Algebra.Solver.IdempotentCommutativeMonoid.html" class="Module">Algebra.Solver.IdempotentCommutativeMonoid</a>
  <a id="1124" class="Symbol">{</a><a id="1125" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1125" class="Bound">m₁</a> <a id="1128" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1128" class="Bound">m₂</a><a id="1130" class="Symbol">}</a> <a id="1132" class="Symbol">(</a><a id="1133" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1133" class="Bound">M</a> <a id="1135" class="Symbol">:</a> <a id="1137" href="Algebra.html#3483" class="Record">IdempotentCommutativeMonoid</a> <a id="1165" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1125" class="Bound">m₁</a> <a id="1168" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1128" class="Bound">m₂</a><a id="1170" class="Symbol">)</a> <a id="1172" class="Keyword">where</a>

<a id="1179" class="Keyword">open</a> <a id="1184" href="Algebra.html#3483" class="Module">IdempotentCommutativeMonoid</a> <a id="1212" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1133" class="Bound">M</a>
<a id="1214" class="Keyword">open</a> <a id="1219" href="Relation.Binary.Reasoning.Setoid.html" class="Module">EqReasoning</a> <a id="1231" href="Algebra.Structures.html#935" class="Function">setoid</a>

<a id="1239" class="Comment">------------------------------------------------------------------------</a>
<a id="1312" class="Comment">-- Monoid expressions</a>

<a id="1335" class="Comment">-- There is one constructor for every operation, plus one for</a>
<a id="1397" class="Comment">-- variables; there may be at most n variables.</a>

<a id="1446" class="Keyword">infixr</a> <a id="1453" class="Number">5</a> <a id="1455" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1544" class="InductiveConstructor Operator">_⊕_</a>
<a id="1459" class="Keyword">infixr</a> <a id="1466" class="Number">10</a> <a id="1469" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2532" class="Function Operator">_•_</a>

<a id="1474" class="Keyword">data</a> <a id="Expr"></a><a id="1479" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1479" class="Datatype">Expr</a> <a id="1484" class="Symbol">(</a><a id="1485" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1485" class="Bound">n</a> <a id="1487" class="Symbol">:</a> <a id="1489" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="1490" class="Symbol">)</a> <a id="1492" class="Symbol">:</a> <a id="1494" class="PrimitiveType">Set</a> <a id="1498" class="Keyword">where</a>
  <a id="Expr.var"></a><a id="1506" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1506" class="InductiveConstructor">var</a> <a id="1510" class="Symbol">:</a> <a id="1512" href="Data.Fin.Base.html#951" class="Datatype">Fin</a> <a id="1516" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1485" class="Bound">n</a> <a id="1518" class="Symbol">→</a> <a id="1520" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1479" class="Datatype">Expr</a> <a id="1525" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1485" class="Bound">n</a>
  <a id="Expr.id"></a><a id="1529" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1529" class="InductiveConstructor">id</a>  <a id="1533" class="Symbol">:</a> <a id="1535" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1479" class="Datatype">Expr</a> <a id="1540" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1485" class="Bound">n</a>
  <a id="Expr._⊕_"></a><a id="1544" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1544" class="InductiveConstructor Operator">_⊕_</a> <a id="1548" class="Symbol">:</a> <a id="1550" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1479" class="Datatype">Expr</a> <a id="1555" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1485" class="Bound">n</a> <a id="1557" class="Symbol">→</a> <a id="1559" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1479" class="Datatype">Expr</a> <a id="1564" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1485" class="Bound">n</a> <a id="1566" class="Symbol">→</a> <a id="1568" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1479" class="Datatype">Expr</a> <a id="1573" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1485" class="Bound">n</a>

<a id="1576" class="Comment">-- An environment contains one value for every variable.</a>

<a id="Env"></a><a id="1634" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1634" class="Function">Env</a> <a id="1638" class="Symbol">:</a> <a id="1640" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="1642" class="Symbol">→</a> <a id="1644" class="PrimitiveType">Set</a> <a id="1648" class="Symbol">_</a>
<a id="1650" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1634" class="Function">Env</a> <a id="1654" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1654" class="Bound">n</a> <a id="1656" class="Symbol">=</a> <a id="1658" href="Data.Vec.html#773" class="Datatype">Vec</a> <a id="1662" href="Algebra.html#3583" class="Field">Carrier</a> <a id="1670" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1654" class="Bound">n</a>

<a id="1673" class="Comment">-- The semantics of an expression is a function from an environment to</a>
<a id="1744" class="Comment">-- a value.</a>

<a id="⟦_⟧"></a><a id="1757" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1757" class="Function Operator">⟦_⟧</a> <a id="1761" class="Symbol">:</a> <a id="1763" class="Symbol">∀</a> <a id="1765" class="Symbol">{</a><a id="1766" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1766" class="Bound">n</a><a id="1767" class="Symbol">}</a> <a id="1769" class="Symbol">→</a> <a id="1771" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1479" class="Datatype">Expr</a> <a id="1776" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1766" class="Bound">n</a> <a id="1778" class="Symbol">→</a> <a id="1780" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1634" class="Function">Env</a> <a id="1784" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1766" class="Bound">n</a> <a id="1786" class="Symbol">→</a> <a id="1788" href="Algebra.html#3583" class="Field">Carrier</a>
<a id="1796" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1757" class="Function Operator">⟦</a> <a id="1798" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1506" class="InductiveConstructor">var</a> <a id="1802" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1802" class="Bound">x</a>   <a id="1806" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1757" class="Function Operator">⟧</a> <a id="1808" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1808" class="Bound">ρ</a> <a id="1810" class="Symbol">=</a> <a id="1812" href="Data.Vec.html#1379" class="Function">lookup</a> <a id="1819" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1802" class="Bound">x</a> <a id="1821" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1808" class="Bound">ρ</a>
<a id="1823" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1757" class="Function Operator">⟦</a> <a id="1825" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1529" class="InductiveConstructor">id</a>      <a id="1833" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1757" class="Function Operator">⟧</a> <a id="1835" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1835" class="Bound">ρ</a> <a id="1837" class="Symbol">=</a> <a id="1839" href="Algebra.html#3723" class="Field">ε</a>
<a id="1841" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1757" class="Function Operator">⟦</a> <a id="1843" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1843" class="Bound">e₁</a> <a id="1846" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1544" class="InductiveConstructor Operator">⊕</a> <a id="1848" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1848" class="Bound">e₂</a> <a id="1851" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1757" class="Function Operator">⟧</a> <a id="1853" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1853" class="Bound">ρ</a> <a id="1855" class="Symbol">=</a> <a id="1857" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1757" class="Function Operator">⟦</a> <a id="1859" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1843" class="Bound">e₁</a> <a id="1862" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1757" class="Function Operator">⟧</a> <a id="1864" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1853" class="Bound">ρ</a> <a id="1866" href="Algebra.html#3675" class="Field Operator">∙</a> <a id="1868" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1757" class="Function Operator">⟦</a> <a id="1870" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1848" class="Bound">e₂</a> <a id="1873" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1757" class="Function Operator">⟧</a> <a id="1875" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1853" class="Bound">ρ</a>

<a id="1878" class="Comment">------------------------------------------------------------------------</a>
<a id="1951" class="Comment">-- Normal forms</a>

<a id="1968" class="Comment">-- A normal form is a vector of bits (a set).</a>

<a id="Normal"></a><a id="2015" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2015" class="Function">Normal</a> <a id="2022" class="Symbol">:</a> <a id="2024" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="2026" class="Symbol">→</a> <a id="2028" class="PrimitiveType">Set</a>
<a id="2032" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2015" class="Function">Normal</a> <a id="2039" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2039" class="Bound">n</a> <a id="2041" class="Symbol">=</a> <a id="2043" href="Data.Vec.html#773" class="Datatype">Vec</a> <a id="2047" href="Agda.Builtin.Bool.html#67" class="Datatype">Bool</a> <a id="2052" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2039" class="Bound">n</a>

<a id="2055" class="Comment">-- The semantics of a normal form.</a>

<a id="⟦_⟧⇓"></a><a id="2091" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2091" class="Function Operator">⟦_⟧⇓</a> <a id="2096" class="Symbol">:</a> <a id="2098" class="Symbol">∀</a> <a id="2100" class="Symbol">{</a><a id="2101" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2101" class="Bound">n</a><a id="2102" class="Symbol">}</a> <a id="2104" class="Symbol">→</a> <a id="2106" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2015" class="Function">Normal</a> <a id="2113" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2101" class="Bound">n</a> <a id="2115" class="Symbol">→</a> <a id="2117" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1634" class="Function">Env</a> <a id="2121" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2101" class="Bound">n</a> <a id="2123" class="Symbol">→</a> <a id="2125" href="Algebra.html#3583" class="Field">Carrier</a>
<a id="2133" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2091" class="Function Operator">⟦</a> <a id="2135" href="Data.Vec.html#813" class="InductiveConstructor">[]</a>    <a id="2141" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2091" class="Function Operator">⟧⇓</a> <a id="2144" class="Symbol">_</a> <a id="2146" class="Symbol">=</a> <a id="2148" href="Algebra.html#3723" class="Field">ε</a>
<a id="2150" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2091" class="Function Operator">⟦</a> <a id="2152" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2152" class="Bound">b</a> <a id="2154" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="2156" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2156" class="Bound">v</a> <a id="2158" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2091" class="Function Operator">⟧⇓</a> <a id="2161" class="Symbol">(</a><a id="2162" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2162" class="Bound">a</a> <a id="2164" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="2166" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2166" class="Bound">ρ</a><a id="2167" class="Symbol">)</a> <a id="2169" class="Symbol">=</a> <a id="2171" href="Data.Bool.Base.html#835" class="Function Operator">if</a> <a id="2174" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2152" class="Bound">b</a> <a id="2176" href="Data.Bool.Base.html#835" class="Function Operator">then</a> <a id="2181" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2162" class="Bound">a</a> <a id="2183" href="Algebra.html#3675" class="Field Operator">∙</a> <a id="2185" class="Symbol">(</a><a id="2186" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2091" class="Function Operator">⟦</a> <a id="2188" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2156" class="Bound">v</a> <a id="2190" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2091" class="Function Operator">⟧⇓</a> <a id="2193" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2166" class="Bound">ρ</a><a id="2194" class="Symbol">)</a> <a id="2196" href="Data.Bool.Base.html#835" class="Function Operator">else</a> <a id="2201" class="Symbol">(</a><a id="2202" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2091" class="Function Operator">⟦</a> <a id="2204" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2156" class="Bound">v</a> <a id="2206" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2091" class="Function Operator">⟧⇓</a> <a id="2209" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2166" class="Bound">ρ</a><a id="2210" class="Symbol">)</a>

<a id="2213" class="Comment">------------------------------------------------------------------------</a>
<a id="2286" class="Comment">-- Constructions on normal forms</a>

<a id="2320" class="Comment">-- The empty bag.</a>

<a id="empty"></a><a id="2339" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2339" class="Function">empty</a> <a id="2345" class="Symbol">:</a> <a id="2347" class="Symbol">∀{</a><a id="2349" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2349" class="Bound">n</a><a id="2350" class="Symbol">}</a> <a id="2352" class="Symbol">→</a> <a id="2354" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2015" class="Function">Normal</a> <a id="2361" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2349" class="Bound">n</a>
<a id="2363" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2339" class="Function">empty</a> <a id="2369" class="Symbol">=</a> <a id="2371" href="Data.Vec.html#5840" class="Function">replicate</a> <a id="2381" href="Agda.Builtin.Bool.html#86" class="InductiveConstructor">false</a>

<a id="2388" class="Comment">-- A singleton bag.</a>

<a id="sg"></a><a id="2409" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2409" class="Function">sg</a> <a id="2412" class="Symbol">:</a> <a id="2414" class="Symbol">∀{</a><a id="2416" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2416" class="Bound">n</a><a id="2417" class="Symbol">}</a> <a id="2419" class="Symbol">(</a><a id="2420" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2420" class="Bound">i</a> <a id="2422" class="Symbol">:</a> <a id="2424" href="Data.Fin.Base.html#951" class="Datatype">Fin</a> <a id="2428" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2416" class="Bound">n</a><a id="2429" class="Symbol">)</a> <a id="2431" class="Symbol">→</a> <a id="2433" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2015" class="Function">Normal</a> <a id="2440" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2416" class="Bound">n</a>
<a id="2442" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2409" class="Function">sg</a> <a id="2445" href="Data.Fin.Base.html#973" class="InductiveConstructor">zero</a>    <a id="2453" class="Symbol">=</a> <a id="2455" href="Agda.Builtin.Bool.html#92" class="InductiveConstructor">true</a> <a id="2460" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="2462" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2339" class="Function">empty</a>
<a id="2468" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2409" class="Function">sg</a> <a id="2471" class="Symbol">(</a><a id="2472" href="Data.Fin.Base.html#1004" class="InductiveConstructor">suc</a> <a id="2476" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2476" class="Bound">i</a><a id="2477" class="Symbol">)</a> <a id="2479" class="Symbol">=</a> <a id="2481" href="Agda.Builtin.Bool.html#86" class="InductiveConstructor">false</a> <a id="2487" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="2489" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2409" class="Function">sg</a> <a id="2492" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2476" class="Bound">i</a>

<a id="2495" class="Comment">-- The composition of normal forms.</a>

<a id="_•_"></a><a id="2532" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2532" class="Function Operator">_•_</a>  <a id="2537" class="Symbol">:</a> <a id="2539" class="Symbol">∀{</a><a id="2541" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2541" class="Bound">n</a><a id="2542" class="Symbol">}</a> <a id="2544" class="Symbol">(</a><a id="2545" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2545" class="Bound">v</a> <a id="2547" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2547" class="Bound">w</a> <a id="2549" class="Symbol">:</a> <a id="2551" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2015" class="Function">Normal</a> <a id="2558" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2541" class="Bound">n</a><a id="2559" class="Symbol">)</a> <a id="2561" class="Symbol">→</a> <a id="2563" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2015" class="Function">Normal</a> <a id="2570" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2541" class="Bound">n</a>
<a id="2572" href="Data.Vec.html#813" class="InductiveConstructor">[]</a>      <a id="2580" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2532" class="Function Operator">•</a> <a id="2582" href="Data.Vec.html#813" class="InductiveConstructor">[]</a>      <a id="2590" class="Symbol">=</a> <a id="2592" href="Data.Vec.html#813" class="InductiveConstructor">[]</a>
<a id="2595" class="Symbol">(</a><a id="2596" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2596" class="Bound">l</a> <a id="2598" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="2600" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2600" class="Bound">v</a><a id="2601" class="Symbol">)</a> <a id="2603" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2532" class="Function Operator">•</a> <a id="2605" class="Symbol">(</a><a id="2606" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2606" class="Bound">m</a> <a id="2608" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="2610" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2610" class="Bound">w</a><a id="2611" class="Symbol">)</a> <a id="2613" class="Symbol">=</a> <a id="2615" class="Symbol">(</a><a id="2616" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2596" class="Bound">l</a> <a id="2618" href="Data.Bool.Base.html#1001" class="Function Operator">∨</a> <a id="2620" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2606" class="Bound">m</a><a id="2621" class="Symbol">)</a> <a id="2623" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="2625" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2600" class="Bound">v</a> <a id="2627" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2532" class="Function Operator">•</a> <a id="2629" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2610" class="Bound">w</a>

<a id="2632" class="Comment">------------------------------------------------------------------------</a>
<a id="2705" class="Comment">-- Correctness of the constructions on normal forms</a>

<a id="2758" class="Comment">-- The empty bag stands for the unit ε.</a>

<a id="empty-correct"></a><a id="2799" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2799" class="Function">empty-correct</a> <a id="2813" class="Symbol">:</a> <a id="2815" class="Symbol">∀{</a><a id="2817" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2817" class="Bound">n</a><a id="2818" class="Symbol">}</a> <a id="2820" class="Symbol">(</a><a id="2821" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2821" class="Bound">ρ</a> <a id="2823" class="Symbol">:</a> <a id="2825" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1634" class="Function">Env</a> <a id="2829" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2817" class="Bound">n</a><a id="2830" class="Symbol">)</a> <a id="2832" class="Symbol">→</a> <a id="2834" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2091" class="Function Operator">⟦</a> <a id="2836" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2339" class="Function">empty</a> <a id="2842" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2091" class="Function Operator">⟧⇓</a> <a id="2845" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2821" class="Bound">ρ</a> <a id="2847" href="Algebra.html#3625" class="Field Operator">≈</a> <a id="2849" href="Algebra.html#3723" class="Field">ε</a>
<a id="2851" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2799" class="Function">empty-correct</a> <a id="2865" href="Data.Vec.html#813" class="InductiveConstructor">[]</a> <a id="2868" class="Symbol">=</a> <a id="2870" href="Relation.Binary.Core.html#5808" class="Function">refl</a>
<a id="2875" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2799" class="Function">empty-correct</a> <a id="2889" class="Symbol">(</a><a id="2890" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2890" class="Bound">a</a> <a id="2892" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="2894" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2894" class="Bound">ρ</a><a id="2895" class="Symbol">)</a> <a id="2897" class="Symbol">=</a> <a id="2899" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2799" class="Function">empty-correct</a> <a id="2913" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2894" class="Bound">ρ</a>

<a id="2916" class="Comment">-- The singleton bag stands for a single variable.</a>

<a id="sg-correct"></a><a id="2968" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2968" class="Function">sg-correct</a> <a id="2979" class="Symbol">:</a> <a id="2981" class="Symbol">∀{</a><a id="2983" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2983" class="Bound">n</a><a id="2984" class="Symbol">}</a> <a id="2986" class="Symbol">(</a><a id="2987" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2987" class="Bound">x</a> <a id="2989" class="Symbol">:</a> <a id="2991" href="Data.Fin.Base.html#951" class="Datatype">Fin</a> <a id="2995" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2983" class="Bound">n</a><a id="2996" class="Symbol">)</a> <a id="2998" class="Symbol">(</a><a id="2999" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2999" class="Bound">ρ</a> <a id="3001" class="Symbol">:</a> <a id="3003" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1634" class="Function">Env</a> <a id="3007" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2983" class="Bound">n</a><a id="3008" class="Symbol">)</a> <a id="3010" class="Symbol">→</a>  <a id="3013" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2091" class="Function Operator">⟦</a> <a id="3015" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2409" class="Function">sg</a> <a id="3018" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2987" class="Bound">x</a> <a id="3020" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2091" class="Function Operator">⟧⇓</a> <a id="3023" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2999" class="Bound">ρ</a> <a id="3025" href="Algebra.html#3625" class="Field Operator">≈</a> <a id="3027" href="Data.Vec.html#1379" class="Function">lookup</a> <a id="3034" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2987" class="Bound">x</a> <a id="3036" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2999" class="Bound">ρ</a>
<a id="3038" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2968" class="Function">sg-correct</a> <a id="3049" href="Data.Fin.Base.html#973" class="InductiveConstructor">zero</a> <a id="3054" class="Symbol">(</a><a id="3055" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3055" class="Bound">x</a> <a id="3057" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="3059" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3059" class="Bound">ρ</a><a id="3060" class="Symbol">)</a> <a id="3062" class="Symbol">=</a> <a id="3064" href="Relation.Binary.Reasoning.Preorder.html#1266" class="Function Operator">begin</a>
    <a id="3074" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3055" class="Bound">x</a> <a id="3076" href="Algebra.html#3675" class="Field Operator">∙</a> <a id="3078" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2091" class="Function Operator">⟦</a> <a id="3080" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2339" class="Function">empty</a> <a id="3086" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2091" class="Function Operator">⟧⇓</a> <a id="3089" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3059" class="Bound">ρ</a>   <a id="3093" href="Relation.Binary.Reasoning.Preorder.html#1332" class="Function Operator">≈⟨</a> <a id="3096" href="Algebra.Structures.html#860" class="Function">∙-cong</a> <a id="3103" href="Relation.Binary.Core.html#5808" class="Function">refl</a> <a id="3108" class="Symbol">(</a><a id="3109" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2799" class="Function">empty-correct</a> <a id="3123" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3059" class="Bound">ρ</a><a id="3124" class="Symbol">)</a> <a id="3126" href="Relation.Binary.Reasoning.Preorder.html#1332" class="Function Operator">⟩</a>
    <a id="3132" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3055" class="Bound">x</a> <a id="3134" href="Algebra.html#3675" class="Field Operator">∙</a> <a id="3136" href="Algebra.html#3723" class="Field">ε</a>              <a id="3151" href="Relation.Binary.Reasoning.Preorder.html#1332" class="Function Operator">≈⟨</a> <a id="3154" href="Algebra.Structures.html#2190" class="Function">identityʳ</a> <a id="3164" class="Symbol">_</a> <a id="3166" href="Relation.Binary.Reasoning.Preorder.html#1332" class="Function Operator">⟩</a>
    <a id="3172" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3055" class="Bound">x</a>                  <a id="3191" href="Relation.Binary.Reasoning.Preorder.html#1719" class="Function Operator">∎</a>
<a id="3193" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2968" class="Function">sg-correct</a> <a id="3204" class="Symbol">(</a><a id="3205" href="Data.Fin.Base.html#1004" class="InductiveConstructor">suc</a> <a id="3209" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3209" class="Bound">x</a><a id="3210" class="Symbol">)</a> <a id="3212" class="Symbol">(</a><a id="3213" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3213" class="Bound">m</a> <a id="3215" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="3217" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3217" class="Bound">ρ</a><a id="3218" class="Symbol">)</a> <a id="3220" class="Symbol">=</a> <a id="3222" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2968" class="Function">sg-correct</a> <a id="3233" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3209" class="Bound">x</a> <a id="3235" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3217" class="Bound">ρ</a>

<a id="3238" class="Comment">-- Normal form composition corresponds to the composition of the monoid.</a>

<a id="flip12"></a><a id="3312" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3312" class="Function">flip12</a> <a id="3319" class="Symbol">:</a> <a id="3321" class="Symbol">∀</a> <a id="3323" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3323" class="Bound">a</a> <a id="3325" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3325" class="Bound">b</a> <a id="3327" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3327" class="Bound">c</a> <a id="3329" class="Symbol">→</a> <a id="3331" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3323" class="Bound">a</a> <a id="3333" href="Algebra.html#3675" class="Field Operator">∙</a> <a id="3335" class="Symbol">(</a><a id="3336" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3325" class="Bound">b</a> <a id="3338" href="Algebra.html#3675" class="Field Operator">∙</a> <a id="3340" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3327" class="Bound">c</a><a id="3341" class="Symbol">)</a> <a id="3343" href="Algebra.html#3625" class="Field Operator">≈</a> <a id="3345" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3325" class="Bound">b</a> <a id="3347" href="Algebra.html#3675" class="Field Operator">∙</a> <a id="3349" class="Symbol">(</a><a id="3350" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3323" class="Bound">a</a> <a id="3352" href="Algebra.html#3675" class="Field Operator">∙</a> <a id="3354" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3327" class="Bound">c</a><a id="3355" class="Symbol">)</a>
<a id="3357" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3312" class="Function">flip12</a> <a id="3364" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3364" class="Bound">a</a> <a id="3366" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3366" class="Bound">b</a> <a id="3368" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3368" class="Bound">c</a> <a id="3370" class="Symbol">=</a> <a id="3372" href="Relation.Binary.Reasoning.Preorder.html#1266" class="Function Operator">begin</a>
    <a id="3382" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3364" class="Bound">a</a> <a id="3384" href="Algebra.html#3675" class="Field Operator">∙</a> <a id="3386" class="Symbol">(</a><a id="3387" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3366" class="Bound">b</a> <a id="3389" href="Algebra.html#3675" class="Field Operator">∙</a> <a id="3391" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3368" class="Bound">c</a><a id="3392" class="Symbol">)</a>  <a id="3395" href="Relation.Binary.Reasoning.Preorder.html#1332" class="Function Operator">≈⟨</a> <a id="3398" href="Relation.Binary.Core.html#5834" class="Function">sym</a> <a id="3402" class="Symbol">(</a><a id="3403" href="Algebra.Structures.html#1218" class="Function">assoc</a> <a id="3409" class="Symbol">_</a> <a id="3411" class="Symbol">_</a> <a id="3413" class="Symbol">_)</a> <a id="3416" href="Relation.Binary.Reasoning.Preorder.html#1332" class="Function Operator">⟩</a>
    <a id="3422" class="Symbol">(</a><a id="3423" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3364" class="Bound">a</a> <a id="3425" href="Algebra.html#3675" class="Field Operator">∙</a> <a id="3427" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3366" class="Bound">b</a><a id="3428" class="Symbol">)</a> <a id="3430" href="Algebra.html#3675" class="Field Operator">∙</a> <a id="3432" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3368" class="Bound">c</a>  <a id="3435" href="Relation.Binary.Reasoning.Preorder.html#1332" class="Function Operator">≈⟨</a> <a id="3438" href="Algebra.Structures.html#860" class="Function">∙-cong</a> <a id="3445" class="Symbol">(</a><a id="3446" href="Algebra.Structures.html#2120" class="Function">comm</a> <a id="3451" class="Symbol">_</a> <a id="3453" class="Symbol">_)</a> <a id="3456" href="Relation.Binary.Core.html#5808" class="Function">refl</a> <a id="3461" href="Relation.Binary.Reasoning.Preorder.html#1332" class="Function Operator">⟩</a>
    <a id="3467" class="Symbol">(</a><a id="3468" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3366" class="Bound">b</a> <a id="3470" href="Algebra.html#3675" class="Field Operator">∙</a> <a id="3472" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3364" class="Bound">a</a><a id="3473" class="Symbol">)</a> <a id="3475" href="Algebra.html#3675" class="Field Operator">∙</a> <a id="3477" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3368" class="Bound">c</a>  <a id="3480" href="Relation.Binary.Reasoning.Preorder.html#1332" class="Function Operator">≈⟨</a> <a id="3483" href="Algebra.Structures.html#1218" class="Function">assoc</a> <a id="3489" class="Symbol">_</a> <a id="3491" class="Symbol">_</a> <a id="3493" class="Symbol">_</a> <a id="3495" href="Relation.Binary.Reasoning.Preorder.html#1332" class="Function Operator">⟩</a>
    <a id="3501" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3366" class="Bound">b</a> <a id="3503" href="Algebra.html#3675" class="Field Operator">∙</a> <a id="3505" class="Symbol">(</a><a id="3506" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3364" class="Bound">a</a> <a id="3508" href="Algebra.html#3675" class="Field Operator">∙</a> <a id="3510" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3368" class="Bound">c</a><a id="3511" class="Symbol">)</a>  <a id="3514" href="Relation.Binary.Reasoning.Preorder.html#1719" class="Function Operator">∎</a>

<a id="distr"></a><a id="3517" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3517" class="Function">distr</a> <a id="3523" class="Symbol">:</a> <a id="3525" class="Symbol">∀</a> <a id="3527" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3527" class="Bound">a</a> <a id="3529" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3529" class="Bound">b</a> <a id="3531" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3531" class="Bound">c</a> <a id="3533" class="Symbol">→</a> <a id="3535" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3527" class="Bound">a</a> <a id="3537" href="Algebra.html#3675" class="Field Operator">∙</a> <a id="3539" class="Symbol">(</a><a id="3540" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3529" class="Bound">b</a> <a id="3542" href="Algebra.html#3675" class="Field Operator">∙</a> <a id="3544" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3531" class="Bound">c</a><a id="3545" class="Symbol">)</a> <a id="3547" href="Algebra.html#3625" class="Field Operator">≈</a> <a id="3549" class="Symbol">(</a><a id="3550" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3527" class="Bound">a</a> <a id="3552" href="Algebra.html#3675" class="Field Operator">∙</a> <a id="3554" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3529" class="Bound">b</a><a id="3555" class="Symbol">)</a> <a id="3557" href="Algebra.html#3675" class="Field Operator">∙</a> <a id="3559" class="Symbol">(</a><a id="3560" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3527" class="Bound">a</a> <a id="3562" href="Algebra.html#3675" class="Field Operator">∙</a> <a id="3564" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3531" class="Bound">c</a><a id="3565" class="Symbol">)</a>
<a id="3567" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3517" class="Function">distr</a> <a id="3573" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3573" class="Bound">a</a> <a id="3575" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3575" class="Bound">b</a> <a id="3577" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3577" class="Bound">c</a> <a id="3579" class="Symbol">=</a> <a id="3581" href="Relation.Binary.Reasoning.Preorder.html#1266" class="Function Operator">begin</a>
    <a id="3591" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3573" class="Bound">a</a> <a id="3593" href="Algebra.html#3675" class="Field Operator">∙</a> <a id="3595" class="Symbol">(</a><a id="3596" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3575" class="Bound">b</a> <a id="3598" href="Algebra.html#3675" class="Field Operator">∙</a> <a id="3600" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3577" class="Bound">c</a><a id="3601" class="Symbol">)</a>  <a id="3604" href="Relation.Binary.Reasoning.Preorder.html#1332" class="Function Operator">≈⟨</a> <a id="3607" href="Algebra.Structures.html#860" class="Function">∙-cong</a> <a id="3614" class="Symbol">(</a><a id="3615" href="Relation.Binary.Core.html#5834" class="Function">sym</a> <a id="3619" class="Symbol">(</a><a id="3620" href="Algebra.Structures.html#2637" class="Function">idem</a> <a id="3625" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3573" class="Bound">a</a><a id="3626" class="Symbol">))</a> <a id="3629" href="Relation.Binary.Core.html#5808" class="Function">refl</a> <a id="3634" href="Relation.Binary.Reasoning.Preorder.html#1332" class="Function Operator">⟩</a>
    <a id="3640" class="Symbol">(</a><a id="3641" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3573" class="Bound">a</a> <a id="3643" href="Algebra.html#3675" class="Field Operator">∙</a> <a id="3645" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3573" class="Bound">a</a><a id="3646" class="Symbol">)</a> <a id="3648" href="Algebra.html#3675" class="Field Operator">∙</a> <a id="3650" class="Symbol">(</a><a id="3651" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3575" class="Bound">b</a> <a id="3653" href="Algebra.html#3675" class="Field Operator">∙</a> <a id="3655" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3577" class="Bound">c</a><a id="3656" class="Symbol">)</a>  <a id="3659" href="Relation.Binary.Reasoning.Preorder.html#1332" class="Function Operator">≈⟨</a> <a id="3662" href="Algebra.Structures.html#1218" class="Function">assoc</a> <a id="3668" class="Symbol">_</a> <a id="3670" class="Symbol">_</a> <a id="3672" class="Symbol">_</a> <a id="3674" href="Relation.Binary.Reasoning.Preorder.html#1332" class="Function Operator">⟩</a>
    <a id="3680" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3573" class="Bound">a</a> <a id="3682" href="Algebra.html#3675" class="Field Operator">∙</a> <a id="3684" class="Symbol">(</a><a id="3685" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3573" class="Bound">a</a> <a id="3687" href="Algebra.html#3675" class="Field Operator">∙</a> <a id="3689" class="Symbol">(</a><a id="3690" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3575" class="Bound">b</a> <a id="3692" href="Algebra.html#3675" class="Field Operator">∙</a> <a id="3694" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3577" class="Bound">c</a><a id="3695" class="Symbol">))</a>  <a id="3699" href="Relation.Binary.Reasoning.Preorder.html#1332" class="Function Operator">≈⟨</a> <a id="3702" href="Algebra.Structures.html#860" class="Function">∙-cong</a> <a id="3709" href="Relation.Binary.Core.html#5808" class="Function">refl</a> <a id="3714" class="Symbol">(</a><a id="3715" href="Relation.Binary.Core.html#5834" class="Function">sym</a> <a id="3719" class="Symbol">(</a><a id="3720" href="Algebra.Structures.html#1218" class="Function">assoc</a> <a id="3726" class="Symbol">_</a> <a id="3728" class="Symbol">_</a> <a id="3730" class="Symbol">_))</a> <a id="3734" href="Relation.Binary.Reasoning.Preorder.html#1332" class="Function Operator">⟩</a>
    <a id="3740" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3573" class="Bound">a</a> <a id="3742" href="Algebra.html#3675" class="Field Operator">∙</a> <a id="3744" class="Symbol">((</a><a id="3746" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3573" class="Bound">a</a> <a id="3748" href="Algebra.html#3675" class="Field Operator">∙</a> <a id="3750" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3575" class="Bound">b</a><a id="3751" class="Symbol">)</a> <a id="3753" href="Algebra.html#3675" class="Field Operator">∙</a> <a id="3755" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3577" class="Bound">c</a><a id="3756" class="Symbol">)</a>  <a id="3759" href="Relation.Binary.Reasoning.Preorder.html#1332" class="Function Operator">≈⟨</a> <a id="3762" href="Algebra.Structures.html#860" class="Function">∙-cong</a> <a id="3769" href="Relation.Binary.Core.html#5808" class="Function">refl</a> <a id="3774" class="Symbol">(</a><a id="3775" href="Algebra.Structures.html#860" class="Function">∙-cong</a> <a id="3782" class="Symbol">(</a><a id="3783" href="Algebra.Structures.html#2120" class="Function">comm</a> <a id="3788" class="Symbol">_</a> <a id="3790" class="Symbol">_)</a> <a id="3793" href="Relation.Binary.Core.html#5808" class="Function">refl</a><a id="3797" class="Symbol">)</a> <a id="3799" href="Relation.Binary.Reasoning.Preorder.html#1332" class="Function Operator">⟩</a>
    <a id="3805" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3573" class="Bound">a</a> <a id="3807" href="Algebra.html#3675" class="Field Operator">∙</a> <a id="3809" class="Symbol">((</a><a id="3811" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3575" class="Bound">b</a> <a id="3813" href="Algebra.html#3675" class="Field Operator">∙</a> <a id="3815" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3573" class="Bound">a</a><a id="3816" class="Symbol">)</a> <a id="3818" href="Algebra.html#3675" class="Field Operator">∙</a> <a id="3820" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3577" class="Bound">c</a><a id="3821" class="Symbol">)</a>  <a id="3824" href="Relation.Binary.Reasoning.Preorder.html#1332" class="Function Operator">≈⟨</a> <a id="3827" href="Algebra.Structures.html#860" class="Function">∙-cong</a> <a id="3834" href="Relation.Binary.Core.html#5808" class="Function">refl</a> <a id="3839" class="Symbol">(</a><a id="3840" href="Algebra.Structures.html#1218" class="Function">assoc</a> <a id="3846" class="Symbol">_</a> <a id="3848" class="Symbol">_</a> <a id="3850" class="Symbol">_)</a> <a id="3853" href="Relation.Binary.Reasoning.Preorder.html#1332" class="Function Operator">⟩</a>
    <a id="3859" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3573" class="Bound">a</a> <a id="3861" href="Algebra.html#3675" class="Field Operator">∙</a> <a id="3863" class="Symbol">(</a><a id="3864" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3575" class="Bound">b</a> <a id="3866" href="Algebra.html#3675" class="Field Operator">∙</a> <a id="3868" class="Symbol">(</a><a id="3869" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3573" class="Bound">a</a> <a id="3871" href="Algebra.html#3675" class="Field Operator">∙</a> <a id="3873" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3577" class="Bound">c</a><a id="3874" class="Symbol">))</a>  <a id="3878" href="Relation.Binary.Reasoning.Preorder.html#1332" class="Function Operator">≈⟨</a> <a id="3881" href="Relation.Binary.Core.html#5834" class="Function">sym</a> <a id="3885" class="Symbol">(</a><a id="3886" href="Algebra.Structures.html#1218" class="Function">assoc</a> <a id="3892" class="Symbol">_</a> <a id="3894" class="Symbol">_</a> <a id="3896" class="Symbol">_)</a> <a id="3899" href="Relation.Binary.Reasoning.Preorder.html#1332" class="Function Operator">⟩</a>
    <a id="3905" class="Symbol">(</a><a id="3906" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3573" class="Bound">a</a> <a id="3908" href="Algebra.html#3675" class="Field Operator">∙</a> <a id="3910" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3575" class="Bound">b</a><a id="3911" class="Symbol">)</a> <a id="3913" href="Algebra.html#3675" class="Field Operator">∙</a> <a id="3915" class="Symbol">(</a><a id="3916" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3573" class="Bound">a</a> <a id="3918" href="Algebra.html#3675" class="Field Operator">∙</a> <a id="3920" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3577" class="Bound">c</a><a id="3921" class="Symbol">)</a>  <a id="3924" href="Relation.Binary.Reasoning.Preorder.html#1719" class="Function Operator">∎</a>

<a id="comp-correct"></a><a id="3927" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3927" class="Function">comp-correct</a> <a id="3940" class="Symbol">:</a> <a id="3942" class="Symbol">∀</a> <a id="3944" class="Symbol">{</a><a id="3945" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3945" class="Bound">n</a><a id="3946" class="Symbol">}</a> <a id="3948" class="Symbol">(</a><a id="3949" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3949" class="Bound">v</a> <a id="3951" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3951" class="Bound">w</a> <a id="3953" class="Symbol">:</a> <a id="3955" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2015" class="Function">Normal</a> <a id="3962" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3945" class="Bound">n</a><a id="3963" class="Symbol">)</a> <a id="3965" class="Symbol">(</a><a id="3966" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3966" class="Bound">ρ</a> <a id="3968" class="Symbol">:</a> <a id="3970" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1634" class="Function">Env</a> <a id="3974" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3945" class="Bound">n</a><a id="3975" class="Symbol">)</a> <a id="3977" class="Symbol">→</a>
              <a id="3993" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2091" class="Function Operator">⟦</a> <a id="3995" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3949" class="Bound">v</a> <a id="3997" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2532" class="Function Operator">•</a> <a id="3999" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3951" class="Bound">w</a> <a id="4001" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2091" class="Function Operator">⟧⇓</a> <a id="4004" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3966" class="Bound">ρ</a> <a id="4006" href="Algebra.html#3625" class="Field Operator">≈</a> <a id="4008" class="Symbol">(</a><a id="4009" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2091" class="Function Operator">⟦</a> <a id="4011" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3949" class="Bound">v</a> <a id="4013" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2091" class="Function Operator">⟧⇓</a> <a id="4016" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3966" class="Bound">ρ</a> <a id="4018" href="Algebra.html#3675" class="Field Operator">∙</a> <a id="4020" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2091" class="Function Operator">⟦</a> <a id="4022" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3951" class="Bound">w</a> <a id="4024" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2091" class="Function Operator">⟧⇓</a> <a id="4027" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3966" class="Bound">ρ</a><a id="4028" class="Symbol">)</a>
<a id="4030" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3927" class="Function">comp-correct</a> <a id="4043" href="Data.Vec.html#813" class="InductiveConstructor">[]</a> <a id="4046" href="Data.Vec.html#813" class="InductiveConstructor">[]</a> <a id="4049" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4049" class="Bound">ρ</a> <a id="4051" class="Symbol">=</a> <a id="4053" href="Relation.Binary.Core.html#5834" class="Function">sym</a> <a id="4057" class="Symbol">(</a><a id="4058" href="Algebra.Structures.html#2085" class="Function">identityˡ</a> <a id="4068" class="Symbol">_)</a>
<a id="4071" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3927" class="Function">comp-correct</a> <a id="4084" class="Symbol">(</a><a id="4085" href="Agda.Builtin.Bool.html#92" class="InductiveConstructor">true</a> <a id="4090" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="4092" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4092" class="Bound">v</a><a id="4093" class="Symbol">)</a> <a id="4095" class="Symbol">(</a><a id="4096" href="Agda.Builtin.Bool.html#92" class="InductiveConstructor">true</a> <a id="4101" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="4103" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4103" class="Bound">w</a><a id="4104" class="Symbol">)</a> <a id="4106" class="Symbol">(</a><a id="4107" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4107" class="Bound">a</a> <a id="4109" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="4111" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4111" class="Bound">ρ</a><a id="4112" class="Symbol">)</a> <a id="4114" class="Symbol">=</a>
  <a id="4118" href="Relation.Binary.Core.html#5860" class="Function">trans</a> <a id="4124" class="Symbol">(</a><a id="4125" href="Algebra.Structures.html#860" class="Function">∙-cong</a> <a id="4132" href="Relation.Binary.Core.html#5808" class="Function">refl</a> <a id="4137" class="Symbol">(</a><a id="4138" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3927" class="Function">comp-correct</a> <a id="4151" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4092" class="Bound">v</a> <a id="4153" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4103" class="Bound">w</a> <a id="4155" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4111" class="Bound">ρ</a><a id="4156" class="Symbol">))</a> <a id="4159" class="Symbol">(</a><a id="4160" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3517" class="Function">distr</a> <a id="4166" class="Symbol">_</a> <a id="4168" class="Symbol">_</a> <a id="4170" class="Symbol">_)</a>
<a id="4173" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3927" class="Function">comp-correct</a> <a id="4186" class="Symbol">(</a><a id="4187" href="Agda.Builtin.Bool.html#92" class="InductiveConstructor">true</a> <a id="4192" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="4194" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4194" class="Bound">v</a><a id="4195" class="Symbol">)</a> <a id="4197" class="Symbol">(</a><a id="4198" href="Agda.Builtin.Bool.html#86" class="InductiveConstructor">false</a> <a id="4204" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="4206" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4206" class="Bound">w</a><a id="4207" class="Symbol">)</a> <a id="4209" class="Symbol">(</a><a id="4210" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4210" class="Bound">a</a> <a id="4212" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="4214" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4214" class="Bound">ρ</a><a id="4215" class="Symbol">)</a> <a id="4217" class="Symbol">=</a>
  <a id="4221" href="Relation.Binary.Core.html#5860" class="Function">trans</a> <a id="4227" class="Symbol">(</a><a id="4228" href="Algebra.Structures.html#860" class="Function">∙-cong</a> <a id="4235" href="Relation.Binary.Core.html#5808" class="Function">refl</a> <a id="4240" class="Symbol">(</a><a id="4241" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3927" class="Function">comp-correct</a> <a id="4254" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4194" class="Bound">v</a> <a id="4256" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4206" class="Bound">w</a> <a id="4258" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4214" class="Bound">ρ</a><a id="4259" class="Symbol">))</a> <a id="4262" class="Symbol">(</a><a id="4263" href="Relation.Binary.Core.html#5834" class="Function">sym</a> <a id="4267" class="Symbol">(</a><a id="4268" href="Algebra.Structures.html#1218" class="Function">assoc</a> <a id="4274" class="Symbol">_</a> <a id="4276" class="Symbol">_</a> <a id="4278" class="Symbol">_))</a>
<a id="4282" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3927" class="Function">comp-correct</a> <a id="4295" class="Symbol">(</a><a id="4296" href="Agda.Builtin.Bool.html#86" class="InductiveConstructor">false</a> <a id="4302" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="4304" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4304" class="Bound">v</a><a id="4305" class="Symbol">)</a> <a id="4307" class="Symbol">(</a><a id="4308" href="Agda.Builtin.Bool.html#92" class="InductiveConstructor">true</a> <a id="4313" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="4315" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4315" class="Bound">w</a><a id="4316" class="Symbol">)</a> <a id="4318" class="Symbol">(</a><a id="4319" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4319" class="Bound">a</a> <a id="4321" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="4323" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4323" class="Bound">ρ</a><a id="4324" class="Symbol">)</a> <a id="4326" class="Symbol">=</a>
  <a id="4330" href="Relation.Binary.Core.html#5860" class="Function">trans</a> <a id="4336" class="Symbol">(</a><a id="4337" href="Algebra.Structures.html#860" class="Function">∙-cong</a> <a id="4344" href="Relation.Binary.Core.html#5808" class="Function">refl</a> <a id="4349" class="Symbol">(</a><a id="4350" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3927" class="Function">comp-correct</a> <a id="4363" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4304" class="Bound">v</a> <a id="4365" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4315" class="Bound">w</a> <a id="4367" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4323" class="Bound">ρ</a><a id="4368" class="Symbol">))</a> <a id="4371" class="Symbol">(</a><a id="4372" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3312" class="Function">flip12</a> <a id="4379" class="Symbol">_</a> <a id="4381" class="Symbol">_</a> <a id="4383" class="Symbol">_)</a>
<a id="4386" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3927" class="Function">comp-correct</a> <a id="4399" class="Symbol">(</a><a id="4400" href="Agda.Builtin.Bool.html#86" class="InductiveConstructor">false</a> <a id="4406" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="4408" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4408" class="Bound">v</a><a id="4409" class="Symbol">)</a> <a id="4411" class="Symbol">(</a><a id="4412" href="Agda.Builtin.Bool.html#86" class="InductiveConstructor">false</a> <a id="4418" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="4420" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4420" class="Bound">w</a><a id="4421" class="Symbol">)</a> <a id="4423" class="Symbol">(</a><a id="4424" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4424" class="Bound">a</a> <a id="4426" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="4428" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4428" class="Bound">ρ</a><a id="4429" class="Symbol">)</a> <a id="4431" class="Symbol">=</a>
  <a id="4435" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3927" class="Function">comp-correct</a> <a id="4448" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4408" class="Bound">v</a> <a id="4450" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4420" class="Bound">w</a> <a id="4452" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4428" class="Bound">ρ</a>

<a id="4455" class="Comment">------------------------------------------------------------------------</a>
<a id="4528" class="Comment">-- Normalization</a>

<a id="4546" class="Comment">-- A normaliser.</a>

<a id="normalise"></a><a id="4564" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4564" class="Function">normalise</a> <a id="4574" class="Symbol">:</a> <a id="4576" class="Symbol">∀</a> <a id="4578" class="Symbol">{</a><a id="4579" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4579" class="Bound">n</a><a id="4580" class="Symbol">}</a> <a id="4582" class="Symbol">→</a> <a id="4584" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1479" class="Datatype">Expr</a> <a id="4589" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4579" class="Bound">n</a> <a id="4591" class="Symbol">→</a> <a id="4593" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2015" class="Function">Normal</a> <a id="4600" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4579" class="Bound">n</a>
<a id="4602" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4564" class="Function">normalise</a> <a id="4612" class="Symbol">(</a><a id="4613" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1506" class="InductiveConstructor">var</a> <a id="4617" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4617" class="Bound">x</a><a id="4618" class="Symbol">)</a>   <a id="4622" class="Symbol">=</a> <a id="4624" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2409" class="Function">sg</a> <a id="4627" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4617" class="Bound">x</a>
<a id="4629" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4564" class="Function">normalise</a> <a id="4639" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1529" class="InductiveConstructor">id</a>        <a id="4649" class="Symbol">=</a> <a id="4651" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2339" class="Function">empty</a>
<a id="4657" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4564" class="Function">normalise</a> <a id="4667" class="Symbol">(</a><a id="4668" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4668" class="Bound">e₁</a> <a id="4671" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1544" class="InductiveConstructor Operator">⊕</a> <a id="4673" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4673" class="Bound">e₂</a><a id="4675" class="Symbol">)</a> <a id="4677" class="Symbol">=</a> <a id="4679" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4564" class="Function">normalise</a> <a id="4689" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4668" class="Bound">e₁</a> <a id="4692" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2532" class="Function Operator">•</a> <a id="4694" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4564" class="Function">normalise</a> <a id="4704" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4673" class="Bound">e₂</a>

<a id="4708" class="Comment">-- The normaliser preserves the semantics of the expression.</a>

<a id="normalise-correct"></a><a id="4770" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4770" class="Function">normalise-correct</a> <a id="4788" class="Symbol">:</a> <a id="4790" class="Symbol">∀</a> <a id="4792" class="Symbol">{</a><a id="4793" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4793" class="Bound">n</a><a id="4794" class="Symbol">}</a> <a id="4796" class="Symbol">(</a><a id="4797" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4797" class="Bound">e</a> <a id="4799" class="Symbol">:</a> <a id="4801" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1479" class="Datatype">Expr</a> <a id="4806" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4793" class="Bound">n</a><a id="4807" class="Symbol">)</a> <a id="4809" class="Symbol">(</a><a id="4810" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4810" class="Bound">ρ</a> <a id="4812" class="Symbol">:</a> <a id="4814" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1634" class="Function">Env</a> <a id="4818" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4793" class="Bound">n</a><a id="4819" class="Symbol">)</a> <a id="4821" class="Symbol">→</a>
    <a id="4827" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2091" class="Function Operator">⟦</a> <a id="4829" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4564" class="Function">normalise</a> <a id="4839" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4797" class="Bound">e</a> <a id="4841" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2091" class="Function Operator">⟧⇓</a> <a id="4844" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4810" class="Bound">ρ</a> <a id="4846" href="Algebra.html#3625" class="Field Operator">≈</a> <a id="4848" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1757" class="Function Operator">⟦</a> <a id="4850" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4797" class="Bound">e</a> <a id="4852" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1757" class="Function Operator">⟧</a> <a id="4854" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4810" class="Bound">ρ</a>
<a id="4856" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4770" class="Function">normalise-correct</a> <a id="4874" class="Symbol">(</a><a id="4875" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1506" class="InductiveConstructor">var</a> <a id="4879" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4879" class="Bound">x</a><a id="4880" class="Symbol">)</a>   <a id="4884" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4884" class="Bound">ρ</a> <a id="4886" class="Symbol">=</a> <a id="4888" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2968" class="Function">sg-correct</a> <a id="4899" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4879" class="Bound">x</a> <a id="4901" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4884" class="Bound">ρ</a>
<a id="4903" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4770" class="Function">normalise-correct</a> <a id="4921" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1529" class="InductiveConstructor">id</a>        <a id="4931" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4931" class="Bound">ρ</a> <a id="4933" class="Symbol">=</a> <a id="4935" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2799" class="Function">empty-correct</a> <a id="4949" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4931" class="Bound">ρ</a>
<a id="4951" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4770" class="Function">normalise-correct</a> <a id="4969" class="Symbol">(</a><a id="4970" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4970" class="Bound">e₁</a> <a id="4973" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1544" class="InductiveConstructor Operator">⊕</a> <a id="4975" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4975" class="Bound">e₂</a><a id="4977" class="Symbol">)</a> <a id="4979" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4979" class="Bound">ρ</a> <a id="4981" class="Symbol">=</a>  <a id="4984" href="Relation.Binary.Reasoning.Preorder.html#1266" class="Function Operator">begin</a>

    <a id="4995" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2091" class="Function Operator">⟦</a> <a id="4997" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4564" class="Function">normalise</a> <a id="5007" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4970" class="Bound">e₁</a> <a id="5010" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2532" class="Function Operator">•</a> <a id="5012" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4564" class="Function">normalise</a> <a id="5022" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4975" class="Bound">e₂</a> <a id="5025" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2091" class="Function Operator">⟧⇓</a> <a id="5028" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4979" class="Bound">ρ</a>

  <a id="5033" href="Relation.Binary.Reasoning.Preorder.html#1332" class="Function Operator">≈⟨</a> <a id="5036" href="Algebra.Solver.IdempotentCommutativeMonoid.html#3927" class="Function">comp-correct</a> <a id="5049" class="Symbol">(</a><a id="5050" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4564" class="Function">normalise</a> <a id="5060" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4970" class="Bound">e₁</a><a id="5062" class="Symbol">)</a> <a id="5064" class="Symbol">(</a><a id="5065" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4564" class="Function">normalise</a> <a id="5075" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4975" class="Bound">e₂</a><a id="5077" class="Symbol">)</a> <a id="5079" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4979" class="Bound">ρ</a> <a id="5081" href="Relation.Binary.Reasoning.Preorder.html#1332" class="Function Operator">⟩</a>

    <a id="5088" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2091" class="Function Operator">⟦</a> <a id="5090" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4564" class="Function">normalise</a> <a id="5100" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4970" class="Bound">e₁</a> <a id="5103" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2091" class="Function Operator">⟧⇓</a> <a id="5106" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4979" class="Bound">ρ</a> <a id="5108" href="Algebra.html#3675" class="Field Operator">∙</a> <a id="5110" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2091" class="Function Operator">⟦</a> <a id="5112" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4564" class="Function">normalise</a> <a id="5122" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4975" class="Bound">e₂</a> <a id="5125" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2091" class="Function Operator">⟧⇓</a> <a id="5128" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4979" class="Bound">ρ</a>

  <a id="5133" href="Relation.Binary.Reasoning.Preorder.html#1332" class="Function Operator">≈⟨</a> <a id="5136" href="Algebra.Structures.html#860" class="Function">∙-cong</a> <a id="5143" class="Symbol">(</a><a id="5144" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4770" class="Function">normalise-correct</a> <a id="5162" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4970" class="Bound">e₁</a> <a id="5165" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4979" class="Bound">ρ</a><a id="5166" class="Symbol">)</a> <a id="5168" class="Symbol">(</a><a id="5169" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4770" class="Function">normalise-correct</a> <a id="5187" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4975" class="Bound">e₂</a> <a id="5190" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4979" class="Bound">ρ</a><a id="5191" class="Symbol">)</a> <a id="5193" href="Relation.Binary.Reasoning.Preorder.html#1332" class="Function Operator">⟩</a>

    <a id="5200" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1757" class="Function Operator">⟦</a> <a id="5202" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4970" class="Bound">e₁</a> <a id="5205" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1757" class="Function Operator">⟧</a> <a id="5207" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4979" class="Bound">ρ</a> <a id="5209" href="Algebra.html#3675" class="Field Operator">∙</a> <a id="5211" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1757" class="Function Operator">⟦</a> <a id="5213" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4975" class="Bound">e₂</a> <a id="5216" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1757" class="Function Operator">⟧</a> <a id="5218" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4979" class="Bound">ρ</a>
  <a id="5222" href="Relation.Binary.Reasoning.Preorder.html#1719" class="Function Operator">∎</a>

<a id="5225" class="Comment">------------------------------------------------------------------------</a>
<a id="5298" class="Comment">-- &quot;Tactics&quot;</a>

<a id="5312" class="Keyword">open</a> <a id="5317" class="Keyword">module</a> <a id="R"></a><a id="5324" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5324" class="Module">R</a> <a id="5326" class="Symbol">=</a> <a id="5328" href="Relation.Binary.Reflection.html" class="Module">Reflection</a>
                  <a id="5357" href="Algebra.Structures.html#935" class="Function">setoid</a> <a id="5364" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1506" class="InductiveConstructor">var</a> <a id="5368" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1757" class="Function Operator">⟦_⟧</a> <a id="5372" class="Symbol">(</a><a id="5373" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2091" class="Function Operator">⟦_⟧⇓</a> <a id="5378" href="Function.html#805" class="Function Operator">∘</a> <a id="5380" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4564" class="Function">normalise</a><a id="5389" class="Symbol">)</a> <a id="5391" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4770" class="Function">normalise-correct</a>
  <a id="5411" class="Keyword">public</a> <a id="5418" class="Keyword">using</a> <a id="5424" class="Symbol">(</a><a id="5425" href="Relation.Binary.Reflection.html#2423" class="Function">solve</a><a id="5430" class="Symbol">;</a> <a id="5432" href="Relation.Binary.Reflection.html#3532" class="Function Operator">_⊜_</a><a id="5435" class="Symbol">)</a>

<a id="5438" class="Comment">-- We can decide if two normal forms are /syntactically/ equal.</a>

<a id="5503" class="Keyword">infix</a> <a id="5509" class="Number">5</a> <a id="5511" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5516" class="Function Operator">_≟_</a>

<a id="_≟_"></a><a id="5516" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5516" class="Function Operator">_≟_</a> <a id="5520" class="Symbol">:</a> <a id="5522" class="Symbol">∀</a> <a id="5524" class="Symbol">{</a><a id="5525" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5525" class="Bound">n</a><a id="5526" class="Symbol">}</a> <a id="5528" class="Symbol">(</a><a id="5529" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5529" class="Bound">nf₁</a> <a id="5533" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5533" class="Bound">nf₂</a> <a id="5537" class="Symbol">:</a> <a id="5539" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2015" class="Function">Normal</a> <a id="5546" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5525" class="Bound">n</a><a id="5547" class="Symbol">)</a> <a id="5549" class="Symbol">→</a> <a id="5551" href="Relation.Nullary.html#570" class="Datatype">Dec</a> <a id="5555" class="Symbol">(</a><a id="5556" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5529" class="Bound">nf₁</a> <a id="5560" href="Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="5562" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5533" class="Bound">nf₂</a><a id="5565" class="Symbol">)</a>
<a id="5567" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5567" class="Bound">nf₁</a> <a id="5571" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5516" class="Function Operator">≟</a> <a id="5573" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5573" class="Bound">nf₂</a> <a id="5577" class="Symbol">=</a> <a id="5579" href="Relation.Nullary.Decidable.html#1668" class="Function">Dec.map</a> <a id="5587" href="Data.Vec.Relation.Pointwise.Inductive.html#9108" class="Function">Pointwise-≡↔≡</a> <a id="5601" class="Symbol">(</a><a id="5602" href="Data.Vec.Relation.Pointwise.Inductive.html#3202" class="Function">decidable</a> <a id="5612" href="Data.Bool.Properties.html#992" class="Function Operator">Bool._≟_</a> <a id="5621" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5567" class="Bound">nf₁</a> <a id="5625" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5573" class="Bound">nf₂</a><a id="5628" class="Symbol">)</a>
  <a id="5632" class="Keyword">where</a> <a id="5638" class="Keyword">open</a> <a id="5643" href="Data.Vec.Relation.Pointwise.Inductive.html" class="Module">Pointwise</a>

<a id="5654" class="Comment">-- We can also give a sound, but not necessarily complete, procedure</a>
<a id="5723" class="Comment">-- for determining if two expressions have the same semantics.</a>

<a id="prove′"></a><a id="5787" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5787" class="Function">prove′</a> <a id="5794" class="Symbol">:</a> <a id="5796" class="Symbol">∀</a> <a id="5798" class="Symbol">{</a><a id="5799" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5799" class="Bound">n</a><a id="5800" class="Symbol">}</a> <a id="5802" class="Symbol">(</a><a id="5803" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5803" class="Bound">e₁</a> <a id="5806" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5806" class="Bound">e₂</a> <a id="5809" class="Symbol">:</a> <a id="5811" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1479" class="Datatype">Expr</a> <a id="5816" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5799" class="Bound">n</a><a id="5817" class="Symbol">)</a> <a id="5819" class="Symbol">→</a> <a id="5821" href="Data.Maybe.Base.html#710" class="Datatype">Maybe</a> <a id="5827" class="Symbol">(∀</a> <a id="5830" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5830" class="Bound">ρ</a> <a id="5832" class="Symbol">→</a> <a id="5834" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1757" class="Function Operator">⟦</a> <a id="5836" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5803" class="Bound">e₁</a> <a id="5839" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1757" class="Function Operator">⟧</a> <a id="5841" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5830" class="Bound">ρ</a> <a id="5843" href="Algebra.html#3625" class="Field Operator">≈</a> <a id="5845" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1757" class="Function Operator">⟦</a> <a id="5847" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5806" class="Bound">e₂</a> <a id="5850" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1757" class="Function Operator">⟧</a> <a id="5852" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5830" class="Bound">ρ</a><a id="5853" class="Symbol">)</a>
<a id="5855" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5787" class="Function">prove′</a> <a id="5862" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5862" class="Bound">e₁</a> <a id="5865" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5865" class="Bound">e₂</a> <a id="5868" class="Symbol">=</a>
  <a id="5872" href="Data.Maybe.Base.html#2139" class="Function">Maybe.map</a> <a id="5882" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5941" class="Function">lemma</a> <a id="5888" class="Symbol">(</a><a id="5889" href="Data.Maybe.Base.html#1285" class="Function">decToMaybe</a> <a id="5900" class="Symbol">(</a><a id="5901" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4564" class="Function">normalise</a> <a id="5911" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5862" class="Bound">e₁</a> <a id="5914" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5516" class="Function Operator">≟</a> <a id="5916" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4564" class="Function">normalise</a> <a id="5926" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5865" class="Bound">e₂</a><a id="5928" class="Symbol">))</a>
  <a id="5933" class="Keyword">where</a>
  <a id="5941" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5941" class="Function">lemma</a> <a id="5947" class="Symbol">:</a> <a id="5949" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4564" class="Function">normalise</a> <a id="5959" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5862" class="Bound">e₁</a> <a id="5962" href="Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="5964" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4564" class="Function">normalise</a> <a id="5974" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5865" class="Bound">e₂</a> <a id="5977" class="Symbol">→</a> <a id="5979" class="Symbol">∀</a> <a id="5981" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5981" class="Bound">ρ</a> <a id="5983" class="Symbol">→</a> <a id="5985" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1757" class="Function Operator">⟦</a> <a id="5987" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5862" class="Bound">e₁</a> <a id="5990" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1757" class="Function Operator">⟧</a> <a id="5992" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5981" class="Bound">ρ</a> <a id="5994" href="Algebra.html#3625" class="Field Operator">≈</a> <a id="5996" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1757" class="Function Operator">⟦</a> <a id="5998" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5865" class="Bound">e₂</a> <a id="6001" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1757" class="Function Operator">⟧</a> <a id="6003" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5981" class="Bound">ρ</a>
  <a id="6007" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5941" class="Function">lemma</a> <a id="6013" href="Algebra.Solver.IdempotentCommutativeMonoid.html#6013" class="Bound">eq</a> <a id="6016" href="Algebra.Solver.IdempotentCommutativeMonoid.html#6016" class="Bound">ρ</a> <a id="6018" class="Symbol">=</a>
    <a id="6024" href="Relation.Binary.Reflection.html#1737" class="Function">R.prove</a> <a id="6032" href="Algebra.Solver.IdempotentCommutativeMonoid.html#6016" class="Bound">ρ</a> <a id="6034" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5862" class="Bound">e₁</a> <a id="6037" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5865" class="Bound">e₂</a> <a id="6040" class="Symbol">(</a><a id="6041" href="Relation.Binary.Reasoning.Preorder.html#1266" class="Function Operator">begin</a>
      <a id="6053" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2091" class="Function Operator">⟦</a> <a id="6055" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4564" class="Function">normalise</a> <a id="6065" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5862" class="Bound">e₁</a> <a id="6068" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2091" class="Function Operator">⟧⇓</a> <a id="6071" href="Algebra.Solver.IdempotentCommutativeMonoid.html#6016" class="Bound">ρ</a>  <a id="6074" href="Relation.Binary.Reasoning.Preorder.html#1562" class="Function Operator">≡⟨</a> <a id="6077" href="Relation.Binary.PropositionalEquality.html#1134" class="Function">P.cong</a> <a id="6084" class="Symbol">(λ</a> <a id="6087" href="Algebra.Solver.IdempotentCommutativeMonoid.html#6087" class="Bound">e</a> <a id="6089" class="Symbol">→</a> <a id="6091" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2091" class="Function Operator">⟦</a> <a id="6093" href="Algebra.Solver.IdempotentCommutativeMonoid.html#6087" class="Bound">e</a> <a id="6095" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2091" class="Function Operator">⟧⇓</a> <a id="6098" href="Algebra.Solver.IdempotentCommutativeMonoid.html#6016" class="Bound">ρ</a><a id="6099" class="Symbol">)</a> <a id="6101" href="Algebra.Solver.IdempotentCommutativeMonoid.html#6013" class="Bound">eq</a> <a id="6104" href="Relation.Binary.Reasoning.Preorder.html#1562" class="Function Operator">⟩</a>
      <a id="6112" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2091" class="Function Operator">⟦</a> <a id="6114" href="Algebra.Solver.IdempotentCommutativeMonoid.html#4564" class="Function">normalise</a> <a id="6124" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5865" class="Bound">e₂</a> <a id="6127" href="Algebra.Solver.IdempotentCommutativeMonoid.html#2091" class="Function Operator">⟧⇓</a> <a id="6130" href="Algebra.Solver.IdempotentCommutativeMonoid.html#6016" class="Bound">ρ</a>  <a id="6133" href="Relation.Binary.Reasoning.Preorder.html#1719" class="Function Operator">∎</a><a id="6134" class="Symbol">)</a>

<a id="6137" class="Comment">-- This procedure can be combined with from-just.</a>

<a id="prove"></a><a id="6188" href="Algebra.Solver.IdempotentCommutativeMonoid.html#6188" class="Function">prove</a> <a id="6194" class="Symbol">:</a> <a id="6196" class="Symbol">∀</a> <a id="6198" href="Algebra.Solver.IdempotentCommutativeMonoid.html#6198" class="Bound">n</a> <a id="6200" class="Symbol">(</a><a id="6201" href="Algebra.Solver.IdempotentCommutativeMonoid.html#6201" class="Bound">e₁</a> <a id="6204" href="Algebra.Solver.IdempotentCommutativeMonoid.html#6204" class="Bound">e₂</a> <a id="6207" class="Symbol">:</a> <a id="6209" href="Algebra.Solver.IdempotentCommutativeMonoid.html#1479" class="Datatype">Expr</a> <a id="6214" href="Algebra.Solver.IdempotentCommutativeMonoid.html#6198" class="Bound">n</a><a id="6215" class="Symbol">)</a> <a id="6217" class="Symbol">→</a> <a id="6219" href="Data.Maybe.Base.html#1936" class="Function">From-just</a> <a id="6229" class="Symbol">(</a><a id="6230" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5787" class="Function">prove′</a> <a id="6237" href="Algebra.Solver.IdempotentCommutativeMonoid.html#6201" class="Bound">e₁</a> <a id="6240" href="Algebra.Solver.IdempotentCommutativeMonoid.html#6204" class="Bound">e₂</a><a id="6242" class="Symbol">)</a>
<a id="6244" href="Algebra.Solver.IdempotentCommutativeMonoid.html#6188" class="Function">prove</a> <a id="6250" class="Symbol">_</a> <a id="6252" href="Algebra.Solver.IdempotentCommutativeMonoid.html#6252" class="Bound">e₁</a> <a id="6255" href="Algebra.Solver.IdempotentCommutativeMonoid.html#6255" class="Bound">e₂</a> <a id="6258" class="Symbol">=</a> <a id="6260" href="Data.Maybe.Base.html#2024" class="Function">from-just</a> <a id="6270" class="Symbol">(</a><a id="6271" href="Algebra.Solver.IdempotentCommutativeMonoid.html#5787" class="Function">prove′</a> <a id="6278" href="Algebra.Solver.IdempotentCommutativeMonoid.html#6252" class="Bound">e₁</a> <a id="6281" href="Algebra.Solver.IdempotentCommutativeMonoid.html#6255" class="Bound">e₂</a><a id="6283" class="Symbol">)</a>

<a id="6286" class="Comment">-- prove : ∀ n (es : Expr n × Expr n) →</a>
<a id="6326" class="Comment">--         From-just (uncurry prove′ es)</a>
<a id="6367" class="Comment">-- prove _ = from-just ∘ uncurry prove′</a>

<a id="6408" class="Comment">-- -}</a>
</pre></body></html>