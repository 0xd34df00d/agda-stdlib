<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.Container.FreeMonad</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- The free monad construction on containers</a>
<a id="151" class="Comment">------------------------------------------------------------------------</a>

<a id="225" class="Symbol">{-#</a> <a id="229" class="Keyword">OPTIONS</a> <a id="237" class="Option">--without-K</a> <a id="249" class="Symbol">#-}</a>

<a id="254" class="Keyword">module</a> <a id="261" href="Data.Container.FreeMonad.html" class="Module">Data.Container.FreeMonad</a> <a id="286" class="Keyword">where</a>

<a id="293" class="Keyword">open</a> <a id="298" class="Keyword">import</a> <a id="305" href="Level.html" class="Module">Level</a>
<a id="311" class="Keyword">open</a> <a id="316" class="Keyword">import</a> <a id="323" href="Data.Sum.html" class="Module">Data.Sum</a> <a id="332" class="Keyword">using</a> <a id="338" class="Symbol">(</a><a id="339" href="Data.Sum.Base.html#558" class="InductiveConstructor">inj₁</a><a id="343" class="Symbol">;</a> <a id="345" href="Data.Sum.Base.html#583" class="InductiveConstructor">inj₂</a> <a id="350" class="Symbol">;</a> <a id="352" href="Data.Sum.Base.html#1010" class="Function Operator">[_,_]′</a><a id="358" class="Symbol">)</a>
<a id="360" class="Keyword">open</a> <a id="365" class="Keyword">import</a> <a id="372" href="Data.Product.html" class="Module">Data.Product</a>
<a id="385" class="Keyword">open</a> <a id="390" class="Keyword">import</a> <a id="397" href="Data.Container.html" class="Module">Data.Container</a>
<a id="412" class="Keyword">open</a> <a id="417" class="Keyword">import</a> <a id="424" href="Data.Container.Combinator.html" class="Module">Data.Container.Combinator</a> <a id="450" class="Keyword">using</a> <a id="456" class="Symbol">(</a><a id="457" href="Data.Container.Combinator.html#910" class="Function">const</a><a id="462" class="Symbol">;</a> <a id="464" href="Data.Container.Combinator.html#1697" class="Function Operator">_⊎_</a><a id="467" class="Symbol">)</a>
<a id="469" class="Keyword">open</a> <a id="474" class="Keyword">import</a> <a id="481" href="Data.W.html" class="Module">Data.W</a>
<a id="488" class="Keyword">open</a> <a id="493" class="Keyword">import</a> <a id="500" href="Category.Monad.html" class="Module">Category.Monad</a>

<a id="516" class="Keyword">infixl</a> <a id="523" class="Number">1</a> <a id="525" href="Data.Container.FreeMonad.html#1414" class="Function Operator">_⋆C_</a>
<a id="530" class="Keyword">infix</a>  <a id="537" class="Number">1</a> <a id="539" href="Data.Container.FreeMonad.html#1499" class="Function Operator">_⋆_</a>

<a id="544" class="Comment">------------------------------------------------------------------------</a>

<a id="618" class="Comment">-- The free monad construction over a container and a set is, in</a>
<a id="683" class="Comment">-- universal algebra terminology, also known as the term algebra over a</a>
<a id="755" class="Comment">-- signature (a container) and a set (of variable symbols). The return</a>
<a id="826" class="Comment">-- of the free monad corresponds to variables and the bind operator</a>
<a id="894" class="Comment">-- corresponds to (parallel) substitution.</a>

<a id="938" class="Comment">-- A useful intuition is to think of containers describing single</a>
<a id="1004" class="Comment">-- operations and the free monad construction over a container and a set</a>
<a id="1077" class="Comment">-- describing a tree of operations as nodes and elements of the set as</a>
<a id="1148" class="Comment">-- leafs. If one starts at the root, then any path will pass finitely</a>
<a id="1218" class="Comment">-- many nodes (operations described by the container) and eventually end</a>
<a id="1291" class="Comment">-- up in a leaf (element of the set) -- hence the Kleene star notation</a>
<a id="1362" class="Comment">-- (the type can be read as a regular expression).</a>

<a id="_⋆C_"></a><a id="1414" href="Data.Container.FreeMonad.html#1414" class="Function Operator">_⋆C_</a> <a id="1419" class="Symbol">:</a> <a id="1421" class="Symbol">∀</a> <a id="1423" class="Symbol">{</a><a id="1424" href="Data.Container.FreeMonad.html#1424" class="Bound">x</a> <a id="1426" href="Data.Container.FreeMonad.html#1426" class="Bound">s</a> <a id="1428" href="Data.Container.FreeMonad.html#1428" class="Bound">p</a><a id="1429" class="Symbol">}</a> <a id="1431" class="Symbol">→</a> <a id="1433" href="Data.Container.Core.html#415" class="Record">Container</a> <a id="1443" href="Data.Container.FreeMonad.html#1426" class="Bound">s</a> <a id="1445" href="Data.Container.FreeMonad.html#1428" class="Bound">p</a> <a id="1447" class="Symbol">→</a> <a id="1449" class="PrimitiveType">Set</a> <a id="1453" href="Data.Container.FreeMonad.html#1424" class="Bound">x</a> <a id="1455" class="Symbol">→</a> <a id="1457" href="Data.Container.Core.html#415" class="Record">Container</a> <a id="1467" class="Symbol">(</a><a id="1468" href="Data.Container.FreeMonad.html#1426" class="Bound">s</a> <a id="1470" href="Agda.Primitive.html#657" class="Primitive Operator">⊔</a> <a id="1472" href="Data.Container.FreeMonad.html#1424" class="Bound">x</a><a id="1473" class="Symbol">)</a> <a id="1475" href="Data.Container.FreeMonad.html#1428" class="Bound">p</a>
<a id="1477" href="Data.Container.FreeMonad.html#1477" class="Bound">C</a> <a id="1479" href="Data.Container.FreeMonad.html#1414" class="Function Operator">⋆C</a> <a id="1482" href="Data.Container.FreeMonad.html#1482" class="Bound">X</a> <a id="1484" class="Symbol">=</a> <a id="1486" href="Data.Container.Combinator.html#910" class="Function">const</a> <a id="1492" href="Data.Container.FreeMonad.html#1482" class="Bound">X</a> <a id="1494" href="Data.Container.Combinator.html#1697" class="Function Operator">⊎</a> <a id="1496" href="Data.Container.FreeMonad.html#1477" class="Bound">C</a>

<a id="_⋆_"></a><a id="1499" href="Data.Container.FreeMonad.html#1499" class="Function Operator">_⋆_</a> <a id="1503" class="Symbol">:</a> <a id="1505" class="Symbol">∀</a> <a id="1507" class="Symbol">{</a><a id="1508" href="Data.Container.FreeMonad.html#1508" class="Bound">x</a> <a id="1510" href="Data.Container.FreeMonad.html#1510" class="Bound">s</a> <a id="1512" href="Data.Container.FreeMonad.html#1512" class="Bound">p</a><a id="1513" class="Symbol">}</a> <a id="1515" class="Symbol">→</a> <a id="1517" href="Data.Container.Core.html#415" class="Record">Container</a> <a id="1527" href="Data.Container.FreeMonad.html#1510" class="Bound">s</a> <a id="1529" href="Data.Container.FreeMonad.html#1512" class="Bound">p</a> <a id="1531" class="Symbol">→</a> <a id="1533" class="PrimitiveType">Set</a> <a id="1537" href="Data.Container.FreeMonad.html#1508" class="Bound">x</a> <a id="1539" class="Symbol">→</a> <a id="1541" class="PrimitiveType">Set</a> <a id="1545" class="Symbol">(</a><a id="1546" href="Data.Container.FreeMonad.html#1508" class="Bound">x</a> <a id="1548" href="Agda.Primitive.html#657" class="Primitive Operator">⊔</a> <a id="1550" href="Data.Container.FreeMonad.html#1510" class="Bound">s</a> <a id="1552" href="Agda.Primitive.html#657" class="Primitive Operator">⊔</a> <a id="1554" href="Data.Container.FreeMonad.html#1512" class="Bound">p</a><a id="1555" class="Symbol">)</a>
<a id="1557" href="Data.Container.FreeMonad.html#1557" class="Bound">C</a> <a id="1559" href="Data.Container.FreeMonad.html#1499" class="Function Operator">⋆</a> <a id="1561" href="Data.Container.FreeMonad.html#1561" class="Bound">X</a> <a id="1563" class="Symbol">=</a> <a id="1565" href="Data.Container.html#1065" class="Function">μ</a> <a id="1567" class="Symbol">(</a><a id="1568" href="Data.Container.FreeMonad.html#1557" class="Bound">C</a> <a id="1570" href="Data.Container.FreeMonad.html#1414" class="Function Operator">⋆C</a> <a id="1573" href="Data.Container.FreeMonad.html#1561" class="Bound">X</a><a id="1574" class="Symbol">)</a>

<a id="1577" class="Keyword">module</a> <a id="1584" href="Data.Container.FreeMonad.html#1584" class="Module">_</a> <a id="1586" class="Symbol">{</a><a id="1587" href="Data.Container.FreeMonad.html#1587" class="Bound">s</a> <a id="1589" href="Data.Container.FreeMonad.html#1589" class="Bound">p</a><a id="1590" class="Symbol">}</a> <a id="1592" class="Symbol">{</a><a id="1593" href="Data.Container.FreeMonad.html#1593" class="Bound">C</a> <a id="1595" class="Symbol">:</a> <a id="1597" href="Data.Container.Core.html#415" class="Record">Container</a> <a id="1607" href="Data.Container.FreeMonad.html#1587" class="Bound">s</a> <a id="1609" href="Data.Container.FreeMonad.html#1589" class="Bound">p</a><a id="1610" class="Symbol">}</a> <a id="1612" class="Keyword">where</a>

  <a id="1621" href="Data.Container.FreeMonad.html#1621" class="Function">inn</a> <a id="1625" class="Symbol">:</a> <a id="1627" class="Symbol">∀</a> <a id="1629" class="Symbol">{</a><a id="1630" href="Data.Container.FreeMonad.html#1630" class="Bound">x</a><a id="1631" class="Symbol">}</a> <a id="1633" class="Symbol">{</a><a id="1634" href="Data.Container.FreeMonad.html#1634" class="Bound">X</a> <a id="1636" class="Symbol">:</a> <a id="1638" class="PrimitiveType">Set</a> <a id="1642" href="Data.Container.FreeMonad.html#1630" class="Bound">x</a><a id="1643" class="Symbol">}</a> <a id="1645" class="Symbol">→</a> <a id="1647" href="Data.Container.Core.html#605" class="Function Operator">⟦</a> <a id="1649" href="Data.Container.FreeMonad.html#1593" class="Bound">C</a> <a id="1651" href="Data.Container.Core.html#605" class="Function Operator">⟧</a> <a id="1653" class="Symbol">(</a><a id="1654" href="Data.Container.FreeMonad.html#1593" class="Bound">C</a> <a id="1656" href="Data.Container.FreeMonad.html#1499" class="Function Operator">⋆</a> <a id="1658" href="Data.Container.FreeMonad.html#1634" class="Bound">X</a><a id="1659" class="Symbol">)</a> <a id="1661" class="Symbol">→</a> <a id="1663" href="Data.Container.FreeMonad.html#1593" class="Bound">C</a> <a id="1665" href="Data.Container.FreeMonad.html#1499" class="Function Operator">⋆</a> <a id="1667" href="Data.Container.FreeMonad.html#1634" class="Bound">X</a>
  <a id="1671" href="Data.Container.FreeMonad.html#1621" class="Function">inn</a> <a id="1675" class="Symbol">(</a><a id="1676" href="Data.Container.FreeMonad.html#1676" class="Bound">s</a> <a id="1678" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1680" href="Data.Container.FreeMonad.html#1680" class="Bound">f</a><a id="1681" class="Symbol">)</a> <a id="1683" class="Symbol">=</a> <a id="1685" href="Data.W.html#496" class="InductiveConstructor">sup</a> <a id="1689" class="Symbol">(</a><a id="1690" href="Data.Sum.Base.html#583" class="InductiveConstructor">inj₂</a> <a id="1695" href="Data.Container.FreeMonad.html#1676" class="Bound">s</a> <a id="1697" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1699" href="Data.Container.FreeMonad.html#1680" class="Bound">f</a><a id="1700" class="Symbol">)</a>

  <a id="1705" href="Data.Container.FreeMonad.html#1705" class="Function">rawMonad</a> <a id="1714" class="Symbol">:</a> <a id="1716" class="Symbol">∀</a> <a id="1718" class="Symbol">{</a><a id="1719" href="Data.Container.FreeMonad.html#1719" class="Bound">x</a><a id="1720" class="Symbol">}</a> <a id="1722" class="Symbol">→</a> <a id="1724" href="Category.Monad.html#389" class="Function">RawMonad</a> <a id="1733" class="Symbol">{</a><a id="1734" href="Data.Container.FreeMonad.html#1587" class="Bound">s</a> <a id="1736" href="Agda.Primitive.html#657" class="Primitive Operator">⊔</a> <a id="1738" href="Data.Container.FreeMonad.html#1589" class="Bound">p</a> <a id="1740" href="Agda.Primitive.html#657" class="Primitive Operator">⊔</a> <a id="1742" href="Data.Container.FreeMonad.html#1719" class="Bound">x</a><a id="1743" class="Symbol">}</a> <a id="1745" class="Symbol">(</a><a id="1746" href="Data.Container.FreeMonad.html#1593" class="Bound">C</a> <a id="1748" href="Data.Container.FreeMonad.html#1499" class="Function Operator">⋆_</a><a id="1750" class="Symbol">)</a>
  <a id="1754" href="Data.Container.FreeMonad.html#1705" class="Function">rawMonad</a> <a id="1763" class="Symbol">=</a> <a id="1765" class="Keyword">record</a> <a id="1772" class="Symbol">{</a> <a id="1774" class="Field">return</a> <a id="1781" class="Symbol">=</a> <a id="1783" href="Data.Container.FreeMonad.html#1821" class="Function">return</a><a id="1789" class="Symbol">;</a> <a id="1791" class="Field Operator">_&gt;&gt;=_</a> <a id="1797" class="Symbol">=</a> <a id="1799" href="Data.Container.FreeMonad.html#1888" class="Function Operator">_&gt;&gt;=_</a> <a id="1805" class="Symbol">}</a>
    <a id="1811" class="Keyword">where</a>
    <a id="1821" href="Data.Container.FreeMonad.html#1821" class="Function">return</a> <a id="1828" class="Symbol">:</a> <a id="1830" class="Symbol">∀</a> <a id="1832" class="Symbol">{</a><a id="1833" href="Data.Container.FreeMonad.html#1833" class="Bound">X</a><a id="1834" class="Symbol">}</a> <a id="1836" class="Symbol">→</a> <a id="1838" href="Data.Container.FreeMonad.html#1833" class="Bound">X</a> <a id="1840" class="Symbol">→</a> <a id="1842" href="Data.Container.FreeMonad.html#1593" class="Bound">C</a> <a id="1844" href="Data.Container.FreeMonad.html#1499" class="Function Operator">⋆</a> <a id="1846" href="Data.Container.FreeMonad.html#1833" class="Bound">X</a>
    <a id="1852" href="Data.Container.FreeMonad.html#1821" class="Function">return</a> <a id="1859" href="Data.Container.FreeMonad.html#1859" class="Bound">x</a> <a id="1861" class="Symbol">=</a> <a id="1863" href="Data.W.html#496" class="InductiveConstructor">sup</a> <a id="1867" class="Symbol">(</a><a id="1868" href="Data.Sum.Base.html#558" class="InductiveConstructor">inj₁</a> <a id="1873" href="Data.Container.FreeMonad.html#1859" class="Bound">x</a> <a id="1875" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1877" class="Symbol">λ</a> <a id="1879" class="Symbol">())</a>

    <a id="1888" href="Data.Container.FreeMonad.html#1888" class="Function Operator">_&gt;&gt;=_</a> <a id="1894" class="Symbol">:</a> <a id="1896" class="Symbol">∀</a> <a id="1898" class="Symbol">{</a><a id="1899" href="Data.Container.FreeMonad.html#1899" class="Bound">X</a> <a id="1901" href="Data.Container.FreeMonad.html#1901" class="Bound">Y</a><a id="1902" class="Symbol">}</a> <a id="1904" class="Symbol">→</a> <a id="1906" href="Data.Container.FreeMonad.html#1593" class="Bound">C</a> <a id="1908" href="Data.Container.FreeMonad.html#1499" class="Function Operator">⋆</a> <a id="1910" href="Data.Container.FreeMonad.html#1899" class="Bound">X</a> <a id="1912" class="Symbol">→</a> <a id="1914" class="Symbol">(</a><a id="1915" href="Data.Container.FreeMonad.html#1899" class="Bound">X</a> <a id="1917" class="Symbol">→</a> <a id="1919" href="Data.Container.FreeMonad.html#1593" class="Bound">C</a> <a id="1921" href="Data.Container.FreeMonad.html#1499" class="Function Operator">⋆</a> <a id="1923" href="Data.Container.FreeMonad.html#1901" class="Bound">Y</a><a id="1924" class="Symbol">)</a> <a id="1926" class="Symbol">→</a> <a id="1928" href="Data.Container.FreeMonad.html#1593" class="Bound">C</a> <a id="1930" href="Data.Container.FreeMonad.html#1499" class="Function Operator">⋆</a> <a id="1932" href="Data.Container.FreeMonad.html#1901" class="Bound">Y</a>
    <a id="1938" href="Data.W.html#496" class="InductiveConstructor">sup</a> <a id="1942" class="Symbol">(</a><a id="1943" href="Data.Sum.Base.html#558" class="InductiveConstructor">inj₁</a> <a id="1948" href="Data.Container.FreeMonad.html#1948" class="Bound">x</a> <a id="1950" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1952" class="Symbol">_)</a> <a id="1955" href="Data.Container.FreeMonad.html#1888" class="Function Operator">&gt;&gt;=</a> <a id="1959" href="Data.Container.FreeMonad.html#1959" class="Bound">k</a> <a id="1961" class="Symbol">=</a> <a id="1963" href="Data.Container.FreeMonad.html#1959" class="Bound">k</a> <a id="1965" href="Data.Container.FreeMonad.html#1948" class="Bound">x</a>
    <a id="1971" href="Data.W.html#496" class="InductiveConstructor">sup</a> <a id="1975" class="Symbol">(</a><a id="1976" href="Data.Sum.Base.html#583" class="InductiveConstructor">inj₂</a> <a id="1981" href="Data.Container.FreeMonad.html#1981" class="Bound">s</a> <a id="1983" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1985" href="Data.Container.FreeMonad.html#1985" class="Bound">f</a><a id="1986" class="Symbol">)</a> <a id="1988" href="Data.Container.FreeMonad.html#1888" class="Function Operator">&gt;&gt;=</a> <a id="1992" href="Data.Container.FreeMonad.html#1992" class="Bound">k</a> <a id="1994" class="Symbol">=</a> <a id="1996" href="Data.Container.FreeMonad.html#1621" class="Function">inn</a> <a id="2000" class="Symbol">(</a><a id="2001" href="Data.Container.FreeMonad.html#1981" class="Bound">s</a> <a id="2003" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2005" class="Symbol">λ</a> <a id="2007" href="Data.Container.FreeMonad.html#2007" class="Bound">p</a> <a id="2009" class="Symbol">→</a> <a id="2011" href="Data.Container.FreeMonad.html#1985" class="Bound">f</a> <a id="2013" href="Data.Container.FreeMonad.html#2007" class="Bound">p</a> <a id="2015" href="Data.Container.FreeMonad.html#1888" class="Function Operator">&gt;&gt;=</a> <a id="2019" href="Data.Container.FreeMonad.html#1992" class="Bound">k</a><a id="2020" class="Symbol">)</a>
</pre></body></html>