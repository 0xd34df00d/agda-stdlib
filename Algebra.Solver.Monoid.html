<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Algebra.Solver.Monoid</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Solver for monoid equalities</a>
<a id="138" class="Comment">------------------------------------------------------------------------</a>

<a id="212" class="Symbol">{-#</a> <a id="216" class="Keyword">OPTIONS</a> <a id="224" class="Option">--without-K</a> <a id="236" class="Option">--safe</a> <a id="243" class="Symbol">#-}</a>

<a id="248" class="Keyword">open</a> <a id="253" class="Keyword">import</a> <a id="260" href="Algebra.html" class="Module">Algebra</a>

<a id="269" class="Keyword">module</a> <a id="276" href="Algebra.Solver.Monoid.html" class="Module">Algebra.Solver.Monoid</a> <a id="298" class="Symbol">{</a><a id="299" href="Algebra.Solver.Monoid.html#299" class="Bound">m₁</a> <a id="302" href="Algebra.Solver.Monoid.html#302" class="Bound">m₂</a><a id="304" class="Symbol">}</a> <a id="306" class="Symbol">(</a><a id="307" href="Algebra.Solver.Monoid.html#307" class="Bound">M</a> <a id="309" class="Symbol">:</a> <a id="311" href="Algebra.html#2524" class="Record">Monoid</a> <a id="318" href="Algebra.Solver.Monoid.html#299" class="Bound">m₁</a> <a id="321" href="Algebra.Solver.Monoid.html#302" class="Bound">m₂</a><a id="323" class="Symbol">)</a> <a id="325" class="Keyword">where</a>

<a id="332" class="Keyword">open</a> <a id="337" class="Keyword">import</a> <a id="344" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="353" class="Symbol">as</a> <a id="356" class="Module">Fin</a> <a id="360" class="Keyword">hiding</a> <a id="367" class="Symbol">(</a><a id="368" href="Data.Fin.Properties.html#1730" class="Function Operator">_≟_</a><a id="371" class="Symbol">)</a>
<a id="373" class="Keyword">import</a> <a id="380" href="Data.Fin.Properties.html" class="Module">Data.Fin.Properties</a> <a id="400" class="Symbol">as</a> <a id="403" class="Module">Fin</a>
<a id="407" class="Keyword">open</a> <a id="412" class="Keyword">import</a> <a id="419" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="434" class="Keyword">hiding</a> <a id="441" class="Symbol">(</a><a id="442" href="Data.List.Base.html#5943" class="Function">lookup</a><a id="448" class="Symbol">)</a>
<a id="450" class="Keyword">import</a> <a id="457" href="Data.List.Relation.Equality.DecPropositional.html" class="Module">Data.List.Relation.Equality.DecPropositional</a> <a id="502" class="Symbol">as</a> <a id="505" class="Module">ListEq</a>
<a id="512" class="Keyword">open</a> <a id="517" class="Keyword">import</a> <a id="524" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="535" class="Symbol">as</a> <a id="538" class="Module">Maybe</a>
  <a id="546" class="Keyword">using</a> <a id="552" class="Symbol">(</a><a id="553" href="Data.Maybe.Base.html#710" class="Datatype">Maybe</a><a id="558" class="Symbol">;</a> <a id="560" href="Data.Maybe.Base.html#1285" class="Function">decToMaybe</a><a id="570" class="Symbol">;</a> <a id="572" href="Data.Maybe.Base.html#1936" class="Function">From-just</a><a id="581" class="Symbol">;</a> <a id="583" href="Data.Maybe.Base.html#2024" class="Function">from-just</a><a id="592" class="Symbol">)</a>
<a id="594" class="Keyword">open</a> <a id="599" class="Keyword">import</a> <a id="606" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="620" class="Keyword">using</a> <a id="626" class="Symbol">(</a><a id="627" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="628" class="Symbol">)</a>
<a id="630" class="Keyword">open</a> <a id="635" class="Keyword">import</a> <a id="642" href="Data.Product.html" class="Module">Data.Product</a>
<a id="655" class="Keyword">open</a> <a id="660" class="Keyword">import</a> <a id="667" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="676" class="Keyword">using</a> <a id="682" class="Symbol">(</a><a id="683" href="Data.Vec.html#773" class="Datatype">Vec</a><a id="686" class="Symbol">;</a> <a id="688" href="Data.Vec.html#1379" class="Function">lookup</a><a id="694" class="Symbol">)</a>
<a id="696" class="Keyword">open</a> <a id="701" class="Keyword">import</a> <a id="708" href="Function.html" class="Module">Function</a> <a id="717" class="Keyword">using</a> <a id="723" class="Symbol">(</a><a id="724" href="Function.html#805" class="Function Operator">_∘_</a><a id="727" class="Symbol">;</a> <a id="729" href="Function.html#1927" class="Function Operator">_$_</a><a id="732" class="Symbol">)</a>
<a id="734" class="Keyword">open</a> <a id="739" class="Keyword">import</a> <a id="746" href="Relation.Binary.html" class="Module">Relation.Binary</a> <a id="762" class="Keyword">using</a> <a id="768" class="Symbol">(</a><a id="769" href="Relation.Binary.Core.html#4722" class="Function">Decidable</a><a id="778" class="Symbol">)</a>
<a id="780" class="Keyword">import</a> <a id="787" href="Relation.Binary.EqReasoning.html" class="Module">Relation.Binary.EqReasoning</a>
<a id="815" class="Keyword">open</a> <a id="820" class="Keyword">import</a> <a id="827" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="865" class="Symbol">as</a> <a id="868" class="Module">P</a> <a id="870" class="Keyword">using</a> <a id="876" class="Symbol">(</a><a id="877" href="Agda.Builtin.Equality.html#83" class="Datatype Operator">_≡_</a><a id="880" class="Symbol">)</a>
<a id="882" class="Keyword">import</a> <a id="889" href="Relation.Binary.Reflection.html" class="Module">Relation.Binary.Reflection</a>
<a id="916" class="Keyword">open</a> <a id="921" class="Keyword">import</a> <a id="928" href="Relation.Nullary.html" class="Module">Relation.Nullary</a>
<a id="945" class="Keyword">import</a> <a id="952" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="979" class="Symbol">as</a> <a id="982" class="Module">Dec</a>

<a id="987" class="Keyword">open</a> <a id="992" href="Algebra.html#2524" class="Module">Monoid</a> <a id="999" href="Algebra.Solver.Monoid.html#307" class="Bound">M</a>
<a id="1001" class="Keyword">open</a> <a id="1006" href="Relation.Binary.EqReasoning.html" class="Module">Relation.Binary.EqReasoning</a> <a id="1034" href="Algebra.Structures.html#935" class="Function">setoid</a>

<a id="1042" class="Comment">------------------------------------------------------------------------</a>
<a id="1115" class="Comment">-- Monoid expressions</a>

<a id="1138" class="Comment">-- There is one constructor for every operation, plus one for</a>
<a id="1200" class="Comment">-- variables; there may be at most n variables.</a>

<a id="1249" class="Keyword">infixr</a> <a id="1256" class="Number">5</a> <a id="1258" href="Algebra.Solver.Monoid.html#1333" class="InductiveConstructor Operator">_⊕_</a>

<a id="1263" class="Keyword">data</a> <a id="Expr"></a><a id="1268" href="Algebra.Solver.Monoid.html#1268" class="Datatype">Expr</a> <a id="1273" class="Symbol">(</a><a id="1274" href="Algebra.Solver.Monoid.html#1274" class="Bound">n</a> <a id="1276" class="Symbol">:</a> <a id="1278" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="1279" class="Symbol">)</a> <a id="1281" class="Symbol">:</a> <a id="1283" class="PrimitiveType">Set</a> <a id="1287" class="Keyword">where</a>
  <a id="Expr.var"></a><a id="1295" href="Algebra.Solver.Monoid.html#1295" class="InductiveConstructor">var</a> <a id="1299" class="Symbol">:</a> <a id="1301" href="Data.Fin.Base.html#951" class="Datatype">Fin</a> <a id="1305" href="Algebra.Solver.Monoid.html#1274" class="Bound">n</a> <a id="1307" class="Symbol">→</a> <a id="1309" href="Algebra.Solver.Monoid.html#1268" class="Datatype">Expr</a> <a id="1314" href="Algebra.Solver.Monoid.html#1274" class="Bound">n</a>
  <a id="Expr.id"></a><a id="1318" href="Algebra.Solver.Monoid.html#1318" class="InductiveConstructor">id</a>  <a id="1322" class="Symbol">:</a> <a id="1324" href="Algebra.Solver.Monoid.html#1268" class="Datatype">Expr</a> <a id="1329" href="Algebra.Solver.Monoid.html#1274" class="Bound">n</a>
  <a id="Expr._⊕_"></a><a id="1333" href="Algebra.Solver.Monoid.html#1333" class="InductiveConstructor Operator">_⊕_</a> <a id="1337" class="Symbol">:</a> <a id="1339" href="Algebra.Solver.Monoid.html#1268" class="Datatype">Expr</a> <a id="1344" href="Algebra.Solver.Monoid.html#1274" class="Bound">n</a> <a id="1346" class="Symbol">→</a> <a id="1348" href="Algebra.Solver.Monoid.html#1268" class="Datatype">Expr</a> <a id="1353" href="Algebra.Solver.Monoid.html#1274" class="Bound">n</a> <a id="1355" class="Symbol">→</a> <a id="1357" href="Algebra.Solver.Monoid.html#1268" class="Datatype">Expr</a> <a id="1362" href="Algebra.Solver.Monoid.html#1274" class="Bound">n</a>

<a id="1365" class="Comment">-- An environment contains one value for every variable.</a>

<a id="Env"></a><a id="1423" href="Algebra.Solver.Monoid.html#1423" class="Function">Env</a> <a id="1427" class="Symbol">:</a> <a id="1429" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="1431" class="Symbol">→</a> <a id="1433" class="PrimitiveType">Set</a> <a id="1437" class="Symbol">_</a>
<a id="1439" href="Algebra.Solver.Monoid.html#1423" class="Function">Env</a> <a id="1443" href="Algebra.Solver.Monoid.html#1443" class="Bound">n</a> <a id="1445" class="Symbol">=</a> <a id="1447" href="Data.Vec.html#773" class="Datatype">Vec</a> <a id="1451" href="Algebra.html#2603" class="Field">Carrier</a> <a id="1459" href="Algebra.Solver.Monoid.html#1443" class="Bound">n</a>

<a id="1462" class="Comment">-- The semantics of an expression is a function from an environment to</a>
<a id="1533" class="Comment">-- a value.</a>

<a id="⟦_⟧"></a><a id="1546" href="Algebra.Solver.Monoid.html#1546" class="Function Operator">⟦_⟧</a> <a id="1550" class="Symbol">:</a> <a id="1552" class="Symbol">∀</a> <a id="1554" class="Symbol">{</a><a id="1555" href="Algebra.Solver.Monoid.html#1555" class="Bound">n</a><a id="1556" class="Symbol">}</a> <a id="1558" class="Symbol">→</a> <a id="1560" href="Algebra.Solver.Monoid.html#1268" class="Datatype">Expr</a> <a id="1565" href="Algebra.Solver.Monoid.html#1555" class="Bound">n</a> <a id="1567" class="Symbol">→</a> <a id="1569" href="Algebra.Solver.Monoid.html#1423" class="Function">Env</a> <a id="1573" href="Algebra.Solver.Monoid.html#1555" class="Bound">n</a> <a id="1575" class="Symbol">→</a> <a id="1577" href="Algebra.html#2603" class="Field">Carrier</a>
<a id="1585" href="Algebra.Solver.Monoid.html#1546" class="Function Operator">⟦</a> <a id="1587" href="Algebra.Solver.Monoid.html#1295" class="InductiveConstructor">var</a> <a id="1591" href="Algebra.Solver.Monoid.html#1591" class="Bound">x</a>   <a id="1595" href="Algebra.Solver.Monoid.html#1546" class="Function Operator">⟧</a> <a id="1597" href="Algebra.Solver.Monoid.html#1597" class="Bound">ρ</a> <a id="1599" class="Symbol">=</a> <a id="1601" href="Data.Vec.html#1379" class="Function">lookup</a> <a id="1608" href="Algebra.Solver.Monoid.html#1591" class="Bound">x</a> <a id="1610" href="Algebra.Solver.Monoid.html#1597" class="Bound">ρ</a>
<a id="1612" href="Algebra.Solver.Monoid.html#1546" class="Function Operator">⟦</a> <a id="1614" href="Algebra.Solver.Monoid.html#1318" class="InductiveConstructor">id</a>      <a id="1622" href="Algebra.Solver.Monoid.html#1546" class="Function Operator">⟧</a> <a id="1624" href="Algebra.Solver.Monoid.html#1624" class="Bound">ρ</a> <a id="1626" class="Symbol">=</a> <a id="1628" href="Algebra.html#2680" class="Field">ε</a>
<a id="1630" href="Algebra.Solver.Monoid.html#1546" class="Function Operator">⟦</a> <a id="1632" href="Algebra.Solver.Monoid.html#1632" class="Bound">e₁</a> <a id="1635" href="Algebra.Solver.Monoid.html#1333" class="InductiveConstructor Operator">⊕</a> <a id="1637" href="Algebra.Solver.Monoid.html#1637" class="Bound">e₂</a> <a id="1640" href="Algebra.Solver.Monoid.html#1546" class="Function Operator">⟧</a> <a id="1642" href="Algebra.Solver.Monoid.html#1642" class="Bound">ρ</a> <a id="1644" class="Symbol">=</a> <a id="1646" href="Algebra.Solver.Monoid.html#1546" class="Function Operator">⟦</a> <a id="1648" href="Algebra.Solver.Monoid.html#1632" class="Bound">e₁</a> <a id="1651" href="Algebra.Solver.Monoid.html#1546" class="Function Operator">⟧</a> <a id="1653" href="Algebra.Solver.Monoid.html#1642" class="Bound">ρ</a> <a id="1655" href="Algebra.html#2653" class="Field Operator">∙</a> <a id="1657" href="Algebra.Solver.Monoid.html#1546" class="Function Operator">⟦</a> <a id="1659" href="Algebra.Solver.Monoid.html#1637" class="Bound">e₂</a> <a id="1662" href="Algebra.Solver.Monoid.html#1546" class="Function Operator">⟧</a> <a id="1664" href="Algebra.Solver.Monoid.html#1642" class="Bound">ρ</a>

<a id="1667" class="Comment">------------------------------------------------------------------------</a>
<a id="1740" class="Comment">-- Normal forms</a>

<a id="1757" class="Comment">-- A normal form is a list of variables.</a>

<a id="Normal"></a><a id="1799" href="Algebra.Solver.Monoid.html#1799" class="Function">Normal</a> <a id="1806" class="Symbol">:</a> <a id="1808" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="1810" class="Symbol">→</a> <a id="1812" class="PrimitiveType">Set</a>
<a id="1816" href="Algebra.Solver.Monoid.html#1799" class="Function">Normal</a> <a id="1823" href="Algebra.Solver.Monoid.html#1823" class="Bound">n</a> <a id="1825" class="Symbol">=</a> <a id="1827" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="1832" class="Symbol">(</a><a id="1833" href="Data.Fin.Base.html#951" class="Datatype">Fin</a> <a id="1837" href="Algebra.Solver.Monoid.html#1823" class="Bound">n</a><a id="1838" class="Symbol">)</a>

<a id="1841" class="Comment">-- The semantics of a normal form.</a>

<a id="⟦_⟧⇓"></a><a id="1877" href="Algebra.Solver.Monoid.html#1877" class="Function Operator">⟦_⟧⇓</a> <a id="1882" class="Symbol">:</a> <a id="1884" class="Symbol">∀</a> <a id="1886" class="Symbol">{</a><a id="1887" href="Algebra.Solver.Monoid.html#1887" class="Bound">n</a><a id="1888" class="Symbol">}</a> <a id="1890" class="Symbol">→</a> <a id="1892" href="Algebra.Solver.Monoid.html#1799" class="Function">Normal</a> <a id="1899" href="Algebra.Solver.Monoid.html#1887" class="Bound">n</a> <a id="1901" class="Symbol">→</a> <a id="1903" href="Algebra.Solver.Monoid.html#1423" class="Function">Env</a> <a id="1907" href="Algebra.Solver.Monoid.html#1887" class="Bound">n</a> <a id="1909" class="Symbol">→</a> <a id="1911" href="Algebra.html#2603" class="Field">Carrier</a>
<a id="1919" href="Algebra.Solver.Monoid.html#1877" class="Function Operator">⟦</a> <a id="1921" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>     <a id="1928" href="Algebra.Solver.Monoid.html#1877" class="Function Operator">⟧⇓</a> <a id="1931" href="Algebra.Solver.Monoid.html#1931" class="Bound">ρ</a> <a id="1933" class="Symbol">=</a> <a id="1935" href="Algebra.html#2680" class="Field">ε</a>
<a id="1937" href="Algebra.Solver.Monoid.html#1877" class="Function Operator">⟦</a> <a id="1939" href="Algebra.Solver.Monoid.html#1939" class="Bound">x</a> <a id="1941" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="1943" href="Algebra.Solver.Monoid.html#1943" class="Bound">nf</a> <a id="1946" href="Algebra.Solver.Monoid.html#1877" class="Function Operator">⟧⇓</a> <a id="1949" href="Algebra.Solver.Monoid.html#1949" class="Bound">ρ</a> <a id="1951" class="Symbol">=</a> <a id="1953" href="Data.Vec.html#1379" class="Function">lookup</a> <a id="1960" href="Algebra.Solver.Monoid.html#1939" class="Bound">x</a> <a id="1962" href="Algebra.Solver.Monoid.html#1949" class="Bound">ρ</a> <a id="1964" href="Algebra.html#2653" class="Field Operator">∙</a> <a id="1966" href="Algebra.Solver.Monoid.html#1877" class="Function Operator">⟦</a> <a id="1968" href="Algebra.Solver.Monoid.html#1943" class="Bound">nf</a> <a id="1971" href="Algebra.Solver.Monoid.html#1877" class="Function Operator">⟧⇓</a> <a id="1974" href="Algebra.Solver.Monoid.html#1949" class="Bound">ρ</a>

<a id="1977" class="Comment">-- A normaliser.</a>

<a id="normalise"></a><a id="1995" href="Algebra.Solver.Monoid.html#1995" class="Function">normalise</a> <a id="2005" class="Symbol">:</a> <a id="2007" class="Symbol">∀</a> <a id="2009" class="Symbol">{</a><a id="2010" href="Algebra.Solver.Monoid.html#2010" class="Bound">n</a><a id="2011" class="Symbol">}</a> <a id="2013" class="Symbol">→</a> <a id="2015" href="Algebra.Solver.Monoid.html#1268" class="Datatype">Expr</a> <a id="2020" href="Algebra.Solver.Monoid.html#2010" class="Bound">n</a> <a id="2022" class="Symbol">→</a> <a id="2024" href="Algebra.Solver.Monoid.html#1799" class="Function">Normal</a> <a id="2031" href="Algebra.Solver.Monoid.html#2010" class="Bound">n</a>
<a id="2033" href="Algebra.Solver.Monoid.html#1995" class="Function">normalise</a> <a id="2043" class="Symbol">(</a><a id="2044" href="Algebra.Solver.Monoid.html#1295" class="InductiveConstructor">var</a> <a id="2048" href="Algebra.Solver.Monoid.html#2048" class="Bound">x</a><a id="2049" class="Symbol">)</a>   <a id="2053" class="Symbol">=</a> <a id="2055" href="Algebra.Solver.Monoid.html#2048" class="Bound">x</a> <a id="2057" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="2059" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
<a id="2062" href="Algebra.Solver.Monoid.html#1995" class="Function">normalise</a> <a id="2072" href="Algebra.Solver.Monoid.html#1318" class="InductiveConstructor">id</a>        <a id="2082" class="Symbol">=</a> <a id="2084" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
<a id="2087" href="Algebra.Solver.Monoid.html#1995" class="Function">normalise</a> <a id="2097" class="Symbol">(</a><a id="2098" href="Algebra.Solver.Monoid.html#2098" class="Bound">e₁</a> <a id="2101" href="Algebra.Solver.Monoid.html#1333" class="InductiveConstructor Operator">⊕</a> <a id="2103" href="Algebra.Solver.Monoid.html#2103" class="Bound">e₂</a><a id="2105" class="Symbol">)</a> <a id="2107" class="Symbol">=</a> <a id="2109" href="Algebra.Solver.Monoid.html#1995" class="Function">normalise</a> <a id="2119" href="Algebra.Solver.Monoid.html#2098" class="Bound">e₁</a> <a id="2122" href="Data.List.Base.html#1538" class="Function Operator">++</a> <a id="2125" href="Algebra.Solver.Monoid.html#1995" class="Function">normalise</a> <a id="2135" href="Algebra.Solver.Monoid.html#2103" class="Bound">e₂</a>

<a id="2139" class="Comment">-- The normaliser is homomorphic with respect to _++_/_∙_.</a>

<a id="homomorphic"></a><a id="2199" href="Algebra.Solver.Monoid.html#2199" class="Function">homomorphic</a> <a id="2211" class="Symbol">:</a> <a id="2213" class="Symbol">∀</a> <a id="2215" class="Symbol">{</a><a id="2216" href="Algebra.Solver.Monoid.html#2216" class="Bound">n</a><a id="2217" class="Symbol">}</a> <a id="2219" class="Symbol">(</a><a id="2220" href="Algebra.Solver.Monoid.html#2220" class="Bound">nf₁</a> <a id="2224" href="Algebra.Solver.Monoid.html#2224" class="Bound">nf₂</a> <a id="2228" class="Symbol">:</a> <a id="2230" href="Algebra.Solver.Monoid.html#1799" class="Function">Normal</a> <a id="2237" href="Algebra.Solver.Monoid.html#2216" class="Bound">n</a><a id="2238" class="Symbol">)</a> <a id="2240" class="Symbol">(</a><a id="2241" href="Algebra.Solver.Monoid.html#2241" class="Bound">ρ</a> <a id="2243" class="Symbol">:</a> <a id="2245" href="Algebra.Solver.Monoid.html#1423" class="Function">Env</a> <a id="2249" href="Algebra.Solver.Monoid.html#2216" class="Bound">n</a><a id="2250" class="Symbol">)</a> <a id="2252" class="Symbol">→</a>
              <a id="2268" href="Algebra.Solver.Monoid.html#1877" class="Function Operator">⟦</a> <a id="2270" href="Algebra.Solver.Monoid.html#2220" class="Bound">nf₁</a> <a id="2274" href="Data.List.Base.html#1538" class="Function Operator">++</a> <a id="2277" href="Algebra.Solver.Monoid.html#2224" class="Bound">nf₂</a> <a id="2281" href="Algebra.Solver.Monoid.html#1877" class="Function Operator">⟧⇓</a> <a id="2284" href="Algebra.Solver.Monoid.html#2241" class="Bound">ρ</a> <a id="2286" href="Algebra.html#2624" class="Field Operator">≈</a> <a id="2288" class="Symbol">(</a><a id="2289" href="Algebra.Solver.Monoid.html#1877" class="Function Operator">⟦</a> <a id="2291" href="Algebra.Solver.Monoid.html#2220" class="Bound">nf₁</a> <a id="2295" href="Algebra.Solver.Monoid.html#1877" class="Function Operator">⟧⇓</a> <a id="2298" href="Algebra.Solver.Monoid.html#2241" class="Bound">ρ</a> <a id="2300" href="Algebra.html#2653" class="Field Operator">∙</a> <a id="2302" href="Algebra.Solver.Monoid.html#1877" class="Function Operator">⟦</a> <a id="2304" href="Algebra.Solver.Monoid.html#2224" class="Bound">nf₂</a> <a id="2308" href="Algebra.Solver.Monoid.html#1877" class="Function Operator">⟧⇓</a> <a id="2311" href="Algebra.Solver.Monoid.html#2241" class="Bound">ρ</a><a id="2312" class="Symbol">)</a>
<a id="2314" href="Algebra.Solver.Monoid.html#2199" class="Function">homomorphic</a> <a id="2326" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a> <a id="2329" href="Algebra.Solver.Monoid.html#2329" class="Bound">nf₂</a> <a id="2333" href="Algebra.Solver.Monoid.html#2333" class="Bound">ρ</a> <a id="2335" class="Symbol">=</a> <a id="2337" href="Relation.Binary.PreorderReasoning.html#1264" class="Function Operator">begin</a>
  <a id="2345" href="Algebra.Solver.Monoid.html#1877" class="Function Operator">⟦</a> <a id="2347" href="Algebra.Solver.Monoid.html#2329" class="Bound">nf₂</a> <a id="2351" href="Algebra.Solver.Monoid.html#1877" class="Function Operator">⟧⇓</a> <a id="2354" href="Algebra.Solver.Monoid.html#2333" class="Bound">ρ</a>      <a id="2361" href="Relation.Binary.PreorderReasoning.html#1330" class="Function Operator">≈⟨</a> <a id="2364" href="Relation.Binary.Core.html#5653" class="Function">sym</a> <a id="2368" href="Function.html#1927" class="Function Operator">$</a> <a id="2370" href="Algebra.Structures.html#1853" class="Function">identityˡ</a> <a id="2380" class="Symbol">_</a> <a id="2382" href="Relation.Binary.PreorderReasoning.html#1330" class="Function Operator">⟩</a>
  <a id="2386" href="Algebra.html#2680" class="Field">ε</a> <a id="2388" href="Algebra.html#2653" class="Field Operator">∙</a> <a id="2390" href="Algebra.Solver.Monoid.html#1877" class="Function Operator">⟦</a> <a id="2392" href="Algebra.Solver.Monoid.html#2329" class="Bound">nf₂</a> <a id="2396" href="Algebra.Solver.Monoid.html#1877" class="Function Operator">⟧⇓</a> <a id="2399" href="Algebra.Solver.Monoid.html#2333" class="Bound">ρ</a>  <a id="2402" href="Relation.Binary.PreorderReasoning.html#1717" class="Function Operator">∎</a>
<a id="2404" href="Algebra.Solver.Monoid.html#2199" class="Function">homomorphic</a> <a id="2416" class="Symbol">(</a><a id="2417" href="Algebra.Solver.Monoid.html#2417" class="Bound">x</a> <a id="2419" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="2421" href="Algebra.Solver.Monoid.html#2421" class="Bound">nf₁</a><a id="2424" class="Symbol">)</a> <a id="2426" href="Algebra.Solver.Monoid.html#2426" class="Bound">nf₂</a> <a id="2430" href="Algebra.Solver.Monoid.html#2430" class="Bound">ρ</a> <a id="2432" class="Symbol">=</a> <a id="2434" href="Relation.Binary.PreorderReasoning.html#1264" class="Function Operator">begin</a>
  <a id="2442" href="Data.Vec.html#1379" class="Function">lookup</a> <a id="2449" href="Algebra.Solver.Monoid.html#2417" class="Bound">x</a> <a id="2451" href="Algebra.Solver.Monoid.html#2430" class="Bound">ρ</a> <a id="2453" href="Algebra.html#2653" class="Field Operator">∙</a> <a id="2455" href="Algebra.Solver.Monoid.html#1877" class="Function Operator">⟦</a> <a id="2457" href="Algebra.Solver.Monoid.html#2421" class="Bound">nf₁</a> <a id="2461" href="Data.List.Base.html#1538" class="Function Operator">++</a> <a id="2464" href="Algebra.Solver.Monoid.html#2426" class="Bound">nf₂</a> <a id="2468" href="Algebra.Solver.Monoid.html#1877" class="Function Operator">⟧⇓</a> <a id="2471" href="Algebra.Solver.Monoid.html#2430" class="Bound">ρ</a>          <a id="2482" href="Relation.Binary.PreorderReasoning.html#1330" class="Function Operator">≈⟨</a> <a id="2485" href="Algebra.Structures.html#860" class="Function">∙-cong</a> <a id="2492" href="Relation.Binary.Core.html#5627" class="Function">refl</a> <a id="2497" class="Symbol">(</a><a id="2498" href="Algebra.Solver.Monoid.html#2199" class="Function">homomorphic</a> <a id="2510" href="Algebra.Solver.Monoid.html#2421" class="Bound">nf₁</a> <a id="2514" href="Algebra.Solver.Monoid.html#2426" class="Bound">nf₂</a> <a id="2518" href="Algebra.Solver.Monoid.html#2430" class="Bound">ρ</a><a id="2519" class="Symbol">)</a> <a id="2521" href="Relation.Binary.PreorderReasoning.html#1330" class="Function Operator">⟩</a>
  <a id="2525" href="Data.Vec.html#1379" class="Function">lookup</a> <a id="2532" href="Algebra.Solver.Monoid.html#2417" class="Bound">x</a> <a id="2534" href="Algebra.Solver.Monoid.html#2430" class="Bound">ρ</a> <a id="2536" href="Algebra.html#2653" class="Field Operator">∙</a> <a id="2538" class="Symbol">(</a><a id="2539" href="Algebra.Solver.Monoid.html#1877" class="Function Operator">⟦</a> <a id="2541" href="Algebra.Solver.Monoid.html#2421" class="Bound">nf₁</a> <a id="2545" href="Algebra.Solver.Monoid.html#1877" class="Function Operator">⟧⇓</a> <a id="2548" href="Algebra.Solver.Monoid.html#2430" class="Bound">ρ</a> <a id="2550" href="Algebra.html#2653" class="Field Operator">∙</a> <a id="2552" href="Algebra.Solver.Monoid.html#1877" class="Function Operator">⟦</a> <a id="2554" href="Algebra.Solver.Monoid.html#2426" class="Bound">nf₂</a> <a id="2558" href="Algebra.Solver.Monoid.html#1877" class="Function Operator">⟧⇓</a> <a id="2561" href="Algebra.Solver.Monoid.html#2430" class="Bound">ρ</a><a id="2562" class="Symbol">)</a>  <a id="2565" href="Relation.Binary.PreorderReasoning.html#1330" class="Function Operator">≈⟨</a> <a id="2568" href="Relation.Binary.Core.html#5653" class="Function">sym</a> <a id="2572" href="Function.html#1927" class="Function Operator">$</a> <a id="2574" href="Algebra.Structures.html#1218" class="Function">assoc</a> <a id="2580" class="Symbol">_</a> <a id="2582" class="Symbol">_</a> <a id="2584" class="Symbol">_</a> <a id="2586" href="Relation.Binary.PreorderReasoning.html#1330" class="Function Operator">⟩</a>
  <a id="2590" href="Data.Vec.html#1379" class="Function">lookup</a> <a id="2597" href="Algebra.Solver.Monoid.html#2417" class="Bound">x</a> <a id="2599" href="Algebra.Solver.Monoid.html#2430" class="Bound">ρ</a> <a id="2601" href="Algebra.html#2653" class="Field Operator">∙</a> <a id="2603" href="Algebra.Solver.Monoid.html#1877" class="Function Operator">⟦</a> <a id="2605" href="Algebra.Solver.Monoid.html#2421" class="Bound">nf₁</a> <a id="2609" href="Algebra.Solver.Monoid.html#1877" class="Function Operator">⟧⇓</a> <a id="2612" href="Algebra.Solver.Monoid.html#2430" class="Bound">ρ</a> <a id="2614" href="Algebra.html#2653" class="Field Operator">∙</a> <a id="2616" href="Algebra.Solver.Monoid.html#1877" class="Function Operator">⟦</a> <a id="2618" href="Algebra.Solver.Monoid.html#2426" class="Bound">nf₂</a> <a id="2622" href="Algebra.Solver.Monoid.html#1877" class="Function Operator">⟧⇓</a> <a id="2625" href="Algebra.Solver.Monoid.html#2430" class="Bound">ρ</a>    <a id="2630" href="Relation.Binary.PreorderReasoning.html#1717" class="Function Operator">∎</a>

<a id="2633" class="Comment">-- The normaliser preserves the semantics of the expression.</a>

<a id="normalise-correct"></a><a id="2695" href="Algebra.Solver.Monoid.html#2695" class="Function">normalise-correct</a> <a id="2713" class="Symbol">:</a>
  <a id="2717" class="Symbol">∀</a> <a id="2719" class="Symbol">{</a><a id="2720" href="Algebra.Solver.Monoid.html#2720" class="Bound">n</a><a id="2721" class="Symbol">}</a> <a id="2723" class="Symbol">(</a><a id="2724" href="Algebra.Solver.Monoid.html#2724" class="Bound">e</a> <a id="2726" class="Symbol">:</a> <a id="2728" href="Algebra.Solver.Monoid.html#1268" class="Datatype">Expr</a> <a id="2733" href="Algebra.Solver.Monoid.html#2720" class="Bound">n</a><a id="2734" class="Symbol">)</a> <a id="2736" class="Symbol">(</a><a id="2737" href="Algebra.Solver.Monoid.html#2737" class="Bound">ρ</a> <a id="2739" class="Symbol">:</a> <a id="2741" href="Algebra.Solver.Monoid.html#1423" class="Function">Env</a> <a id="2745" href="Algebra.Solver.Monoid.html#2720" class="Bound">n</a><a id="2746" class="Symbol">)</a> <a id="2748" class="Symbol">→</a> <a id="2750" href="Algebra.Solver.Monoid.html#1877" class="Function Operator">⟦</a> <a id="2752" href="Algebra.Solver.Monoid.html#1995" class="Function">normalise</a> <a id="2762" href="Algebra.Solver.Monoid.html#2724" class="Bound">e</a> <a id="2764" href="Algebra.Solver.Monoid.html#1877" class="Function Operator">⟧⇓</a> <a id="2767" href="Algebra.Solver.Monoid.html#2737" class="Bound">ρ</a> <a id="2769" href="Algebra.html#2624" class="Field Operator">≈</a> <a id="2771" href="Algebra.Solver.Monoid.html#1546" class="Function Operator">⟦</a> <a id="2773" href="Algebra.Solver.Monoid.html#2724" class="Bound">e</a> <a id="2775" href="Algebra.Solver.Monoid.html#1546" class="Function Operator">⟧</a> <a id="2777" href="Algebra.Solver.Monoid.html#2737" class="Bound">ρ</a>
<a id="2779" href="Algebra.Solver.Monoid.html#2695" class="Function">normalise-correct</a> <a id="2797" class="Symbol">(</a><a id="2798" href="Algebra.Solver.Monoid.html#1295" class="InductiveConstructor">var</a> <a id="2802" href="Algebra.Solver.Monoid.html#2802" class="Bound">x</a><a id="2803" class="Symbol">)</a> <a id="2805" href="Algebra.Solver.Monoid.html#2805" class="Bound">ρ</a> <a id="2807" class="Symbol">=</a> <a id="2809" href="Relation.Binary.PreorderReasoning.html#1264" class="Function Operator">begin</a>
  <a id="2817" href="Data.Vec.html#1379" class="Function">lookup</a> <a id="2824" href="Algebra.Solver.Monoid.html#2802" class="Bound">x</a> <a id="2826" href="Algebra.Solver.Monoid.html#2805" class="Bound">ρ</a> <a id="2828" href="Algebra.html#2653" class="Field Operator">∙</a> <a id="2830" href="Algebra.html#2680" class="Field">ε</a>  <a id="2833" href="Relation.Binary.PreorderReasoning.html#1330" class="Function Operator">≈⟨</a> <a id="2836" href="Algebra.Structures.html#1914" class="Function">identityʳ</a> <a id="2846" class="Symbol">_</a> <a id="2848" href="Relation.Binary.PreorderReasoning.html#1330" class="Function Operator">⟩</a>
  <a id="2852" href="Data.Vec.html#1379" class="Function">lookup</a> <a id="2859" href="Algebra.Solver.Monoid.html#2802" class="Bound">x</a> <a id="2861" href="Algebra.Solver.Monoid.html#2805" class="Bound">ρ</a>      <a id="2868" href="Relation.Binary.PreorderReasoning.html#1717" class="Function Operator">∎</a>
<a id="2870" href="Algebra.Solver.Monoid.html#2695" class="Function">normalise-correct</a> <a id="2888" href="Algebra.Solver.Monoid.html#1318" class="InductiveConstructor">id</a> <a id="2891" href="Algebra.Solver.Monoid.html#2891" class="Bound">ρ</a> <a id="2893" class="Symbol">=</a> <a id="2895" href="Relation.Binary.PreorderReasoning.html#1264" class="Function Operator">begin</a>
  <a id="2903" href="Algebra.html#2680" class="Field">ε</a>  <a id="2906" href="Relation.Binary.PreorderReasoning.html#1717" class="Function Operator">∎</a>
<a id="2908" href="Algebra.Solver.Monoid.html#2695" class="Function">normalise-correct</a> <a id="2926" class="Symbol">(</a><a id="2927" href="Algebra.Solver.Monoid.html#2927" class="Bound">e₁</a> <a id="2930" href="Algebra.Solver.Monoid.html#1333" class="InductiveConstructor Operator">⊕</a> <a id="2932" href="Algebra.Solver.Monoid.html#2932" class="Bound">e₂</a><a id="2934" class="Symbol">)</a> <a id="2936" href="Algebra.Solver.Monoid.html#2936" class="Bound">ρ</a> <a id="2938" class="Symbol">=</a> <a id="2940" href="Relation.Binary.PreorderReasoning.html#1264" class="Function Operator">begin</a>
  <a id="2948" href="Algebra.Solver.Monoid.html#1877" class="Function Operator">⟦</a> <a id="2950" href="Algebra.Solver.Monoid.html#1995" class="Function">normalise</a> <a id="2960" href="Algebra.Solver.Monoid.html#2927" class="Bound">e₁</a> <a id="2963" href="Data.List.Base.html#1538" class="Function Operator">++</a> <a id="2966" href="Algebra.Solver.Monoid.html#1995" class="Function">normalise</a> <a id="2976" href="Algebra.Solver.Monoid.html#2932" class="Bound">e₂</a> <a id="2979" href="Algebra.Solver.Monoid.html#1877" class="Function Operator">⟧⇓</a> <a id="2982" href="Algebra.Solver.Monoid.html#2936" class="Bound">ρ</a>        <a id="2991" href="Relation.Binary.PreorderReasoning.html#1330" class="Function Operator">≈⟨</a> <a id="2994" href="Algebra.Solver.Monoid.html#2199" class="Function">homomorphic</a> <a id="3006" class="Symbol">(</a><a id="3007" href="Algebra.Solver.Monoid.html#1995" class="Function">normalise</a> <a id="3017" href="Algebra.Solver.Monoid.html#2927" class="Bound">e₁</a><a id="3019" class="Symbol">)</a> <a id="3021" class="Symbol">(</a><a id="3022" href="Algebra.Solver.Monoid.html#1995" class="Function">normalise</a> <a id="3032" href="Algebra.Solver.Monoid.html#2932" class="Bound">e₂</a><a id="3034" class="Symbol">)</a> <a id="3036" href="Algebra.Solver.Monoid.html#2936" class="Bound">ρ</a> <a id="3038" href="Relation.Binary.PreorderReasoning.html#1330" class="Function Operator">⟩</a>
  <a id="3042" href="Algebra.Solver.Monoid.html#1877" class="Function Operator">⟦</a> <a id="3044" href="Algebra.Solver.Monoid.html#1995" class="Function">normalise</a> <a id="3054" href="Algebra.Solver.Monoid.html#2927" class="Bound">e₁</a> <a id="3057" href="Algebra.Solver.Monoid.html#1877" class="Function Operator">⟧⇓</a> <a id="3060" href="Algebra.Solver.Monoid.html#2936" class="Bound">ρ</a> <a id="3062" href="Algebra.html#2653" class="Field Operator">∙</a> <a id="3064" href="Algebra.Solver.Monoid.html#1877" class="Function Operator">⟦</a> <a id="3066" href="Algebra.Solver.Monoid.html#1995" class="Function">normalise</a> <a id="3076" href="Algebra.Solver.Monoid.html#2932" class="Bound">e₂</a> <a id="3079" href="Algebra.Solver.Monoid.html#1877" class="Function Operator">⟧⇓</a> <a id="3082" href="Algebra.Solver.Monoid.html#2936" class="Bound">ρ</a>  <a id="3085" href="Relation.Binary.PreorderReasoning.html#1330" class="Function Operator">≈⟨</a> <a id="3088" href="Algebra.Structures.html#860" class="Function">∙-cong</a> <a id="3095" class="Symbol">(</a><a id="3096" href="Algebra.Solver.Monoid.html#2695" class="Function">normalise-correct</a> <a id="3114" href="Algebra.Solver.Monoid.html#2927" class="Bound">e₁</a> <a id="3117" href="Algebra.Solver.Monoid.html#2936" class="Bound">ρ</a><a id="3118" class="Symbol">)</a> <a id="3120" class="Symbol">(</a><a id="3121" href="Algebra.Solver.Monoid.html#2695" class="Function">normalise-correct</a> <a id="3139" href="Algebra.Solver.Monoid.html#2932" class="Bound">e₂</a> <a id="3142" href="Algebra.Solver.Monoid.html#2936" class="Bound">ρ</a><a id="3143" class="Symbol">)</a> <a id="3145" href="Relation.Binary.PreorderReasoning.html#1330" class="Function Operator">⟩</a>
  <a id="3149" href="Algebra.Solver.Monoid.html#1546" class="Function Operator">⟦</a> <a id="3151" href="Algebra.Solver.Monoid.html#2927" class="Bound">e₁</a> <a id="3154" href="Algebra.Solver.Monoid.html#1546" class="Function Operator">⟧</a> <a id="3156" href="Algebra.Solver.Monoid.html#2936" class="Bound">ρ</a> <a id="3158" href="Algebra.html#2653" class="Field Operator">∙</a> <a id="3160" href="Algebra.Solver.Monoid.html#1546" class="Function Operator">⟦</a> <a id="3162" href="Algebra.Solver.Monoid.html#2932" class="Bound">e₂</a> <a id="3165" href="Algebra.Solver.Monoid.html#1546" class="Function Operator">⟧</a> <a id="3167" href="Algebra.Solver.Monoid.html#2936" class="Bound">ρ</a>                        <a id="3192" href="Relation.Binary.PreorderReasoning.html#1717" class="Function Operator">∎</a>

<a id="3195" class="Comment">------------------------------------------------------------------------</a>
<a id="3268" class="Comment">-- &quot;Tactics&quot;</a>

<a id="3282" class="Keyword">open</a> <a id="3287" class="Keyword">module</a> <a id="R"></a><a id="3294" href="Algebra.Solver.Monoid.html#3294" class="Module">R</a> <a id="3296" class="Symbol">=</a> <a id="3298" href="Relation.Binary.Reflection.html" class="Module">Relation.Binary.Reflection</a>
                  <a id="3343" href="Algebra.Structures.html#935" class="Function">setoid</a> <a id="3350" href="Algebra.Solver.Monoid.html#1295" class="InductiveConstructor">var</a> <a id="3354" href="Algebra.Solver.Monoid.html#1546" class="Function Operator">⟦_⟧</a> <a id="3358" class="Symbol">(</a><a id="3359" href="Algebra.Solver.Monoid.html#1877" class="Function Operator">⟦_⟧⇓</a> <a id="3364" href="Function.html#805" class="Function Operator">∘</a> <a id="3366" href="Algebra.Solver.Monoid.html#1995" class="Function">normalise</a><a id="3375" class="Symbol">)</a> <a id="3377" href="Algebra.Solver.Monoid.html#2695" class="Function">normalise-correct</a>
  <a id="3397" class="Keyword">public</a> <a id="3404" class="Keyword">using</a> <a id="3410" class="Symbol">(</a><a id="3411" href="Relation.Binary.Reflection.html#2418" class="Function">solve</a><a id="3416" class="Symbol">;</a> <a id="3418" href="Relation.Binary.Reflection.html#3527" class="Function Operator">_⊜_</a><a id="3421" class="Symbol">)</a>

<a id="3424" class="Comment">-- We can decide if two normal forms are /syntactically/ equal.</a>

<a id="3489" class="Keyword">infix</a> <a id="3495" class="Number">5</a> <a id="3497" href="Algebra.Solver.Monoid.html#3502" class="Function Operator">_≟_</a>

<a id="_≟_"></a><a id="3502" href="Algebra.Solver.Monoid.html#3502" class="Function Operator">_≟_</a> <a id="3506" class="Symbol">:</a> <a id="3508" class="Symbol">∀</a> <a id="3510" class="Symbol">{</a><a id="3511" href="Algebra.Solver.Monoid.html#3511" class="Bound">n</a><a id="3512" class="Symbol">}</a> <a id="3514" class="Symbol">→</a> <a id="3516" href="Relation.Binary.Core.html#4722" class="Function">Decidable</a> <a id="3526" class="Symbol">{</a><a id="3527" class="Argument">A</a> <a id="3529" class="Symbol">=</a> <a id="3531" href="Algebra.Solver.Monoid.html#1799" class="Function">Normal</a> <a id="3538" href="Algebra.Solver.Monoid.html#3511" class="Bound">n</a><a id="3539" class="Symbol">}</a> <a id="3541" href="Agda.Builtin.Equality.html#83" class="Datatype Operator">_≡_</a>
<a id="3545" href="Algebra.Solver.Monoid.html#3545" class="Bound">nf₁</a> <a id="3549" href="Algebra.Solver.Monoid.html#3502" class="Function Operator">≟</a> <a id="3551" href="Algebra.Solver.Monoid.html#3551" class="Bound">nf₂</a> <a id="3555" class="Symbol">=</a> <a id="3557" href="Relation.Nullary.Decidable.html#1837" class="Function">Dec.map′</a> <a id="3566" href="Data.List.Relation.Equality.Propositional.html#767" class="Function">≋⇒≡</a> <a id="3570" href="Data.List.Relation.Equality.Propositional.html#855" class="Function">≡⇒≋</a> <a id="3574" class="Symbol">(</a><a id="3575" href="Algebra.Solver.Monoid.html#3545" class="Bound">nf₁</a> <a id="3579" href="Data.List.Relation.Equality.DecSetoid.html#850" class="Function Operator">≋?</a> <a id="3582" href="Algebra.Solver.Monoid.html#3551" class="Bound">nf₂</a><a id="3585" class="Symbol">)</a>
  <a id="3589" class="Keyword">where</a> <a id="3595" class="Keyword">open</a> <a id="3600" href="Data.List.Relation.Equality.DecPropositional.html" class="Module">ListEq</a> <a id="3607" href="Data.Fin.Properties.html#1730" class="Function Operator">Fin._≟_</a>

<a id="3616" class="Comment">-- We can also give a sound, but not necessarily complete, procedure</a>
<a id="3685" class="Comment">-- for determining if two expressions have the same semantics.</a>

<a id="prove′"></a><a id="3749" href="Algebra.Solver.Monoid.html#3749" class="Function">prove′</a> <a id="3756" class="Symbol">:</a> <a id="3758" class="Symbol">∀</a> <a id="3760" class="Symbol">{</a><a id="3761" href="Algebra.Solver.Monoid.html#3761" class="Bound">n</a><a id="3762" class="Symbol">}</a> <a id="3764" class="Symbol">(</a><a id="3765" href="Algebra.Solver.Monoid.html#3765" class="Bound">e₁</a> <a id="3768" href="Algebra.Solver.Monoid.html#3768" class="Bound">e₂</a> <a id="3771" class="Symbol">:</a> <a id="3773" href="Algebra.Solver.Monoid.html#1268" class="Datatype">Expr</a> <a id="3778" href="Algebra.Solver.Monoid.html#3761" class="Bound">n</a><a id="3779" class="Symbol">)</a> <a id="3781" class="Symbol">→</a> <a id="3783" href="Data.Maybe.Base.html#710" class="Datatype">Maybe</a> <a id="3789" class="Symbol">(∀</a> <a id="3792" href="Algebra.Solver.Monoid.html#3792" class="Bound">ρ</a> <a id="3794" class="Symbol">→</a> <a id="3796" href="Algebra.Solver.Monoid.html#1546" class="Function Operator">⟦</a> <a id="3798" href="Algebra.Solver.Monoid.html#3765" class="Bound">e₁</a> <a id="3801" href="Algebra.Solver.Monoid.html#1546" class="Function Operator">⟧</a> <a id="3803" href="Algebra.Solver.Monoid.html#3792" class="Bound">ρ</a> <a id="3805" href="Algebra.html#2624" class="Field Operator">≈</a> <a id="3807" href="Algebra.Solver.Monoid.html#1546" class="Function Operator">⟦</a> <a id="3809" href="Algebra.Solver.Monoid.html#3768" class="Bound">e₂</a> <a id="3812" href="Algebra.Solver.Monoid.html#1546" class="Function Operator">⟧</a> <a id="3814" href="Algebra.Solver.Monoid.html#3792" class="Bound">ρ</a><a id="3815" class="Symbol">)</a>
<a id="3817" href="Algebra.Solver.Monoid.html#3749" class="Function">prove′</a> <a id="3824" href="Algebra.Solver.Monoid.html#3824" class="Bound">e₁</a> <a id="3827" href="Algebra.Solver.Monoid.html#3827" class="Bound">e₂</a> <a id="3830" class="Symbol">=</a>
  <a id="3834" href="Data.Maybe.Base.html#2139" class="Function">Maybe.map</a> <a id="3844" href="Algebra.Solver.Monoid.html#3903" class="Function">lemma</a> <a id="3850" href="Function.html#1927" class="Function Operator">$</a> <a id="3852" href="Data.Maybe.Base.html#1285" class="Function">decToMaybe</a> <a id="3863" class="Symbol">(</a><a id="3864" href="Algebra.Solver.Monoid.html#1995" class="Function">normalise</a> <a id="3874" href="Algebra.Solver.Monoid.html#3824" class="Bound">e₁</a> <a id="3877" href="Algebra.Solver.Monoid.html#3502" class="Function Operator">≟</a> <a id="3879" href="Algebra.Solver.Monoid.html#1995" class="Function">normalise</a> <a id="3889" href="Algebra.Solver.Monoid.html#3827" class="Bound">e₂</a><a id="3891" class="Symbol">)</a>
  <a id="3895" class="Keyword">where</a>
  <a id="3903" href="Algebra.Solver.Monoid.html#3903" class="Function">lemma</a> <a id="3909" class="Symbol">:</a> <a id="3911" href="Algebra.Solver.Monoid.html#1995" class="Function">normalise</a> <a id="3921" href="Algebra.Solver.Monoid.html#3824" class="Bound">e₁</a> <a id="3924" href="Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="3926" href="Algebra.Solver.Monoid.html#1995" class="Function">normalise</a> <a id="3936" href="Algebra.Solver.Monoid.html#3827" class="Bound">e₂</a> <a id="3939" class="Symbol">→</a> <a id="3941" class="Symbol">∀</a> <a id="3943" href="Algebra.Solver.Monoid.html#3943" class="Bound">ρ</a> <a id="3945" class="Symbol">→</a> <a id="3947" href="Algebra.Solver.Monoid.html#1546" class="Function Operator">⟦</a> <a id="3949" href="Algebra.Solver.Monoid.html#3824" class="Bound">e₁</a> <a id="3952" href="Algebra.Solver.Monoid.html#1546" class="Function Operator">⟧</a> <a id="3954" href="Algebra.Solver.Monoid.html#3943" class="Bound">ρ</a> <a id="3956" href="Algebra.html#2624" class="Field Operator">≈</a> <a id="3958" href="Algebra.Solver.Monoid.html#1546" class="Function Operator">⟦</a> <a id="3960" href="Algebra.Solver.Monoid.html#3827" class="Bound">e₂</a> <a id="3963" href="Algebra.Solver.Monoid.html#1546" class="Function Operator">⟧</a> <a id="3965" href="Algebra.Solver.Monoid.html#3943" class="Bound">ρ</a>
  <a id="3969" href="Algebra.Solver.Monoid.html#3903" class="Function">lemma</a> <a id="3975" href="Algebra.Solver.Monoid.html#3975" class="Bound">eq</a> <a id="3978" href="Algebra.Solver.Monoid.html#3978" class="Bound">ρ</a> <a id="3980" class="Symbol">=</a>
    <a id="3986" href="Relation.Binary.Reflection.html#1732" class="Function">R.prove</a> <a id="3994" href="Algebra.Solver.Monoid.html#3978" class="Bound">ρ</a> <a id="3996" href="Algebra.Solver.Monoid.html#3824" class="Bound">e₁</a> <a id="3999" href="Algebra.Solver.Monoid.html#3827" class="Bound">e₂</a> <a id="4002" class="Symbol">(</a><a id="4003" href="Relation.Binary.PreorderReasoning.html#1264" class="Function Operator">begin</a>
      <a id="4015" href="Algebra.Solver.Monoid.html#1877" class="Function Operator">⟦</a> <a id="4017" href="Algebra.Solver.Monoid.html#1995" class="Function">normalise</a> <a id="4027" href="Algebra.Solver.Monoid.html#3824" class="Bound">e₁</a> <a id="4030" href="Algebra.Solver.Monoid.html#1877" class="Function Operator">⟧⇓</a> <a id="4033" href="Algebra.Solver.Monoid.html#3978" class="Bound">ρ</a>  <a id="4036" href="Relation.Binary.PreorderReasoning.html#1560" class="Function Operator">≡⟨</a> <a id="4039" href="Relation.Binary.PropositionalEquality.html#1134" class="Function">P.cong</a> <a id="4046" class="Symbol">(λ</a> <a id="4049" href="Algebra.Solver.Monoid.html#4049" class="Bound">e</a> <a id="4051" class="Symbol">→</a> <a id="4053" href="Algebra.Solver.Monoid.html#1877" class="Function Operator">⟦</a> <a id="4055" href="Algebra.Solver.Monoid.html#4049" class="Bound">e</a> <a id="4057" href="Algebra.Solver.Monoid.html#1877" class="Function Operator">⟧⇓</a> <a id="4060" href="Algebra.Solver.Monoid.html#3978" class="Bound">ρ</a><a id="4061" class="Symbol">)</a> <a id="4063" href="Algebra.Solver.Monoid.html#3975" class="Bound">eq</a> <a id="4066" href="Relation.Binary.PreorderReasoning.html#1560" class="Function Operator">⟩</a>
      <a id="4074" href="Algebra.Solver.Monoid.html#1877" class="Function Operator">⟦</a> <a id="4076" href="Algebra.Solver.Monoid.html#1995" class="Function">normalise</a> <a id="4086" href="Algebra.Solver.Monoid.html#3827" class="Bound">e₂</a> <a id="4089" href="Algebra.Solver.Monoid.html#1877" class="Function Operator">⟧⇓</a> <a id="4092" href="Algebra.Solver.Monoid.html#3978" class="Bound">ρ</a>  <a id="4095" href="Relation.Binary.PreorderReasoning.html#1717" class="Function Operator">∎</a><a id="4096" class="Symbol">)</a>

<a id="4099" class="Comment">-- This procedure can be combined with from-just.</a>

<a id="prove"></a><a id="4150" href="Algebra.Solver.Monoid.html#4150" class="Function">prove</a> <a id="4156" class="Symbol">:</a> <a id="4158" class="Symbol">∀</a> <a id="4160" href="Algebra.Solver.Monoid.html#4160" class="Bound">n</a> <a id="4162" class="Symbol">(</a><a id="4163" href="Algebra.Solver.Monoid.html#4163" class="Bound">es</a> <a id="4166" class="Symbol">:</a> <a id="4168" href="Algebra.Solver.Monoid.html#1268" class="Datatype">Expr</a> <a id="4173" href="Algebra.Solver.Monoid.html#4160" class="Bound">n</a> <a id="4175" href="Data.Product.html#1389" class="Function Operator">×</a> <a id="4177" href="Algebra.Solver.Monoid.html#1268" class="Datatype">Expr</a> <a id="4182" href="Algebra.Solver.Monoid.html#4160" class="Bound">n</a><a id="4183" class="Symbol">)</a> <a id="4185" class="Symbol">→</a>
        <a id="4195" href="Data.Maybe.Base.html#1936" class="Function">From-just</a> <a id="4205" class="Symbol">(</a><a id="4206" href="Data.Product.html#3500" class="Function">uncurry</a> <a id="4214" href="Algebra.Solver.Monoid.html#3749" class="Function">prove′</a> <a id="4221" href="Algebra.Solver.Monoid.html#4163" class="Bound">es</a><a id="4223" class="Symbol">)</a>
<a id="4225" href="Algebra.Solver.Monoid.html#4150" class="Function">prove</a> <a id="4231" class="Symbol">_</a> <a id="4233" class="Symbol">=</a> <a id="4235" href="Data.Maybe.Base.html#2024" class="Function">from-just</a> <a id="4245" href="Function.html#805" class="Function Operator">∘</a> <a id="4247" href="Data.Product.html#3500" class="Function">uncurry</a> <a id="4255" href="Algebra.Solver.Monoid.html#3749" class="Function">prove′</a>
</pre></body></html>