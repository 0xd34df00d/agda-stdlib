<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Algebra.Solver.Monoid</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Solver for monoid equalities</a>
<a id="138" class="Comment">------------------------------------------------------------------------</a>

<a id="212" class="Symbol">{-#</a> <a id="216" class="Keyword">OPTIONS</a> <a id="224" class="Option">--without-K</a> <a id="236" class="Symbol">#-}</a>

<a id="241" class="Keyword">open</a> <a id="246" class="Keyword">import</a> <a id="253" href="Algebra.html" class="Module">Algebra</a>

<a id="262" class="Keyword">module</a> <a id="269" href="Algebra.Solver.Monoid.html" class="Module">Algebra.Solver.Monoid</a> <a id="291" class="Symbol">{</a><a id="292" href="Algebra.Solver.Monoid.html#292" class="Bound">m₁</a> <a id="295" href="Algebra.Solver.Monoid.html#295" class="Bound">m₂</a><a id="297" class="Symbol">}</a> <a id="299" class="Symbol">(</a><a id="300" href="Algebra.Solver.Monoid.html#300" class="Bound">M</a> <a id="302" class="Symbol">:</a> <a id="304" href="Algebra.html#2518" class="Record">Monoid</a> <a id="311" href="Algebra.Solver.Monoid.html#292" class="Bound">m₁</a> <a id="314" href="Algebra.Solver.Monoid.html#295" class="Bound">m₂</a><a id="316" class="Symbol">)</a> <a id="318" class="Keyword">where</a>

<a id="325" class="Keyword">open</a> <a id="330" class="Keyword">import</a> <a id="337" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="346" class="Symbol">as</a> <a id="349" class="Module">Fin</a> <a id="353" class="Keyword">hiding</a> <a id="360" class="Symbol">(</a><a id="361" href="Data.Fin.Properties.html#1723" class="Function Operator">_≟_</a><a id="364" class="Symbol">)</a>
<a id="366" class="Keyword">import</a> <a id="373" href="Data.Fin.Properties.html" class="Module">Data.Fin.Properties</a> <a id="393" class="Symbol">as</a> <a id="396" class="Module">Fin</a>
<a id="400" class="Keyword">open</a> <a id="405" class="Keyword">import</a> <a id="412" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="427" class="Keyword">hiding</a> <a id="434" class="Symbol">(</a><a id="435" href="Data.List.Base.html#5544" class="Function">lookup</a><a id="441" class="Symbol">)</a>
<a id="443" class="Keyword">import</a> <a id="450" href="Data.List.Relation.Equality.DecPropositional.html" class="Module">Data.List.Relation.Equality.DecPropositional</a> <a id="495" class="Symbol">as</a> <a id="498" class="Module">ListEq</a>
<a id="505" class="Keyword">open</a> <a id="510" class="Keyword">import</a> <a id="517" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="528" class="Symbol">as</a> <a id="531" class="Module">Maybe</a>
  <a id="539" class="Keyword">using</a> <a id="545" class="Symbol">(</a><a id="546" href="Data.Maybe.Base.html#703" class="Datatype">Maybe</a><a id="551" class="Symbol">;</a> <a id="553" href="Data.Maybe.Base.html#1278" class="Function">decToMaybe</a><a id="563" class="Symbol">;</a> <a id="565" href="Data.Maybe.Base.html#1929" class="Function">From-just</a><a id="574" class="Symbol">;</a> <a id="576" href="Data.Maybe.Base.html#2017" class="Function">from-just</a><a id="585" class="Symbol">)</a>
<a id="587" class="Keyword">open</a> <a id="592" class="Keyword">import</a> <a id="599" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="613" class="Keyword">using</a> <a id="619" class="Symbol">(</a><a id="620" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="621" class="Symbol">)</a>
<a id="623" class="Keyword">open</a> <a id="628" class="Keyword">import</a> <a id="635" href="Data.Product.html" class="Module">Data.Product</a>
<a id="648" class="Keyword">open</a> <a id="653" class="Keyword">import</a> <a id="660" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="669" class="Keyword">using</a> <a id="675" class="Symbol">(</a><a id="676" href="Data.Vec.html#766" class="Datatype">Vec</a><a id="679" class="Symbol">;</a> <a id="681" href="Data.Vec.html#1372" class="Function">lookup</a><a id="687" class="Symbol">)</a>
<a id="689" class="Keyword">open</a> <a id="694" class="Keyword">import</a> <a id="701" href="Function.html" class="Module">Function</a> <a id="710" class="Keyword">using</a> <a id="716" class="Symbol">(</a><a id="717" href="Function.html#798" class="Function Operator">_∘_</a><a id="720" class="Symbol">;</a> <a id="722" href="Function.html#1920" class="Function Operator">_$_</a><a id="725" class="Symbol">)</a>
<a id="727" class="Keyword">open</a> <a id="732" class="Keyword">import</a> <a id="739" href="Relation.Binary.html" class="Module">Relation.Binary</a> <a id="755" class="Keyword">using</a> <a id="761" class="Symbol">(</a><a id="762" href="Relation.Binary.Core.html#4715" class="Function">Decidable</a><a id="771" class="Symbol">)</a>
<a id="773" class="Keyword">import</a> <a id="780" href="Relation.Binary.EqReasoning.html" class="Module">Relation.Binary.EqReasoning</a>
<a id="808" class="Keyword">open</a> <a id="813" class="Keyword">import</a> <a id="820" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="858" class="Symbol">as</a> <a id="861" class="Module">P</a> <a id="863" class="Keyword">using</a> <a id="869" class="Symbol">(</a><a id="870" href="Agda.Builtin.Equality.html#83" class="Datatype Operator">_≡_</a><a id="873" class="Symbol">)</a>
<a id="875" class="Keyword">import</a> <a id="882" href="Relation.Binary.Reflection.html" class="Module">Relation.Binary.Reflection</a>
<a id="909" class="Keyword">open</a> <a id="914" class="Keyword">import</a> <a id="921" href="Relation.Nullary.html" class="Module">Relation.Nullary</a>
<a id="938" class="Keyword">import</a> <a id="945" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="972" class="Symbol">as</a> <a id="975" class="Module">Dec</a>

<a id="980" class="Keyword">open</a> <a id="985" href="Algebra.html#2518" class="Module">Monoid</a> <a id="992" href="Algebra.Solver.Monoid.html#300" class="Bound">M</a>
<a id="994" class="Keyword">open</a> <a id="999" href="Relation.Binary.EqReasoning.html" class="Module">Relation.Binary.EqReasoning</a> <a id="1027" href="Algebra.Structures.html#928" class="Function">setoid</a>

<a id="1035" class="Comment">------------------------------------------------------------------------</a>
<a id="1108" class="Comment">-- Monoid expressions</a>

<a id="1131" class="Comment">-- There is one constructor for every operation, plus one for</a>
<a id="1193" class="Comment">-- variables; there may be at most n variables.</a>

<a id="1242" class="Keyword">infixr</a> <a id="1249" class="Number">5</a> <a id="1251" href="Algebra.Solver.Monoid.html#1326" class="InductiveConstructor Operator">_⊕_</a>

<a id="1256" class="Keyword">data</a> <a id="Expr"></a><a id="1261" href="Algebra.Solver.Monoid.html#1261" class="Datatype">Expr</a> <a id="1266" class="Symbol">(</a><a id="1267" href="Algebra.Solver.Monoid.html#1267" class="Bound">n</a> <a id="1269" class="Symbol">:</a> <a id="1271" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="1272" class="Symbol">)</a> <a id="1274" class="Symbol">:</a> <a id="1276" class="PrimitiveType">Set</a> <a id="1280" class="Keyword">where</a>
  <a id="Expr.var"></a><a id="1288" href="Algebra.Solver.Monoid.html#1288" class="InductiveConstructor">var</a> <a id="1292" class="Symbol">:</a> <a id="1294" href="Data.Fin.Base.html#944" class="Datatype">Fin</a> <a id="1298" href="Algebra.Solver.Monoid.html#1267" class="Bound">n</a> <a id="1300" class="Symbol">→</a> <a id="1302" href="Algebra.Solver.Monoid.html#1261" class="Datatype">Expr</a> <a id="1307" href="Algebra.Solver.Monoid.html#1267" class="Bound">n</a>
  <a id="Expr.id"></a><a id="1311" href="Algebra.Solver.Monoid.html#1311" class="InductiveConstructor">id</a>  <a id="1315" class="Symbol">:</a> <a id="1317" href="Algebra.Solver.Monoid.html#1261" class="Datatype">Expr</a> <a id="1322" href="Algebra.Solver.Monoid.html#1267" class="Bound">n</a>
  <a id="Expr._⊕_"></a><a id="1326" href="Algebra.Solver.Monoid.html#1326" class="InductiveConstructor Operator">_⊕_</a> <a id="1330" class="Symbol">:</a> <a id="1332" href="Algebra.Solver.Monoid.html#1261" class="Datatype">Expr</a> <a id="1337" href="Algebra.Solver.Monoid.html#1267" class="Bound">n</a> <a id="1339" class="Symbol">→</a> <a id="1341" href="Algebra.Solver.Monoid.html#1261" class="Datatype">Expr</a> <a id="1346" href="Algebra.Solver.Monoid.html#1267" class="Bound">n</a> <a id="1348" class="Symbol">→</a> <a id="1350" href="Algebra.Solver.Monoid.html#1261" class="Datatype">Expr</a> <a id="1355" href="Algebra.Solver.Monoid.html#1267" class="Bound">n</a>

<a id="1358" class="Comment">-- An environment contains one value for every variable.</a>

<a id="Env"></a><a id="1416" href="Algebra.Solver.Monoid.html#1416" class="Function">Env</a> <a id="1420" class="Symbol">:</a> <a id="1422" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="1424" class="Symbol">→</a> <a id="1426" class="PrimitiveType">Set</a> <a id="1430" class="Symbol">_</a>
<a id="1432" href="Algebra.Solver.Monoid.html#1416" class="Function">Env</a> <a id="1436" href="Algebra.Solver.Monoid.html#1436" class="Bound">n</a> <a id="1438" class="Symbol">=</a> <a id="1440" href="Data.Vec.html#766" class="Datatype">Vec</a> <a id="1444" href="Algebra.html#2597" class="Field">Carrier</a> <a id="1452" href="Algebra.Solver.Monoid.html#1436" class="Bound">n</a>

<a id="1455" class="Comment">-- The semantics of an expression is a function from an environment to</a>
<a id="1526" class="Comment">-- a value.</a>

<a id="⟦_⟧"></a><a id="1539" href="Algebra.Solver.Monoid.html#1539" class="Function Operator">⟦_⟧</a> <a id="1543" class="Symbol">:</a> <a id="1545" class="Symbol">∀</a> <a id="1547" class="Symbol">{</a><a id="1548" href="Algebra.Solver.Monoid.html#1548" class="Bound">n</a><a id="1549" class="Symbol">}</a> <a id="1551" class="Symbol">→</a> <a id="1553" href="Algebra.Solver.Monoid.html#1261" class="Datatype">Expr</a> <a id="1558" href="Algebra.Solver.Monoid.html#1548" class="Bound">n</a> <a id="1560" class="Symbol">→</a> <a id="1562" href="Algebra.Solver.Monoid.html#1416" class="Function">Env</a> <a id="1566" href="Algebra.Solver.Monoid.html#1548" class="Bound">n</a> <a id="1568" class="Symbol">→</a> <a id="1570" href="Algebra.html#2597" class="Field">Carrier</a>
<a id="1578" href="Algebra.Solver.Monoid.html#1539" class="Function Operator">⟦</a> <a id="1580" href="Algebra.Solver.Monoid.html#1288" class="InductiveConstructor">var</a> <a id="1584" href="Algebra.Solver.Monoid.html#1584" class="Bound">x</a>   <a id="1588" href="Algebra.Solver.Monoid.html#1539" class="Function Operator">⟧</a> <a id="1590" href="Algebra.Solver.Monoid.html#1590" class="Bound">ρ</a> <a id="1592" class="Symbol">=</a> <a id="1594" href="Data.Vec.html#1372" class="Function">lookup</a> <a id="1601" href="Algebra.Solver.Monoid.html#1584" class="Bound">x</a> <a id="1603" href="Algebra.Solver.Monoid.html#1590" class="Bound">ρ</a>
<a id="1605" href="Algebra.Solver.Monoid.html#1539" class="Function Operator">⟦</a> <a id="1607" href="Algebra.Solver.Monoid.html#1311" class="InductiveConstructor">id</a>      <a id="1615" href="Algebra.Solver.Monoid.html#1539" class="Function Operator">⟧</a> <a id="1617" href="Algebra.Solver.Monoid.html#1617" class="Bound">ρ</a> <a id="1619" class="Symbol">=</a> <a id="1621" href="Algebra.html#2674" class="Field">ε</a>
<a id="1623" href="Algebra.Solver.Monoid.html#1539" class="Function Operator">⟦</a> <a id="1625" href="Algebra.Solver.Monoid.html#1625" class="Bound">e₁</a> <a id="1628" href="Algebra.Solver.Monoid.html#1326" class="InductiveConstructor Operator">⊕</a> <a id="1630" href="Algebra.Solver.Monoid.html#1630" class="Bound">e₂</a> <a id="1633" href="Algebra.Solver.Monoid.html#1539" class="Function Operator">⟧</a> <a id="1635" href="Algebra.Solver.Monoid.html#1635" class="Bound">ρ</a> <a id="1637" class="Symbol">=</a> <a id="1639" href="Algebra.Solver.Monoid.html#1539" class="Function Operator">⟦</a> <a id="1641" href="Algebra.Solver.Monoid.html#1625" class="Bound">e₁</a> <a id="1644" href="Algebra.Solver.Monoid.html#1539" class="Function Operator">⟧</a> <a id="1646" href="Algebra.Solver.Monoid.html#1635" class="Bound">ρ</a> <a id="1648" href="Algebra.html#2647" class="Field Operator">∙</a> <a id="1650" href="Algebra.Solver.Monoid.html#1539" class="Function Operator">⟦</a> <a id="1652" href="Algebra.Solver.Monoid.html#1630" class="Bound">e₂</a> <a id="1655" href="Algebra.Solver.Monoid.html#1539" class="Function Operator">⟧</a> <a id="1657" href="Algebra.Solver.Monoid.html#1635" class="Bound">ρ</a>

<a id="1660" class="Comment">------------------------------------------------------------------------</a>
<a id="1733" class="Comment">-- Normal forms</a>

<a id="1750" class="Comment">-- A normal form is a list of variables.</a>

<a id="Normal"></a><a id="1792" href="Algebra.Solver.Monoid.html#1792" class="Function">Normal</a> <a id="1799" class="Symbol">:</a> <a id="1801" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="1803" class="Symbol">→</a> <a id="1805" class="PrimitiveType">Set</a>
<a id="1809" href="Algebra.Solver.Monoid.html#1792" class="Function">Normal</a> <a id="1816" href="Algebra.Solver.Monoid.html#1816" class="Bound">n</a> <a id="1818" class="Symbol">=</a> <a id="1820" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="1825" class="Symbol">(</a><a id="1826" href="Data.Fin.Base.html#944" class="Datatype">Fin</a> <a id="1830" href="Algebra.Solver.Monoid.html#1816" class="Bound">n</a><a id="1831" class="Symbol">)</a>

<a id="1834" class="Comment">-- The semantics of a normal form.</a>

<a id="⟦_⟧⇓"></a><a id="1870" href="Algebra.Solver.Monoid.html#1870" class="Function Operator">⟦_⟧⇓</a> <a id="1875" class="Symbol">:</a> <a id="1877" class="Symbol">∀</a> <a id="1879" class="Symbol">{</a><a id="1880" href="Algebra.Solver.Monoid.html#1880" class="Bound">n</a><a id="1881" class="Symbol">}</a> <a id="1883" class="Symbol">→</a> <a id="1885" href="Algebra.Solver.Monoid.html#1792" class="Function">Normal</a> <a id="1892" href="Algebra.Solver.Monoid.html#1880" class="Bound">n</a> <a id="1894" class="Symbol">→</a> <a id="1896" href="Algebra.Solver.Monoid.html#1416" class="Function">Env</a> <a id="1900" href="Algebra.Solver.Monoid.html#1880" class="Bound">n</a> <a id="1902" class="Symbol">→</a> <a id="1904" href="Algebra.html#2597" class="Field">Carrier</a>
<a id="1912" href="Algebra.Solver.Monoid.html#1870" class="Function Operator">⟦</a> <a id="1914" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>     <a id="1921" href="Algebra.Solver.Monoid.html#1870" class="Function Operator">⟧⇓</a> <a id="1924" href="Algebra.Solver.Monoid.html#1924" class="Bound">ρ</a> <a id="1926" class="Symbol">=</a> <a id="1928" href="Algebra.html#2674" class="Field">ε</a>
<a id="1930" href="Algebra.Solver.Monoid.html#1870" class="Function Operator">⟦</a> <a id="1932" href="Algebra.Solver.Monoid.html#1932" class="Bound">x</a> <a id="1934" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="1936" href="Algebra.Solver.Monoid.html#1936" class="Bound">nf</a> <a id="1939" href="Algebra.Solver.Monoid.html#1870" class="Function Operator">⟧⇓</a> <a id="1942" href="Algebra.Solver.Monoid.html#1942" class="Bound">ρ</a> <a id="1944" class="Symbol">=</a> <a id="1946" href="Data.Vec.html#1372" class="Function">lookup</a> <a id="1953" href="Algebra.Solver.Monoid.html#1932" class="Bound">x</a> <a id="1955" href="Algebra.Solver.Monoid.html#1942" class="Bound">ρ</a> <a id="1957" href="Algebra.html#2647" class="Field Operator">∙</a> <a id="1959" href="Algebra.Solver.Monoid.html#1870" class="Function Operator">⟦</a> <a id="1961" href="Algebra.Solver.Monoid.html#1936" class="Bound">nf</a> <a id="1964" href="Algebra.Solver.Monoid.html#1870" class="Function Operator">⟧⇓</a> <a id="1967" href="Algebra.Solver.Monoid.html#1942" class="Bound">ρ</a>

<a id="1970" class="Comment">-- A normaliser.</a>

<a id="normalise"></a><a id="1988" href="Algebra.Solver.Monoid.html#1988" class="Function">normalise</a> <a id="1998" class="Symbol">:</a> <a id="2000" class="Symbol">∀</a> <a id="2002" class="Symbol">{</a><a id="2003" href="Algebra.Solver.Monoid.html#2003" class="Bound">n</a><a id="2004" class="Symbol">}</a> <a id="2006" class="Symbol">→</a> <a id="2008" href="Algebra.Solver.Monoid.html#1261" class="Datatype">Expr</a> <a id="2013" href="Algebra.Solver.Monoid.html#2003" class="Bound">n</a> <a id="2015" class="Symbol">→</a> <a id="2017" href="Algebra.Solver.Monoid.html#1792" class="Function">Normal</a> <a id="2024" href="Algebra.Solver.Monoid.html#2003" class="Bound">n</a>
<a id="2026" href="Algebra.Solver.Monoid.html#1988" class="Function">normalise</a> <a id="2036" class="Symbol">(</a><a id="2037" href="Algebra.Solver.Monoid.html#1288" class="InductiveConstructor">var</a> <a id="2041" href="Algebra.Solver.Monoid.html#2041" class="Bound">x</a><a id="2042" class="Symbol">)</a>   <a id="2046" class="Symbol">=</a> <a id="2048" href="Algebra.Solver.Monoid.html#2041" class="Bound">x</a> <a id="2050" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="2052" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
<a id="2055" href="Algebra.Solver.Monoid.html#1988" class="Function">normalise</a> <a id="2065" href="Algebra.Solver.Monoid.html#1311" class="InductiveConstructor">id</a>        <a id="2075" class="Symbol">=</a> <a id="2077" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
<a id="2080" href="Algebra.Solver.Monoid.html#1988" class="Function">normalise</a> <a id="2090" class="Symbol">(</a><a id="2091" href="Algebra.Solver.Monoid.html#2091" class="Bound">e₁</a> <a id="2094" href="Algebra.Solver.Monoid.html#1326" class="InductiveConstructor Operator">⊕</a> <a id="2096" href="Algebra.Solver.Monoid.html#2096" class="Bound">e₂</a><a id="2098" class="Symbol">)</a> <a id="2100" class="Symbol">=</a> <a id="2102" href="Algebra.Solver.Monoid.html#1988" class="Function">normalise</a> <a id="2112" href="Algebra.Solver.Monoid.html#2091" class="Bound">e₁</a> <a id="2115" href="Data.List.Base.html#1495" class="Function Operator">++</a> <a id="2118" href="Algebra.Solver.Monoid.html#1988" class="Function">normalise</a> <a id="2128" href="Algebra.Solver.Monoid.html#2096" class="Bound">e₂</a>

<a id="2132" class="Comment">-- The normaliser is homomorphic with respect to _++_/_∙_.</a>

<a id="homomorphic"></a><a id="2192" href="Algebra.Solver.Monoid.html#2192" class="Function">homomorphic</a> <a id="2204" class="Symbol">:</a> <a id="2206" class="Symbol">∀</a> <a id="2208" class="Symbol">{</a><a id="2209" href="Algebra.Solver.Monoid.html#2209" class="Bound">n</a><a id="2210" class="Symbol">}</a> <a id="2212" class="Symbol">(</a><a id="2213" href="Algebra.Solver.Monoid.html#2213" class="Bound">nf₁</a> <a id="2217" href="Algebra.Solver.Monoid.html#2217" class="Bound">nf₂</a> <a id="2221" class="Symbol">:</a> <a id="2223" href="Algebra.Solver.Monoid.html#1792" class="Function">Normal</a> <a id="2230" href="Algebra.Solver.Monoid.html#2209" class="Bound">n</a><a id="2231" class="Symbol">)</a> <a id="2233" class="Symbol">(</a><a id="2234" href="Algebra.Solver.Monoid.html#2234" class="Bound">ρ</a> <a id="2236" class="Symbol">:</a> <a id="2238" href="Algebra.Solver.Monoid.html#1416" class="Function">Env</a> <a id="2242" href="Algebra.Solver.Monoid.html#2209" class="Bound">n</a><a id="2243" class="Symbol">)</a> <a id="2245" class="Symbol">→</a>
              <a id="2261" href="Algebra.Solver.Monoid.html#1870" class="Function Operator">⟦</a> <a id="2263" href="Algebra.Solver.Monoid.html#2213" class="Bound">nf₁</a> <a id="2267" href="Data.List.Base.html#1495" class="Function Operator">++</a> <a id="2270" href="Algebra.Solver.Monoid.html#2217" class="Bound">nf₂</a> <a id="2274" href="Algebra.Solver.Monoid.html#1870" class="Function Operator">⟧⇓</a> <a id="2277" href="Algebra.Solver.Monoid.html#2234" class="Bound">ρ</a> <a id="2279" href="Algebra.html#2618" class="Field Operator">≈</a> <a id="2281" class="Symbol">(</a><a id="2282" href="Algebra.Solver.Monoid.html#1870" class="Function Operator">⟦</a> <a id="2284" href="Algebra.Solver.Monoid.html#2213" class="Bound">nf₁</a> <a id="2288" href="Algebra.Solver.Monoid.html#1870" class="Function Operator">⟧⇓</a> <a id="2291" href="Algebra.Solver.Monoid.html#2234" class="Bound">ρ</a> <a id="2293" href="Algebra.html#2647" class="Field Operator">∙</a> <a id="2295" href="Algebra.Solver.Monoid.html#1870" class="Function Operator">⟦</a> <a id="2297" href="Algebra.Solver.Monoid.html#2217" class="Bound">nf₂</a> <a id="2301" href="Algebra.Solver.Monoid.html#1870" class="Function Operator">⟧⇓</a> <a id="2304" href="Algebra.Solver.Monoid.html#2234" class="Bound">ρ</a><a id="2305" class="Symbol">)</a>
<a id="2307" href="Algebra.Solver.Monoid.html#2192" class="Function">homomorphic</a> <a id="2319" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a> <a id="2322" href="Algebra.Solver.Monoid.html#2322" class="Bound">nf₂</a> <a id="2326" href="Algebra.Solver.Monoid.html#2326" class="Bound">ρ</a> <a id="2328" class="Symbol">=</a> <a id="2330" href="Relation.Binary.PreorderReasoning.html#1257" class="Function Operator">begin</a>
  <a id="2338" href="Algebra.Solver.Monoid.html#1870" class="Function Operator">⟦</a> <a id="2340" href="Algebra.Solver.Monoid.html#2322" class="Bound">nf₂</a> <a id="2344" href="Algebra.Solver.Monoid.html#1870" class="Function Operator">⟧⇓</a> <a id="2347" href="Algebra.Solver.Monoid.html#2326" class="Bound">ρ</a>      <a id="2354" href="Relation.Binary.PreorderReasoning.html#1323" class="Function Operator">≈⟨</a> <a id="2357" href="Relation.Binary.Core.html#5646" class="Function">sym</a> <a id="2361" href="Function.html#1920" class="Function Operator">$</a> <a id="2363" href="Algebra.Structures.html#1695" class="Function">identityˡ</a> <a id="2373" class="Symbol">_</a> <a id="2375" href="Relation.Binary.PreorderReasoning.html#1323" class="Function Operator">⟩</a>
  <a id="2379" href="Algebra.html#2674" class="Field">ε</a> <a id="2381" href="Algebra.html#2647" class="Field Operator">∙</a> <a id="2383" href="Algebra.Solver.Monoid.html#1870" class="Function Operator">⟦</a> <a id="2385" href="Algebra.Solver.Monoid.html#2322" class="Bound">nf₂</a> <a id="2389" href="Algebra.Solver.Monoid.html#1870" class="Function Operator">⟧⇓</a> <a id="2392" href="Algebra.Solver.Monoid.html#2326" class="Bound">ρ</a>  <a id="2395" href="Relation.Binary.PreorderReasoning.html#1710" class="Function Operator">∎</a>
<a id="2397" href="Algebra.Solver.Monoid.html#2192" class="Function">homomorphic</a> <a id="2409" class="Symbol">(</a><a id="2410" href="Algebra.Solver.Monoid.html#2410" class="Bound">x</a> <a id="2412" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="2414" href="Algebra.Solver.Monoid.html#2414" class="Bound">nf₁</a><a id="2417" class="Symbol">)</a> <a id="2419" href="Algebra.Solver.Monoid.html#2419" class="Bound">nf₂</a> <a id="2423" href="Algebra.Solver.Monoid.html#2423" class="Bound">ρ</a> <a id="2425" class="Symbol">=</a> <a id="2427" href="Relation.Binary.PreorderReasoning.html#1257" class="Function Operator">begin</a>
  <a id="2435" href="Data.Vec.html#1372" class="Function">lookup</a> <a id="2442" href="Algebra.Solver.Monoid.html#2410" class="Bound">x</a> <a id="2444" href="Algebra.Solver.Monoid.html#2423" class="Bound">ρ</a> <a id="2446" href="Algebra.html#2647" class="Field Operator">∙</a> <a id="2448" href="Algebra.Solver.Monoid.html#1870" class="Function Operator">⟦</a> <a id="2450" href="Algebra.Solver.Monoid.html#2414" class="Bound">nf₁</a> <a id="2454" href="Data.List.Base.html#1495" class="Function Operator">++</a> <a id="2457" href="Algebra.Solver.Monoid.html#2419" class="Bound">nf₂</a> <a id="2461" href="Algebra.Solver.Monoid.html#1870" class="Function Operator">⟧⇓</a> <a id="2464" href="Algebra.Solver.Monoid.html#2423" class="Bound">ρ</a>          <a id="2475" href="Relation.Binary.PreorderReasoning.html#1323" class="Function Operator">≈⟨</a> <a id="2478" href="Algebra.Structures.html#853" class="Function">∙-cong</a> <a id="2485" href="Relation.Binary.Core.html#5620" class="Function">refl</a> <a id="2490" class="Symbol">(</a><a id="2491" href="Algebra.Solver.Monoid.html#2192" class="Function">homomorphic</a> <a id="2503" href="Algebra.Solver.Monoid.html#2414" class="Bound">nf₁</a> <a id="2507" href="Algebra.Solver.Monoid.html#2419" class="Bound">nf₂</a> <a id="2511" href="Algebra.Solver.Monoid.html#2423" class="Bound">ρ</a><a id="2512" class="Symbol">)</a> <a id="2514" href="Relation.Binary.PreorderReasoning.html#1323" class="Function Operator">⟩</a>
  <a id="2518" href="Data.Vec.html#1372" class="Function">lookup</a> <a id="2525" href="Algebra.Solver.Monoid.html#2410" class="Bound">x</a> <a id="2527" href="Algebra.Solver.Monoid.html#2423" class="Bound">ρ</a> <a id="2529" href="Algebra.html#2647" class="Field Operator">∙</a> <a id="2531" class="Symbol">(</a><a id="2532" href="Algebra.Solver.Monoid.html#1870" class="Function Operator">⟦</a> <a id="2534" href="Algebra.Solver.Monoid.html#2414" class="Bound">nf₁</a> <a id="2538" href="Algebra.Solver.Monoid.html#1870" class="Function Operator">⟧⇓</a> <a id="2541" href="Algebra.Solver.Monoid.html#2423" class="Bound">ρ</a> <a id="2543" href="Algebra.html#2647" class="Field Operator">∙</a> <a id="2545" href="Algebra.Solver.Monoid.html#1870" class="Function Operator">⟦</a> <a id="2547" href="Algebra.Solver.Monoid.html#2419" class="Bound">nf₂</a> <a id="2551" href="Algebra.Solver.Monoid.html#1870" class="Function Operator">⟧⇓</a> <a id="2554" href="Algebra.Solver.Monoid.html#2423" class="Bound">ρ</a><a id="2555" class="Symbol">)</a>  <a id="2558" href="Relation.Binary.PreorderReasoning.html#1323" class="Function Operator">≈⟨</a> <a id="2561" href="Relation.Binary.Core.html#5646" class="Function">sym</a> <a id="2565" href="Function.html#1920" class="Function Operator">$</a> <a id="2567" href="Algebra.Structures.html#1088" class="Function">assoc</a> <a id="2573" class="Symbol">_</a> <a id="2575" class="Symbol">_</a> <a id="2577" class="Symbol">_</a> <a id="2579" href="Relation.Binary.PreorderReasoning.html#1323" class="Function Operator">⟩</a>
  <a id="2583" href="Data.Vec.html#1372" class="Function">lookup</a> <a id="2590" href="Algebra.Solver.Monoid.html#2410" class="Bound">x</a> <a id="2592" href="Algebra.Solver.Monoid.html#2423" class="Bound">ρ</a> <a id="2594" href="Algebra.html#2647" class="Field Operator">∙</a> <a id="2596" href="Algebra.Solver.Monoid.html#1870" class="Function Operator">⟦</a> <a id="2598" href="Algebra.Solver.Monoid.html#2414" class="Bound">nf₁</a> <a id="2602" href="Algebra.Solver.Monoid.html#1870" class="Function Operator">⟧⇓</a> <a id="2605" href="Algebra.Solver.Monoid.html#2423" class="Bound">ρ</a> <a id="2607" href="Algebra.html#2647" class="Field Operator">∙</a> <a id="2609" href="Algebra.Solver.Monoid.html#1870" class="Function Operator">⟦</a> <a id="2611" href="Algebra.Solver.Monoid.html#2419" class="Bound">nf₂</a> <a id="2615" href="Algebra.Solver.Monoid.html#1870" class="Function Operator">⟧⇓</a> <a id="2618" href="Algebra.Solver.Monoid.html#2423" class="Bound">ρ</a>    <a id="2623" href="Relation.Binary.PreorderReasoning.html#1710" class="Function Operator">∎</a>

<a id="2626" class="Comment">-- The normaliser preserves the semantics of the expression.</a>

<a id="normalise-correct"></a><a id="2688" href="Algebra.Solver.Monoid.html#2688" class="Function">normalise-correct</a> <a id="2706" class="Symbol">:</a>
  <a id="2710" class="Symbol">∀</a> <a id="2712" class="Symbol">{</a><a id="2713" href="Algebra.Solver.Monoid.html#2713" class="Bound">n</a><a id="2714" class="Symbol">}</a> <a id="2716" class="Symbol">(</a><a id="2717" href="Algebra.Solver.Monoid.html#2717" class="Bound">e</a> <a id="2719" class="Symbol">:</a> <a id="2721" href="Algebra.Solver.Monoid.html#1261" class="Datatype">Expr</a> <a id="2726" href="Algebra.Solver.Monoid.html#2713" class="Bound">n</a><a id="2727" class="Symbol">)</a> <a id="2729" class="Symbol">(</a><a id="2730" href="Algebra.Solver.Monoid.html#2730" class="Bound">ρ</a> <a id="2732" class="Symbol">:</a> <a id="2734" href="Algebra.Solver.Monoid.html#1416" class="Function">Env</a> <a id="2738" href="Algebra.Solver.Monoid.html#2713" class="Bound">n</a><a id="2739" class="Symbol">)</a> <a id="2741" class="Symbol">→</a> <a id="2743" href="Algebra.Solver.Monoid.html#1870" class="Function Operator">⟦</a> <a id="2745" href="Algebra.Solver.Monoid.html#1988" class="Function">normalise</a> <a id="2755" href="Algebra.Solver.Monoid.html#2717" class="Bound">e</a> <a id="2757" href="Algebra.Solver.Monoid.html#1870" class="Function Operator">⟧⇓</a> <a id="2760" href="Algebra.Solver.Monoid.html#2730" class="Bound">ρ</a> <a id="2762" href="Algebra.html#2618" class="Field Operator">≈</a> <a id="2764" href="Algebra.Solver.Monoid.html#1539" class="Function Operator">⟦</a> <a id="2766" href="Algebra.Solver.Monoid.html#2717" class="Bound">e</a> <a id="2768" href="Algebra.Solver.Monoid.html#1539" class="Function Operator">⟧</a> <a id="2770" href="Algebra.Solver.Monoid.html#2730" class="Bound">ρ</a>
<a id="2772" href="Algebra.Solver.Monoid.html#2688" class="Function">normalise-correct</a> <a id="2790" class="Symbol">(</a><a id="2791" href="Algebra.Solver.Monoid.html#1288" class="InductiveConstructor">var</a> <a id="2795" href="Algebra.Solver.Monoid.html#2795" class="Bound">x</a><a id="2796" class="Symbol">)</a> <a id="2798" href="Algebra.Solver.Monoid.html#2798" class="Bound">ρ</a> <a id="2800" class="Symbol">=</a> <a id="2802" href="Relation.Binary.PreorderReasoning.html#1257" class="Function Operator">begin</a>
  <a id="2810" href="Data.Vec.html#1372" class="Function">lookup</a> <a id="2817" href="Algebra.Solver.Monoid.html#2795" class="Bound">x</a> <a id="2819" href="Algebra.Solver.Monoid.html#2798" class="Bound">ρ</a> <a id="2821" href="Algebra.html#2647" class="Field Operator">∙</a> <a id="2823" href="Algebra.html#2674" class="Field">ε</a>  <a id="2826" href="Relation.Binary.PreorderReasoning.html#1323" class="Function Operator">≈⟨</a> <a id="2829" href="Algebra.Structures.html#1756" class="Function">identityʳ</a> <a id="2839" class="Symbol">_</a> <a id="2841" href="Relation.Binary.PreorderReasoning.html#1323" class="Function Operator">⟩</a>
  <a id="2845" href="Data.Vec.html#1372" class="Function">lookup</a> <a id="2852" href="Algebra.Solver.Monoid.html#2795" class="Bound">x</a> <a id="2854" href="Algebra.Solver.Monoid.html#2798" class="Bound">ρ</a>      <a id="2861" href="Relation.Binary.PreorderReasoning.html#1710" class="Function Operator">∎</a>
<a id="2863" href="Algebra.Solver.Monoid.html#2688" class="Function">normalise-correct</a> <a id="2881" href="Algebra.Solver.Monoid.html#1311" class="InductiveConstructor">id</a> <a id="2884" href="Algebra.Solver.Monoid.html#2884" class="Bound">ρ</a> <a id="2886" class="Symbol">=</a> <a id="2888" href="Relation.Binary.PreorderReasoning.html#1257" class="Function Operator">begin</a>
  <a id="2896" href="Algebra.html#2674" class="Field">ε</a>  <a id="2899" href="Relation.Binary.PreorderReasoning.html#1710" class="Function Operator">∎</a>
<a id="2901" href="Algebra.Solver.Monoid.html#2688" class="Function">normalise-correct</a> <a id="2919" class="Symbol">(</a><a id="2920" href="Algebra.Solver.Monoid.html#2920" class="Bound">e₁</a> <a id="2923" href="Algebra.Solver.Monoid.html#1326" class="InductiveConstructor Operator">⊕</a> <a id="2925" href="Algebra.Solver.Monoid.html#2925" class="Bound">e₂</a><a id="2927" class="Symbol">)</a> <a id="2929" href="Algebra.Solver.Monoid.html#2929" class="Bound">ρ</a> <a id="2931" class="Symbol">=</a> <a id="2933" href="Relation.Binary.PreorderReasoning.html#1257" class="Function Operator">begin</a>
  <a id="2941" href="Algebra.Solver.Monoid.html#1870" class="Function Operator">⟦</a> <a id="2943" href="Algebra.Solver.Monoid.html#1988" class="Function">normalise</a> <a id="2953" href="Algebra.Solver.Monoid.html#2920" class="Bound">e₁</a> <a id="2956" href="Data.List.Base.html#1495" class="Function Operator">++</a> <a id="2959" href="Algebra.Solver.Monoid.html#1988" class="Function">normalise</a> <a id="2969" href="Algebra.Solver.Monoid.html#2925" class="Bound">e₂</a> <a id="2972" href="Algebra.Solver.Monoid.html#1870" class="Function Operator">⟧⇓</a> <a id="2975" href="Algebra.Solver.Monoid.html#2929" class="Bound">ρ</a>        <a id="2984" href="Relation.Binary.PreorderReasoning.html#1323" class="Function Operator">≈⟨</a> <a id="2987" href="Algebra.Solver.Monoid.html#2192" class="Function">homomorphic</a> <a id="2999" class="Symbol">(</a><a id="3000" href="Algebra.Solver.Monoid.html#1988" class="Function">normalise</a> <a id="3010" href="Algebra.Solver.Monoid.html#2920" class="Bound">e₁</a><a id="3012" class="Symbol">)</a> <a id="3014" class="Symbol">(</a><a id="3015" href="Algebra.Solver.Monoid.html#1988" class="Function">normalise</a> <a id="3025" href="Algebra.Solver.Monoid.html#2925" class="Bound">e₂</a><a id="3027" class="Symbol">)</a> <a id="3029" href="Algebra.Solver.Monoid.html#2929" class="Bound">ρ</a> <a id="3031" href="Relation.Binary.PreorderReasoning.html#1323" class="Function Operator">⟩</a>
  <a id="3035" href="Algebra.Solver.Monoid.html#1870" class="Function Operator">⟦</a> <a id="3037" href="Algebra.Solver.Monoid.html#1988" class="Function">normalise</a> <a id="3047" href="Algebra.Solver.Monoid.html#2920" class="Bound">e₁</a> <a id="3050" href="Algebra.Solver.Monoid.html#1870" class="Function Operator">⟧⇓</a> <a id="3053" href="Algebra.Solver.Monoid.html#2929" class="Bound">ρ</a> <a id="3055" href="Algebra.html#2647" class="Field Operator">∙</a> <a id="3057" href="Algebra.Solver.Monoid.html#1870" class="Function Operator">⟦</a> <a id="3059" href="Algebra.Solver.Monoid.html#1988" class="Function">normalise</a> <a id="3069" href="Algebra.Solver.Monoid.html#2925" class="Bound">e₂</a> <a id="3072" href="Algebra.Solver.Monoid.html#1870" class="Function Operator">⟧⇓</a> <a id="3075" href="Algebra.Solver.Monoid.html#2929" class="Bound">ρ</a>  <a id="3078" href="Relation.Binary.PreorderReasoning.html#1323" class="Function Operator">≈⟨</a> <a id="3081" href="Algebra.Structures.html#853" class="Function">∙-cong</a> <a id="3088" class="Symbol">(</a><a id="3089" href="Algebra.Solver.Monoid.html#2688" class="Function">normalise-correct</a> <a id="3107" href="Algebra.Solver.Monoid.html#2920" class="Bound">e₁</a> <a id="3110" href="Algebra.Solver.Monoid.html#2929" class="Bound">ρ</a><a id="3111" class="Symbol">)</a> <a id="3113" class="Symbol">(</a><a id="3114" href="Algebra.Solver.Monoid.html#2688" class="Function">normalise-correct</a> <a id="3132" href="Algebra.Solver.Monoid.html#2925" class="Bound">e₂</a> <a id="3135" href="Algebra.Solver.Monoid.html#2929" class="Bound">ρ</a><a id="3136" class="Symbol">)</a> <a id="3138" href="Relation.Binary.PreorderReasoning.html#1323" class="Function Operator">⟩</a>
  <a id="3142" href="Algebra.Solver.Monoid.html#1539" class="Function Operator">⟦</a> <a id="3144" href="Algebra.Solver.Monoid.html#2920" class="Bound">e₁</a> <a id="3147" href="Algebra.Solver.Monoid.html#1539" class="Function Operator">⟧</a> <a id="3149" href="Algebra.Solver.Monoid.html#2929" class="Bound">ρ</a> <a id="3151" href="Algebra.html#2647" class="Field Operator">∙</a> <a id="3153" href="Algebra.Solver.Monoid.html#1539" class="Function Operator">⟦</a> <a id="3155" href="Algebra.Solver.Monoid.html#2925" class="Bound">e₂</a> <a id="3158" href="Algebra.Solver.Monoid.html#1539" class="Function Operator">⟧</a> <a id="3160" href="Algebra.Solver.Monoid.html#2929" class="Bound">ρ</a>                        <a id="3185" href="Relation.Binary.PreorderReasoning.html#1710" class="Function Operator">∎</a>

<a id="3188" class="Comment">------------------------------------------------------------------------</a>
<a id="3261" class="Comment">-- &quot;Tactics&quot;</a>

<a id="3275" class="Keyword">open</a> <a id="3280" class="Keyword">module</a> <a id="R"></a><a id="3287" href="Algebra.Solver.Monoid.html#3287" class="Module">R</a> <a id="3289" class="Symbol">=</a> <a id="3291" href="Relation.Binary.Reflection.html" class="Module">Relation.Binary.Reflection</a>
                  <a id="3336" href="Algebra.Structures.html#928" class="Function">setoid</a> <a id="3343" href="Algebra.Solver.Monoid.html#1288" class="InductiveConstructor">var</a> <a id="3347" href="Algebra.Solver.Monoid.html#1539" class="Function Operator">⟦_⟧</a> <a id="3351" class="Symbol">(</a><a id="3352" href="Algebra.Solver.Monoid.html#1870" class="Function Operator">⟦_⟧⇓</a> <a id="3357" href="Function.html#798" class="Function Operator">∘</a> <a id="3359" href="Algebra.Solver.Monoid.html#1988" class="Function">normalise</a><a id="3368" class="Symbol">)</a> <a id="3370" href="Algebra.Solver.Monoid.html#2688" class="Function">normalise-correct</a>
  <a id="3390" class="Keyword">public</a> <a id="3397" class="Keyword">using</a> <a id="3403" class="Symbol">(</a><a id="3404" href="Relation.Binary.Reflection.html#2411" class="Function">solve</a><a id="3409" class="Symbol">;</a> <a id="3411" href="Relation.Binary.Reflection.html#3520" class="Function Operator">_⊜_</a><a id="3414" class="Symbol">)</a>

<a id="3417" class="Comment">-- We can decide if two normal forms are /syntactically/ equal.</a>

<a id="3482" class="Keyword">infix</a> <a id="3488" class="Number">5</a> <a id="3490" href="Algebra.Solver.Monoid.html#3495" class="Function Operator">_≟_</a>

<a id="_≟_"></a><a id="3495" href="Algebra.Solver.Monoid.html#3495" class="Function Operator">_≟_</a> <a id="3499" class="Symbol">:</a> <a id="3501" class="Symbol">∀</a> <a id="3503" class="Symbol">{</a><a id="3504" href="Algebra.Solver.Monoid.html#3504" class="Bound">n</a><a id="3505" class="Symbol">}</a> <a id="3507" class="Symbol">→</a> <a id="3509" href="Relation.Binary.Core.html#4715" class="Function">Decidable</a> <a id="3519" class="Symbol">{</a><a id="3520" class="Argument">A</a> <a id="3522" class="Symbol">=</a> <a id="3524" href="Algebra.Solver.Monoid.html#1792" class="Function">Normal</a> <a id="3531" href="Algebra.Solver.Monoid.html#3504" class="Bound">n</a><a id="3532" class="Symbol">}</a> <a id="3534" href="Agda.Builtin.Equality.html#83" class="Datatype Operator">_≡_</a>
<a id="3538" href="Algebra.Solver.Monoid.html#3538" class="Bound">nf₁</a> <a id="3542" href="Algebra.Solver.Monoid.html#3495" class="Function Operator">≟</a> <a id="3544" href="Algebra.Solver.Monoid.html#3544" class="Bound">nf₂</a> <a id="3548" class="Symbol">=</a> <a id="3550" href="Relation.Nullary.Decidable.html#1830" class="Function">Dec.map′</a> <a id="3559" href="Data.List.Relation.Equality.Propositional.html#760" class="Function">≋⇒≡</a> <a id="3563" href="Data.List.Relation.Equality.Propositional.html#848" class="Function">≡⇒≋</a> <a id="3567" class="Symbol">(</a><a id="3568" href="Algebra.Solver.Monoid.html#3538" class="Bound">nf₁</a> <a id="3572" href="Data.List.Relation.Equality.DecSetoid.html#843" class="Function Operator">≋?</a> <a id="3575" href="Algebra.Solver.Monoid.html#3544" class="Bound">nf₂</a><a id="3578" class="Symbol">)</a>
  <a id="3582" class="Keyword">where</a> <a id="3588" class="Keyword">open</a> <a id="3593" href="Data.List.Relation.Equality.DecPropositional.html" class="Module">ListEq</a> <a id="3600" href="Data.Fin.Properties.html#1723" class="Function Operator">Fin._≟_</a>

<a id="3609" class="Comment">-- We can also give a sound, but not necessarily complete, procedure</a>
<a id="3678" class="Comment">-- for determining if two expressions have the same semantics.</a>

<a id="prove′"></a><a id="3742" href="Algebra.Solver.Monoid.html#3742" class="Function">prove′</a> <a id="3749" class="Symbol">:</a> <a id="3751" class="Symbol">∀</a> <a id="3753" class="Symbol">{</a><a id="3754" href="Algebra.Solver.Monoid.html#3754" class="Bound">n</a><a id="3755" class="Symbol">}</a> <a id="3757" class="Symbol">(</a><a id="3758" href="Algebra.Solver.Monoid.html#3758" class="Bound">e₁</a> <a id="3761" href="Algebra.Solver.Monoid.html#3761" class="Bound">e₂</a> <a id="3764" class="Symbol">:</a> <a id="3766" href="Algebra.Solver.Monoid.html#1261" class="Datatype">Expr</a> <a id="3771" href="Algebra.Solver.Monoid.html#3754" class="Bound">n</a><a id="3772" class="Symbol">)</a> <a id="3774" class="Symbol">→</a> <a id="3776" href="Data.Maybe.Base.html#703" class="Datatype">Maybe</a> <a id="3782" class="Symbol">(∀</a> <a id="3785" href="Algebra.Solver.Monoid.html#3785" class="Bound">ρ</a> <a id="3787" class="Symbol">→</a> <a id="3789" href="Algebra.Solver.Monoid.html#1539" class="Function Operator">⟦</a> <a id="3791" href="Algebra.Solver.Monoid.html#3758" class="Bound">e₁</a> <a id="3794" href="Algebra.Solver.Monoid.html#1539" class="Function Operator">⟧</a> <a id="3796" href="Algebra.Solver.Monoid.html#3785" class="Bound">ρ</a> <a id="3798" href="Algebra.html#2618" class="Field Operator">≈</a> <a id="3800" href="Algebra.Solver.Monoid.html#1539" class="Function Operator">⟦</a> <a id="3802" href="Algebra.Solver.Monoid.html#3761" class="Bound">e₂</a> <a id="3805" href="Algebra.Solver.Monoid.html#1539" class="Function Operator">⟧</a> <a id="3807" href="Algebra.Solver.Monoid.html#3785" class="Bound">ρ</a><a id="3808" class="Symbol">)</a>
<a id="3810" href="Algebra.Solver.Monoid.html#3742" class="Function">prove′</a> <a id="3817" href="Algebra.Solver.Monoid.html#3817" class="Bound">e₁</a> <a id="3820" href="Algebra.Solver.Monoid.html#3820" class="Bound">e₂</a> <a id="3823" class="Symbol">=</a>
  <a id="3827" href="Data.Maybe.Base.html#2132" class="Function">Maybe.map</a> <a id="3837" href="Algebra.Solver.Monoid.html#3896" class="Function">lemma</a> <a id="3843" href="Function.html#1920" class="Function Operator">$</a> <a id="3845" href="Data.Maybe.Base.html#1278" class="Function">decToMaybe</a> <a id="3856" class="Symbol">(</a><a id="3857" href="Algebra.Solver.Monoid.html#1988" class="Function">normalise</a> <a id="3867" href="Algebra.Solver.Monoid.html#3817" class="Bound">e₁</a> <a id="3870" href="Algebra.Solver.Monoid.html#3495" class="Function Operator">≟</a> <a id="3872" href="Algebra.Solver.Monoid.html#1988" class="Function">normalise</a> <a id="3882" href="Algebra.Solver.Monoid.html#3820" class="Bound">e₂</a><a id="3884" class="Symbol">)</a>
  <a id="3888" class="Keyword">where</a>
  <a id="3896" href="Algebra.Solver.Monoid.html#3896" class="Function">lemma</a> <a id="3902" class="Symbol">:</a> <a id="3904" href="Algebra.Solver.Monoid.html#1988" class="Function">normalise</a> <a id="3914" href="Algebra.Solver.Monoid.html#3817" class="Bound">e₁</a> <a id="3917" href="Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="3919" href="Algebra.Solver.Monoid.html#1988" class="Function">normalise</a> <a id="3929" href="Algebra.Solver.Monoid.html#3820" class="Bound">e₂</a> <a id="3932" class="Symbol">→</a> <a id="3934" class="Symbol">∀</a> <a id="3936" href="Algebra.Solver.Monoid.html#3936" class="Bound">ρ</a> <a id="3938" class="Symbol">→</a> <a id="3940" href="Algebra.Solver.Monoid.html#1539" class="Function Operator">⟦</a> <a id="3942" href="Algebra.Solver.Monoid.html#3817" class="Bound">e₁</a> <a id="3945" href="Algebra.Solver.Monoid.html#1539" class="Function Operator">⟧</a> <a id="3947" href="Algebra.Solver.Monoid.html#3936" class="Bound">ρ</a> <a id="3949" href="Algebra.html#2618" class="Field Operator">≈</a> <a id="3951" href="Algebra.Solver.Monoid.html#1539" class="Function Operator">⟦</a> <a id="3953" href="Algebra.Solver.Monoid.html#3820" class="Bound">e₂</a> <a id="3956" href="Algebra.Solver.Monoid.html#1539" class="Function Operator">⟧</a> <a id="3958" href="Algebra.Solver.Monoid.html#3936" class="Bound">ρ</a>
  <a id="3962" href="Algebra.Solver.Monoid.html#3896" class="Function">lemma</a> <a id="3968" href="Algebra.Solver.Monoid.html#3968" class="Bound">eq</a> <a id="3971" href="Algebra.Solver.Monoid.html#3971" class="Bound">ρ</a> <a id="3973" class="Symbol">=</a>
    <a id="3979" href="Relation.Binary.Reflection.html#1725" class="Function">R.prove</a> <a id="3987" href="Algebra.Solver.Monoid.html#3971" class="Bound">ρ</a> <a id="3989" href="Algebra.Solver.Monoid.html#3817" class="Bound">e₁</a> <a id="3992" href="Algebra.Solver.Monoid.html#3820" class="Bound">e₂</a> <a id="3995" class="Symbol">(</a><a id="3996" href="Relation.Binary.PreorderReasoning.html#1257" class="Function Operator">begin</a>
      <a id="4008" href="Algebra.Solver.Monoid.html#1870" class="Function Operator">⟦</a> <a id="4010" href="Algebra.Solver.Monoid.html#1988" class="Function">normalise</a> <a id="4020" href="Algebra.Solver.Monoid.html#3817" class="Bound">e₁</a> <a id="4023" href="Algebra.Solver.Monoid.html#1870" class="Function Operator">⟧⇓</a> <a id="4026" href="Algebra.Solver.Monoid.html#3971" class="Bound">ρ</a>  <a id="4029" href="Relation.Binary.PreorderReasoning.html#1553" class="Function Operator">≡⟨</a> <a id="4032" href="Relation.Binary.PropositionalEquality.html#1127" class="Function">P.cong</a> <a id="4039" class="Symbol">(λ</a> <a id="4042" href="Algebra.Solver.Monoid.html#4042" class="Bound">e</a> <a id="4044" class="Symbol">→</a> <a id="4046" href="Algebra.Solver.Monoid.html#1870" class="Function Operator">⟦</a> <a id="4048" href="Algebra.Solver.Monoid.html#4042" class="Bound">e</a> <a id="4050" href="Algebra.Solver.Monoid.html#1870" class="Function Operator">⟧⇓</a> <a id="4053" href="Algebra.Solver.Monoid.html#3971" class="Bound">ρ</a><a id="4054" class="Symbol">)</a> <a id="4056" href="Algebra.Solver.Monoid.html#3968" class="Bound">eq</a> <a id="4059" href="Relation.Binary.PreorderReasoning.html#1553" class="Function Operator">⟩</a>
      <a id="4067" href="Algebra.Solver.Monoid.html#1870" class="Function Operator">⟦</a> <a id="4069" href="Algebra.Solver.Monoid.html#1988" class="Function">normalise</a> <a id="4079" href="Algebra.Solver.Monoid.html#3820" class="Bound">e₂</a> <a id="4082" href="Algebra.Solver.Monoid.html#1870" class="Function Operator">⟧⇓</a> <a id="4085" href="Algebra.Solver.Monoid.html#3971" class="Bound">ρ</a>  <a id="4088" href="Relation.Binary.PreorderReasoning.html#1710" class="Function Operator">∎</a><a id="4089" class="Symbol">)</a>

<a id="4092" class="Comment">-- This procedure can be combined with from-just.</a>

<a id="prove"></a><a id="4143" href="Algebra.Solver.Monoid.html#4143" class="Function">prove</a> <a id="4149" class="Symbol">:</a> <a id="4151" class="Symbol">∀</a> <a id="4153" href="Algebra.Solver.Monoid.html#4153" class="Bound">n</a> <a id="4155" class="Symbol">(</a><a id="4156" href="Algebra.Solver.Monoid.html#4156" class="Bound">es</a> <a id="4159" class="Symbol">:</a> <a id="4161" href="Algebra.Solver.Monoid.html#1261" class="Datatype">Expr</a> <a id="4166" href="Algebra.Solver.Monoid.html#4153" class="Bound">n</a> <a id="4168" href="Data.Product.html#1382" class="Function Operator">×</a> <a id="4170" href="Algebra.Solver.Monoid.html#1261" class="Datatype">Expr</a> <a id="4175" href="Algebra.Solver.Monoid.html#4153" class="Bound">n</a><a id="4176" class="Symbol">)</a> <a id="4178" class="Symbol">→</a>
        <a id="4188" href="Data.Maybe.Base.html#1929" class="Function">From-just</a> <a id="4198" class="Symbol">(</a><a id="4199" href="Data.Product.html#3493" class="Function">uncurry</a> <a id="4207" href="Algebra.Solver.Monoid.html#3742" class="Function">prove′</a> <a id="4214" href="Algebra.Solver.Monoid.html#4156" class="Bound">es</a><a id="4216" class="Symbol">)</a>
<a id="4218" href="Algebra.Solver.Monoid.html#4143" class="Function">prove</a> <a id="4224" class="Symbol">_</a> <a id="4226" class="Symbol">=</a> <a id="4228" href="Data.Maybe.Base.html#2017" class="Function">from-just</a> <a id="4238" href="Function.html#798" class="Function Operator">∘</a> <a id="4240" href="Data.Product.html#3493" class="Function">uncurry</a> <a id="4248" href="Algebra.Solver.Monoid.html#3742" class="Function">prove′</a>
</pre></body></html>