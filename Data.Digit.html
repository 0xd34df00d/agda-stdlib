<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.Digit</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Digits and digit expansions</a>
<a id="137" class="Comment">------------------------------------------------------------------------</a>

<a id="211" class="Symbol">{-#</a> <a id="215" class="Keyword">OPTIONS</a> <a id="223" class="Option">--without-K</a> <a id="235" class="Symbol">#-}</a>

<a id="240" class="Keyword">module</a> <a id="247" href="Data.Digit.html" class="Module">Data.Digit</a> <a id="258" class="Keyword">where</a>

<a id="265" class="Keyword">open</a> <a id="270" class="Keyword">import</a> <a id="277" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="286" class="Keyword">using</a> <a id="292" class="Symbol">(</a><a id="293" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="294" class="Symbol">;</a> <a id="296" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a><a id="300" class="Symbol">;</a> <a id="302" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a><a id="305" class="Symbol">;</a> <a id="307" href="Data.Nat.Base.html#1373" class="Function">pred</a><a id="311" class="Symbol">;</a> <a id="313" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">_+_</a><a id="316" class="Symbol">;</a> <a id="318" href="Agda.Builtin.Nat.html#433" class="Primitive Operator">_*_</a><a id="321" class="Symbol">;</a> <a id="323" href="Data.Nat.Properties.html#2682" class="Function Operator">_≤?_</a><a id="327" class="Symbol">;</a> <a id="329" href="Data.Nat.Base.html#2369" class="Datatype Operator">_≤′_</a><a id="333" class="Symbol">)</a>
<a id="335" class="Keyword">open</a> <a id="340" class="Keyword">import</a> <a id="347" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a>
<a id="367" class="Keyword">open</a> <a id="372" class="Keyword">import</a> <a id="379" href="Data.Nat.Solver.html" class="Module">Data.Nat.Solver</a>
<a id="395" class="Keyword">open</a> <a id="400" class="Keyword">import</a> <a id="407" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="416" class="Symbol">as</a> <a id="419" class="Module">Fin</a> <a id="423" class="Keyword">using</a> <a id="429" class="Symbol">(</a><a id="430" href="Data.Fin.Base.html#944" class="Datatype">Fin</a><a id="433" class="Symbol">;</a> <a id="435" href="Data.Fin.Base.html#966" class="InductiveConstructor">zero</a><a id="439" class="Symbol">;</a> <a id="441" href="Data.Fin.Base.html#997" class="InductiveConstructor">suc</a><a id="444" class="Symbol">;</a> <a id="446" href="Data.Fin.Base.html#1070" class="Function">toℕ</a><a id="449" class="Symbol">)</a>
<a id="451" class="Keyword">open</a> <a id="456" class="Keyword">import</a> <a id="463" href="Data.Char.html" class="Module">Data.Char</a> <a id="473" class="Keyword">using</a> <a id="479" class="Symbol">(</a><a id="480" href="Agda.Builtin.Char.html#132" class="Postulate">Char</a><a id="484" class="Symbol">)</a>
<a id="486" class="Keyword">open</a> <a id="491" class="Keyword">import</a> <a id="498" href="Data.List.Base.html" class="Module">Data.List.Base</a>
<a id="513" class="Keyword">open</a> <a id="518" class="Keyword">import</a> <a id="525" href="Data.Product.html" class="Module">Data.Product</a>
<a id="538" class="Keyword">open</a> <a id="543" class="Keyword">import</a> <a id="550" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="559" class="Symbol">as</a> <a id="562" class="Module">Vec</a> <a id="566" class="Keyword">using</a> <a id="572" class="Symbol">(</a><a id="573" href="Data.Vec.html#766" class="Datatype">Vec</a><a id="576" class="Symbol">;</a> <a id="578" href="Data.Vec.html#825" class="InductiveConstructor Operator">_∷_</a><a id="581" class="Symbol">;</a> <a id="583" href="Data.Vec.html#806" class="InductiveConstructor">[]</a><a id="585" class="Symbol">)</a>
<a id="587" class="Keyword">open</a> <a id="592" class="Keyword">import</a> <a id="599" href="Data.Nat.DivMod.html" class="Module">Data.Nat.DivMod</a>
<a id="615" class="Keyword">open</a> <a id="620" class="Keyword">import</a> <a id="627" href="Induction.Nat.html" class="Module">Induction.Nat</a> <a id="641" class="Keyword">using</a> <a id="647" class="Symbol">(</a><a id="648" href="Induction.WellFounded.html#2225" class="Function">&lt;′-rec</a><a id="654" class="Symbol">;</a> <a id="656" href="Induction.Nat.html#1511" class="Function">&lt;′-Rec</a><a id="662" class="Symbol">)</a>
<a id="664" class="Keyword">open</a> <a id="669" class="Keyword">import</a> <a id="676" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="693" class="Keyword">using</a> <a id="699" class="Symbol">(</a><a id="700" href="Relation.Nullary.html#599" class="InductiveConstructor">yes</a><a id="703" class="Symbol">;</a> <a id="705" href="Relation.Nullary.html#626" class="InductiveConstructor">no</a><a id="707" class="Symbol">)</a>
<a id="709" class="Keyword">open</a> <a id="714" class="Keyword">import</a> <a id="721" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a>
<a id="748" class="Keyword">open</a> <a id="753" class="Keyword">import</a> <a id="760" href="Relation.Binary.html" class="Module">Relation.Binary</a> <a id="776" class="Keyword">using</a> <a id="782" class="Symbol">(</a><a id="783" href="Relation.Binary.Core.html#4715" class="Function">Decidable</a><a id="792" class="Symbol">)</a>
<a id="794" class="Keyword">open</a> <a id="799" class="Keyword">import</a> <a id="806" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="844" class="Symbol">as</a> <a id="847" class="Module">P</a> <a id="849" class="Keyword">using</a> <a id="855" class="Symbol">(</a><a id="856" href="Agda.Builtin.Equality.html#83" class="Datatype Operator">_≡_</a><a id="859" class="Symbol">;</a> <a id="861" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="865" class="Symbol">)</a>
<a id="867" class="Keyword">open</a> <a id="872" class="Keyword">import</a> <a id="879" href="Function.html" class="Module">Function</a>

<a id="889" class="Keyword">open</a> <a id="894" href="Data.Nat.Solver.html#684" class="Module">+-*-Solver</a>

<a id="906" class="Comment">------------------------------------------------------------------------</a>
<a id="979" class="Comment">-- Digits</a>

<a id="990" class="Comment">-- Digit b is the type of digits in base b.</a>

<a id="Digit"></a><a id="1035" href="Data.Digit.html#1035" class="Function">Digit</a> <a id="1041" class="Symbol">:</a> <a id="1043" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="1045" class="Symbol">→</a> <a id="1047" class="PrimitiveType">Set</a>
<a id="1051" href="Data.Digit.html#1035" class="Function">Digit</a> <a id="1057" href="Data.Digit.html#1057" class="Bound">b</a> <a id="1059" class="Symbol">=</a> <a id="1061" href="Data.Fin.Base.html#944" class="Datatype">Fin</a> <a id="1065" href="Data.Digit.html#1057" class="Bound">b</a>

<a id="1068" class="Comment">-- Some specific digit kinds.</a>

<a id="Decimal"></a><a id="1099" href="Data.Digit.html#1099" class="Function">Decimal</a> <a id="1107" class="Symbol">=</a> <a id="1109" href="Data.Digit.html#1035" class="Function">Digit</a> <a id="1115" class="Number">10</a>
<a id="Bit"></a><a id="1118" href="Data.Digit.html#1118" class="Function">Bit</a>     <a id="1126" class="Symbol">=</a> <a id="1128" href="Data.Digit.html#1035" class="Function">Digit</a> <a id="1134" class="Number">2</a>

<a id="1137" class="Comment">-- Some named digits.</a>

<a id="0b"></a><a id="1160" href="Data.Digit.html#1160" class="Function">0b</a> <a id="1163" class="Symbol">:</a> <a id="1165" href="Data.Digit.html#1118" class="Function">Bit</a>
<a id="1169" href="Data.Digit.html#1160" class="Function">0b</a> <a id="1172" class="Symbol">=</a> <a id="1174" href="Data.Fin.Base.html#966" class="InductiveConstructor">zero</a>

<a id="1b"></a><a id="1180" href="Data.Digit.html#1180" class="Function">1b</a> <a id="1183" class="Symbol">:</a> <a id="1185" href="Data.Digit.html#1118" class="Function">Bit</a>
<a id="1189" href="Data.Digit.html#1180" class="Function">1b</a> <a id="1192" class="Symbol">=</a> <a id="1194" href="Data.Fin.Base.html#997" class="InductiveConstructor">suc</a> <a id="1198" href="Data.Fin.Base.html#966" class="InductiveConstructor">zero</a>

<a id="1204" class="Comment">------------------------------------------------------------------------</a>
<a id="1277" class="Comment">-- Showing digits</a>

<a id="1296" class="Comment">-- The characters used to show the first 16 digits.</a>

<a id="digitChars"></a><a id="1349" href="Data.Digit.html#1349" class="Function">digitChars</a> <a id="1360" class="Symbol">:</a> <a id="1362" href="Data.Vec.html#766" class="Datatype">Vec</a> <a id="1366" href="Agda.Builtin.Char.html#132" class="Postulate">Char</a> <a id="1371" class="Number">16</a>
<a id="1374" href="Data.Digit.html#1349" class="Function">digitChars</a> <a id="1385" class="Symbol">=</a>
  <a id="1389" class="String">&#39;0&#39;</a> <a id="1393" href="Data.Vec.html#825" class="InductiveConstructor Operator">∷</a> <a id="1395" class="String">&#39;1&#39;</a> <a id="1399" href="Data.Vec.html#825" class="InductiveConstructor Operator">∷</a> <a id="1401" class="String">&#39;2&#39;</a> <a id="1405" href="Data.Vec.html#825" class="InductiveConstructor Operator">∷</a> <a id="1407" class="String">&#39;3&#39;</a> <a id="1411" href="Data.Vec.html#825" class="InductiveConstructor Operator">∷</a> <a id="1413" class="String">&#39;4&#39;</a> <a id="1417" href="Data.Vec.html#825" class="InductiveConstructor Operator">∷</a> <a id="1419" class="String">&#39;5&#39;</a> <a id="1423" href="Data.Vec.html#825" class="InductiveConstructor Operator">∷</a> <a id="1425" class="String">&#39;6&#39;</a> <a id="1429" href="Data.Vec.html#825" class="InductiveConstructor Operator">∷</a> <a id="1431" class="String">&#39;7&#39;</a> <a id="1435" href="Data.Vec.html#825" class="InductiveConstructor Operator">∷</a> <a id="1437" class="String">&#39;8&#39;</a> <a id="1441" href="Data.Vec.html#825" class="InductiveConstructor Operator">∷</a> <a id="1443" class="String">&#39;9&#39;</a> <a id="1447" href="Data.Vec.html#825" class="InductiveConstructor Operator">∷</a>
  <a id="1451" class="String">&#39;a&#39;</a> <a id="1455" href="Data.Vec.html#825" class="InductiveConstructor Operator">∷</a> <a id="1457" class="String">&#39;b&#39;</a> <a id="1461" href="Data.Vec.html#825" class="InductiveConstructor Operator">∷</a> <a id="1463" class="String">&#39;c&#39;</a> <a id="1467" href="Data.Vec.html#825" class="InductiveConstructor Operator">∷</a> <a id="1469" class="String">&#39;d&#39;</a> <a id="1473" href="Data.Vec.html#825" class="InductiveConstructor Operator">∷</a> <a id="1475" class="String">&#39;e&#39;</a> <a id="1479" href="Data.Vec.html#825" class="InductiveConstructor Operator">∷</a> <a id="1481" class="String">&#39;f&#39;</a> <a id="1485" href="Data.Vec.html#825" class="InductiveConstructor Operator">∷</a> <a id="1487" href="Data.Vec.html#806" class="InductiveConstructor">[]</a>

<a id="1491" class="Comment">-- showDigit shows digits in base ≤ 16.</a>

<a id="showDigit"></a><a id="1532" href="Data.Digit.html#1532" class="Function">showDigit</a> <a id="1542" class="Symbol">:</a> <a id="1544" class="Symbol">∀</a> <a id="1546" class="Symbol">{</a><a id="1547" href="Data.Digit.html#1547" class="Bound">base</a><a id="1551" class="Symbol">}</a> <a id="1553" class="Symbol">{</a><a id="1554" href="Data.Digit.html#1554" class="Bound">base≤16</a> <a id="1562" class="Symbol">:</a> <a id="1564" href="Relation.Nullary.Decidable.html#926" class="Function">True</a> <a id="1569" class="Symbol">(</a><a id="1570" href="Data.Digit.html#1547" class="Bound">base</a> <a id="1575" href="Data.Nat.Properties.html#2682" class="Function Operator">≤?</a> <a id="1578" class="Number">16</a><a id="1580" class="Symbol">)}</a> <a id="1583" class="Symbol">→</a>
            <a id="1597" href="Data.Digit.html#1035" class="Function">Digit</a> <a id="1603" href="Data.Digit.html#1547" class="Bound">base</a> <a id="1608" class="Symbol">→</a> <a id="1610" href="Agda.Builtin.Char.html#132" class="Postulate">Char</a>
<a id="1615" href="Data.Digit.html#1532" class="Function">showDigit</a> <a id="1625" class="Symbol">{</a><a id="1626" class="Argument">base≤16</a> <a id="1634" class="Symbol">=</a> <a id="1636" href="Data.Digit.html#1636" class="Bound">base≤16</a><a id="1643" class="Symbol">}</a> <a id="1645" href="Data.Digit.html#1645" class="Bound">d</a> <a id="1647" class="Symbol">=</a>
  <a id="1651" href="Data.Vec.html#1372" class="Function">Vec.lookup</a> <a id="1662" class="Symbol">(</a><a id="1663" href="Data.Fin.Base.html#3212" class="Function">Fin.inject≤</a> <a id="1675" href="Data.Digit.html#1645" class="Bound">d</a> <a id="1677" class="Symbol">(</a><a id="1678" href="Relation.Nullary.Decidable.html#1084" class="Function">toWitness</a> <a id="1688" href="Data.Digit.html#1636" class="Bound">base≤16</a><a id="1695" class="Symbol">))</a> <a id="1698" href="Data.Digit.html#1349" class="Function">digitChars</a>

<a id="1710" class="Comment">------------------------------------------------------------------------</a>
<a id="1783" class="Comment">-- Digit expansions</a>

<a id="Expansion"></a><a id="1804" href="Data.Digit.html#1804" class="Function">Expansion</a> <a id="1814" class="Symbol">:</a> <a id="1816" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="1818" class="Symbol">→</a> <a id="1820" class="PrimitiveType">Set</a>
<a id="1824" href="Data.Digit.html#1804" class="Function">Expansion</a> <a id="1834" href="Data.Digit.html#1834" class="Bound">base</a> <a id="1839" class="Symbol">=</a> <a id="1841" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="1846" class="Symbol">(</a><a id="1847" href="Data.Fin.Base.html#944" class="Datatype">Fin</a> <a id="1851" href="Data.Digit.html#1834" class="Bound">base</a><a id="1855" class="Symbol">)</a>

<a id="1858" class="Comment">-- fromDigits takes a digit expansion of a natural number, starting</a>
<a id="1926" class="Comment">-- with the _least_ significant digit, and returns the corresponding</a>
<a id="1995" class="Comment">-- natural number.</a>

<a id="fromDigits"></a><a id="2015" href="Data.Digit.html#2015" class="Function">fromDigits</a> <a id="2026" class="Symbol">:</a> <a id="2028" class="Symbol">∀</a> <a id="2030" class="Symbol">{</a><a id="2031" href="Data.Digit.html#2031" class="Bound">base</a><a id="2035" class="Symbol">}</a> <a id="2037" class="Symbol">→</a> <a id="2039" href="Data.Digit.html#1804" class="Function">Expansion</a> <a id="2049" href="Data.Digit.html#2031" class="Bound">base</a> <a id="2054" class="Symbol">→</a> <a id="2056" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a>
<a id="2058" href="Data.Digit.html#2015" class="Function">fromDigits</a>        <a id="2076" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>       <a id="2085" class="Symbol">=</a> <a id="2087" class="Number">0</a>
<a id="2089" href="Data.Digit.html#2015" class="Function">fromDigits</a> <a id="2100" class="Symbol">{</a><a id="2101" href="Data.Digit.html#2101" class="Bound">base</a><a id="2105" class="Symbol">}</a> <a id="2107" class="Symbol">(</a><a id="2108" href="Data.Digit.html#2108" class="Bound">d</a> <a id="2110" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="2112" href="Data.Digit.html#2112" class="Bound">ds</a><a id="2114" class="Symbol">)</a> <a id="2116" class="Symbol">=</a> <a id="2118" href="Data.Fin.Base.html#1070" class="Function">toℕ</a> <a id="2122" href="Data.Digit.html#2108" class="Bound">d</a> <a id="2124" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">+</a> <a id="2126" href="Data.Digit.html#2015" class="Function">fromDigits</a> <a id="2137" href="Data.Digit.html#2112" class="Bound">ds</a> <a id="2140" href="Agda.Builtin.Nat.html#433" class="Primitive Operator">*</a> <a id="2142" href="Data.Digit.html#2101" class="Bound">base</a>

<a id="2148" class="Comment">-- toDigits b n yields the digits of n, in base b, starting with the</a>
<a id="2217" class="Comment">-- _least_ significant digit.</a>
<a id="2247" class="Comment">--</a>
<a id="2250" class="Comment">-- Note that the list of digits is always non-empty.</a>

<a id="toDigits"></a><a id="2304" href="Data.Digit.html#2304" class="Function">toDigits</a> <a id="2313" class="Symbol">:</a> <a id="2315" class="Symbol">(</a><a id="2316" href="Data.Digit.html#2316" class="Bound">base</a> <a id="2321" class="Symbol">:</a> <a id="2323" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="2324" class="Symbol">)</a> <a id="2326" class="Symbol">{</a><a id="2327" href="Data.Digit.html#2327" class="Bound">base≥2</a> <a id="2334" class="Symbol">:</a> <a id="2336" href="Relation.Nullary.Decidable.html#926" class="Function">True</a> <a id="2341" class="Symbol">(</a><a id="2342" class="Number">2</a> <a id="2344" href="Data.Nat.Properties.html#2682" class="Function Operator">≤?</a> <a id="2347" href="Data.Digit.html#2316" class="Bound">base</a><a id="2351" class="Symbol">)}</a> <a id="2354" class="Symbol">(</a><a id="2355" href="Data.Digit.html#2355" class="Bound">n</a> <a id="2357" class="Symbol">:</a> <a id="2359" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="2360" class="Symbol">)</a> <a id="2362" class="Symbol">→</a>
           <a id="2375" href="Data.Product.html#910" class="Function">∃</a> <a id="2377" class="Symbol">λ</a> <a id="2379" class="Symbol">(</a><a id="2380" href="Data.Digit.html#2380" class="Bound">ds</a> <a id="2383" class="Symbol">:</a> <a id="2385" href="Data.Digit.html#1804" class="Function">Expansion</a> <a id="2395" href="Data.Digit.html#2316" class="Bound">base</a><a id="2399" class="Symbol">)</a> <a id="2401" class="Symbol">→</a> <a id="2403" href="Data.Digit.html#2015" class="Function">fromDigits</a> <a id="2414" href="Data.Digit.html#2380" class="Bound">ds</a> <a id="2417" href="Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="2419" href="Data.Digit.html#2355" class="Bound">n</a>
<a id="2421" href="Data.Digit.html#2304" class="Function">toDigits</a> <a id="2430" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a>       <a id="2441" class="Symbol">{</a><a id="2442" class="Argument">base≥2</a> <a id="2449" class="Symbol">=</a> <a id="2451" class="Symbol">()}</a> <a id="2455" class="Symbol">_</a>
<a id="2457" href="Data.Digit.html#2304" class="Function">toDigits</a> <a id="2466" class="Symbol">(</a><a id="2467" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="2471" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a><a id="2475" class="Symbol">)</a> <a id="2477" class="Symbol">{</a><a id="2478" class="Argument">base≥2</a> <a id="2485" class="Symbol">=</a> <a id="2487" class="Symbol">()}</a> <a id="2491" class="Symbol">_</a>
<a id="2493" href="Data.Digit.html#2304" class="Function">toDigits</a> <a id="2502" class="Symbol">(</a><a id="2503" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="2507" class="Symbol">(</a><a id="2508" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="2512" href="Data.Digit.html#2512" class="Bound">k</a><a id="2513" class="Symbol">))</a> <a id="2516" href="Data.Digit.html#2516" class="Bound">n</a> <a id="2518" class="Symbol">=</a> <a id="2520" href="Induction.WellFounded.html#2225" class="Function">&lt;′-rec</a> <a id="2527" href="Data.Digit.html#2572" class="Function">Pred</a> <a id="2532" href="Data.Digit.html#3142" class="Function">helper</a> <a id="2539" href="Data.Digit.html#2516" class="Bound">n</a>
  <a id="2543" class="Keyword">where</a>
  <a id="2551" href="Data.Digit.html#2551" class="Function">base</a> <a id="2556" class="Symbol">=</a> <a id="2558" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="2562" class="Symbol">(</a><a id="2563" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="2567" href="Data.Digit.html#2512" class="Bound">k</a><a id="2568" class="Symbol">)</a>
  <a id="2572" href="Data.Digit.html#2572" class="Function">Pred</a> <a id="2577" class="Symbol">=</a> <a id="2579" class="Symbol">λ</a> <a id="2581" href="Data.Digit.html#2581" class="Bound">n</a> <a id="2583" class="Symbol">→</a> <a id="2585" href="Data.Product.html#910" class="Function">∃</a> <a id="2587" class="Symbol">λ</a> <a id="2589" href="Data.Digit.html#2589" class="Bound">ds</a> <a id="2592" class="Symbol">→</a> <a id="2594" href="Data.Digit.html#2015" class="Function">fromDigits</a> <a id="2605" href="Data.Digit.html#2589" class="Bound">ds</a> <a id="2608" href="Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="2610" href="Data.Digit.html#2581" class="Bound">n</a>

  <a id="2615" href="Data.Digit.html#2615" class="Function">cons</a> <a id="2620" class="Symbol">:</a> <a id="2622" class="Symbol">∀</a> <a id="2624" class="Symbol">{</a><a id="2625" href="Data.Digit.html#2625" class="Bound">m</a><a id="2626" class="Symbol">}</a> <a id="2628" class="Symbol">(</a><a id="2629" href="Data.Digit.html#2629" class="Bound">r</a> <a id="2631" class="Symbol">:</a> <a id="2633" href="Data.Fin.Base.html#944" class="Datatype">Fin</a> <a id="2637" href="Data.Digit.html#2551" class="Function">base</a><a id="2641" class="Symbol">)</a> <a id="2643" class="Symbol">→</a> <a id="2645" href="Data.Digit.html#2572" class="Function">Pred</a> <a id="2650" href="Data.Digit.html#2625" class="Bound">m</a> <a id="2652" class="Symbol">→</a> <a id="2654" href="Data.Digit.html#2572" class="Function">Pred</a> <a id="2659" class="Symbol">(</a><a id="2660" href="Data.Fin.Base.html#1070" class="Function">toℕ</a> <a id="2664" href="Data.Digit.html#2629" class="Bound">r</a> <a id="2666" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">+</a> <a id="2668" href="Data.Digit.html#2625" class="Bound">m</a> <a id="2670" href="Agda.Builtin.Nat.html#433" class="Primitive Operator">*</a> <a id="2672" href="Data.Digit.html#2551" class="Function">base</a><a id="2676" class="Symbol">)</a>
  <a id="2680" href="Data.Digit.html#2615" class="Function">cons</a> <a id="2685" href="Data.Digit.html#2685" class="Bound">r</a> <a id="2687" class="Symbol">(</a><a id="2688" href="Data.Digit.html#2688" class="Bound">ds</a> <a id="2691" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2693" href="Data.Digit.html#2693" class="Bound">eq</a><a id="2695" class="Symbol">)</a> <a id="2697" class="Symbol">=</a> <a id="2699" class="Symbol">(</a><a id="2700" href="Data.Digit.html#2685" class="Bound">r</a> <a id="2702" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="2704" href="Data.Digit.html#2688" class="Bound">ds</a> <a id="2707" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2709" href="Relation.Binary.PropositionalEquality.html#1127" class="Function">P.cong</a> <a id="2716" class="Symbol">(λ</a> <a id="2719" href="Data.Digit.html#2719" class="Bound">i</a> <a id="2721" class="Symbol">→</a> <a id="2723" href="Data.Fin.Base.html#1070" class="Function">toℕ</a> <a id="2727" href="Data.Digit.html#2685" class="Bound">r</a> <a id="2729" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">+</a> <a id="2731" href="Data.Digit.html#2719" class="Bound">i</a> <a id="2733" href="Agda.Builtin.Nat.html#433" class="Primitive Operator">*</a> <a id="2735" href="Data.Digit.html#2551" class="Function">base</a><a id="2739" class="Symbol">)</a> <a id="2741" href="Data.Digit.html#2693" class="Bound">eq</a><a id="2743" class="Symbol">)</a>

  <a id="2748" class="Keyword">open</a> <a id="2753" href="Data.Nat.Properties.html#40915" class="Module">≤-Reasoning</a>

  <a id="2768" href="Data.Digit.html#2768" class="Function">lem</a> <a id="2772" class="Symbol">:</a> <a id="2774" class="Symbol">∀</a> <a id="2776" href="Data.Digit.html#2776" class="Bound">x</a> <a id="2778" href="Data.Digit.html#2778" class="Bound">k</a> <a id="2780" href="Data.Digit.html#2780" class="Bound">r</a> <a id="2782" class="Symbol">→</a> <a id="2784" class="Number">2</a> <a id="2786" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">+</a> <a id="2788" href="Data.Digit.html#2776" class="Bound">x</a> <a id="2790" href="Data.Nat.Base.html#2369" class="Datatype Operator">≤′</a> <a id="2793" href="Data.Digit.html#2780" class="Bound">r</a> <a id="2795" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">+</a> <a id="2797" class="Symbol">(</a><a id="2798" class="Number">1</a> <a id="2800" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">+</a> <a id="2802" href="Data.Digit.html#2776" class="Bound">x</a><a id="2803" class="Symbol">)</a> <a id="2805" href="Agda.Builtin.Nat.html#433" class="Primitive Operator">*</a> <a id="2807" class="Symbol">(</a><a id="2808" class="Number">2</a> <a id="2810" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">+</a> <a id="2812" href="Data.Digit.html#2778" class="Bound">k</a><a id="2813" class="Symbol">)</a>
  <a id="2817" href="Data.Digit.html#2768" class="Function">lem</a> <a id="2821" href="Data.Digit.html#2821" class="Bound">x</a> <a id="2823" href="Data.Digit.html#2823" class="Bound">k</a> <a id="2825" href="Data.Digit.html#2825" class="Bound">r</a> <a id="2827" class="Symbol">=</a> <a id="2829" href="Data.Nat.Properties.html#7794" class="Function">≤⇒≤′</a> <a id="2834" href="Function.html#1920" class="Function Operator">$</a> <a id="2836" href="Relation.Binary.PreorderReasoning.html#1257" class="Function Operator">begin</a>
    <a id="2846" class="Number">2</a> <a id="2848" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">+</a> <a id="2850" href="Data.Digit.html#2821" class="Bound">x</a>
      <a id="2858" href="Relation.Binary.PreorderReasoning.html#1323" class="Function Operator">≤⟨</a> <a id="2861" href="Data.Nat.Properties.html#12502" class="Function">m≤m+n</a> <a id="2867" class="Symbol">_</a> <a id="2869" class="Symbol">_</a> <a id="2871" href="Relation.Binary.PreorderReasoning.html#1323" class="Function Operator">⟩</a>
    <a id="2877" class="Number">2</a> <a id="2879" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">+</a> <a id="2881" href="Data.Digit.html#2821" class="Bound">x</a> <a id="2883" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">+</a> <a id="2885" class="Symbol">(</a><a id="2886" href="Data.Digit.html#2821" class="Bound">x</a> <a id="2888" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">+</a> <a id="2890" class="Symbol">(</a><a id="2891" class="Number">1</a> <a id="2893" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">+</a> <a id="2895" href="Data.Digit.html#2821" class="Bound">x</a><a id="2896" class="Symbol">)</a> <a id="2898" href="Agda.Builtin.Nat.html#433" class="Primitive Operator">*</a> <a id="2900" href="Data.Digit.html#2823" class="Bound">k</a> <a id="2902" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">+</a> <a id="2904" href="Data.Digit.html#2825" class="Bound">r</a><a id="2905" class="Symbol">)</a>
      <a id="2913" href="Relation.Binary.PreorderReasoning.html#1553" class="Function Operator">≡⟨</a> <a id="2916" href="Relation.Binary.Reflection.html#2411" class="Function">solve</a> <a id="2922" class="Number">3</a> <a id="2924" class="Symbol">(λ</a> <a id="2927" href="Data.Digit.html#2927" class="Bound">x</a> <a id="2929" href="Data.Digit.html#2929" class="Bound">r</a> <a id="2931" href="Data.Digit.html#2931" class="Bound">k</a> <a id="2933" class="Symbol">→</a> <a id="2935" href="Algebra.Solver.Ring.html#2515" class="InductiveConstructor">con</a> <a id="2939" class="Number">2</a> <a id="2941" href="Algebra.Solver.Ring.html#2709" class="Function Operator">:+</a> <a id="2944" href="Data.Digit.html#2927" class="Bound">x</a> <a id="2946" href="Algebra.Solver.Ring.html#2709" class="Function Operator">:+</a> <a id="2949" class="Symbol">(</a><a id="2950" href="Data.Digit.html#2927" class="Bound">x</a> <a id="2952" href="Algebra.Solver.Ring.html#2709" class="Function Operator">:+</a> <a id="2955" class="Symbol">(</a><a id="2956" href="Algebra.Solver.Ring.html#2515" class="InductiveConstructor">con</a> <a id="2960" class="Number">1</a> <a id="2962" href="Algebra.Solver.Ring.html#2709" class="Function Operator">:+</a> <a id="2965" href="Data.Digit.html#2927" class="Bound">x</a><a id="2966" class="Symbol">)</a> <a id="2968" href="Algebra.Solver.Ring.html#2782" class="Function Operator">:*</a> <a id="2971" href="Data.Digit.html#2931" class="Bound">k</a> <a id="2973" href="Algebra.Solver.Ring.html#2709" class="Function Operator">:+</a> <a id="2976" href="Data.Digit.html#2929" class="Bound">r</a><a id="2977" class="Symbol">)</a>
                              <a id="3009" href="Relation.Binary.Reflection.html#3520" class="Function Operator">:=</a>
                            <a id="3040" href="Data.Digit.html#2929" class="Bound">r</a> <a id="3042" href="Algebra.Solver.Ring.html#2709" class="Function Operator">:+</a> <a id="3045" class="Symbol">(</a><a id="3046" href="Algebra.Solver.Ring.html#2515" class="InductiveConstructor">con</a> <a id="3050" class="Number">1</a> <a id="3052" href="Algebra.Solver.Ring.html#2709" class="Function Operator">:+</a> <a id="3055" href="Data.Digit.html#2927" class="Bound">x</a><a id="3056" class="Symbol">)</a> <a id="3058" href="Algebra.Solver.Ring.html#2782" class="Function Operator">:*</a> <a id="3061" class="Symbol">(</a><a id="3062" href="Algebra.Solver.Ring.html#2515" class="InductiveConstructor">con</a> <a id="3066" class="Number">2</a> <a id="3068" href="Algebra.Solver.Ring.html#2709" class="Function Operator">:+</a> <a id="3071" href="Data.Digit.html#2931" class="Bound">k</a><a id="3072" class="Symbol">))</a>
                 <a id="3092" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="3097" href="Data.Digit.html#2821" class="Bound">x</a> <a id="3099" href="Data.Digit.html#2825" class="Bound">r</a> <a id="3101" href="Data.Digit.html#2823" class="Bound">k</a> <a id="3103" href="Relation.Binary.PreorderReasoning.html#1553" class="Function Operator">⟩</a>
    <a id="3109" href="Data.Digit.html#2825" class="Bound">r</a> <a id="3111" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">+</a> <a id="3113" class="Symbol">(</a><a id="3114" class="Number">1</a> <a id="3116" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">+</a> <a id="3118" href="Data.Digit.html#2821" class="Bound">x</a><a id="3119" class="Symbol">)</a> <a id="3121" href="Agda.Builtin.Nat.html#433" class="Primitive Operator">*</a> <a id="3123" class="Symbol">(</a><a id="3124" class="Number">2</a> <a id="3126" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">+</a> <a id="3128" href="Data.Digit.html#2823" class="Bound">k</a><a id="3129" class="Symbol">)</a>
      <a id="3137" href="Relation.Binary.PreorderReasoning.html#1710" class="Function Operator">∎</a>

  <a id="3142" href="Data.Digit.html#3142" class="Function">helper</a> <a id="3149" class="Symbol">:</a> <a id="3151" class="Symbol">∀</a> <a id="3153" href="Data.Digit.html#3153" class="Bound">n</a> <a id="3155" class="Symbol">→</a> <a id="3157" href="Induction.Nat.html#1511" class="Function">&lt;′-Rec</a> <a id="3164" href="Data.Digit.html#2572" class="Function">Pred</a> <a id="3169" href="Data.Digit.html#3153" class="Bound">n</a> <a id="3171" class="Symbol">→</a> <a id="3173" href="Data.Digit.html#2572" class="Function">Pred</a> <a id="3178" href="Data.Digit.html#3153" class="Bound">n</a>
  <a id="3182" href="Data.Digit.html#3142" class="Function">helper</a> <a id="3189" href="Data.Digit.html#3189" class="Bound">n</a>                       <a id="3213" href="Data.Digit.html#3213" class="Bound">rec</a> <a id="3217" class="Keyword">with</a> <a id="3222" href="Data.Digit.html#3189" class="Bound">n</a> <a id="3224" href="Data.Nat.DivMod.html#3358" class="Function Operator">divMod</a> <a id="3231" href="Data.Digit.html#2551" class="Function">base</a>
  <a id="3238" href="Data.Digit.html#3142" class="Function">helper</a> <a id="3245" class="DottedPattern Symbol">.(</a><a id="3247" href="Data.Fin.Base.html#1070" class="DottedPattern Function">toℕ</a> <a id="3251" href="Data.Digit.html#3290" class="DottedPattern Bound">r</a> <a id="3253" href="Agda.Builtin.Nat.html#230" class="DottedPattern Primitive Operator">+</a> <a id="3255" class="DottedPattern Number">0</a>     <a id="3261" href="Agda.Builtin.Nat.html#433" class="DottedPattern Primitive Operator">*</a> <a id="3263" href="Data.Digit.html#2551" class="DottedPattern Function">base</a><a id="3267" class="DottedPattern Symbol">)</a> <a id="3269" href="Data.Digit.html#3269" class="Bound">rec</a> <a id="3273" class="Symbol">|</a> <a id="3275" href="Data.Nat.DivMod.html#3113" class="InductiveConstructor">result</a> <a id="3282" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a>    <a id="3290" href="Data.Digit.html#3290" class="Bound">r</a> <a id="3292" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="3297" class="Symbol">=</a> <a id="3299" class="Symbol">(</a><a id="3300" href="Data.List.Base.html#4622" class="Function Operator">[</a> <a id="3302" href="Data.Digit.html#3290" class="Bound">r</a> <a id="3304" href="Data.List.Base.html#4622" class="Function Operator">]</a> <a id="3306" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="3308" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="3312" class="Symbol">)</a>
  <a id="3316" href="Data.Digit.html#3142" class="Function">helper</a> <a id="3323" class="DottedPattern Symbol">.(</a><a id="3325" href="Data.Fin.Base.html#1070" class="DottedPattern Function">toℕ</a> <a id="3329" href="Data.Digit.html#3368" class="DottedPattern Bound">r</a> <a id="3331" href="Agda.Builtin.Nat.html#230" class="DottedPattern Primitive Operator">+</a> <a id="3333" href="Agda.Builtin.Nat.html#128" class="DottedPattern InductiveConstructor">suc</a> <a id="3337" href="Data.Digit.html#3365" class="DottedPattern Bound">x</a> <a id="3339" href="Agda.Builtin.Nat.html#433" class="DottedPattern Primitive Operator">*</a> <a id="3341" href="Data.Digit.html#2551" class="DottedPattern Function">base</a><a id="3345" class="DottedPattern Symbol">)</a> <a id="3347" href="Data.Digit.html#3347" class="Bound">rec</a> <a id="3351" class="Symbol">|</a> <a id="3353" href="Data.Nat.DivMod.html#3113" class="InductiveConstructor">result</a> <a id="3360" class="Symbol">(</a><a id="3361" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="3365" href="Data.Digit.html#3365" class="Bound">x</a><a id="3366" class="Symbol">)</a> <a id="3368" href="Data.Digit.html#3368" class="Bound">r</a> <a id="3370" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="3375" class="Symbol">=</a>
    <a id="3381" href="Data.Digit.html#2615" class="Function">cons</a> <a id="3386" href="Data.Digit.html#3368" class="Bound">r</a> <a id="3388" class="Symbol">(</a><a id="3389" href="Data.Digit.html#3347" class="Bound">rec</a> <a id="3393" class="Symbol">(</a><a id="3394" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="3398" href="Data.Digit.html#3365" class="Bound">x</a><a id="3399" class="Symbol">)</a> <a id="3401" class="Symbol">(</a><a id="3402" href="Data.Digit.html#2768" class="Function">lem</a> <a id="3406" class="Symbol">(</a><a id="3407" href="Data.Nat.Base.html#1373" class="Function">pred</a> <a id="3412" class="Symbol">(</a><a id="3413" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="3417" href="Data.Digit.html#3365" class="Bound">x</a><a id="3418" class="Symbol">))</a> <a id="3421" href="Data.Digit.html#2512" class="Bound">k</a> <a id="3423" class="Symbol">(</a><a id="3424" href="Data.Fin.Base.html#1070" class="Function">toℕ</a> <a id="3428" href="Data.Digit.html#3368" class="Bound">r</a><a id="3429" class="Symbol">)))</a>
</pre></body></html>