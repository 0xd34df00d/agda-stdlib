<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.String.Base</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Strings: builtin type and basic operations</a>
<a id="152" class="Comment">------------------------------------------------------------------------</a>

<a id="226" class="Symbol">{-#</a> <a id="230" class="Keyword">OPTIONS</a> <a id="238" class="Pragma">--without-K</a> <a id="250" class="Pragma">--safe</a> <a id="257" class="Symbol">#-}</a>

<a id="262" class="Keyword">module</a> <a id="269" href="Data.String.Base.html" class="Module">Data.String.Base</a> <a id="286" class="Keyword">where</a>

<a id="293" class="Keyword">open</a> <a id="298" class="Keyword">import</a> <a id="305" href="Level.html" class="Module">Level</a> <a id="311" class="Keyword">using</a> <a id="317" class="Symbol">(</a><a id="318" href="Agda.Primitive.html#575" class="Primitive">zero</a><a id="322" class="Symbol">)</a>
<a id="324" class="Keyword">open</a> <a id="329" class="Keyword">import</a> <a id="336" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="350" class="Symbol">as</a> <a id="353" class="Module">ℕ</a> <a id="355" class="Keyword">using</a> <a id="361" class="Symbol">(</a><a id="362" href="Agda.Builtin.Nat.html#165" class="Datatype">ℕ</a><a id="363" class="Symbol">;</a> <a id="365" href="Agda.Builtin.Nat.html#388" class="Primitive Operator">_∸_</a><a id="368" class="Symbol">;</a> <a id="370" href="Data.Nat.Base.html#1859" class="Function Operator">⌊_/2⌋</a><a id="375" class="Symbol">;</a> <a id="377" href="Data.Nat.Base.html#1986" class="Function Operator">⌈_/2⌉</a><a id="382" class="Symbol">)</a>
<a id="384" class="Keyword">import</a> <a id="391" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="411" class="Symbol">as</a> <a id="414" class="Module">ℕₚ</a>
<a id="417" class="Keyword">open</a> <a id="422" class="Keyword">import</a> <a id="429" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="444" class="Symbol">as</a> <a id="447" class="Module">List</a> <a id="452" class="Keyword">using</a> <a id="458" class="Symbol">(</a><a id="459" href="Agda.Builtin.List.html#121" class="Datatype">List</a><a id="463" class="Symbol">;</a> <a id="465" href="Data.List.Base.html#4364" class="Function Operator">[_]</a><a id="468" class="Symbol">)</a>
<a id="470" class="Keyword">open</a> <a id="475" class="Keyword">import</a> <a id="482" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="501" class="Symbol">as</a> <a id="504" class="Module">NE</a> <a id="507" class="Keyword">using</a> <a id="513" class="Symbol">(</a><a id="514" href="Data.List.NonEmpty.html#1295" class="Record">List⁺</a><a id="519" class="Symbol">)</a>
<a id="521" class="Keyword">open</a> <a id="526" class="Keyword">import</a> <a id="533" href="Data.List.Extrema.html" class="Module">Data.List.Extrema</a> <a id="551" href="Data.Nat.Properties.html#5742" class="Function">ℕₚ.≤-totalOrder</a>
<a id="567" class="Keyword">open</a> <a id="572" class="Keyword">import</a> <a id="579" href="Data.List.Relation.Binary.Pointwise.html" class="Module">Data.List.Relation.Binary.Pointwise</a> <a id="615" class="Keyword">using</a> <a id="621" class="Symbol">(</a><a id="622" href="Data.List.Relation.Binary.Pointwise.html#1561" class="Datatype">Pointwise</a><a id="631" class="Symbol">)</a>
<a id="633" class="Keyword">open</a> <a id="638" class="Keyword">import</a> <a id="645" href="Data.List.Relation.Binary.Lex.Strict.html" class="Module">Data.List.Relation.Binary.Lex.Strict</a> <a id="682" class="Keyword">using</a> <a id="688" class="Symbol">(</a><a id="689" href="Data.List.Relation.Binary.Lex.Strict.html#1172" class="Function">Lex-&lt;</a><a id="694" class="Symbol">)</a>
<a id="696" class="Keyword">open</a> <a id="701" class="Keyword">import</a> <a id="708" href="Data.Vec.Base.html" class="Module">Data.Vec.Base</a> <a id="722" class="Symbol">as</a> <a id="725" class="Module">Vec</a> <a id="729" class="Keyword">using</a> <a id="735" class="Symbol">(</a><a id="736" href="Data.Vec.Base.html#959" class="Datatype">Vec</a><a id="739" class="Symbol">)</a>
<a id="741" class="Keyword">open</a> <a id="746" class="Keyword">import</a> <a id="753" href="Data.Char.Base.html" class="Module">Data.Char.Base</a> <a id="768" class="Symbol">as</a> <a id="771" class="Module">Char</a> <a id="776" class="Keyword">using</a> <a id="782" class="Symbol">(</a><a id="783" href="Agda.Builtin.Char.html#200" class="Postulate">Char</a><a id="787" class="Symbol">)</a>
<a id="789" class="Keyword">open</a> <a id="794" class="Keyword">import</a> <a id="801" href="Function.html" class="Module">Function</a>
<a id="810" class="Keyword">open</a> <a id="815" class="Keyword">import</a> <a id="822" href="Relation.Binary.html" class="Module">Relation.Binary</a> <a id="838" class="Keyword">using</a> <a id="844" class="Symbol">(</a><a id="845" href="Relation.Binary.Core.html#845" class="Function">Rel</a><a id="848" class="Symbol">)</a>

<a id="851" class="Comment">------------------------------------------------------------------------</a>
<a id="924" class="Comment">-- From Agda.Builtin: type and renamed primitives</a>

<a id="975" class="Comment">-- Note that we do not re-export primStringAppend because we want to</a>
<a id="1044" class="Comment">-- give it an infix definition and be able to assign it a level.</a>

<a id="1110" class="Keyword">import</a> <a id="1117" href="Agda.Builtin.String.html" class="Module">Agda.Builtin.String</a> <a id="1137" class="Symbol">as</a> <a id="1140" class="Module">String</a>

<a id="1148" class="Keyword">open</a> <a id="1153" href="Agda.Builtin.String.html" class="Module">String</a> <a id="1160" class="Keyword">public</a> <a id="1167" class="Keyword">using</a> <a id="1173" class="Symbol">(</a> <a id="1175" href="Agda.Builtin.String.html#247" class="Postulate">String</a> <a id="1182" class="Symbol">)</a>
  <a id="1186" class="Keyword">renaming</a>
  <a id="1197" class="Symbol">(</a> <a id="1199" href="Agda.Builtin.String.html#303" class="Primitive">primStringToList</a>   <a id="1218" class="Symbol">to</a> <a id="1221" href="Agda.Builtin.String.html#303" class="Primitive">toList</a>
  <a id="1230" class="Symbol">;</a> <a id="1232" href="Agda.Builtin.String.html#345" class="Primitive">primStringFromList</a> <a id="1251" class="Symbol">to</a> <a id="1254" href="Agda.Builtin.String.html#345" class="Primitive">fromList</a>
  <a id="1265" class="Symbol">;</a> <a id="1267" href="Agda.Builtin.String.html#518" class="Primitive">primShowString</a>     <a id="1286" class="Symbol">to</a> <a id="1289" href="Agda.Builtin.String.html#518" class="Primitive">show</a>
  <a id="1296" class="Symbol">)</a>

<a id="1299" class="Comment">------------------------------------------------------------------------</a>
<a id="1372" class="Comment">-- Relations</a>

<a id="1386" class="Comment">-- Pointwise equality on Strings</a>

<a id="1420" class="Keyword">infix</a> <a id="1426" class="Number">4</a> <a id="1428" href="Data.String.Base.html#1432" class="Function Operator">_≈_</a>
<a id="_≈_"></a><a id="1432" href="Data.String.Base.html#1432" class="Function Operator">_≈_</a> <a id="1436" class="Symbol">:</a> <a id="1438" href="Relation.Binary.Core.html#845" class="Function">Rel</a> <a id="1442" href="Agda.Builtin.String.html#247" class="Postulate">String</a> <a id="1449" href="Agda.Primitive.html#575" class="Primitive">zero</a>
<a id="1454" href="Data.String.Base.html#1432" class="Function Operator">_≈_</a> <a id="1458" class="Symbol">=</a> <a id="1460" href="Data.List.Relation.Binary.Pointwise.html#1561" class="Datatype">Pointwise</a> <a id="1470" href="Data.Char.Base.html#1132" class="Function Operator">Char._≈_</a> <a id="1479" href="Function.Base.html#3938" class="Function Operator">on</a> <a id="1482" href="Agda.Builtin.String.html#303" class="Primitive">toList</a>

<a id="1490" class="Comment">-- Lexicographic ordering on Strings</a>

<a id="1528" class="Keyword">infix</a> <a id="1534" class="Number">4</a> <a id="1536" href="Data.String.Base.html#1540" class="Function Operator">_&lt;_</a>
<a id="_&lt;_"></a><a id="1540" href="Data.String.Base.html#1540" class="Function Operator">_&lt;_</a> <a id="1544" class="Symbol">:</a> <a id="1546" href="Relation.Binary.Core.html#845" class="Function">Rel</a> <a id="1550" href="Agda.Builtin.String.html#247" class="Postulate">String</a> <a id="1557" href="Agda.Primitive.html#575" class="Primitive">zero</a>
<a id="1562" href="Data.String.Base.html#1540" class="Function Operator">_&lt;_</a> <a id="1566" class="Symbol">=</a> <a id="1568" href="Data.List.Relation.Binary.Lex.Strict.html#1172" class="Function">Lex-&lt;</a> <a id="1574" href="Data.Char.Base.html#1132" class="Function Operator">Char._≈_</a> <a id="1583" href="Data.Char.Base.html#1182" class="Function Operator">Char._&lt;_</a> <a id="1592" href="Function.Base.html#3938" class="Function Operator">on</a> <a id="1595" href="Agda.Builtin.String.html#303" class="Primitive">toList</a>

<a id="1603" class="Comment">------------------------------------------------------------------------</a>
<a id="1676" class="Comment">-- Operations</a>

<a id="1691" class="Comment">-- Additional conversion functions</a>

<a id="fromChar"></a><a id="1727" href="Data.String.Base.html#1727" class="Function">fromChar</a> <a id="1736" class="Symbol">:</a> <a id="1738" href="Agda.Builtin.Char.html#200" class="Postulate">Char</a> <a id="1743" class="Symbol">→</a> <a id="1745" href="Agda.Builtin.String.html#247" class="Postulate">String</a>
<a id="1752" href="Data.String.Base.html#1727" class="Function">fromChar</a> <a id="1761" class="Symbol">=</a> <a id="1763" href="Agda.Builtin.String.html#345" class="Primitive">fromList</a> <a id="1772" href="Function.Base.html#3193" class="Function Operator">∘′</a> <a id="1775" href="Data.List.Base.html#4364" class="Function Operator">[_]</a>

<a id="fromList⁺"></a><a id="1780" href="Data.String.Base.html#1780" class="Function">fromList⁺</a> <a id="1790" class="Symbol">:</a> <a id="1792" href="Data.List.NonEmpty.html#1295" class="Record">List⁺</a> <a id="1798" href="Agda.Builtin.Char.html#200" class="Postulate">Char</a> <a id="1803" class="Symbol">→</a> <a id="1805" href="Agda.Builtin.String.html#247" class="Postulate">String</a>
<a id="1812" href="Data.String.Base.html#1780" class="Function">fromList⁺</a> <a id="1822" class="Symbol">=</a> <a id="1824" href="Agda.Builtin.String.html#345" class="Primitive">fromList</a> <a id="1833" href="Function.Base.html#3193" class="Function Operator">∘′</a> <a id="1836" href="Data.List.NonEmpty.html#1737" class="Function">NE.toList</a>

<a id="1847" class="Comment">-- List-like functions</a>

<a id="1871" class="Keyword">infixr</a> <a id="1878" class="Number">5</a> <a id="1880" href="Data.String.Base.html#1885" class="Function Operator">_++_</a>
<a id="_++_"></a><a id="1885" href="Data.String.Base.html#1885" class="Function Operator">_++_</a> <a id="1890" class="Symbol">:</a> <a id="1892" href="Agda.Builtin.String.html#247" class="Postulate">String</a> <a id="1899" class="Symbol">→</a> <a id="1901" href="Agda.Builtin.String.html#247" class="Postulate">String</a> <a id="1908" class="Symbol">→</a> <a id="1910" href="Agda.Builtin.String.html#247" class="Postulate">String</a>
<a id="1917" href="Data.String.Base.html#1885" class="Function Operator">_++_</a> <a id="1922" class="Symbol">=</a> <a id="1924" href="Agda.Builtin.String.html#387" class="Primitive">String.primStringAppend</a>

<a id="length"></a><a id="1949" href="Data.String.Base.html#1949" class="Function">length</a> <a id="1956" class="Symbol">:</a> <a id="1958" href="Agda.Builtin.String.html#247" class="Postulate">String</a> <a id="1965" class="Symbol">→</a> <a id="1967" href="Agda.Builtin.Nat.html#165" class="Datatype">ℕ</a>
<a id="1969" href="Data.String.Base.html#1949" class="Function">length</a> <a id="1976" class="Symbol">=</a> <a id="1978" href="Data.List.Base.html#4203" class="Function">List.length</a> <a id="1990" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="1992" href="Agda.Builtin.String.html#303" class="Primitive">toList</a>

<a id="replicate"></a><a id="2000" href="Data.String.Base.html#2000" class="Function">replicate</a> <a id="2010" class="Symbol">:</a> <a id="2012" href="Agda.Builtin.Nat.html#165" class="Datatype">ℕ</a> <a id="2014" class="Symbol">→</a> <a id="2016" href="Agda.Builtin.Char.html#200" class="Postulate">Char</a> <a id="2021" class="Symbol">→</a> <a id="2023" href="Agda.Builtin.String.html#247" class="Postulate">String</a>
<a id="2030" href="Data.String.Base.html#2000" class="Function">replicate</a> <a id="2040" href="Data.String.Base.html#2040" class="Bound">n</a> <a id="2042" class="Symbol">=</a> <a id="2044" href="Agda.Builtin.String.html#345" class="Primitive">fromList</a> <a id="2053" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="2055" href="Data.List.Base.html#4478" class="Function">List.replicate</a> <a id="2070" href="Data.String.Base.html#2040" class="Bound">n</a>

<a id="concat"></a><a id="2073" href="Data.String.Base.html#2073" class="Function">concat</a> <a id="2080" class="Symbol">:</a> <a id="2082" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="2087" href="Agda.Builtin.String.html#247" class="Postulate">String</a> <a id="2094" class="Symbol">→</a> <a id="2096" href="Agda.Builtin.String.html#247" class="Postulate">String</a>
<a id="2103" href="Data.String.Base.html#2073" class="Function">concat</a> <a id="2110" class="Symbol">=</a> <a id="2112" href="Data.List.Base.html#3531" class="Function">List.foldr</a> <a id="2123" href="Data.String.Base.html#1885" class="Function Operator">_++_</a> <a id="2128" class="String">&quot;&quot;</a>

<a id="intersperse"></a><a id="2132" href="Data.String.Base.html#2132" class="Function">intersperse</a> <a id="2144" class="Symbol">:</a> <a id="2146" href="Agda.Builtin.String.html#247" class="Postulate">String</a> <a id="2153" class="Symbol">→</a> <a id="2155" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="2160" href="Agda.Builtin.String.html#247" class="Postulate">String</a> <a id="2167" class="Symbol">→</a> <a id="2169" href="Agda.Builtin.String.html#247" class="Postulate">String</a>
<a id="2176" href="Data.String.Base.html#2132" class="Function">intersperse</a> <a id="2188" href="Data.String.Base.html#2188" class="Bound">sep</a> <a id="2192" class="Symbol">=</a> <a id="2194" href="Data.String.Base.html#2073" class="Function">concat</a> <a id="2201" href="Function.Base.html#3193" class="Function Operator">∘′</a> <a id="2204" class="Symbol">(</a><a id="2205" href="Data.List.Base.html#1754" class="Function">List.intersperse</a> <a id="2222" href="Data.String.Base.html#2188" class="Bound">sep</a><a id="2225" class="Symbol">)</a>

<a id="2228" class="Comment">-- String-specific functions</a>

<a id="unlines"></a><a id="2258" href="Data.String.Base.html#2258" class="Function">unlines</a> <a id="2266" class="Symbol">:</a> <a id="2268" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="2273" href="Agda.Builtin.String.html#247" class="Postulate">String</a> <a id="2280" class="Symbol">→</a> <a id="2282" href="Agda.Builtin.String.html#247" class="Postulate">String</a>
<a id="2289" href="Data.String.Base.html#2258" class="Function">unlines</a> <a id="2297" class="Symbol">=</a> <a id="2299" href="Data.String.Base.html#2132" class="Function">intersperse</a> <a id="2311" class="String">&quot;\n&quot;</a>

<a id="unwords"></a><a id="2317" href="Data.String.Base.html#2317" class="Function">unwords</a> <a id="2325" class="Symbol">:</a> <a id="2327" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="2332" href="Agda.Builtin.String.html#247" class="Postulate">String</a> <a id="2339" class="Symbol">→</a> <a id="2341" href="Agda.Builtin.String.html#247" class="Postulate">String</a>
<a id="2348" href="Data.String.Base.html#2317" class="Function">unwords</a> <a id="2356" class="Symbol">=</a> <a id="2358" href="Data.String.Base.html#2132" class="Function">intersperse</a> <a id="2370" class="String">&quot; &quot;</a>

<a id="parens"></a><a id="2375" href="Data.String.Base.html#2375" class="Function">parens</a> <a id="2382" class="Symbol">:</a> <a id="2384" href="Agda.Builtin.String.html#247" class="Postulate">String</a> <a id="2391" class="Symbol">→</a> <a id="2393" href="Agda.Builtin.String.html#247" class="Postulate">String</a>
<a id="2400" href="Data.String.Base.html#2375" class="Function">parens</a> <a id="2407" href="Data.String.Base.html#2407" class="Bound">s</a> <a id="2409" class="Symbol">=</a> <a id="2411" class="String">&quot;(&quot;</a> <a id="2415" href="Data.String.Base.html#1885" class="Function Operator">++</a> <a id="2418" href="Data.String.Base.html#2407" class="Bound">s</a> <a id="2420" href="Data.String.Base.html#1885" class="Function Operator">++</a> <a id="2423" class="String">&quot;)&quot;</a>

<a id="braces"></a><a id="2428" href="Data.String.Base.html#2428" class="Function">braces</a> <a id="2435" class="Symbol">:</a> <a id="2437" href="Agda.Builtin.String.html#247" class="Postulate">String</a> <a id="2444" class="Symbol">→</a> <a id="2446" href="Agda.Builtin.String.html#247" class="Postulate">String</a>
<a id="2453" href="Data.String.Base.html#2428" class="Function">braces</a> <a id="2460" href="Data.String.Base.html#2460" class="Bound">s</a> <a id="2462" class="Symbol">=</a> <a id="2464" class="String">&quot;{&quot;</a> <a id="2468" href="Data.String.Base.html#1885" class="Function Operator">++</a> <a id="2471" href="Data.String.Base.html#2460" class="Bound">s</a> <a id="2473" href="Data.String.Base.html#1885" class="Function Operator">++</a> <a id="2476" class="String">&quot;}&quot;</a>

<a id="2481" class="Comment">-- append that also introduces spaces, if necessary</a>
<a id="2533" class="Keyword">infixr</a> <a id="2540" class="Number">5</a> <a id="2542" href="Data.String.Base.html#2548" class="Function Operator">_&lt;+&gt;_</a>
<a id="_&lt;+&gt;_"></a><a id="2548" href="Data.String.Base.html#2548" class="Function Operator">_&lt;+&gt;_</a> <a id="2554" class="Symbol">:</a> <a id="2556" href="Agda.Builtin.String.html#247" class="Postulate">String</a> <a id="2563" class="Symbol">→</a> <a id="2565" href="Agda.Builtin.String.html#247" class="Postulate">String</a> <a id="2572" class="Symbol">→</a> <a id="2574" href="Agda.Builtin.String.html#247" class="Postulate">String</a>
<a id="2581" class="String">&quot;&quot;</a> <a id="2584" href="Data.String.Base.html#2548" class="Function Operator">&lt;+&gt;</a> <a id="2588" href="Data.String.Base.html#2588" class="Bound">b</a> <a id="2590" class="Symbol">=</a> <a id="2592" href="Data.String.Base.html#2588" class="Bound">b</a>
<a id="2594" href="Data.String.Base.html#2594" class="Bound">a</a> <a id="2596" href="Data.String.Base.html#2548" class="Function Operator">&lt;+&gt;</a> <a id="2600" class="String">&quot;&quot;</a> <a id="2603" class="Symbol">=</a> <a id="2605" href="Data.String.Base.html#2594" class="Bound">a</a>
<a id="2607" href="Data.String.Base.html#2607" class="Bound">a</a> <a id="2609" href="Data.String.Base.html#2548" class="Function Operator">&lt;+&gt;</a> <a id="2613" href="Data.String.Base.html#2613" class="Bound">b</a> <a id="2615" class="Symbol">=</a> <a id="2617" href="Data.String.Base.html#2607" class="Bound">a</a> <a id="2619" href="Data.String.Base.html#1885" class="Function Operator">++</a> <a id="2622" class="String">&quot; &quot;</a> <a id="2626" href="Data.String.Base.html#1885" class="Function Operator">++</a> <a id="2629" href="Data.String.Base.html#2613" class="Bound">b</a>

<a id="2632" class="Comment">------------------------------------------------------------------------</a>
<a id="2705" class="Comment">-- Padding</a>

<a id="2717" class="Comment">-- Each one of the padding functions should verify the following</a>
<a id="2782" class="Comment">-- invariant:</a>
<a id="2796" class="Comment">--   If length str ≤ n then length (padLeft c n str) ≡ n</a>
<a id="2853" class="Comment">--   and otherwise padLeft c n str ≡ str.</a>

<a id="2896" class="Comment">-- Appending an empty string is expensive (append for Haskell&#39;s</a>
<a id="2960" class="Comment">-- Text creates a fresh Text value in which both contents are</a>
<a id="3022" class="Comment">-- copied) so we precompute `n ∸ length str` and check whether</a>
<a id="3085" class="Comment">-- it is equal to 0.</a>

<a id="padLeft"></a><a id="3107" href="Data.String.Base.html#3107" class="Function">padLeft</a> <a id="3115" class="Symbol">:</a> <a id="3117" href="Agda.Builtin.Char.html#200" class="Postulate">Char</a> <a id="3122" class="Symbol">→</a> <a id="3124" href="Agda.Builtin.Nat.html#165" class="Datatype">ℕ</a> <a id="3126" class="Symbol">→</a> <a id="3128" href="Agda.Builtin.String.html#247" class="Postulate">String</a> <a id="3135" class="Symbol">→</a> <a id="3137" href="Agda.Builtin.String.html#247" class="Postulate">String</a>
<a id="3144" href="Data.String.Base.html#3107" class="Function">padLeft</a> <a id="3152" href="Data.String.Base.html#3152" class="Bound">c</a> <a id="3154" href="Data.String.Base.html#3154" class="Bound">n</a> <a id="3156" href="Data.String.Base.html#3156" class="Bound">str</a> <a id="3160" class="Keyword">with</a> <a id="3165" href="Data.String.Base.html#3154" class="Bound">n</a> <a id="3167" href="Agda.Builtin.Nat.html#388" class="Primitive Operator">∸</a> <a id="3169" href="Data.String.Base.html#1949" class="Function">length</a> <a id="3176" href="Data.String.Base.html#3156" class="Bound">str</a>
<a id="3180" class="Symbol">...</a> <a id="3184" class="Symbol">|</a> <a id="3186" class="Number">0</a> <a id="3188" class="Symbol">=</a> <a id="3190" class="Bound">str</a>
<a id="3194" class="CatchallClause Symbol">...</a><a id="3197" class="CatchallClause"> </a><a id="3198" class="CatchallClause Symbol">|</a><a id="3199" class="CatchallClause"> </a><a id="3200" href="Data.String.Base.html#3200" class="CatchallClause Bound">l</a> <a id="3202" class="Symbol">=</a> <a id="3204" href="Data.String.Base.html#2000" class="Function">replicate</a> <a id="3214" href="Data.String.Base.html#3200" class="Bound">l</a> <a id="3216" class="Bound">c</a> <a id="3218" href="Data.String.Base.html#1885" class="Function Operator">++</a> <a id="3221" class="Bound">str</a>

<a id="padRight"></a><a id="3226" href="Data.String.Base.html#3226" class="Function">padRight</a> <a id="3235" class="Symbol">:</a> <a id="3237" href="Agda.Builtin.Char.html#200" class="Postulate">Char</a> <a id="3242" class="Symbol">→</a> <a id="3244" href="Agda.Builtin.Nat.html#165" class="Datatype">ℕ</a> <a id="3246" class="Symbol">→</a> <a id="3248" href="Agda.Builtin.String.html#247" class="Postulate">String</a> <a id="3255" class="Symbol">→</a> <a id="3257" href="Agda.Builtin.String.html#247" class="Postulate">String</a>
<a id="3264" href="Data.String.Base.html#3226" class="Function">padRight</a> <a id="3273" href="Data.String.Base.html#3273" class="Bound">c</a> <a id="3275" href="Data.String.Base.html#3275" class="Bound">n</a> <a id="3277" href="Data.String.Base.html#3277" class="Bound">str</a> <a id="3281" class="Keyword">with</a> <a id="3286" href="Data.String.Base.html#3275" class="Bound">n</a> <a id="3288" href="Agda.Builtin.Nat.html#388" class="Primitive Operator">∸</a> <a id="3290" href="Data.String.Base.html#1949" class="Function">length</a> <a id="3297" href="Data.String.Base.html#3277" class="Bound">str</a>
<a id="3301" class="Symbol">...</a> <a id="3305" class="Symbol">|</a> <a id="3307" class="Number">0</a> <a id="3309" class="Symbol">=</a> <a id="3311" class="Bound">str</a>
<a id="3315" class="CatchallClause Symbol">...</a><a id="3318" class="CatchallClause"> </a><a id="3319" class="CatchallClause Symbol">|</a><a id="3320" class="CatchallClause"> </a><a id="3321" href="Data.String.Base.html#3321" class="CatchallClause Bound">l</a> <a id="3323" class="Symbol">=</a> <a id="3325" class="Bound">str</a> <a id="3329" href="Data.String.Base.html#1885" class="Function Operator">++</a> <a id="3332" href="Data.String.Base.html#2000" class="Function">replicate</a> <a id="3342" href="Data.String.Base.html#3321" class="Bound">l</a> <a id="3344" class="Bound">c</a>

<a id="padBoth"></a><a id="3347" href="Data.String.Base.html#3347" class="Function">padBoth</a> <a id="3355" class="Symbol">:</a> <a id="3357" href="Agda.Builtin.Char.html#200" class="Postulate">Char</a> <a id="3362" class="Symbol">→</a> <a id="3364" href="Agda.Builtin.Char.html#200" class="Postulate">Char</a> <a id="3369" class="Symbol">→</a> <a id="3371" href="Agda.Builtin.Nat.html#165" class="Datatype">ℕ</a> <a id="3373" class="Symbol">→</a> <a id="3375" href="Agda.Builtin.String.html#247" class="Postulate">String</a> <a id="3382" class="Symbol">→</a> <a id="3384" href="Agda.Builtin.String.html#247" class="Postulate">String</a>
<a id="3391" href="Data.String.Base.html#3347" class="Function">padBoth</a> <a id="3399" href="Data.String.Base.html#3399" class="Bound">cₗ</a> <a id="3402" href="Data.String.Base.html#3402" class="Bound">cᵣ</a> <a id="3405" href="Data.String.Base.html#3405" class="Bound">n</a> <a id="3407" href="Data.String.Base.html#3407" class="Bound">str</a> <a id="3411" class="Keyword">with</a> <a id="3416" href="Data.String.Base.html#3405" class="Bound">n</a> <a id="3418" href="Agda.Builtin.Nat.html#388" class="Primitive Operator">∸</a> <a id="3420" href="Data.String.Base.html#1949" class="Function">length</a> <a id="3427" href="Data.String.Base.html#3407" class="Bound">str</a>
<a id="3431" class="Symbol">...</a> <a id="3435" class="Symbol">|</a> <a id="3437" class="Number">0</a> <a id="3439" class="Symbol">=</a> <a id="3441" class="Bound">str</a>
<a id="3445" class="CatchallClause Symbol">...</a><a id="3448" class="CatchallClause"> </a><a id="3449" class="CatchallClause Symbol">|</a><a id="3450" class="CatchallClause"> </a><a id="3451" href="Data.String.Base.html#3451" class="CatchallClause Bound">l</a> <a id="3453" class="Symbol">=</a> <a id="3455" href="Data.String.Base.html#2000" class="Function">replicate</a> <a id="3465" href="Data.Nat.Base.html#1859" class="Function Operator">⌊</a> <a id="3467" href="Data.String.Base.html#3451" class="Bound">l</a> <a id="3469" href="Data.Nat.Base.html#1859" class="Function Operator">/2⌋</a> <a id="3473" class="Bound">cₗ</a> <a id="3476" href="Data.String.Base.html#1885" class="Function Operator">++</a> <a id="3479" class="Bound">str</a> <a id="3483" href="Data.String.Base.html#1885" class="Function Operator">++</a> <a id="3486" href="Data.String.Base.html#2000" class="Function">replicate</a> <a id="3496" href="Data.Nat.Base.html#1986" class="Function Operator">⌈</a> <a id="3498" href="Data.String.Base.html#3451" class="Bound">l</a> <a id="3500" href="Data.Nat.Base.html#1986" class="Function Operator">/2⌉</a> <a id="3504" class="Bound">cᵣ</a>

<a id="3508" class="Comment">------------------------------------------------------------------------</a>
<a id="3581" class="Comment">-- Alignment</a>

<a id="3595" class="Comment">-- We can align a String left, center or right in a column of a given</a>
<a id="3665" class="Comment">-- width by padding it with whitespace.</a>

<a id="3706" class="Keyword">data</a> <a id="Alignment"></a><a id="3711" href="Data.String.Base.html#3711" class="Datatype">Alignment</a> <a id="3721" class="Symbol">:</a> <a id="3723" class="PrimitiveType">Set</a> <a id="3727" class="Keyword">where</a>
  <a id="Alignment.Left"></a><a id="3735" href="Data.String.Base.html#3735" class="InductiveConstructor">Left</a> <a id="Alignment.Center"></a><a id="3740" href="Data.String.Base.html#3740" class="InductiveConstructor">Center</a> <a id="Alignment.Right"></a><a id="3747" href="Data.String.Base.html#3747" class="InductiveConstructor">Right</a> <a id="3753" class="Symbol">:</a> <a id="3755" href="Data.String.Base.html#3711" class="Datatype">Alignment</a>

<a id="fromAlignment"></a><a id="3766" href="Data.String.Base.html#3766" class="Function">fromAlignment</a> <a id="3780" class="Symbol">:</a> <a id="3782" href="Data.String.Base.html#3711" class="Datatype">Alignment</a> <a id="3792" class="Symbol">→</a> <a id="3794" href="Agda.Builtin.Nat.html#165" class="Datatype">ℕ</a> <a id="3796" class="Symbol">→</a> <a id="3798" href="Agda.Builtin.String.html#247" class="Postulate">String</a> <a id="3805" class="Symbol">→</a> <a id="3807" href="Agda.Builtin.String.html#247" class="Postulate">String</a>
<a id="3814" href="Data.String.Base.html#3766" class="Function">fromAlignment</a> <a id="3828" href="Data.String.Base.html#3735" class="InductiveConstructor">Left</a>   <a id="3835" class="Symbol">=</a> <a id="3837" href="Data.String.Base.html#3226" class="Function">padRight</a> <a id="3846" class="String">&#39; &#39;</a>
<a id="3850" href="Data.String.Base.html#3766" class="Function">fromAlignment</a> <a id="3864" href="Data.String.Base.html#3740" class="InductiveConstructor">Center</a> <a id="3871" class="Symbol">=</a> <a id="3873" href="Data.String.Base.html#3347" class="Function">padBoth</a> <a id="3881" class="String">&#39; &#39;</a> <a id="3885" class="String">&#39; &#39;</a>
<a id="3889" href="Data.String.Base.html#3766" class="Function">fromAlignment</a> <a id="3903" href="Data.String.Base.html#3747" class="InductiveConstructor">Right</a>  <a id="3910" class="Symbol">=</a> <a id="3912" href="Data.String.Base.html#3107" class="Function">padLeft</a> <a id="3920" class="String">&#39; &#39;</a>

<a id="3925" class="Comment">------------------------------------------------------------------------</a>
<a id="3998" class="Comment">-- Rectangle</a>

<a id="4012" class="Comment">-- Build a rectangular column by:</a>
<a id="4046" class="Comment">-- Given a vector of cells and a padding function for each one</a>
<a id="4109" class="Comment">-- Compute the max of the widths, and pad the strings accordingly.</a>

<a id="rectangle"></a><a id="4177" href="Data.String.Base.html#4177" class="Function">rectangle</a> <a id="4187" class="Symbol">:</a> <a id="4189" class="Symbol">∀</a> <a id="4191" class="Symbol">{</a><a id="4192" href="Data.String.Base.html#4192" class="Bound">n</a><a id="4193" class="Symbol">}</a> <a id="4195" class="Symbol">→</a> <a id="4197" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="4201" class="Symbol">(</a><a id="4202" href="Agda.Builtin.Nat.html#165" class="Datatype">ℕ</a> <a id="4204" class="Symbol">→</a> <a id="4206" href="Agda.Builtin.String.html#247" class="Postulate">String</a> <a id="4213" class="Symbol">→</a> <a id="4215" href="Agda.Builtin.String.html#247" class="Postulate">String</a><a id="4221" class="Symbol">)</a> <a id="4223" href="Data.String.Base.html#4192" class="Bound">n</a> <a id="4225" class="Symbol">→</a>
            <a id="4239" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="4243" href="Agda.Builtin.String.html#247" class="Postulate">String</a> <a id="4250" href="Data.String.Base.html#4192" class="Bound">n</a> <a id="4252" class="Symbol">→</a> <a id="4254" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="4258" href="Agda.Builtin.String.html#247" class="Postulate">String</a> <a id="4265" href="Data.String.Base.html#4192" class="Bound">n</a>
<a id="4267" href="Data.String.Base.html#4177" class="Function">rectangle</a> <a id="4277" href="Data.String.Base.html#4277" class="Bound">pads</a> <a id="4282" href="Data.String.Base.html#4282" class="Bound">cells</a> <a id="4288" class="Symbol">=</a> <a id="4290" href="Data.Vec.Base.html#3379" class="Function">Vec.zipWith</a> <a id="4302" class="Symbol">(λ</a> <a id="4305" href="Data.String.Base.html#4305" class="Bound">p</a> <a id="4307" href="Data.String.Base.html#4307" class="Bound">c</a> <a id="4309" class="Symbol">→</a> <a id="4311" href="Data.String.Base.html#4305" class="Bound">p</a> <a id="4313" href="Data.String.Base.html#4387" class="Function">width</a> <a id="4319" href="Data.String.Base.html#4307" class="Bound">c</a><a id="4320" class="Symbol">)</a> <a id="4322" href="Data.String.Base.html#4277" class="Bound">pads</a> <a id="4327" href="Data.String.Base.html#4282" class="Bound">cells</a> <a id="4333" class="Keyword">where</a>

  <a id="4342" href="Data.String.Base.html#4342" class="Function">sizes</a> <a id="4348" class="Symbol">=</a> <a id="4350" href="Data.List.Base.html#1403" class="Function">List.map</a> <a id="4359" href="Data.String.Base.html#1949" class="Function">length</a> <a id="4366" class="Symbol">(</a><a id="4367" href="Data.Vec.Base.html#7328" class="Function">Vec.toList</a> <a id="4378" href="Data.String.Base.html#4282" class="Bound">cells</a><a id="4383" class="Symbol">)</a>
  <a id="4387" href="Data.String.Base.html#4387" class="Function">width</a> <a id="4393" class="Symbol">=</a> <a id="4395" href="Data.List.Extrema.html#1946" class="Function">max</a> <a id="4399" class="Number">0</a> <a id="4401" href="Data.String.Base.html#4342" class="Function">sizes</a>

<a id="4408" class="Comment">-- Special cases for left, center, and right alignment</a>

<a id="rectangleˡ"></a><a id="4464" href="Data.String.Base.html#4464" class="Function">rectangleˡ</a> <a id="4475" class="Symbol">:</a> <a id="4477" class="Symbol">∀</a> <a id="4479" class="Symbol">{</a><a id="4480" href="Data.String.Base.html#4480" class="Bound">n</a><a id="4481" class="Symbol">}</a> <a id="4483" class="Symbol">→</a> <a id="4485" href="Agda.Builtin.Char.html#200" class="Postulate">Char</a> <a id="4490" class="Symbol">→</a> <a id="4492" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="4496" href="Agda.Builtin.String.html#247" class="Postulate">String</a> <a id="4503" href="Data.String.Base.html#4480" class="Bound">n</a> <a id="4505" class="Symbol">→</a> <a id="4507" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="4511" href="Agda.Builtin.String.html#247" class="Postulate">String</a> <a id="4518" href="Data.String.Base.html#4480" class="Bound">n</a>
<a id="4520" href="Data.String.Base.html#4464" class="Function">rectangleˡ</a> <a id="4531" href="Data.String.Base.html#4531" class="Bound">c</a> <a id="4533" class="Symbol">=</a> <a id="4535" href="Data.String.Base.html#4177" class="Function">rectangle</a> <a id="4545" class="Symbol">(</a><a id="4546" href="Data.Vec.Base.html#5745" class="Function">Vec.replicate</a> <a id="4560" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="4562" href="Data.String.Base.html#3107" class="Function">padLeft</a> <a id="4570" href="Data.String.Base.html#4531" class="Bound">c</a><a id="4571" class="Symbol">)</a>

<a id="rectangleʳ"></a><a id="4574" href="Data.String.Base.html#4574" class="Function">rectangleʳ</a> <a id="4585" class="Symbol">:</a> <a id="4587" class="Symbol">∀</a> <a id="4589" class="Symbol">{</a><a id="4590" href="Data.String.Base.html#4590" class="Bound">n</a><a id="4591" class="Symbol">}</a> <a id="4593" class="Symbol">→</a> <a id="4595" href="Agda.Builtin.Char.html#200" class="Postulate">Char</a> <a id="4600" class="Symbol">→</a> <a id="4602" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="4606" href="Agda.Builtin.String.html#247" class="Postulate">String</a> <a id="4613" href="Data.String.Base.html#4590" class="Bound">n</a> <a id="4615" class="Symbol">→</a> <a id="4617" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="4621" href="Agda.Builtin.String.html#247" class="Postulate">String</a> <a id="4628" href="Data.String.Base.html#4590" class="Bound">n</a>
<a id="4630" href="Data.String.Base.html#4574" class="Function">rectangleʳ</a> <a id="4641" href="Data.String.Base.html#4641" class="Bound">c</a> <a id="4643" class="Symbol">=</a> <a id="4645" href="Data.String.Base.html#4177" class="Function">rectangle</a> <a id="4655" class="Symbol">(</a><a id="4656" href="Data.Vec.Base.html#5745" class="Function">Vec.replicate</a> <a id="4670" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="4672" href="Data.String.Base.html#3226" class="Function">padRight</a> <a id="4681" href="Data.String.Base.html#4641" class="Bound">c</a><a id="4682" class="Symbol">)</a>

<a id="rectangleᶜ"></a><a id="4685" href="Data.String.Base.html#4685" class="Function">rectangleᶜ</a> <a id="4696" class="Symbol">:</a> <a id="4698" class="Symbol">∀</a> <a id="4700" class="Symbol">{</a><a id="4701" href="Data.String.Base.html#4701" class="Bound">n</a><a id="4702" class="Symbol">}</a> <a id="4704" class="Symbol">→</a> <a id="4706" href="Agda.Builtin.Char.html#200" class="Postulate">Char</a> <a id="4711" class="Symbol">→</a> <a id="4713" href="Agda.Builtin.Char.html#200" class="Postulate">Char</a> <a id="4718" class="Symbol">→</a> <a id="4720" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="4724" href="Agda.Builtin.String.html#247" class="Postulate">String</a> <a id="4731" href="Data.String.Base.html#4701" class="Bound">n</a> <a id="4733" class="Symbol">→</a> <a id="4735" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="4739" href="Agda.Builtin.String.html#247" class="Postulate">String</a> <a id="4746" href="Data.String.Base.html#4701" class="Bound">n</a>
<a id="4748" href="Data.String.Base.html#4685" class="Function">rectangleᶜ</a> <a id="4759" href="Data.String.Base.html#4759" class="Bound">cₗ</a> <a id="4762" href="Data.String.Base.html#4762" class="Bound">cᵣ</a> <a id="4765" class="Symbol">=</a> <a id="4767" href="Data.String.Base.html#4177" class="Function">rectangle</a> <a id="4777" class="Symbol">(</a><a id="4778" href="Data.Vec.Base.html#5745" class="Function">Vec.replicate</a> <a id="4792" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="4794" href="Data.String.Base.html#3347" class="Function">padBoth</a> <a id="4802" href="Data.String.Base.html#4759" class="Bound">cₗ</a> <a id="4805" href="Data.String.Base.html#4762" class="Bound">cᵣ</a><a id="4807" class="Symbol">)</a>
</pre></body></html>