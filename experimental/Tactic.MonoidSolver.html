<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Tactic.MonoidSolver</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Reflection-based solver for monoid equalities</a>
<a id="155" class="Comment">------------------------------------------------------------------------</a>
<a id="228" class="Comment">--</a>
<a id="231" class="Comment">-- This solver automates the construction of proofs of equivalences</a>
<a id="299" class="Comment">-- between monoid expressions.</a>
<a id="330" class="Comment">-- When called like so:</a>
<a id="354" class="Comment">--</a>
<a id="357" class="Comment">--   proof : ∀ x y z → (x ∙ y) ∙ z ≈ x ∙ (y ∙ z) ∙ ε</a>
<a id="410" class="Comment">--   proof x y z = solve mon</a>
<a id="439" class="Comment">--</a>
<a id="442" class="Comment">-- The following diagram describes what happens under the hood:</a>
<a id="506" class="Comment">--</a>
<a id="509" class="Comment">--            ┌▸x ∙ (y ∙ (z ∙ ε)) ════ x ∙ (y ∙ (z ∙ ε))◂┐</a>
<a id="568" class="Comment">--            │         ║                      ║         │</a>
<a id="627" class="Comment">--            │         ║                      ║         │</a>
<a id="686" class="Comment">--          [_⇓]        ║                      ║        [_⇓]</a>
<a id="747" class="Comment">--          ╱           ║                      ║          ╲</a>
<a id="807" class="Comment">--         ╱            ║                      ║           ╲</a>
<a id="868" class="Comment">-- (x ∙′ y) ∙′ z      homo                   homo    x ∙′ (y ∙′ z) ∙′ ε′</a>
<a id="941" class="Comment">--   ▴     ╲            ║                      ║           ╱       ▴</a>
<a id="1010" class="Comment">--   │      ╲           ║                      ║          ╱        │</a>
<a id="1079" class="Comment">--   │       [_↓]       ║                      ║        [_↓]       │</a>
<a id="1148" class="Comment">--   │        │         ║                      ║         │         │</a>
<a id="1217" class="Comment">--   │        │         ║                      ║         │         │</a>
<a id="1286" class="Comment">--   │        └───▸(x ∙ y) ∙ z          x ∙ (y ∙ z) ∙ ε◂─┘         │</a>
<a id="1355" class="Comment">--   │                  │                      │                   │</a>
<a id="1424" class="Comment">--   │                  │                      │                   │</a>
<a id="1493" class="Comment">--   └────reflection────┘                      └───reflection──────┘</a>
<a id="1562" class="Comment">--</a>
<a id="1565" class="Comment">-- The actual output—the proof constructed by the solver—is represented</a>
<a id="1637" class="Comment">-- by the double-lined path (══).</a>
<a id="1671" class="Comment">--</a>
<a id="1674" class="Comment">-- We start at the bottom, with our two expressions.</a>
<a id="1727" class="Comment">-- Through reflection, we convert these two expressions to their AST</a>
<a id="1796" class="Comment">-- representations, in the Expr type.</a>
<a id="1834" class="Comment">-- We then can evaluate the AST in two ways: one simply gives us back</a>
<a id="1904" class="Comment">-- the two expressions we put in ([_↓]), and the other normalises</a>
<a id="1970" class="Comment">-- ([_⇓]).</a>
<a id="1981" class="Comment">-- We use the homo function to prove equivalence between these two</a>
<a id="2048" class="Comment">-- forms: joining up these two proofs gives us the desired overall</a>
<a id="2115" class="Comment">-- proof.</a>

<a id="2126" class="Comment">-- Note: What&#39;s going on with the Monoid parameter?</a>
<a id="2178" class="Comment">--</a>
<a id="2181" class="Comment">-- This module is not parameterised over a monoid, which is contrary</a>
<a id="2250" class="Comment">-- to what you might expect. Instead, we take the monoid record as an</a>
<a id="2320" class="Comment">-- argument to the solve macro, and then pass it around as an</a>
<a id="2382" class="Comment">-- argument wherever we need it.</a>
<a id="2415" class="Comment">--</a>
<a id="2418" class="Comment">-- We need to get the monoid record at the call site, not the import</a>
<a id="2487" class="Comment">-- site, to ensure that it&#39;s consistent with the rest of the context.</a>
<a id="2557" class="Comment">-- For instance, if we wanted to produce `x ∙ y` using the monoid record</a>
<a id="2630" class="Comment">-- as imported, we would run into problems:</a>
<a id="2674" class="Comment">-- * If we tried to just reflect on the expression itself</a>
<a id="2732" class="Comment">--   (quoteTerm (x ∙ y)) we would likely get some de Bruijn indices</a>
<a id="2800" class="Comment">--   wrong (in x and y), and ∙ might not even be in scope where the</a>
<a id="2868" class="Comment">--   user wants us to solve! If they&#39;re solving an expression like</a>
<a id="2935" class="Comment">--   x + (y + z), they can pass in the +-0-monoid, but don&#39;t have to</a>
<a id="3004" class="Comment">--   open it themselves.</a>
<a id="3029" class="Comment">-- * If instead we tried to construct a term which accesses the _∙_</a>
<a id="3097" class="Comment">--   field on the reflection of the record, we&#39;d run into similar</a>
<a id="3163" class="Comment">--   problems again. While the record is a parameter for us, it might</a>
<a id="3233" class="Comment">--   not be for the user.</a>
<a id="3259" class="Comment">-- Basically, we need the Monoid we&#39;re looking at to be exactly the</a>
<a id="3327" class="Comment">-- same as the one the user is looking at, and in order to do that we</a>
<a id="3397" class="Comment">-- quote it at the call site.</a>

<a id="3428" class="Symbol">{-#</a> <a id="3432" class="Keyword">OPTIONS</a> <a id="3440" class="Pragma">--without-K</a> <a id="3452" class="Pragma">--safe</a> <a id="3459" class="Symbol">#-}</a>

<a id="3464" class="Keyword">module</a> <a id="3471" href="Tactic.MonoidSolver.html" class="Module">Tactic.MonoidSolver</a> <a id="3491" class="Keyword">where</a>

<a id="3498" class="Keyword">open</a> <a id="3503" class="Keyword">import</a> <a id="3510" href="Algebra.html" class="Module">Algebra</a>
<a id="3518" class="Keyword">open</a> <a id="3523" class="Keyword">import</a> <a id="3530" href="Function.html" class="Module">Function</a>

<a id="3540" class="Keyword">open</a> <a id="3545" class="Keyword">import</a> <a id="3552" href="Data.Bool.html" class="Module">Data.Bool</a>    <a id="3565" class="Symbol">as</a> <a id="3568" class="Module">Bool</a>    <a id="3576" class="Keyword">using</a> <a id="3582" class="Symbol">(</a><a id="3583" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a><a id="3587" class="Symbol">;</a> <a id="3589" href="Data.Bool.Base.html#1044" class="Function Operator">_∨_</a><a id="3592" class="Symbol">;</a> <a id="3594" href="Data.Bool.Base.html#1283" class="Function Operator">if_then_else_</a><a id="3607" class="Symbol">)</a>
<a id="3609" class="Keyword">open</a> <a id="3614" class="Keyword">import</a> <a id="3621" href="Data.Maybe.html" class="Module">Data.Maybe</a>   <a id="3634" class="Symbol">as</a> <a id="3637" class="Module">Maybe</a>   <a id="3645" class="Keyword">using</a> <a id="3651" class="Symbol">(</a><a id="3652" href="Data.Maybe.Base.html#838" class="Datatype">Maybe</a><a id="3657" class="Symbol">;</a> <a id="3659" href="Data.Maybe.Base.html#892" class="InductiveConstructor">just</a><a id="3663" class="Symbol">;</a> <a id="3665" href="Data.Maybe.Base.html#872" class="InductiveConstructor">nothing</a><a id="3672" class="Symbol">;</a> <a id="3674" href="Data.Maybe.Base.html#1381" class="Function">maybe</a><a id="3679" class="Symbol">)</a>
<a id="3681" class="Keyword">open</a> <a id="3686" class="Keyword">import</a> <a id="3693" href="Data.List.html" class="Module">Data.List</a>    <a id="3706" class="Symbol">as</a> <a id="3709" class="Module">List</a>    <a id="3717" class="Keyword">using</a> <a id="3723" class="Symbol">(</a><a id="3724" href="Agda.Builtin.List.html#148" class="Datatype">List</a><a id="3728" class="Symbol">;</a> <a id="3730" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">_∷_</a><a id="3733" class="Symbol">;</a> <a id="3735" href="Data.List.Base.html#9701" class="InductiveConstructor">[]</a><a id="3737" class="Symbol">)</a>
<a id="3739" class="Keyword">open</a> <a id="3744" class="Keyword">import</a> <a id="3751" href="Data.Nat.html" class="Module">Data.Nat</a>     <a id="3764" class="Symbol">as</a> <a id="3767" class="Module">ℕ</a>       <a id="3775" class="Keyword">using</a> <a id="3781" class="Symbol">(</a><a id="3782" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="3783" class="Symbol">;</a> <a id="3785" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a><a id="3788" class="Symbol">;</a> <a id="3790" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a><a id="3794" class="Symbol">)</a>
<a id="3796" class="Keyword">open</a> <a id="3801" class="Keyword">import</a> <a id="3808" href="Data.Product.html" class="Module">Data.Product</a> <a id="3821" class="Symbol">as</a> <a id="3824" class="Module">Product</a> <a id="3832" class="Keyword">using</a> <a id="3838" class="Symbol">(</a><a id="3839" href="Data.Product.html#1167" class="Function Operator">_×_</a><a id="3842" class="Symbol">;</a> <a id="3844" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a><a id="3847" class="Symbol">)</a>

<a id="3850" class="Keyword">open</a> <a id="3855" class="Keyword">import</a> <a id="3862" href="Agda.Builtin.Reflection.html" class="Module">Agda.Builtin.Reflection</a>

<a id="3887" class="Keyword">import</a> <a id="3894" href="Relation.Binary.Reasoning.Setoid.html" class="Module">Relation.Binary.Reasoning.Setoid</a> <a id="3927" class="Symbol">as</a> <a id="3930" class="Module">SetoidReasoning</a>

<a id="3947" class="Comment">----------------------------------------------------------------------</a>
<a id="4018" class="Comment">-- The Expr type with homomorphism proofs</a>
<a id="4060" class="Comment">----------------------------------------------------------------------</a>

<a id="4132" class="Keyword">infixl</a> <a id="4139" class="Number">7</a> <a id="4141" href="Tactic.MonoidSolver.html#4188" class="InductiveConstructor Operator">_∙′_</a>
<a id="4146" class="Keyword">data</a> <a id="Expr"></a><a id="4151" href="Tactic.MonoidSolver.html#4151" class="Datatype">Expr</a> <a id="4156" class="Symbol">{</a><a id="4157" href="Tactic.MonoidSolver.html#4157" class="Bound">a</a><a id="4158" class="Symbol">}</a> <a id="4160" class="Symbol">(</a><a id="4161" href="Tactic.MonoidSolver.html#4161" class="Bound">A</a> <a id="4163" class="Symbol">:</a> <a id="4165" class="PrimitiveType">Set</a> <a id="4169" href="Tactic.MonoidSolver.html#4157" class="Bound">a</a><a id="4170" class="Symbol">)</a> <a id="4172" class="Symbol">:</a> <a id="4174" class="PrimitiveType">Set</a> <a id="4178" href="Tactic.MonoidSolver.html#4157" class="Bound">a</a> <a id="4180" class="Keyword">where</a>
  <a id="Expr._∙′_"></a><a id="4188" href="Tactic.MonoidSolver.html#4188" class="InductiveConstructor Operator">_∙′_</a>  <a id="4194" class="Symbol">:</a> <a id="4196" href="Tactic.MonoidSolver.html#4151" class="Datatype">Expr</a> <a id="4201" href="Tactic.MonoidSolver.html#4161" class="Bound">A</a> <a id="4203" class="Symbol">→</a> <a id="4205" href="Tactic.MonoidSolver.html#4151" class="Datatype">Expr</a> <a id="4210" href="Tactic.MonoidSolver.html#4161" class="Bound">A</a> <a id="4212" class="Symbol">→</a> <a id="4214" href="Tactic.MonoidSolver.html#4151" class="Datatype">Expr</a> <a id="4219" href="Tactic.MonoidSolver.html#4161" class="Bound">A</a>
  <a id="Expr.ε′"></a><a id="4223" href="Tactic.MonoidSolver.html#4223" class="InductiveConstructor">ε′</a>    <a id="4229" class="Symbol">:</a> <a id="4231" href="Tactic.MonoidSolver.html#4151" class="Datatype">Expr</a> <a id="4236" href="Tactic.MonoidSolver.html#4161" class="Bound">A</a>
  <a id="Expr.[_↑]"></a><a id="4240" href="Tactic.MonoidSolver.html#4240" class="InductiveConstructor Operator">[_↑]</a>  <a id="4246" class="Symbol">:</a> <a id="4248" href="Tactic.MonoidSolver.html#4161" class="Bound">A</a> <a id="4250" class="Symbol">→</a> <a id="4252" href="Tactic.MonoidSolver.html#4151" class="Datatype">Expr</a> <a id="4257" href="Tactic.MonoidSolver.html#4161" class="Bound">A</a>

<a id="4260" class="Keyword">module</a> <a id="4267" href="Tactic.MonoidSolver.html#4267" class="Module">_</a> <a id="4269" class="Symbol">{</a><a id="4270" href="Tactic.MonoidSolver.html#4270" class="Bound">m₁</a> <a id="4273" href="Tactic.MonoidSolver.html#4273" class="Bound">m₂</a><a id="4275" class="Symbol">}</a> <a id="4277" class="Symbol">(</a><a id="4278" href="Tactic.MonoidSolver.html#4278" class="Bound">mon</a> <a id="4282" class="Symbol">:</a> <a id="4284" href="Algebra.Bundles.html#3673" class="Record">Monoid</a> <a id="4291" href="Tactic.MonoidSolver.html#4270" class="Bound">m₁</a> <a id="4294" href="Tactic.MonoidSolver.html#4273" class="Bound">m₂</a><a id="4296" class="Symbol">)</a> <a id="4298" class="Keyword">where</a>
  <a id="4306" class="Keyword">open</a> <a id="4311" href="Algebra.Bundles.html#3673" class="Module">Monoid</a> <a id="4318" href="Tactic.MonoidSolver.html#4278" class="Bound">mon</a>

  <a id="4325" class="Comment">-- Convert the AST to an expression (i.e. evaluate it) without</a>
  <a id="4390" class="Comment">-- normalising.</a>
  <a id="4408" href="Tactic.MonoidSolver.html#4408" class="Function Operator">[_↓]</a> <a id="4413" class="Symbol">:</a> <a id="4415" href="Tactic.MonoidSolver.html#4151" class="Datatype">Expr</a> <a id="4420" href="Algebra.Bundles.html#3752" class="Field">Carrier</a> <a id="4428" class="Symbol">→</a> <a id="4430" href="Algebra.Bundles.html#3752" class="Field">Carrier</a>
  <a id="4440" href="Tactic.MonoidSolver.html#4408" class="Function Operator">[</a> <a id="4442" href="Tactic.MonoidSolver.html#4442" class="Bound">x</a> <a id="4444" href="Tactic.MonoidSolver.html#4188" class="InductiveConstructor Operator">∙′</a> <a id="4447" href="Tactic.MonoidSolver.html#4447" class="Bound">y</a>  <a id="4450" href="Tactic.MonoidSolver.html#4408" class="Function Operator">↓]</a> <a id="4453" class="Symbol">=</a> <a id="4455" href="Tactic.MonoidSolver.html#4408" class="Function Operator">[</a> <a id="4457" href="Tactic.MonoidSolver.html#4442" class="Bound">x</a> <a id="4459" href="Tactic.MonoidSolver.html#4408" class="Function Operator">↓]</a> <a id="4462" href="Algebra.Bundles.html#3802" class="Field Operator">∙</a> <a id="4464" href="Tactic.MonoidSolver.html#4408" class="Function Operator">[</a> <a id="4466" href="Tactic.MonoidSolver.html#4447" class="Bound">y</a> <a id="4468" href="Tactic.MonoidSolver.html#4408" class="Function Operator">↓]</a>
  <a id="4473" href="Tactic.MonoidSolver.html#4408" class="Function Operator">[</a> <a id="4475" href="Tactic.MonoidSolver.html#4223" class="InductiveConstructor">ε′</a>      <a id="4483" href="Tactic.MonoidSolver.html#4408" class="Function Operator">↓]</a> <a id="4486" class="Symbol">=</a> <a id="4488" href="Algebra.Bundles.html#3829" class="Field">ε</a>
  <a id="4492" href="Tactic.MonoidSolver.html#4408" class="Function Operator">[</a> <a id="4494" href="Tactic.MonoidSolver.html#4240" class="InductiveConstructor Operator">[</a> <a id="4496" href="Tactic.MonoidSolver.html#4496" class="Bound">x</a> <a id="4498" href="Tactic.MonoidSolver.html#4240" class="InductiveConstructor Operator">↑]</a>  <a id="4502" href="Tactic.MonoidSolver.html#4408" class="Function Operator">↓]</a> <a id="4505" class="Symbol">=</a> <a id="4507" href="Tactic.MonoidSolver.html#4496" class="Bound">x</a>

  <a id="4512" class="Comment">-- Convert an AST to an expression (i.e. evaluate it) while</a>
  <a id="4574" class="Comment">-- normalising.</a>
  <a id="4592" class="Comment">--</a>
  <a id="4597" class="Comment">-- This first function actually converts an AST to the Cayley</a>
  <a id="4661" class="Comment">-- representation of the underlying monoid.</a>
  <a id="4707" class="Comment">-- This obeys the monoid laws up to beta-eta equality, which is the</a>
  <a id="4777" class="Comment">-- property which gives us the &quot;normalising&quot; behaviour we want.</a>
  <a id="4843" href="Tactic.MonoidSolver.html#4843" class="Function Operator">[_⇓]′</a> <a id="4849" class="Symbol">:</a> <a id="4851" href="Tactic.MonoidSolver.html#4151" class="Datatype">Expr</a> <a id="4856" href="Algebra.Bundles.html#3752" class="Field">Carrier</a> <a id="4864" class="Symbol">→</a> <a id="4866" href="Algebra.Bundles.html#3752" class="Field">Carrier</a> <a id="4874" class="Symbol">→</a> <a id="4876" href="Algebra.Bundles.html#3752" class="Field">Carrier</a>
  <a id="4886" href="Tactic.MonoidSolver.html#4843" class="Function Operator">[</a> <a id="4888" href="Tactic.MonoidSolver.html#4888" class="Bound">x</a> <a id="4890" href="Tactic.MonoidSolver.html#4188" class="InductiveConstructor Operator">∙′</a> <a id="4893" href="Tactic.MonoidSolver.html#4893" class="Bound">y</a>  <a id="4896" href="Tactic.MonoidSolver.html#4843" class="Function Operator">⇓]′</a> <a id="4900" href="Tactic.MonoidSolver.html#4900" class="Bound">z</a> <a id="4902" class="Symbol">=</a> <a id="4904" href="Tactic.MonoidSolver.html#4843" class="Function Operator">[</a> <a id="4906" href="Tactic.MonoidSolver.html#4888" class="Bound">x</a> <a id="4908" href="Tactic.MonoidSolver.html#4843" class="Function Operator">⇓]′</a> <a id="4912" class="Symbol">(</a><a id="4913" href="Tactic.MonoidSolver.html#4843" class="Function Operator">[</a> <a id="4915" href="Tactic.MonoidSolver.html#4893" class="Bound">y</a> <a id="4917" href="Tactic.MonoidSolver.html#4843" class="Function Operator">⇓]′</a> <a id="4921" href="Tactic.MonoidSolver.html#4900" class="Bound">z</a><a id="4922" class="Symbol">)</a>
  <a id="4926" href="Tactic.MonoidSolver.html#4843" class="Function Operator">[</a> <a id="4928" href="Tactic.MonoidSolver.html#4223" class="InductiveConstructor">ε′</a>      <a id="4936" href="Tactic.MonoidSolver.html#4843" class="Function Operator">⇓]′</a> <a id="4940" href="Tactic.MonoidSolver.html#4940" class="Bound">y</a> <a id="4942" class="Symbol">=</a> <a id="4944" href="Tactic.MonoidSolver.html#4940" class="Bound">y</a>
  <a id="4948" href="Tactic.MonoidSolver.html#4843" class="Function Operator">[</a> <a id="4950" href="Tactic.MonoidSolver.html#4240" class="InductiveConstructor Operator">[</a> <a id="4952" href="Tactic.MonoidSolver.html#4952" class="Bound">x</a> <a id="4954" href="Tactic.MonoidSolver.html#4240" class="InductiveConstructor Operator">↑]</a>  <a id="4958" href="Tactic.MonoidSolver.html#4843" class="Function Operator">⇓]′</a> <a id="4962" href="Tactic.MonoidSolver.html#4962" class="Bound">y</a> <a id="4964" class="Symbol">=</a> <a id="4966" href="Tactic.MonoidSolver.html#4952" class="Bound">x</a> <a id="4968" href="Algebra.Bundles.html#3802" class="Field Operator">∙</a> <a id="4970" href="Tactic.MonoidSolver.html#4962" class="Bound">y</a>

  <a id="4975" href="Tactic.MonoidSolver.html#4975" class="Function Operator">[_⇓]</a> <a id="4980" class="Symbol">:</a> <a id="4982" href="Tactic.MonoidSolver.html#4151" class="Datatype">Expr</a> <a id="4987" href="Algebra.Bundles.html#3752" class="Field">Carrier</a> <a id="4995" class="Symbol">→</a> <a id="4997" href="Algebra.Bundles.html#3752" class="Field">Carrier</a>
  <a id="5007" href="Tactic.MonoidSolver.html#4975" class="Function Operator">[</a> <a id="5009" href="Tactic.MonoidSolver.html#5009" class="Bound">x</a> <a id="5011" href="Tactic.MonoidSolver.html#4975" class="Function Operator">⇓]</a> <a id="5014" class="Symbol">=</a> <a id="5016" href="Tactic.MonoidSolver.html#4843" class="Function Operator">[</a> <a id="5018" href="Tactic.MonoidSolver.html#5009" class="Bound">x</a> <a id="5020" href="Tactic.MonoidSolver.html#4843" class="Function Operator">⇓]′</a> <a id="5024" href="Algebra.Bundles.html#3829" class="Field">ε</a>

  <a id="5029" class="Keyword">open</a> <a id="5034" href="Relation.Binary.Reasoning.Setoid.html" class="Module">SetoidReasoning</a> <a id="5050" href="Algebra.Structures.html#1285" class="Function">setoid</a>

  <a id="5060" href="Tactic.MonoidSolver.html#5060" class="Function">homo′</a> <a id="5066" class="Symbol">:</a> <a id="5068" class="Symbol">∀</a> <a id="5070" href="Tactic.MonoidSolver.html#5070" class="Bound">x</a> <a id="5072" href="Tactic.MonoidSolver.html#5072" class="Bound">y</a> <a id="5074" class="Symbol">→</a> <a id="5076" href="Tactic.MonoidSolver.html#4975" class="Function Operator">[</a> <a id="5078" href="Tactic.MonoidSolver.html#5070" class="Bound">x</a> <a id="5080" href="Tactic.MonoidSolver.html#4975" class="Function Operator">⇓]</a> <a id="5083" href="Algebra.Bundles.html#3802" class="Field Operator">∙</a> <a id="5085" href="Tactic.MonoidSolver.html#5072" class="Bound">y</a> <a id="5087" href="Algebra.Bundles.html#3773" class="Field Operator">≈</a> <a id="5089" href="Tactic.MonoidSolver.html#4843" class="Function Operator">[</a> <a id="5091" href="Tactic.MonoidSolver.html#5070" class="Bound">x</a> <a id="5093" href="Tactic.MonoidSolver.html#4843" class="Function Operator">⇓]′</a> <a id="5097" href="Tactic.MonoidSolver.html#5072" class="Bound">y</a>
  <a id="5101" href="Tactic.MonoidSolver.html#5060" class="Function">homo′</a> <a id="5107" href="Tactic.MonoidSolver.html#4223" class="InductiveConstructor">ε′</a> <a id="5110" href="Tactic.MonoidSolver.html#5110" class="Bound">y</a>       <a id="5118" class="Symbol">=</a> <a id="5120" href="Algebra.Structures.html#2685" class="Function">identityˡ</a> <a id="5130" href="Tactic.MonoidSolver.html#5110" class="Bound">y</a>
  <a id="5134" href="Tactic.MonoidSolver.html#5060" class="Function">homo′</a> <a id="5140" href="Tactic.MonoidSolver.html#4240" class="InductiveConstructor Operator">[</a> <a id="5142" href="Tactic.MonoidSolver.html#5142" class="Bound">x</a> <a id="5144" href="Tactic.MonoidSolver.html#4240" class="InductiveConstructor Operator">↑]</a> <a id="5147" href="Tactic.MonoidSolver.html#5147" class="Bound">y</a>   <a id="5151" class="Symbol">=</a> <a id="5153" href="Algebra.Structures.html#1421" class="Function">∙-congʳ</a> <a id="5161" class="Symbol">(</a><a id="5162" href="Algebra.Structures.html#2746" class="Function">identityʳ</a> <a id="5172" href="Tactic.MonoidSolver.html#5142" class="Bound">x</a><a id="5173" class="Symbol">)</a>
  <a id="5177" href="Tactic.MonoidSolver.html#5060" class="Function">homo′</a> <a id="5183" class="Symbol">(</a><a id="5184" href="Tactic.MonoidSolver.html#5184" class="Bound">x</a> <a id="5186" href="Tactic.MonoidSolver.html#4188" class="InductiveConstructor Operator">∙′</a> <a id="5189" href="Tactic.MonoidSolver.html#5189" class="Bound">y</a><a id="5190" class="Symbol">)</a> <a id="5192" href="Tactic.MonoidSolver.html#5192" class="Bound">z</a> <a id="5194" class="Symbol">=</a> <a id="5196" href="Relation.Binary.Reasoning.Base.Partial.html#1660" class="Function Operator">begin</a>
    <a id="5206" href="Tactic.MonoidSolver.html#4975" class="Function Operator">[</a> <a id="5208" href="Tactic.MonoidSolver.html#5184" class="Bound">x</a> <a id="5210" href="Tactic.MonoidSolver.html#4188" class="InductiveConstructor Operator">∙′</a> <a id="5213" href="Tactic.MonoidSolver.html#5189" class="Bound">y</a> <a id="5215" href="Tactic.MonoidSolver.html#4975" class="Function Operator">⇓]</a> <a id="5218" href="Algebra.Bundles.html#3802" class="Field Operator">∙</a> <a id="5220" href="Tactic.MonoidSolver.html#5192" class="Bound">z</a>       <a id="5228" href="Relation.Binary.Reasoning.Base.Partial.html#2214" class="Function Operator">≡⟨⟩</a>
    <a id="5236" href="Tactic.MonoidSolver.html#4843" class="Function Operator">[</a> <a id="5238" href="Tactic.MonoidSolver.html#5184" class="Bound">x</a> <a id="5240" href="Tactic.MonoidSolver.html#4843" class="Function Operator">⇓]′</a> <a id="5244" href="Tactic.MonoidSolver.html#4975" class="Function Operator">[</a> <a id="5246" href="Tactic.MonoidSolver.html#5189" class="Bound">y</a> <a id="5248" href="Tactic.MonoidSolver.html#4975" class="Function Operator">⇓]</a> <a id="5251" href="Algebra.Bundles.html#3802" class="Field Operator">∙</a> <a id="5253" href="Tactic.MonoidSolver.html#5192" class="Bound">z</a>    <a id="5258" href="Relation.Binary.Reasoning.PartialSetoid.html#898" class="Function">≈˘⟨</a> <a id="5262" href="Algebra.Structures.html#1421" class="Function">∙-congʳ</a> <a id="5270" class="Symbol">(</a><a id="5271" href="Tactic.MonoidSolver.html#5060" class="Function">homo′</a> <a id="5277" href="Tactic.MonoidSolver.html#5184" class="Bound">x</a> <a id="5279" href="Tactic.MonoidSolver.html#4975" class="Function Operator">[</a> <a id="5281" href="Tactic.MonoidSolver.html#5189" class="Bound">y</a> <a id="5283" href="Tactic.MonoidSolver.html#4975" class="Function Operator">⇓]</a><a id="5285" class="Symbol">)</a> <a id="5287" href="Relation.Binary.Reasoning.PartialSetoid.html#898" class="Function">⟩</a>
    <a id="5293" class="Symbol">(</a><a id="5294" href="Tactic.MonoidSolver.html#4975" class="Function Operator">[</a> <a id="5296" href="Tactic.MonoidSolver.html#5184" class="Bound">x</a> <a id="5298" href="Tactic.MonoidSolver.html#4975" class="Function Operator">⇓]</a> <a id="5301" href="Algebra.Bundles.html#3802" class="Field Operator">∙</a> <a id="5303" href="Tactic.MonoidSolver.html#4975" class="Function Operator">[</a> <a id="5305" href="Tactic.MonoidSolver.html#5189" class="Bound">y</a> <a id="5307" href="Tactic.MonoidSolver.html#4975" class="Function Operator">⇓]</a><a id="5309" class="Symbol">)</a> <a id="5311" href="Algebra.Bundles.html#3802" class="Field Operator">∙</a> <a id="5313" href="Tactic.MonoidSolver.html#5192" class="Bound">z</a> <a id="5315" href="Relation.Binary.Reasoning.PartialSetoid.html#797" class="Function">≈⟨</a> <a id="5318" href="Algebra.Structures.html#1569" class="Function">assoc</a> <a id="5324" href="Tactic.MonoidSolver.html#4975" class="Function Operator">[</a> <a id="5326" href="Tactic.MonoidSolver.html#5184" class="Bound">x</a> <a id="5328" href="Tactic.MonoidSolver.html#4975" class="Function Operator">⇓]</a> <a id="5331" href="Tactic.MonoidSolver.html#4975" class="Function Operator">[</a> <a id="5333" href="Tactic.MonoidSolver.html#5189" class="Bound">y</a> <a id="5335" href="Tactic.MonoidSolver.html#4975" class="Function Operator">⇓]</a> <a id="5338" href="Tactic.MonoidSolver.html#5192" class="Bound">z</a> <a id="5340" href="Relation.Binary.Reasoning.PartialSetoid.html#797" class="Function">⟩</a>
    <a id="5346" href="Tactic.MonoidSolver.html#4975" class="Function Operator">[</a> <a id="5348" href="Tactic.MonoidSolver.html#5184" class="Bound">x</a> <a id="5350" href="Tactic.MonoidSolver.html#4975" class="Function Operator">⇓]</a> <a id="5353" href="Algebra.Bundles.html#3802" class="Field Operator">∙</a> <a id="5355" class="Symbol">(</a><a id="5356" href="Tactic.MonoidSolver.html#4975" class="Function Operator">[</a> <a id="5358" href="Tactic.MonoidSolver.html#5189" class="Bound">y</a> <a id="5360" href="Tactic.MonoidSolver.html#4975" class="Function Operator">⇓]</a> <a id="5363" href="Algebra.Bundles.html#3802" class="Field Operator">∙</a> <a id="5365" href="Tactic.MonoidSolver.html#5192" class="Bound">z</a><a id="5366" class="Symbol">)</a> <a id="5368" href="Relation.Binary.Reasoning.PartialSetoid.html#797" class="Function">≈⟨</a> <a id="5371" href="Algebra.Structures.html#1360" class="Function">∙-congˡ</a> <a id="5379" class="Symbol">(</a><a id="5380" href="Tactic.MonoidSolver.html#5060" class="Function">homo′</a> <a id="5386" href="Tactic.MonoidSolver.html#5189" class="Bound">y</a> <a id="5388" href="Tactic.MonoidSolver.html#5192" class="Bound">z</a><a id="5389" class="Symbol">)</a> <a id="5391" href="Relation.Binary.Reasoning.PartialSetoid.html#797" class="Function">⟩</a>
    <a id="5397" href="Tactic.MonoidSolver.html#4975" class="Function Operator">[</a> <a id="5399" href="Tactic.MonoidSolver.html#5184" class="Bound">x</a> <a id="5401" href="Tactic.MonoidSolver.html#4975" class="Function Operator">⇓]</a> <a id="5404" href="Algebra.Bundles.html#3802" class="Field Operator">∙</a> <a id="5406" class="Symbol">(</a><a id="5407" href="Tactic.MonoidSolver.html#4843" class="Function Operator">[</a> <a id="5409" href="Tactic.MonoidSolver.html#5189" class="Bound">y</a> <a id="5411" href="Tactic.MonoidSolver.html#4843" class="Function Operator">⇓]′</a> <a id="5415" href="Tactic.MonoidSolver.html#5192" class="Bound">z</a><a id="5416" class="Symbol">)</a>  <a id="5419" href="Relation.Binary.Reasoning.PartialSetoid.html#797" class="Function">≈⟨</a> <a id="5422" href="Tactic.MonoidSolver.html#5060" class="Function">homo′</a> <a id="5428" href="Tactic.MonoidSolver.html#5184" class="Bound">x</a> <a id="5430" class="Symbol">(</a><a id="5431" href="Tactic.MonoidSolver.html#4843" class="Function Operator">[</a> <a id="5433" href="Tactic.MonoidSolver.html#5189" class="Bound">y</a> <a id="5435" href="Tactic.MonoidSolver.html#4843" class="Function Operator">⇓]′</a> <a id="5439" href="Tactic.MonoidSolver.html#5192" class="Bound">z</a><a id="5440" class="Symbol">)</a> <a id="5442" href="Relation.Binary.Reasoning.PartialSetoid.html#797" class="Function">⟩</a>
    <a id="5448" href="Tactic.MonoidSolver.html#4843" class="Function Operator">[</a> <a id="5450" href="Tactic.MonoidSolver.html#5184" class="Bound">x</a> <a id="5452" href="Tactic.MonoidSolver.html#4843" class="Function Operator">⇓]′</a> <a id="5456" class="Symbol">(</a><a id="5457" href="Tactic.MonoidSolver.html#4843" class="Function Operator">[</a> <a id="5459" href="Tactic.MonoidSolver.html#5189" class="Bound">y</a> <a id="5461" href="Tactic.MonoidSolver.html#4843" class="Function Operator">⇓]′</a> <a id="5465" href="Tactic.MonoidSolver.html#5192" class="Bound">z</a><a id="5466" class="Symbol">)</a>   <a id="5470" href="Relation.Binary.Reasoning.Base.Single.html#767" class="Function Operator">∎</a>

  <a id="5475" href="Tactic.MonoidSolver.html#5475" class="Function">homo</a> <a id="5480" class="Symbol">:</a> <a id="5482" class="Symbol">∀</a> <a id="5484" href="Tactic.MonoidSolver.html#5484" class="Bound">x</a> <a id="5486" class="Symbol">→</a> <a id="5488" href="Tactic.MonoidSolver.html#4975" class="Function Operator">[</a> <a id="5490" href="Tactic.MonoidSolver.html#5484" class="Bound">x</a> <a id="5492" href="Tactic.MonoidSolver.html#4975" class="Function Operator">⇓]</a> <a id="5495" href="Algebra.Bundles.html#3773" class="Field Operator">≈</a> <a id="5497" href="Tactic.MonoidSolver.html#4408" class="Function Operator">[</a> <a id="5499" href="Tactic.MonoidSolver.html#5484" class="Bound">x</a> <a id="5501" href="Tactic.MonoidSolver.html#4408" class="Function Operator">↓]</a>
  <a id="5506" href="Tactic.MonoidSolver.html#5475" class="Function">homo</a> <a id="5511" href="Tactic.MonoidSolver.html#4223" class="InductiveConstructor">ε′</a>       <a id="5520" class="Symbol">=</a> <a id="5522" href="Relation.Binary.Structures.html#1568" class="Function">refl</a>
  <a id="5529" href="Tactic.MonoidSolver.html#5475" class="Function">homo</a> <a id="5534" href="Tactic.MonoidSolver.html#4240" class="InductiveConstructor Operator">[</a> <a id="5536" href="Tactic.MonoidSolver.html#5536" class="Bound">x</a> <a id="5538" href="Tactic.MonoidSolver.html#4240" class="InductiveConstructor Operator">↑]</a>   <a id="5543" class="Symbol">=</a> <a id="5545" href="Algebra.Structures.html#2746" class="Function">identityʳ</a> <a id="5555" href="Tactic.MonoidSolver.html#5536" class="Bound">x</a>
  <a id="5559" href="Tactic.MonoidSolver.html#5475" class="Function">homo</a> <a id="5564" class="Symbol">(</a><a id="5565" href="Tactic.MonoidSolver.html#5565" class="Bound">x</a> <a id="5567" href="Tactic.MonoidSolver.html#4188" class="InductiveConstructor Operator">∙′</a> <a id="5570" href="Tactic.MonoidSolver.html#5570" class="Bound">y</a><a id="5571" class="Symbol">)</a> <a id="5573" class="Symbol">=</a> <a id="5575" href="Relation.Binary.Reasoning.Base.Partial.html#1660" class="Function Operator">begin</a>
    <a id="5585" href="Tactic.MonoidSolver.html#4975" class="Function Operator">[</a> <a id="5587" href="Tactic.MonoidSolver.html#5565" class="Bound">x</a> <a id="5589" href="Tactic.MonoidSolver.html#4188" class="InductiveConstructor Operator">∙′</a> <a id="5592" href="Tactic.MonoidSolver.html#5570" class="Bound">y</a> <a id="5594" href="Tactic.MonoidSolver.html#4975" class="Function Operator">⇓]</a>     <a id="5601" href="Relation.Binary.Reasoning.Base.Partial.html#2214" class="Function Operator">≡⟨⟩</a>
    <a id="5609" href="Tactic.MonoidSolver.html#4843" class="Function Operator">[</a> <a id="5611" href="Tactic.MonoidSolver.html#5565" class="Bound">x</a> <a id="5613" href="Tactic.MonoidSolver.html#4843" class="Function Operator">⇓]′</a> <a id="5617" href="Tactic.MonoidSolver.html#4975" class="Function Operator">[</a> <a id="5619" href="Tactic.MonoidSolver.html#5570" class="Bound">y</a> <a id="5621" href="Tactic.MonoidSolver.html#4975" class="Function Operator">⇓]</a>  <a id="5625" href="Relation.Binary.Reasoning.PartialSetoid.html#898" class="Function">≈˘⟨</a> <a id="5629" href="Tactic.MonoidSolver.html#5060" class="Function">homo′</a> <a id="5635" href="Tactic.MonoidSolver.html#5565" class="Bound">x</a> <a id="5637" href="Tactic.MonoidSolver.html#4975" class="Function Operator">[</a> <a id="5639" href="Tactic.MonoidSolver.html#5570" class="Bound">y</a> <a id="5641" href="Tactic.MonoidSolver.html#4975" class="Function Operator">⇓]</a> <a id="5644" href="Relation.Binary.Reasoning.PartialSetoid.html#898" class="Function">⟩</a>
    <a id="5650" href="Tactic.MonoidSolver.html#4975" class="Function Operator">[</a> <a id="5652" href="Tactic.MonoidSolver.html#5565" class="Bound">x</a> <a id="5654" href="Tactic.MonoidSolver.html#4975" class="Function Operator">⇓]</a> <a id="5657" href="Algebra.Bundles.html#3802" class="Field Operator">∙</a> <a id="5659" href="Tactic.MonoidSolver.html#4975" class="Function Operator">[</a> <a id="5661" href="Tactic.MonoidSolver.html#5570" class="Bound">y</a> <a id="5663" href="Tactic.MonoidSolver.html#4975" class="Function Operator">⇓]</a> <a id="5666" href="Relation.Binary.Reasoning.PartialSetoid.html#797" class="Function">≈⟨</a> <a id="5669" href="Algebra.Structures.html#1210" class="Function">∙-cong</a> <a id="5676" class="Symbol">(</a><a id="5677" href="Tactic.MonoidSolver.html#5475" class="Function">homo</a> <a id="5682" href="Tactic.MonoidSolver.html#5565" class="Bound">x</a><a id="5683" class="Symbol">)</a> <a id="5685" class="Symbol">(</a><a id="5686" href="Tactic.MonoidSolver.html#5475" class="Function">homo</a> <a id="5691" href="Tactic.MonoidSolver.html#5570" class="Bound">y</a><a id="5692" class="Symbol">)</a> <a id="5694" href="Relation.Binary.Reasoning.PartialSetoid.html#797" class="Function">⟩</a>
    <a id="5700" href="Tactic.MonoidSolver.html#4408" class="Function Operator">[</a> <a id="5702" href="Tactic.MonoidSolver.html#5565" class="Bound">x</a> <a id="5704" href="Tactic.MonoidSolver.html#4408" class="Function Operator">↓]</a> <a id="5707" href="Algebra.Bundles.html#3802" class="Field Operator">∙</a> <a id="5709" href="Tactic.MonoidSolver.html#4408" class="Function Operator">[</a> <a id="5711" href="Tactic.MonoidSolver.html#5570" class="Bound">y</a> <a id="5713" href="Tactic.MonoidSolver.html#4408" class="Function Operator">↓]</a> <a id="5716" href="Relation.Binary.Reasoning.Base.Single.html#767" class="Function Operator">∎</a>

<a id="5719" class="Comment">----------------------------------------------------------------------</a>
<a id="5790" class="Comment">-- Helpers for reflection</a>
<a id="5816" class="Comment">----------------------------------------------------------------------</a>

<a id="_==_"></a><a id="5888" href="Tactic.MonoidSolver.html#5888" class="Function Operator">_==_</a> <a id="5893" class="Symbol">=</a> <a id="5895" href="Agda.Builtin.Reflection.html#513" class="Primitive">primQNameEquality</a>
<a id="5913" class="Symbol">{-#</a> <a id="5917" class="Keyword">INLINE</a> <a id="5924" href="Tactic.MonoidSolver.html#5888" class="Function Operator">_==_</a> <a id="5929" class="Symbol">#-}</a>

<a id="_&gt;&gt;=_"></a><a id="5934" href="Tactic.MonoidSolver.html#5934" class="Function Operator">_&gt;&gt;=_</a> <a id="5940" class="Symbol">=</a> <a id="5942" href="Agda.Builtin.Reflection.html#7449" class="Postulate">bindTC</a>
<a id="5949" class="Symbol">{-#</a> <a id="5953" class="Keyword">INLINE</a> <a id="5960" href="Tactic.MonoidSolver.html#5934" class="Function Operator">_&gt;&gt;=_</a> <a id="5966" class="Symbol">#-}</a>

<a id="_&gt;&gt;_"></a><a id="5971" href="Tactic.MonoidSolver.html#5971" class="Function Operator">_&gt;&gt;_</a> <a id="5976" class="Symbol">:</a> <a id="5978" class="Symbol">∀</a> <a id="5980" class="Symbol">{</a><a id="5981" href="Tactic.MonoidSolver.html#5981" class="Bound">a</a> <a id="5983" href="Tactic.MonoidSolver.html#5983" class="Bound">b</a><a id="5984" class="Symbol">}</a> <a id="5986" class="Symbol">{</a><a id="5987" href="Tactic.MonoidSolver.html#5987" class="Bound">A</a> <a id="5989" class="Symbol">:</a> <a id="5991" class="PrimitiveType">Set</a> <a id="5995" href="Tactic.MonoidSolver.html#5981" class="Bound">a</a><a id="5996" class="Symbol">}</a> <a id="5998" class="Symbol">{</a><a id="5999" href="Tactic.MonoidSolver.html#5999" class="Bound">B</a> <a id="6001" class="Symbol">:</a> <a id="6003" class="PrimitiveType">Set</a> <a id="6007" href="Tactic.MonoidSolver.html#5983" class="Bound">b</a><a id="6008" class="Symbol">}</a> <a id="6010" class="Symbol">→</a> <a id="6012" href="Agda.Builtin.Reflection.html#7356" class="Postulate">TC</a> <a id="6015" href="Tactic.MonoidSolver.html#5987" class="Bound">A</a> <a id="6017" class="Symbol">→</a> <a id="6019" href="Agda.Builtin.Reflection.html#7356" class="Postulate">TC</a> <a id="6022" href="Tactic.MonoidSolver.html#5999" class="Bound">B</a> <a id="6024" class="Symbol">→</a> <a id="6026" href="Agda.Builtin.Reflection.html#7356" class="Postulate">TC</a> <a id="6029" href="Tactic.MonoidSolver.html#5999" class="Bound">B</a>
<a id="6031" href="Tactic.MonoidSolver.html#6031" class="Bound">xs</a> <a id="6034" href="Tactic.MonoidSolver.html#5971" class="Function Operator">&gt;&gt;</a> <a id="6037" href="Tactic.MonoidSolver.html#6037" class="Bound">ys</a> <a id="6040" class="Symbol">=</a> <a id="6042" href="Tactic.MonoidSolver.html#6031" class="Bound">xs</a> <a id="6045" href="Tactic.MonoidSolver.html#5934" class="Function Operator">&gt;&gt;=</a> <a id="6049" class="Symbol">λ</a> <a id="6051" href="Tactic.MonoidSolver.html#6051" class="Bound">_</a> <a id="6053" class="Symbol">→</a> <a id="6055" href="Tactic.MonoidSolver.html#6037" class="Bound">ys</a>
<a id="6058" class="Symbol">{-#</a> <a id="6062" class="Keyword">INLINE</a> <a id="6069" href="Tactic.MonoidSolver.html#5971" class="Function Operator">_&gt;&gt;_</a> <a id="6074" class="Symbol">#-}</a>

<a id="6079" class="Keyword">infixr</a> <a id="6086" class="Number">5</a> <a id="6088" href="Tactic.MonoidSolver.html#6108" class="InductiveConstructor Operator">_⟨∷⟩_</a> <a id="6094" href="Tactic.MonoidSolver.html#6168" class="InductiveConstructor Operator">_⟅∷⟆_</a>
<a id="6100" class="Keyword">pattern</a> <a id="_⟨∷⟩_"></a><a id="6108" href="Tactic.MonoidSolver.html#6108" class="InductiveConstructor Operator">_⟨∷⟩_</a> <a id="6114" href="Tactic.MonoidSolver.html#6153" class="Bound">x</a> <a id="6116" href="Tactic.MonoidSolver.html#6157" class="Bound">xs</a> <a id="6119" class="Symbol">=</a> <a id="6121" href="Agda.Builtin.Reflection.html#3264" class="InductiveConstructor">arg</a> <a id="6125" class="Symbol">(</a><a id="6126" href="Agda.Builtin.Reflection.html#3168" class="InductiveConstructor">arg-info</a> <a id="6135" href="Agda.Builtin.Reflection.html#2736" class="InductiveConstructor">visible</a> <a id="6143" href="Agda.Builtin.Reflection.html#2993" class="InductiveConstructor">relevant</a><a id="6151" class="Symbol">)</a> <a id="6153" href="Tactic.MonoidSolver.html#6153" class="Bound">x</a> <a id="6155" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6157" href="Tactic.MonoidSolver.html#6157" class="Bound">xs</a>
<a id="6160" class="Keyword">pattern</a> <a id="_⟅∷⟆_"></a><a id="6168" href="Tactic.MonoidSolver.html#6168" class="InductiveConstructor Operator">_⟅∷⟆_</a> <a id="6174" href="Tactic.MonoidSolver.html#6212" class="Bound">x</a> <a id="6176" href="Tactic.MonoidSolver.html#6216" class="Bound">xs</a> <a id="6179" class="Symbol">=</a> <a id="6181" href="Agda.Builtin.Reflection.html#3264" class="InductiveConstructor">arg</a> <a id="6185" class="Symbol">(</a><a id="6186" href="Agda.Builtin.Reflection.html#3168" class="InductiveConstructor">arg-info</a> <a id="6195" href="Agda.Builtin.Reflection.html#2744" class="InductiveConstructor">hidden</a> <a id="6202" href="Agda.Builtin.Reflection.html#2993" class="InductiveConstructor">relevant</a><a id="6210" class="Symbol">)</a> <a id="6212" href="Tactic.MonoidSolver.html#6212" class="Bound">x</a> <a id="6214" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6216" href="Tactic.MonoidSolver.html#6216" class="Bound">xs</a>

<a id="6220" class="Keyword">infixr</a> <a id="6227" class="Number">5</a> <a id="6229" href="Tactic.MonoidSolver.html#6236" class="Function Operator">_⋯⟅∷⟆_</a>
<a id="_⋯⟅∷⟆_"></a><a id="6236" href="Tactic.MonoidSolver.html#6236" class="Function Operator">_⋯⟅∷⟆_</a> <a id="6243" class="Symbol">:</a> <a id="6245" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="6247" class="Symbol">→</a> <a id="6249" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="6254" class="Symbol">(</a><a id="6255" href="Agda.Builtin.Reflection.html#3228" class="Datatype">Arg</a> <a id="6259" href="Agda.Builtin.Reflection.html#4751" class="Datatype">Term</a><a id="6263" class="Symbol">)</a> <a id="6265" class="Symbol">→</a> <a id="6267" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="6272" class="Symbol">(</a><a id="6273" href="Agda.Builtin.Reflection.html#3228" class="Datatype">Arg</a> <a id="6277" href="Agda.Builtin.Reflection.html#4751" class="Datatype">Term</a><a id="6281" class="Symbol">)</a>
<a id="6283" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>  <a id="6289" href="Tactic.MonoidSolver.html#6236" class="Function Operator">⋯⟅∷⟆</a> <a id="6294" href="Tactic.MonoidSolver.html#6294" class="Bound">xs</a> <a id="6297" class="Symbol">=</a> <a id="6299" href="Tactic.MonoidSolver.html#6294" class="Bound">xs</a>
<a id="6302" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="6306" href="Tactic.MonoidSolver.html#6306" class="Bound">i</a> <a id="6308" href="Tactic.MonoidSolver.html#6236" class="Function Operator">⋯⟅∷⟆</a> <a id="6313" href="Tactic.MonoidSolver.html#6313" class="Bound">xs</a> <a id="6316" class="Symbol">=</a> <a id="6318" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">unknown</a> <a id="6326" href="Tactic.MonoidSolver.html#6168" class="InductiveConstructor Operator">⟅∷⟆</a> <a id="6330" href="Tactic.MonoidSolver.html#6306" class="Bound">i</a> <a id="6332" href="Tactic.MonoidSolver.html#6236" class="Function Operator">⋯⟅∷⟆</a> <a id="6337" href="Tactic.MonoidSolver.html#6313" class="Bound">xs</a>
<a id="6340" class="Symbol">{-#</a> <a id="6344" class="Keyword">INLINE</a> <a id="6351" href="Tactic.MonoidSolver.html#6236" class="Function Operator">_⋯⟅∷⟆_</a> <a id="6358" class="Symbol">#-}</a>

<a id="getName"></a><a id="6363" href="Tactic.MonoidSolver.html#6363" class="Function">getName</a> <a id="6371" class="Symbol">:</a> <a id="6373" href="Agda.Builtin.Reflection.html#4751" class="Datatype">Term</a> <a id="6378" class="Symbol">→</a> <a id="6380" href="Data.Maybe.Base.html#838" class="Datatype">Maybe</a> <a id="6386" href="Agda.Builtin.Reflection.html#462" class="Postulate">Name</a>
<a id="6391" href="Tactic.MonoidSolver.html#6363" class="Function">getName</a> <a id="6399" class="Symbol">(</a><a id="6400" href="Agda.Builtin.Reflection.html#4851" class="InductiveConstructor">con</a> <a id="6404" href="Tactic.MonoidSolver.html#6404" class="Bound">c</a> <a id="6406" href="Tactic.MonoidSolver.html#6406" class="Bound">args</a><a id="6410" class="Symbol">)</a> <a id="6412" class="Symbol">=</a> <a id="6414" href="Data.Maybe.Base.html#892" class="InductiveConstructor">just</a> <a id="6419" href="Tactic.MonoidSolver.html#6404" class="Bound">c</a>
<a id="6421" href="Tactic.MonoidSolver.html#6363" class="Function">getName</a> <a id="6429" class="Symbol">(</a><a id="6430" href="Agda.Builtin.Reflection.html#4908" class="InductiveConstructor">def</a> <a id="6434" href="Tactic.MonoidSolver.html#6434" class="Bound">f</a> <a id="6436" href="Tactic.MonoidSolver.html#6436" class="Bound">args</a><a id="6440" class="Symbol">)</a> <a id="6442" class="Symbol">=</a> <a id="6444" href="Data.Maybe.Base.html#892" class="InductiveConstructor">just</a> <a id="6449" href="Tactic.MonoidSolver.html#6434" class="Bound">f</a>
<a id="6451" href="Tactic.MonoidSolver.html#6363" class="CatchallClause Function">getName</a><a id="6458" class="CatchallClause"> </a><a id="6459" class="CatchallClause Symbol">_</a> <a id="6461" class="Symbol">=</a> <a id="6463" href="Data.Maybe.Base.html#872" class="InductiveConstructor">nothing</a>

<a id="getArgs"></a><a id="6472" href="Tactic.MonoidSolver.html#6472" class="Function">getArgs</a> <a id="6480" class="Symbol">:</a> <a id="6482" href="Agda.Builtin.Reflection.html#4751" class="Datatype">Term</a> <a id="6487" class="Symbol">→</a> <a id="6489" href="Data.Maybe.Base.html#838" class="Datatype">Maybe</a> <a id="6495" class="Symbol">(</a><a id="6496" href="Agda.Builtin.Reflection.html#4751" class="Datatype">Term</a> <a id="6501" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="6503" href="Agda.Builtin.Reflection.html#4751" class="Datatype">Term</a><a id="6507" class="Symbol">)</a>
<a id="6509" href="Tactic.MonoidSolver.html#6472" class="Function">getArgs</a> <a id="6517" class="Symbol">(</a><a id="6518" href="Agda.Builtin.Reflection.html#4908" class="InductiveConstructor">def</a> <a id="6522" class="Symbol">_</a> <a id="6524" href="Tactic.MonoidSolver.html#6524" class="Bound">xs</a><a id="6526" class="Symbol">)</a> <a id="6528" class="Symbol">=</a> <a id="6530" href="Tactic.MonoidSolver.html#6546" class="Function">go</a> <a id="6533" href="Tactic.MonoidSolver.html#6524" class="Bound">xs</a>
  <a id="6538" class="Keyword">where</a>
  <a id="6546" href="Tactic.MonoidSolver.html#6546" class="Function">go</a> <a id="6549" class="Symbol">:</a> <a id="6551" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="6556" class="Symbol">(</a><a id="6557" href="Agda.Builtin.Reflection.html#3228" class="Datatype">Arg</a> <a id="6561" href="Agda.Builtin.Reflection.html#4751" class="Datatype">Term</a><a id="6565" class="Symbol">)</a> <a id="6567" class="Symbol">→</a> <a id="6569" href="Data.Maybe.Base.html#838" class="Datatype">Maybe</a> <a id="6575" class="Symbol">(</a><a id="6576" href="Agda.Builtin.Reflection.html#4751" class="Datatype">Term</a> <a id="6581" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="6583" href="Agda.Builtin.Reflection.html#4751" class="Datatype">Term</a><a id="6587" class="Symbol">)</a>
  <a id="6591" href="Tactic.MonoidSolver.html#6546" class="Function">go</a> <a id="6594" class="Symbol">(</a><a id="6595" href="Tactic.MonoidSolver.html#6595" class="Bound">x</a> <a id="6597" href="Tactic.MonoidSolver.html#6108" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="6601" href="Tactic.MonoidSolver.html#6601" class="Bound">y</a> <a id="6603" href="Tactic.MonoidSolver.html#6108" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="6607" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="6609" class="Symbol">)</a> <a id="6611" class="Symbol">=</a> <a id="6613" href="Data.Maybe.Base.html#892" class="InductiveConstructor">just</a> <a id="6618" class="Symbol">(</a><a id="6619" href="Tactic.MonoidSolver.html#6595" class="Bound">x</a> <a id="6621" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6623" href="Tactic.MonoidSolver.html#6601" class="Bound">y</a><a id="6624" class="Symbol">)</a>
  <a id="6628" href="Tactic.MonoidSolver.html#6546" class="CatchallClause Function">go</a><a id="6630" class="CatchallClause"> </a><a id="6631" class="CatchallClause Symbol">(</a><a id="6632" href="Tactic.MonoidSolver.html#6632" class="CatchallClause Bound">x</a><a id="6633" class="CatchallClause"> </a><a id="6634" href="Agda.Builtin.List.html#200" class="CatchallClause InductiveConstructor Operator">∷</a><a id="6635" class="CatchallClause"> </a><a id="6636" href="Tactic.MonoidSolver.html#6636" class="CatchallClause Bound">xs</a><a id="6638" class="CatchallClause Symbol">)</a> <a id="6640" class="Symbol">=</a> <a id="6642" href="Tactic.MonoidSolver.html#6546" class="Function">go</a> <a id="6645" href="Tactic.MonoidSolver.html#6636" class="Bound">xs</a>
  <a id="6650" href="Tactic.MonoidSolver.html#6546" class="CatchallClause Function">go</a><a id="6652" class="CatchallClause"> </a><a id="6653" class="CatchallClause Symbol">_</a> <a id="6655" class="Symbol">=</a> <a id="6657" href="Data.Maybe.Base.html#872" class="InductiveConstructor">nothing</a>
<a id="6665" href="Tactic.MonoidSolver.html#6472" class="CatchallClause Function">getArgs</a><a id="6672" class="CatchallClause"> </a><a id="6673" class="CatchallClause Symbol">_</a> <a id="6675" class="Symbol">=</a> <a id="6677" href="Data.Maybe.Base.html#872" class="InductiveConstructor">nothing</a>

<a id="6686" class="Comment">----------------------------------------------------------------------</a>
<a id="6757" class="Comment">-- Getting monoid names</a>
<a id="6781" class="Comment">----------------------------------------------------------------------</a>

<a id="6853" class="Comment">-- We try to be flexible here, by matching two kinds of names.</a>
<a id="6916" class="Comment">-- The first is the field accessor for the monoid record itself.</a>
<a id="6981" class="Comment">-- However, users will likely want to use the solver with</a>
<a id="7039" class="Comment">-- expressions like:</a>
<a id="7060" class="Comment">--   xs ++ (ys ++ zs) ≡ (xs ++ ys) ++ zs</a>
<a id="7101" class="Comment">-- So we also evaluate the field accessor to find functions like ++.</a>

<a id="7171" class="Keyword">record</a> <a id="MonoidNames"></a><a id="7178" href="Tactic.MonoidSolver.html#7178" class="Record">MonoidNames</a> <a id="7190" class="Symbol">:</a> <a id="7192" class="PrimitiveType">Set</a> <a id="7196" class="Keyword">where</a>
  <a id="7204" class="Keyword">field</a>
    <a id="MonoidNames.is-∙"></a><a id="7214" href="Tactic.MonoidSolver.html#7214" class="Field">is-∙</a> <a id="7219" class="Symbol">:</a> <a id="7221" href="Agda.Builtin.Reflection.html#462" class="Postulate">Name</a> <a id="7226" class="Symbol">→</a> <a id="7228" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
    <a id="MonoidNames.is-ε"></a><a id="7237" href="Tactic.MonoidSolver.html#7237" class="Field">is-ε</a> <a id="7242" class="Symbol">:</a> <a id="7244" href="Agda.Builtin.Reflection.html#462" class="Postulate">Name</a> <a id="7249" class="Symbol">→</a> <a id="7251" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>

<a id="findMonoidNames"></a><a id="7257" href="Tactic.MonoidSolver.html#7257" class="Function">findMonoidNames</a> <a id="7273" class="Symbol">:</a> <a id="7275" href="Agda.Builtin.Reflection.html#4751" class="Datatype">Term</a> <a id="7280" class="Symbol">→</a> <a id="7282" href="Agda.Builtin.Reflection.html#7356" class="Postulate">TC</a> <a id="7285" href="Tactic.MonoidSolver.html#7178" class="Record">MonoidNames</a>
<a id="7297" href="Tactic.MonoidSolver.html#7257" class="Function">findMonoidNames</a> <a id="7313" href="Tactic.MonoidSolver.html#7313" class="Bound">mon</a> <a id="7317" class="Symbol">=</a> <a id="7319" class="Keyword">do</a>
  <a id="7324" href="Tactic.MonoidSolver.html#7324" class="Bound">∙-name</a> <a id="7331" href="Tactic.MonoidSolver.html#5934" class="Function Operator">←</a> <a id="7333" href="Agda.Builtin.Reflection.html#7711" class="Postulate">normalise</a> <a id="7343" class="Symbol">(</a><a id="7344" class="Keyword">quote</a> <a id="7350" href="Algebra.Bundles.html#3802" class="Field Operator">Monoid._∙_</a> <a id="7361" href="Function.Base.html#3828" class="Function Operator">⟨</a> <a id="7363" href="Agda.Builtin.Reflection.html#4908" class="InductiveConstructor">def</a> <a id="7367" href="Function.Base.html#3828" class="Function Operator">⟩</a> <a id="7369" class="Number">2</a> <a id="7371" href="Tactic.MonoidSolver.html#6236" class="Function Operator">⋯⟅∷⟆</a> <a id="7376" href="Tactic.MonoidSolver.html#7313" class="Bound">mon</a> <a id="7380" href="Tactic.MonoidSolver.html#6108" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="7384" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="7386" class="Symbol">)</a>
  <a id="7390" href="Tactic.MonoidSolver.html#7390" class="Bound">ε-name</a> <a id="7397" href="Tactic.MonoidSolver.html#5934" class="Function Operator">←</a> <a id="7399" href="Agda.Builtin.Reflection.html#7711" class="Postulate">normalise</a> <a id="7409" class="Symbol">(</a><a id="7410" class="Keyword">quote</a> <a id="7416" href="Algebra.Bundles.html#3829" class="Field">Monoid.ε</a>   <a id="7427" href="Function.Base.html#3828" class="Function Operator">⟨</a> <a id="7429" href="Agda.Builtin.Reflection.html#4908" class="InductiveConstructor">def</a> <a id="7433" href="Function.Base.html#3828" class="Function Operator">⟩</a> <a id="7435" class="Number">2</a> <a id="7437" href="Tactic.MonoidSolver.html#6236" class="Function Operator">⋯⟅∷⟆</a> <a id="7442" href="Tactic.MonoidSolver.html#7313" class="Bound">mon</a> <a id="7446" href="Tactic.MonoidSolver.html#6108" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="7450" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="7452" class="Symbol">)</a>
  <a id="7456" href="Agda.Builtin.Reflection.html#7399" class="Postulate">returnTC</a> <a id="7465" class="Keyword">record</a>
    <a id="7476" class="Symbol">{</a> <a id="7478" href="Tactic.MonoidSolver.html#7214" class="Field">is-∙</a> <a id="7483" class="Symbol">=</a> <a id="7485" href="Tactic.MonoidSolver.html#7613" class="Function">buildMatcher</a> <a id="7498" class="Symbol">(</a><a id="7499" class="Keyword">quote</a> <a id="7505" href="Algebra.Bundles.html#3802" class="Field Operator">Monoid._∙_</a><a id="7515" class="Symbol">)</a> <a id="7517" class="Symbol">(</a><a id="7518" href="Tactic.MonoidSolver.html#6363" class="Function">getName</a> <a id="7526" href="Tactic.MonoidSolver.html#7324" class="Bound">∙-name</a><a id="7532" class="Symbol">)</a>
    <a id="7538" class="Symbol">;</a> <a id="7540" href="Tactic.MonoidSolver.html#7237" class="Field">is-ε</a> <a id="7545" class="Symbol">=</a> <a id="7547" href="Tactic.MonoidSolver.html#7613" class="Function">buildMatcher</a> <a id="7560" class="Symbol">(</a><a id="7561" class="Keyword">quote</a> <a id="7567" href="Algebra.Bundles.html#3829" class="Field">Monoid.ε</a><a id="7575" class="Symbol">)</a>   <a id="7579" class="Symbol">(</a><a id="7580" href="Tactic.MonoidSolver.html#6363" class="Function">getName</a> <a id="7588" href="Tactic.MonoidSolver.html#7390" class="Bound">ε-name</a><a id="7594" class="Symbol">)</a>
    <a id="7600" class="Symbol">}</a>
  <a id="7604" class="Keyword">where</a>

  <a id="7613" href="Tactic.MonoidSolver.html#7613" class="Function">buildMatcher</a> <a id="7626" class="Symbol">:</a> <a id="7628" href="Agda.Builtin.Reflection.html#462" class="Postulate">Name</a> <a id="7633" class="Symbol">→</a> <a id="7635" href="Data.Maybe.Base.html#838" class="Datatype">Maybe</a> <a id="7641" href="Agda.Builtin.Reflection.html#462" class="Postulate">Name</a> <a id="7646" class="Symbol">→</a> <a id="7648" href="Agda.Builtin.Reflection.html#462" class="Postulate">Name</a> <a id="7653" class="Symbol">→</a> <a id="7655" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
  <a id="7662" href="Tactic.MonoidSolver.html#7613" class="Function">buildMatcher</a> <a id="7675" href="Tactic.MonoidSolver.html#7675" class="Bound">n</a> <a id="7677" class="Symbol">=</a> <a id="7679" href="Data.Maybe.Base.html#1381" class="Function">maybe</a> <a id="7685" class="Symbol">(λ</a> <a id="7688" href="Tactic.MonoidSolver.html#7688" class="Bound">m</a> <a id="7690" href="Tactic.MonoidSolver.html#7690" class="Bound">x</a> <a id="7692" class="Symbol">→</a> <a id="7694" href="Tactic.MonoidSolver.html#7675" class="Bound">n</a> <a id="7696" href="Tactic.MonoidSolver.html#5888" class="Function Operator">==</a> <a id="7699" href="Tactic.MonoidSolver.html#7690" class="Bound">x</a> <a id="7701" href="Data.Bool.Base.html#1044" class="Function Operator">∨</a> <a id="7703" href="Tactic.MonoidSolver.html#7688" class="Bound">m</a> <a id="7705" href="Tactic.MonoidSolver.html#5888" class="Function Operator">==</a> <a id="7708" href="Tactic.MonoidSolver.html#7690" class="Bound">x</a><a id="7709" class="Symbol">)</a> <a id="7711" class="Symbol">(</a><a id="7712" href="Tactic.MonoidSolver.html#7675" class="Bound">n</a> <a id="7714" href="Tactic.MonoidSolver.html#5888" class="Function Operator">==_</a><a id="7717" class="Symbol">)</a>

<a id="7720" class="Comment">----------------------------------------------------------------------</a>
<a id="7791" class="Comment">-- Building Expr</a>
<a id="7808" class="Comment">----------------------------------------------------------------------</a>

<a id="ε″"></a><a id="7880" href="Tactic.MonoidSolver.html#7880" class="Function">ε″</a> <a id="7883" class="Symbol">:</a> <a id="7885" href="Agda.Builtin.Reflection.html#4751" class="Datatype">Term</a>
<a id="7890" href="Tactic.MonoidSolver.html#7880" class="Function">ε″</a> <a id="7893" class="Symbol">=</a> <a id="7895" class="Keyword">quote</a> <a id="7901" href="Tactic.MonoidSolver.html#4223" class="InductiveConstructor">ε′</a> <a id="7904" href="Function.Base.html#3828" class="Function Operator">⟨</a> <a id="7906" href="Agda.Builtin.Reflection.html#4851" class="InductiveConstructor">con</a> <a id="7910" href="Function.Base.html#3828" class="Function Operator">⟩</a> <a id="7912" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>

<a id="[_↑]′"></a><a id="7916" href="Tactic.MonoidSolver.html#7916" class="Function Operator">[_↑]′</a> <a id="7922" class="Symbol">:</a> <a id="7924" href="Agda.Builtin.Reflection.html#4751" class="Datatype">Term</a> <a id="7929" class="Symbol">→</a> <a id="7931" href="Agda.Builtin.Reflection.html#4751" class="Datatype">Term</a>
<a id="7936" href="Tactic.MonoidSolver.html#7916" class="Function Operator">[</a> <a id="7938" href="Tactic.MonoidSolver.html#7938" class="Bound">t</a> <a id="7940" href="Tactic.MonoidSolver.html#7916" class="Function Operator">↑]′</a> <a id="7944" class="Symbol">=</a> <a id="7946" class="Keyword">quote</a> <a id="7952" href="Tactic.MonoidSolver.html#4240" class="InductiveConstructor Operator">[_↑]</a> <a id="7957" href="Function.Base.html#3828" class="Function Operator">⟨</a> <a id="7959" href="Agda.Builtin.Reflection.html#4851" class="InductiveConstructor">con</a> <a id="7963" href="Function.Base.html#3828" class="Function Operator">⟩</a> <a id="7965" class="Symbol">(</a><a id="7966" href="Tactic.MonoidSolver.html#7938" class="Bound">t</a> <a id="7968" href="Tactic.MonoidSolver.html#6108" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="7972" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="7974" class="Symbol">)</a>

<a id="7977" class="Keyword">module</a> <a id="7984" href="Tactic.MonoidSolver.html#7984" class="Module">_</a> <a id="7986" class="Symbol">(</a><a id="7987" href="Tactic.MonoidSolver.html#7987" class="Bound">names</a> <a id="7993" class="Symbol">:</a> <a id="7995" href="Tactic.MonoidSolver.html#7178" class="Record">MonoidNames</a><a id="8006" class="Symbol">)</a> <a id="8008" class="Keyword">where</a>
 <a id="8015" class="Keyword">open</a> <a id="8020" href="Tactic.MonoidSolver.html#7178" class="Module">MonoidNames</a> <a id="8032" href="Tactic.MonoidSolver.html#7987" class="Bound">names</a>

 <a id="8040" class="Keyword">mutual</a>
  <a id="8049" href="Tactic.MonoidSolver.html#8049" class="Function">∙″</a> <a id="8052" class="Symbol">:</a> <a id="8054" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="8059" class="Symbol">(</a><a id="8060" href="Agda.Builtin.Reflection.html#3228" class="Datatype">Arg</a> <a id="8064" href="Agda.Builtin.Reflection.html#4751" class="Datatype">Term</a><a id="8068" class="Symbol">)</a> <a id="8070" class="Symbol">→</a> <a id="8072" href="Agda.Builtin.Reflection.html#4751" class="Datatype">Term</a>
  <a id="8079" href="Tactic.MonoidSolver.html#8049" class="Function">∙″</a> <a id="8082" class="Symbol">(</a><a id="8083" href="Tactic.MonoidSolver.html#8083" class="Bound">x</a> <a id="8085" href="Tactic.MonoidSolver.html#6108" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="8089" href="Tactic.MonoidSolver.html#8089" class="Bound">y</a> <a id="8091" href="Tactic.MonoidSolver.html#6108" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="8095" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="8097" class="Symbol">)</a> <a id="8099" class="Symbol">=</a> <a id="8101" class="Keyword">quote</a> <a id="8107" href="Tactic.MonoidSolver.html#4188" class="InductiveConstructor Operator">_∙′_</a> <a id="8112" href="Function.Base.html#3828" class="Function Operator">⟨</a> <a id="8114" href="Agda.Builtin.Reflection.html#4851" class="InductiveConstructor">con</a> <a id="8118" href="Function.Base.html#3828" class="Function Operator">⟩</a> <a id="8120" href="Tactic.MonoidSolver.html#8183" class="Function">E′</a> <a id="8123" href="Tactic.MonoidSolver.html#8083" class="Bound">x</a> <a id="8125" href="Tactic.MonoidSolver.html#6108" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="8129" href="Tactic.MonoidSolver.html#8183" class="Function">E′</a> <a id="8132" href="Tactic.MonoidSolver.html#8089" class="Bound">y</a> <a id="8134" href="Tactic.MonoidSolver.html#6108" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="8138" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
  <a id="8143" href="Tactic.MonoidSolver.html#8049" class="CatchallClause Function">∙″</a><a id="8145" class="CatchallClause"> </a><a id="8146" class="CatchallClause Symbol">(</a><a id="8147" href="Tactic.MonoidSolver.html#8147" class="CatchallClause Bound">x</a><a id="8148" class="CatchallClause"> </a><a id="8149" href="Agda.Builtin.List.html#200" class="CatchallClause InductiveConstructor Operator">∷</a><a id="8150" class="CatchallClause"> </a><a id="8151" href="Tactic.MonoidSolver.html#8151" class="CatchallClause Bound">xs</a><a id="8153" class="CatchallClause Symbol">)</a> <a id="8155" class="Symbol">=</a> <a id="8157" href="Tactic.MonoidSolver.html#8049" class="Function">∙″</a> <a id="8160" href="Tactic.MonoidSolver.html#8151" class="Bound">xs</a>
  <a id="8165" href="Tactic.MonoidSolver.html#8049" class="CatchallClause Function">∙″</a><a id="8167" class="CatchallClause"> </a><a id="8168" class="CatchallClause Symbol">_</a> <a id="8170" class="Symbol">=</a> <a id="8172" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">unknown</a>

  <a id="8183" href="Tactic.MonoidSolver.html#8183" class="Function">E′</a> <a id="8186" class="Symbol">:</a> <a id="8188" href="Agda.Builtin.Reflection.html#4751" class="Datatype">Term</a> <a id="8193" class="Symbol">→</a> <a id="8195" href="Agda.Builtin.Reflection.html#4751" class="Datatype">Term</a>
  <a id="8202" href="Tactic.MonoidSolver.html#8183" class="Function">E′</a> <a id="8205" href="Tactic.MonoidSolver.html#8205" class="Bound">t</a><a id="8206" class="Symbol">@(</a><a id="8208" href="Agda.Builtin.Reflection.html#4908" class="InductiveConstructor">def</a> <a id="8212" href="Tactic.MonoidSolver.html#8212" class="Bound">n</a> <a id="8214" href="Tactic.MonoidSolver.html#8214" class="Bound">xs</a><a id="8216" class="Symbol">)</a> <a id="8218" class="Symbol">=</a> <a id="8220" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="8223" href="Tactic.MonoidSolver.html#7214" class="Field">is-∙</a> <a id="8228" href="Tactic.MonoidSolver.html#8212" class="Bound">n</a>
                      <a id="8252" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="8257" href="Tactic.MonoidSolver.html#8049" class="Function">∙″</a> <a id="8260" href="Tactic.MonoidSolver.html#8214" class="Bound">xs</a>
                    <a id="8283" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="8288" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="8291" href="Tactic.MonoidSolver.html#7237" class="Field">is-ε</a> <a id="8296" href="Tactic.MonoidSolver.html#8212" class="Bound">n</a>
                      <a id="8320" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="8325" href="Tactic.MonoidSolver.html#7880" class="Function">ε″</a>
                      <a id="8350" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="8355" href="Tactic.MonoidSolver.html#7916" class="Function Operator">[</a> <a id="8357" href="Tactic.MonoidSolver.html#8205" class="Bound">t</a> <a id="8359" href="Tactic.MonoidSolver.html#7916" class="Function Operator">↑]′</a>
  <a id="8365" href="Tactic.MonoidSolver.html#8183" class="Function">E′</a> <a id="8368" href="Tactic.MonoidSolver.html#8368" class="Bound">t</a><a id="8369" class="Symbol">@(</a><a id="8371" href="Agda.Builtin.Reflection.html#4851" class="InductiveConstructor">con</a> <a id="8375" href="Tactic.MonoidSolver.html#8375" class="Bound">n</a> <a id="8377" href="Tactic.MonoidSolver.html#8377" class="Bound">xs</a><a id="8379" class="Symbol">)</a> <a id="8381" class="Symbol">=</a> <a id="8383" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="8386" href="Tactic.MonoidSolver.html#7214" class="Field">is-∙</a> <a id="8391" href="Tactic.MonoidSolver.html#8375" class="Bound">n</a>
                      <a id="8415" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="8420" href="Tactic.MonoidSolver.html#8049" class="Function">∙″</a> <a id="8423" href="Tactic.MonoidSolver.html#8377" class="Bound">xs</a>
                    <a id="8446" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="8451" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="8454" href="Tactic.MonoidSolver.html#7237" class="Field">is-ε</a> <a id="8459" href="Tactic.MonoidSolver.html#8375" class="Bound">n</a>
                      <a id="8483" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="8488" href="Tactic.MonoidSolver.html#7880" class="Function">ε″</a>
                      <a id="8513" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="8518" href="Tactic.MonoidSolver.html#7916" class="Function Operator">[</a> <a id="8520" href="Tactic.MonoidSolver.html#8368" class="Bound">t</a> <a id="8522" href="Tactic.MonoidSolver.html#7916" class="Function Operator">↑]′</a>
  <a id="8528" href="Tactic.MonoidSolver.html#8183" class="CatchallClause Function">E′</a><a id="8530" class="CatchallClause"> </a><a id="8531" href="Tactic.MonoidSolver.html#8531" class="CatchallClause Bound">t</a> <a id="8533" class="Symbol">=</a> <a id="8535" class="Keyword">quote</a> <a id="8541" href="Tactic.MonoidSolver.html#4240" class="InductiveConstructor Operator">[_↑]</a> <a id="8546" href="Function.Base.html#3828" class="Function Operator">⟨</a> <a id="8548" href="Agda.Builtin.Reflection.html#4851" class="InductiveConstructor">con</a> <a id="8552" href="Function.Base.html#3828" class="Function Operator">⟩</a> <a id="8554" class="Symbol">(</a><a id="8555" href="Tactic.MonoidSolver.html#8531" class="Bound">t</a> <a id="8557" href="Tactic.MonoidSolver.html#6108" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="8561" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="8563" class="Symbol">)</a>

<a id="8566" class="Comment">----------------------------------------------------------------------</a>
<a id="8637" class="Comment">-- Constructing the solution</a>
<a id="8666" class="Comment">----------------------------------------------------------------------</a>

<a id="8738" class="Comment">-- This function joins up the two homomorphism proofs. It constructs</a>
<a id="8807" class="Comment">-- an expression something like the following:</a>
<a id="8854" class="Comment">--   trans (sym (homo x)) (homo y)</a>
<a id="8889" class="Comment">-- where x and y are the Expr representations of each side of the</a>
<a id="8955" class="Comment">-- goal equation.</a>
<a id="constructSoln"></a><a id="8973" href="Tactic.MonoidSolver.html#8973" class="Function">constructSoln</a> <a id="8987" class="Symbol">:</a> <a id="8989" href="Agda.Builtin.Reflection.html#4751" class="Datatype">Term</a> <a id="8994" class="Symbol">→</a> <a id="8996" href="Tactic.MonoidSolver.html#7178" class="Record">MonoidNames</a> <a id="9008" class="Symbol">→</a> <a id="9010" href="Agda.Builtin.Reflection.html#4751" class="Datatype">Term</a> <a id="9015" class="Symbol">→</a> <a id="9017" href="Agda.Builtin.Reflection.html#4751" class="Datatype">Term</a> <a id="9022" class="Symbol">→</a> <a id="9024" href="Agda.Builtin.Reflection.html#4751" class="Datatype">Term</a>
<a id="9029" href="Tactic.MonoidSolver.html#8973" class="Function">constructSoln</a> <a id="9043" href="Tactic.MonoidSolver.html#9043" class="Bound">mon</a> <a id="9047" href="Tactic.MonoidSolver.html#9047" class="Bound">names</a> <a id="9053" href="Tactic.MonoidSolver.html#9053" class="Bound">lhs</a> <a id="9057" href="Tactic.MonoidSolver.html#9057" class="Bound">rhs</a> <a id="9061" class="Symbol">=</a>
  <a id="9065" class="Keyword">quote</a> <a id="9071" href="Relation.Binary.Structures.html#1620" class="Function">Monoid.trans</a> <a id="9084" href="Function.Base.html#3828" class="Function Operator">⟨</a> <a id="9086" href="Agda.Builtin.Reflection.html#4908" class="InductiveConstructor">def</a> <a id="9090" href="Function.Base.html#3828" class="Function Operator">⟩</a> <a id="9092" class="Number">2</a> <a id="9094" href="Tactic.MonoidSolver.html#6236" class="Function Operator">⋯⟅∷⟆</a> <a id="9099" href="Tactic.MonoidSolver.html#9043" class="Bound">mon</a> <a id="9103" href="Tactic.MonoidSolver.html#6108" class="InductiveConstructor Operator">⟨∷⟩</a>
    <a id="9111" class="Symbol">(</a><a id="9112" class="Keyword">quote</a> <a id="9118" href="Relation.Binary.Structures.html#1594" class="Function">Monoid.sym</a> <a id="9129" href="Function.Base.html#3828" class="Function Operator">⟨</a> <a id="9131" href="Agda.Builtin.Reflection.html#4908" class="InductiveConstructor">def</a> <a id="9135" href="Function.Base.html#3828" class="Function Operator">⟩</a> <a id="9137" class="Number">2</a> <a id="9139" href="Tactic.MonoidSolver.html#6236" class="Function Operator">⋯⟅∷⟆</a> <a id="9144" href="Tactic.MonoidSolver.html#9043" class="Bound">mon</a> <a id="9148" href="Tactic.MonoidSolver.html#6108" class="InductiveConstructor Operator">⟨∷⟩</a>
       <a id="9159" class="Symbol">(</a><a id="9160" class="Keyword">quote</a> <a id="9166" href="Tactic.MonoidSolver.html#5475" class="Function">homo</a> <a id="9171" href="Function.Base.html#3828" class="Function Operator">⟨</a> <a id="9173" href="Agda.Builtin.Reflection.html#4908" class="InductiveConstructor">def</a> <a id="9177" href="Function.Base.html#3828" class="Function Operator">⟩</a> <a id="9179" class="Number">2</a> <a id="9181" href="Tactic.MonoidSolver.html#6236" class="Function Operator">⋯⟅∷⟆</a> <a id="9186" href="Tactic.MonoidSolver.html#9043" class="Bound">mon</a> <a id="9190" href="Tactic.MonoidSolver.html#6108" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="9194" href="Tactic.MonoidSolver.html#8183" class="Function">E′</a> <a id="9197" href="Tactic.MonoidSolver.html#9047" class="Bound">names</a> <a id="9203" href="Tactic.MonoidSolver.html#9053" class="Bound">lhs</a> <a id="9207" href="Tactic.MonoidSolver.html#6108" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="9211" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="9213" class="Symbol">)</a> <a id="9215" href="Tactic.MonoidSolver.html#6108" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="9219" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="9221" class="Symbol">)</a>
    <a id="9227" href="Tactic.MonoidSolver.html#6108" class="InductiveConstructor Operator">⟨∷⟩</a>
    <a id="9235" class="Symbol">(</a><a id="9236" class="Keyword">quote</a> <a id="9242" href="Tactic.MonoidSolver.html#5475" class="Function">homo</a> <a id="9247" href="Function.Base.html#3828" class="Function Operator">⟨</a> <a id="9249" href="Agda.Builtin.Reflection.html#4908" class="InductiveConstructor">def</a> <a id="9253" href="Function.Base.html#3828" class="Function Operator">⟩</a> <a id="9255" class="Number">2</a> <a id="9257" href="Tactic.MonoidSolver.html#6236" class="Function Operator">⋯⟅∷⟆</a> <a id="9262" href="Tactic.MonoidSolver.html#9043" class="Bound">mon</a> <a id="9266" href="Tactic.MonoidSolver.html#6108" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="9270" href="Tactic.MonoidSolver.html#8183" class="Function">E′</a> <a id="9273" href="Tactic.MonoidSolver.html#9047" class="Bound">names</a> <a id="9279" href="Tactic.MonoidSolver.html#9057" class="Bound">rhs</a> <a id="9283" href="Tactic.MonoidSolver.html#6108" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="9287" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="9289" class="Symbol">)</a> <a id="9291" href="Tactic.MonoidSolver.html#6108" class="InductiveConstructor Operator">⟨∷⟩</a>
    <a id="9299" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>

<a id="solve-macro"></a><a id="9303" href="Tactic.MonoidSolver.html#9303" class="Function">solve-macro</a> <a id="9315" class="Symbol">:</a> <a id="9317" href="Agda.Builtin.Reflection.html#4751" class="Datatype">Term</a> <a id="9322" class="Symbol">→</a> <a id="9324" href="Agda.Builtin.Reflection.html#4751" class="Datatype">Term</a> <a id="9329" class="Symbol">→</a> <a id="9331" href="Agda.Builtin.Reflection.html#7356" class="Postulate">TC</a> <a id="9334" class="Symbol">_</a>
<a id="9336" href="Tactic.MonoidSolver.html#9303" class="Function">solve-macro</a> <a id="9348" href="Tactic.MonoidSolver.html#9348" class="Bound">mon</a> <a id="9352" class="Symbol">=</a> <a id="9354" class="Symbol">λ</a> <a id="9356" href="Tactic.MonoidSolver.html#9356" class="Bound">hole</a> <a id="9361" class="Symbol">→</a> <a id="9363" class="Keyword">do</a>
  <a id="9368" href="Tactic.MonoidSolver.html#9368" class="Bound">hole′</a> <a id="9374" href="Tactic.MonoidSolver.html#5934" class="Function Operator">←</a> <a id="9376" href="Agda.Builtin.Reflection.html#7632" class="Postulate">inferType</a> <a id="9386" href="Tactic.MonoidSolver.html#9356" class="Bound">hole</a> <a id="9391" href="Tactic.MonoidSolver.html#5934" class="Function Operator">&gt;&gt;=</a> <a id="9395" href="Agda.Builtin.Reflection.html#7711" class="Postulate">normalise</a>
  <a id="9407" href="Tactic.MonoidSolver.html#9407" class="Bound">names</a> <a id="9413" href="Tactic.MonoidSolver.html#5934" class="Function Operator">←</a> <a id="9415" href="Tactic.MonoidSolver.html#7257" class="Function">findMonoidNames</a> <a id="9431" href="Tactic.MonoidSolver.html#9348" class="Bound">mon</a>
  <a id="9437" href="Data.Maybe.Base.html#892" class="InductiveConstructor">just</a> <a id="9442" class="Symbol">(</a><a id="9443" href="Tactic.MonoidSolver.html#9443" class="Bound">lhs</a> <a id="9447" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9449" href="Tactic.MonoidSolver.html#9449" class="Bound">rhs</a><a id="9452" class="Symbol">)</a> <a id="9454" href="Tactic.MonoidSolver.html#5934" class="Function Operator">←</a> <a id="9456" href="Agda.Builtin.Reflection.html#7399" class="Postulate">returnTC</a> <a id="9465" class="Symbol">(</a><a id="9466" href="Tactic.MonoidSolver.html#6472" class="Function">getArgs</a> <a id="9474" href="Tactic.MonoidSolver.html#9368" class="Bound">hole′</a><a id="9479" class="Symbol">)</a>
    <a id="9485" class="Keyword">where</a> <a id="9491" href="Data.Maybe.Base.html#872" class="InductiveConstructor">nothing</a> <a id="9499" class="Symbol">→</a> <a id="9501" href="Agda.Builtin.Reflection.html#7569" class="Postulate">typeError</a> <a id="9511" class="Symbol">(</a><a id="9512" href="Agda.Builtin.Reflection.html#7086" class="InductiveConstructor">termErr</a> <a id="9520" href="Tactic.MonoidSolver.html#9368" class="Bound">hole′</a> <a id="9526" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9528" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="9530" class="Symbol">)</a>
  <a id="9534" class="Keyword">let</a> <a id="9538" href="Tactic.MonoidSolver.html#9538" class="Bound">soln</a> <a id="9543" class="Symbol">=</a> <a id="9545" href="Tactic.MonoidSolver.html#8973" class="Function">constructSoln</a> <a id="9559" href="Tactic.MonoidSolver.html#9348" class="Bound">mon</a> <a id="9563" href="Tactic.MonoidSolver.html#9407" class="Bound">names</a> <a id="9569" href="Tactic.MonoidSolver.html#9443" class="Bound">lhs</a> <a id="9573" href="Tactic.MonoidSolver.html#9449" class="Bound">rhs</a>
  <a id="9579" href="Agda.Builtin.Reflection.html#7529" class="Postulate">unify</a> <a id="9585" href="Tactic.MonoidSolver.html#9356" class="Bound">hole</a> <a id="9590" href="Tactic.MonoidSolver.html#9538" class="Bound">soln</a>

<a id="9596" class="Keyword">macro</a>
  <a id="solve"></a><a id="9604" href="Tactic.MonoidSolver.html#9604" class="Function">solve</a> <a id="9610" class="Symbol">:</a> <a id="9612" href="Agda.Builtin.Reflection.html#4751" class="Datatype">Term</a> <a id="9617" class="Symbol">→</a> <a id="9619" href="Agda.Builtin.Reflection.html#4751" class="Datatype">Term</a> <a id="9624" class="Symbol">→</a> <a id="9626" href="Agda.Builtin.Reflection.html#7356" class="Postulate">TC</a> <a id="9629" class="Symbol">_</a>
  <a id="9633" href="Tactic.MonoidSolver.html#9604" class="Function">solve</a> <a id="9639" class="Symbol">=</a> <a id="9641" href="Tactic.MonoidSolver.html#9303" class="Function">solve-macro</a>
</pre></body></html>