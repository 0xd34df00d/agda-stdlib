<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.AVL</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- AVL trees</a>
<a id="119" class="Comment">------------------------------------------------------------------------</a>

<a id="193" class="Comment">-- AVL trees are balanced binary search trees.</a>

<a id="241" class="Comment">-- The search tree invariant is specified using the technique</a>
<a id="303" class="Comment">-- described by Conor McBride in his talk &quot;Pivotal pragmatism&quot;.</a>

<a id="368" class="Symbol">{-#</a> <a id="372" class="Keyword">OPTIONS</a> <a id="380" class="Option">--without-K</a> <a id="392" class="Symbol">#-}</a>

<a id="397" class="Keyword">open</a> <a id="402" class="Keyword">import</a> <a id="409" href="Relation.Binary.html" class="Module">Relation.Binary</a>
<a id="425" class="Keyword">open</a> <a id="430" class="Keyword">import</a> <a id="437" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="475" class="Symbol">as</a> <a id="478" class="Module">P</a> <a id="480" class="Keyword">using</a> <a id="486" class="Symbol">(</a><a id="487" href="Agda.Builtin.Equality.html#83" class="Datatype Operator">_≡_</a> <a id="491" class="Symbol">;</a> <a id="493" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="497" class="Symbol">)</a>

<a id="500" class="Keyword">module</a> <a id="507" href="Data.AVL.html" class="Module">Data.AVL</a>
  <a id="518" class="Symbol">{</a><a id="519" href="Data.AVL.html#519" class="Bound">k</a> <a id="521" href="Data.AVL.html#521" class="Bound">r</a><a id="522" class="Symbol">}</a> <a id="524" class="Symbol">{</a><a id="525" href="Data.AVL.html#525" class="Bound">Key</a> <a id="529" class="Symbol">:</a> <a id="531" class="PrimitiveType">Set</a> <a id="535" href="Data.AVL.html#519" class="Bound">k</a><a id="536" class="Symbol">}</a> <a id="538" class="Symbol">{</a><a id="539" href="Data.AVL.html#539" class="Bound Operator">_&lt;_</a> <a id="543" class="Symbol">:</a> <a id="545" href="Relation.Binary.Core.html#969" class="Function">Rel</a> <a id="549" href="Data.AVL.html#525" class="Bound">Key</a> <a id="553" href="Data.AVL.html#521" class="Bound">r</a><a id="554" class="Symbol">}</a>
  <a id="558" class="Symbol">(</a><a id="559" href="Data.AVL.html#559" class="Bound">isStrictTotalOrder</a> <a id="578" class="Symbol">:</a> <a id="580" href="Relation.Binary.html#10258" class="Record">IsStrictTotalOrder</a> <a id="599" href="Agda.Builtin.Equality.html#83" class="Datatype Operator">_≡_</a> <a id="603" href="Data.AVL.html#539" class="Bound Operator">_&lt;_</a><a id="606" class="Symbol">)</a>
  <a id="610" class="Keyword">where</a>

<a id="617" class="Keyword">open</a> <a id="622" class="Keyword">import</a> <a id="629" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a> <a id="644" class="Keyword">using</a> <a id="650" class="Symbol">(</a><a id="651" href="Agda.Builtin.Bool.html#67" class="Datatype">Bool</a><a id="655" class="Symbol">)</a>
<a id="657" class="Keyword">import</a> <a id="664" href="Data.DifferenceList.html" class="Module">Data.DifferenceList</a> <a id="684" class="Symbol">as</a> <a id="687" class="Module">DiffList</a>
<a id="696" class="Keyword">open</a> <a id="701" class="Keyword">import</a> <a id="708" href="Data.Empty.html" class="Module">Data.Empty</a>
<a id="719" class="Keyword">open</a> <a id="724" class="Keyword">import</a> <a id="731" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="746" class="Symbol">as</a> <a id="749" class="Module">List</a> <a id="754" class="Keyword">using</a> <a id="760" class="Symbol">(</a><a id="761" href="Agda.Builtin.List.html#80" class="Datatype">List</a><a id="765" class="Symbol">)</a>
<a id="767" class="Keyword">open</a> <a id="772" class="Keyword">import</a> <a id="779" href="Data.Maybe.Base.html" class="Module">Data.Maybe.Base</a> <a id="795" class="Keyword">hiding</a> <a id="802" class="Symbol">(</a><a id="803" href="Data.Maybe.Base.html#2132" class="Function">map</a><a id="806" class="Symbol">)</a>
<a id="808" class="Keyword">open</a> <a id="813" class="Keyword">import</a> <a id="820" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="834" class="Keyword">hiding</a> <a id="841" class="Symbol">(</a><a id="842" href="Data.Nat.Base.html#984" class="Function Operator">_&lt;_</a><a id="845" class="Symbol">;</a> <a id="847" href="Data.Nat.Base.html#1578" class="Function Operator">_⊔_</a><a id="850" class="Symbol">;</a> <a id="852" href="Data.Nat.Base.html#3277" class="Function">compare</a><a id="859" class="Symbol">)</a>
<a id="861" class="Keyword">open</a> <a id="866" class="Keyword">import</a> <a id="873" href="Data.Product.html" class="Module">Data.Product</a> <a id="886" class="Keyword">hiding</a> <a id="893" class="Symbol">(</a><a id="894" href="Data.Product.html#2183" class="Function">map</a><a id="897" class="Symbol">)</a>
<a id="899" class="Keyword">open</a> <a id="904" class="Keyword">import</a> <a id="911" href="Data.Unit.html" class="Module">Data.Unit</a>
<a id="921" class="Keyword">open</a> <a id="926" class="Keyword">import</a> <a id="933" href="Function.html" class="Module">Function</a>
<a id="942" class="Keyword">open</a> <a id="947" class="Keyword">import</a> <a id="954" href="Level.html" class="Module">Level</a> <a id="960" class="Keyword">using</a> <a id="966" class="Symbol">(</a><a id="967" href="Agda.Primitive.html#657" class="Primitive Operator">_⊔_</a><a id="970" class="Symbol">;</a> <a id="972" href="Level.html#387" class="Record">Lift</a><a id="976" class="Symbol">;</a> <a id="978" href="Level.html#444" class="InductiveConstructor">lift</a><a id="982" class="Symbol">)</a>

<a id="985" class="Keyword">open</a> <a id="990" href="Relation.Binary.html#10258" class="Module">IsStrictTotalOrder</a> <a id="1009" href="Data.AVL.html#559" class="Bound">isStrictTotalOrder</a>
<a id="1028" class="Keyword">import</a> <a id="1035" href="Data.AVL.Indexed.html" class="Module">Data.AVL.Indexed</a> <a id="1052" href="Data.AVL.html#525" class="Bound">Key</a> <a id="1056" href="Data.AVL.html#559" class="Bound">isStrictTotalOrder</a> <a id="1075" class="Symbol">as</a> <a id="Indexed"></a><a id="1078" href="Data.AVL.html#1078" class="Module">Indexed</a>
<a id="1086" class="Keyword">open</a> <a id="1091" href="Data.AVL.html#1078" class="Module">Indexed</a> <a id="1099" class="Keyword">using</a> <a id="1105" class="Symbol">(</a><a id="1106" href="Data.AVL.Indexed.html#835" class="Function Operator">K&amp;_</a> <a id="1110" class="Symbol">;</a> <a id="1112" href="Data.AVL.Key.html#705" class="InductiveConstructor">⊥⁺</a> <a id="1115" class="Symbol">;</a> <a id="1117" href="Data.AVL.Key.html#708" class="InductiveConstructor">⊤⁺</a><a id="1119" class="Symbol">)</a>

<a id="1122" class="Comment">------------------------------------------------------------------------</a>
<a id="1195" class="Comment">-- Types and functions with hidden indices</a>

<a id="1239" class="Keyword">data</a> <a id="Tree"></a><a id="1244" href="Data.AVL.html#1244" class="Datatype">Tree</a> <a id="1249" class="Symbol">{</a><a id="1250" href="Data.AVL.html#1250" class="Bound">v</a><a id="1251" class="Symbol">}</a> <a id="1253" class="Symbol">(</a><a id="1254" href="Data.AVL.html#1254" class="Bound">V</a> <a id="1256" class="Symbol">:</a> <a id="1258" href="Data.AVL.html#525" class="Bound">Key</a> <a id="1262" class="Symbol">→</a> <a id="1264" class="PrimitiveType">Set</a> <a id="1268" href="Data.AVL.html#1250" class="Bound">v</a><a id="1269" class="Symbol">)</a> <a id="1271" class="Symbol">:</a> <a id="1273" class="PrimitiveType">Set</a> <a id="1277" class="Symbol">(</a><a id="1278" href="Data.AVL.html#519" class="Bound">k</a> <a id="1280" href="Agda.Primitive.html#657" class="Primitive Operator">⊔</a> <a id="1282" href="Data.AVL.html#1250" class="Bound">v</a> <a id="1284" href="Agda.Primitive.html#657" class="Primitive Operator">⊔</a> <a id="1286" href="Data.AVL.html#521" class="Bound">r</a><a id="1287" class="Symbol">)</a> <a id="1289" class="Keyword">where</a>
  <a id="Tree.tree"></a><a id="1297" href="Data.AVL.html#1297" class="InductiveConstructor">tree</a> <a id="1302" class="Symbol">:</a> <a id="1304" class="Symbol">∀</a> <a id="1306" class="Symbol">{</a><a id="1307" href="Data.AVL.html#1307" class="Bound">h</a><a id="1308" class="Symbol">}</a> <a id="1310" class="Symbol">→</a> <a id="1312" href="Data.AVL.Indexed.html#1065" class="Datatype">Indexed.Tree</a> <a id="1325" href="Data.AVL.html#1254" class="Bound">V</a> <a id="1327" href="Data.AVL.Key.html#705" class="InductiveConstructor">⊥⁺</a> <a id="1330" href="Data.AVL.Key.html#708" class="InductiveConstructor">⊤⁺</a> <a id="1333" href="Data.AVL.html#1307" class="Bound">h</a> <a id="1335" class="Symbol">→</a> <a id="1337" href="Data.AVL.html#1244" class="Datatype">Tree</a> <a id="1342" href="Data.AVL.html#1254" class="Bound">V</a>

<a id="1345" class="Keyword">module</a> <a id="1352" href="Data.AVL.html#1352" class="Module">_</a> <a id="1354" class="Symbol">{</a><a id="1355" href="Data.AVL.html#1355" class="Bound">v</a><a id="1356" class="Symbol">}</a> <a id="1358" class="Symbol">{</a><a id="1359" href="Data.AVL.html#1359" class="Bound">V</a> <a id="1361" class="Symbol">:</a> <a id="1363" href="Data.AVL.html#525" class="Bound">Key</a> <a id="1367" class="Symbol">→</a> <a id="1369" class="PrimitiveType">Set</a> <a id="1373" href="Data.AVL.html#1355" class="Bound">v</a><a id="1374" class="Symbol">}</a> <a id="1376" class="Keyword">where</a>

  <a id="1385" href="Data.AVL.html#1385" class="Function">empty</a> <a id="1391" class="Symbol">:</a> <a id="1393" href="Data.AVL.html#1244" class="Datatype">Tree</a> <a id="1398" href="Data.AVL.html#1359" class="Bound">V</a>
  <a id="1402" href="Data.AVL.html#1385" class="Function">empty</a> <a id="1408" class="Symbol">=</a> <a id="1410" href="Data.AVL.html#1297" class="InductiveConstructor">tree</a> <a id="1415" class="Symbol">(</a><a id="1416" href="Data.AVL.Indexed.html#7765" class="Function">Indexed.empty</a> <a id="1430" class="Symbol">_)</a>

  <a id="1436" href="Data.AVL.html#1436" class="Function">singleton</a> <a id="1446" class="Symbol">:</a> <a id="1448" class="Symbol">(</a><a id="1449" href="Data.AVL.html#1449" class="Bound">k</a> <a id="1451" class="Symbol">:</a> <a id="1453" href="Data.AVL.html#525" class="Bound">Key</a><a id="1456" class="Symbol">)</a> <a id="1458" class="Symbol">→</a> <a id="1460" href="Data.AVL.html#1359" class="Bound">V</a> <a id="1462" href="Data.AVL.html#1449" class="Bound">k</a> <a id="1464" class="Symbol">→</a> <a id="1466" href="Data.AVL.html#1244" class="Datatype">Tree</a> <a id="1471" href="Data.AVL.html#1359" class="Bound">V</a>
  <a id="1475" href="Data.AVL.html#1436" class="Function">singleton</a> <a id="1485" href="Data.AVL.html#1485" class="Bound">k</a> <a id="1487" href="Data.AVL.html#1487" class="Bound">v</a> <a id="1489" class="Symbol">=</a> <a id="1491" href="Data.AVL.html#1297" class="InductiveConstructor">tree</a> <a id="1496" class="Symbol">(</a><a id="1497" href="Data.AVL.Indexed.html#7847" class="Function">Indexed.singleton</a> <a id="1515" href="Data.AVL.html#1485" class="Bound">k</a> <a id="1517" href="Data.AVL.html#1487" class="Bound">v</a> <a id="1519" class="Symbol">_)</a>

  <a id="1525" href="Data.AVL.html#1525" class="Function">insert</a> <a id="1532" class="Symbol">:</a> <a id="1534" class="Symbol">(</a><a id="1535" href="Data.AVL.html#1535" class="Bound">k</a> <a id="1537" class="Symbol">:</a> <a id="1539" href="Data.AVL.html#525" class="Bound">Key</a><a id="1542" class="Symbol">)</a> <a id="1544" class="Symbol">→</a> <a id="1546" href="Data.AVL.html#1359" class="Bound">V</a> <a id="1548" href="Data.AVL.html#1535" class="Bound">k</a> <a id="1550" class="Symbol">→</a> <a id="1552" href="Data.AVL.html#1244" class="Datatype">Tree</a> <a id="1557" href="Data.AVL.html#1359" class="Bound">V</a> <a id="1559" class="Symbol">→</a> <a id="1561" href="Data.AVL.html#1244" class="Datatype">Tree</a> <a id="1566" href="Data.AVL.html#1359" class="Bound">V</a>
  <a id="1570" href="Data.AVL.html#1525" class="Function">insert</a> <a id="1577" href="Data.AVL.html#1577" class="Bound">k</a> <a id="1579" href="Data.AVL.html#1579" class="Bound">v</a> <a id="1581" class="Symbol">(</a><a id="1582" href="Data.AVL.html#1297" class="InductiveConstructor">tree</a> <a id="1587" href="Data.AVL.html#1587" class="Bound">t</a><a id="1588" class="Symbol">)</a> <a id="1590" class="Symbol">=</a> <a id="1592" href="Data.AVL.html#1297" class="InductiveConstructor">tree</a> <a id="1597" href="Function.html#1920" class="Function Operator">$</a> <a id="1599" href="Agda.Builtin.Sigma.html#167" class="Field">proj₂</a> <a id="1605" href="Function.html#1920" class="Function Operator">$</a> <a id="1607" href="Data.AVL.Indexed.html#8952" class="Function">Indexed.insert</a> <a id="1622" href="Data.AVL.html#1577" class="Bound">k</a> <a id="1624" href="Data.AVL.html#1579" class="Bound">v</a> <a id="1626" href="Data.AVL.html#1587" class="Bound">t</a> <a id="1628" class="Symbol">_</a>

  <a id="1633" href="Data.AVL.html#1633" class="Function">insertWith</a> <a id="1644" class="Symbol">:</a> <a id="1646" class="Symbol">(</a><a id="1647" href="Data.AVL.html#1647" class="Bound">k</a> <a id="1649" class="Symbol">:</a> <a id="1651" href="Data.AVL.html#525" class="Bound">Key</a><a id="1654" class="Symbol">)</a> <a id="1656" class="Symbol">→</a> <a id="1658" href="Data.AVL.html#1359" class="Bound">V</a> <a id="1660" href="Data.AVL.html#1647" class="Bound">k</a> <a id="1662" class="Symbol">→</a> <a id="1664" class="Symbol">(</a><a id="1665" href="Data.AVL.html#1359" class="Bound">V</a> <a id="1667" href="Data.AVL.html#1647" class="Bound">k</a> <a id="1669" class="Symbol">→</a> <a id="1671" href="Data.AVL.html#1359" class="Bound">V</a> <a id="1673" href="Data.AVL.html#1647" class="Bound">k</a> <a id="1675" class="Symbol">→</a> <a id="1677" href="Data.AVL.html#1359" class="Bound">V</a> <a id="1679" href="Data.AVL.html#1647" class="Bound">k</a><a id="1680" class="Symbol">)</a> <a id="1682" class="Symbol">→</a>
               <a id="1699" href="Data.AVL.html#1244" class="Datatype">Tree</a> <a id="1704" href="Data.AVL.html#1359" class="Bound">V</a> <a id="1706" class="Symbol">→</a> <a id="1708" href="Data.AVL.html#1244" class="Datatype">Tree</a> <a id="1713" href="Data.AVL.html#1359" class="Bound">V</a>
  <a id="1717" href="Data.AVL.html#1633" class="Function">insertWith</a> <a id="1728" href="Data.AVL.html#1728" class="Bound">k</a> <a id="1730" href="Data.AVL.html#1730" class="Bound">v</a> <a id="1732" href="Data.AVL.html#1732" class="Bound">f</a> <a id="1734" class="Symbol">(</a><a id="1735" href="Data.AVL.html#1297" class="InductiveConstructor">tree</a> <a id="1740" href="Data.AVL.html#1740" class="Bound">t</a><a id="1741" class="Symbol">)</a> <a id="1743" class="Symbol">=</a> <a id="1745" href="Data.AVL.html#1297" class="InductiveConstructor">tree</a> <a id="1750" href="Function.html#1920" class="Function Operator">$</a> <a id="1752" href="Agda.Builtin.Sigma.html#167" class="Field">proj₂</a> <a id="1758" href="Function.html#1920" class="Function Operator">$</a> <a id="1760" href="Data.AVL.Indexed.html#8211" class="Function">Indexed.insertWith</a> <a id="1779" href="Data.AVL.html#1728" class="Bound">k</a> <a id="1781" href="Data.AVL.html#1730" class="Bound">v</a> <a id="1783" href="Data.AVL.html#1732" class="Bound">f</a> <a id="1785" href="Data.AVL.html#1740" class="Bound">t</a> <a id="1787" class="Symbol">_</a>

  <a id="1792" href="Data.AVL.html#1792" class="Function">delete</a> <a id="1799" class="Symbol">:</a> <a id="1801" href="Data.AVL.html#525" class="Bound">Key</a> <a id="1805" class="Symbol">→</a> <a id="1807" href="Data.AVL.html#1244" class="Datatype">Tree</a> <a id="1812" href="Data.AVL.html#1359" class="Bound">V</a> <a id="1814" class="Symbol">→</a> <a id="1816" href="Data.AVL.html#1244" class="Datatype">Tree</a> <a id="1821" href="Data.AVL.html#1359" class="Bound">V</a>
  <a id="1825" href="Data.AVL.html#1792" class="Function">delete</a> <a id="1832" href="Data.AVL.html#1832" class="Bound">k</a> <a id="1834" class="Symbol">(</a><a id="1835" href="Data.AVL.html#1297" class="InductiveConstructor">tree</a> <a id="1840" href="Data.AVL.html#1840" class="Bound">t</a><a id="1841" class="Symbol">)</a> <a id="1843" class="Symbol">=</a> <a id="1845" href="Data.AVL.html#1297" class="InductiveConstructor">tree</a> <a id="1850" href="Function.html#1920" class="Function Operator">$</a> <a id="1852" href="Agda.Builtin.Sigma.html#167" class="Field">proj₂</a> <a id="1858" href="Function.html#1920" class="Function Operator">$</a> <a id="1860" href="Data.AVL.Indexed.html#9246" class="Function">Indexed.delete</a> <a id="1875" href="Data.AVL.html#1832" class="Bound">k</a> <a id="1877" href="Data.AVL.html#1840" class="Bound">t</a>

  <a id="1882" href="Data.AVL.html#1882" class="Function">lookup</a> <a id="1889" class="Symbol">:</a> <a id="1891" class="Symbol">(</a><a id="1892" href="Data.AVL.html#1892" class="Bound">k</a> <a id="1894" class="Symbol">:</a> <a id="1896" href="Data.AVL.html#525" class="Bound">Key</a><a id="1899" class="Symbol">)</a> <a id="1901" class="Symbol">→</a> <a id="1903" href="Data.AVL.html#1244" class="Datatype">Tree</a> <a id="1908" href="Data.AVL.html#1359" class="Bound">V</a> <a id="1910" class="Symbol">→</a> <a id="1912" href="Data.Maybe.Base.html#703" class="Datatype">Maybe</a> <a id="1918" class="Symbol">(</a><a id="1919" href="Data.AVL.html#1359" class="Bound">V</a> <a id="1921" href="Data.AVL.html#1892" class="Bound">k</a><a id="1922" class="Symbol">)</a>
  <a id="1926" href="Data.AVL.html#1882" class="Function">lookup</a> <a id="1933" href="Data.AVL.html#1933" class="Bound">k</a> <a id="1935" class="Symbol">(</a><a id="1936" href="Data.AVL.html#1297" class="InductiveConstructor">tree</a> <a id="1941" href="Data.AVL.html#1941" class="Bound">t</a><a id="1942" class="Symbol">)</a> <a id="1944" class="Symbol">=</a> <a id="1946" href="Data.AVL.Indexed.html#9681" class="Function">Indexed.lookup</a> <a id="1961" href="Data.AVL.html#1933" class="Bound">k</a> <a id="1963" href="Data.AVL.html#1941" class="Bound">t</a>

<a id="1966" class="Keyword">module</a> <a id="1973" href="Data.AVL.html#1973" class="Module">_</a> <a id="1975" class="Symbol">{</a><a id="1976" href="Data.AVL.html#1976" class="Bound">v</a> <a id="1978" href="Data.AVL.html#1978" class="Bound">w</a><a id="1979" class="Symbol">}</a> <a id="1981" class="Symbol">{</a><a id="1982" href="Data.AVL.html#1982" class="Bound">V</a> <a id="1984" class="Symbol">:</a> <a id="1986" href="Data.AVL.html#525" class="Bound">Key</a> <a id="1990" class="Symbol">→</a> <a id="1992" class="PrimitiveType">Set</a> <a id="1996" href="Data.AVL.html#1976" class="Bound">v</a><a id="1997" class="Symbol">}</a> <a id="1999" class="Symbol">{</a><a id="2000" href="Data.AVL.html#2000" class="Bound">W</a> <a id="2002" class="Symbol">:</a> <a id="2004" href="Data.AVL.html#525" class="Bound">Key</a> <a id="2008" class="Symbol">→</a> <a id="2010" class="PrimitiveType">Set</a> <a id="2014" href="Data.AVL.html#1978" class="Bound">w</a><a id="2015" class="Symbol">}</a> <a id="2017" class="Keyword">where</a>

  <a id="2026" href="Data.AVL.html#2026" class="Function">map</a> <a id="2030" class="Symbol">:</a> <a id="2032" class="Symbol">({</a><a id="2034" href="Data.AVL.html#2034" class="Bound">k</a> <a id="2036" class="Symbol">:</a> <a id="2038" href="Data.AVL.html#525" class="Bound">Key</a><a id="2041" class="Symbol">}</a> <a id="2043" class="Symbol">→</a> <a id="2045" href="Data.AVL.html#1982" class="Bound">V</a> <a id="2047" href="Data.AVL.html#2034" class="Bound">k</a> <a id="2049" class="Symbol">→</a> <a id="2051" href="Data.AVL.html#2000" class="Bound">W</a> <a id="2053" href="Data.AVL.html#2034" class="Bound">k</a><a id="2054" class="Symbol">)</a> <a id="2056" class="Symbol">→</a> <a id="2058" href="Data.AVL.html#1244" class="Datatype">Tree</a> <a id="2063" href="Data.AVL.html#1982" class="Bound">V</a> <a id="2065" class="Symbol">→</a> <a id="2067" href="Data.AVL.html#1244" class="Datatype">Tree</a> <a id="2072" href="Data.AVL.html#2000" class="Bound">W</a>
  <a id="2076" href="Data.AVL.html#2026" class="Function">map</a> <a id="2080" href="Data.AVL.html#2080" class="Bound">f</a> <a id="2082" class="Symbol">(</a><a id="2083" href="Data.AVL.html#1297" class="InductiveConstructor">tree</a> <a id="2088" href="Data.AVL.html#2088" class="Bound">t</a><a id="2089" class="Symbol">)</a> <a id="2091" class="Symbol">=</a> <a id="2093" href="Data.AVL.html#1297" class="InductiveConstructor">tree</a> <a id="2098" href="Function.html#1920" class="Function Operator">$</a> <a id="2100" href="Data.AVL.Indexed.html#10318" class="Function">Indexed.map</a> <a id="2112" href="Data.AVL.html#2080" class="Bound">f</a> <a id="2114" href="Data.AVL.html#2088" class="Bound">t</a>

<a id="2117" class="Keyword">module</a> <a id="2124" href="Data.AVL.html#2124" class="Module">_</a> <a id="2126" class="Symbol">{</a><a id="2127" href="Data.AVL.html#2127" class="Bound">v</a><a id="2128" class="Symbol">}</a> <a id="2130" class="Symbol">{</a><a id="2131" href="Data.AVL.html#2131" class="Bound">V</a> <a id="2133" class="Symbol">:</a> <a id="2135" href="Data.AVL.html#525" class="Bound">Key</a> <a id="2139" class="Symbol">→</a> <a id="2141" class="PrimitiveType">Set</a> <a id="2145" href="Data.AVL.html#2127" class="Bound">v</a><a id="2146" class="Symbol">}</a> <a id="2148" class="Keyword">where</a>

  <a id="2157" class="Keyword">infix</a> <a id="2163" class="Number">4</a> <a id="2165" href="Data.AVL.html#2173" class="Function Operator">_∈?_</a>

  <a id="2173" href="Data.AVL.html#2173" class="Function Operator">_∈?_</a> <a id="2178" class="Symbol">:</a> <a id="2180" href="Data.AVL.html#525" class="Bound">Key</a> <a id="2184" class="Symbol">→</a> <a id="2186" href="Data.AVL.html#1244" class="Datatype">Tree</a> <a id="2191" href="Data.AVL.html#2131" class="Bound">V</a> <a id="2193" class="Symbol">→</a> <a id="2195" href="Agda.Builtin.Bool.html#67" class="Datatype">Bool</a>
  <a id="2202" href="Data.AVL.html#2202" class="Bound">k</a> <a id="2204" href="Data.AVL.html#2173" class="Function Operator">∈?</a> <a id="2207" href="Data.AVL.html#2207" class="Bound">t</a> <a id="2209" class="Symbol">=</a> <a id="2211" href="Data.Maybe.Base.html#1107" class="Function">is-just</a> <a id="2219" class="Symbol">(</a><a id="2220" href="Data.AVL.html#1882" class="Function">lookup</a> <a id="2227" href="Data.AVL.html#2202" class="Bound">k</a> <a id="2229" href="Data.AVL.html#2207" class="Bound">t</a><a id="2230" class="Symbol">)</a>

  <a id="2235" href="Data.AVL.html#2235" class="Function">headTail</a> <a id="2244" class="Symbol">:</a> <a id="2246" href="Data.AVL.html#1244" class="Datatype">Tree</a> <a id="2251" href="Data.AVL.html#2131" class="Bound">V</a> <a id="2253" class="Symbol">→</a> <a id="2255" href="Data.Maybe.Base.html#703" class="Datatype">Maybe</a> <a id="2261" class="Symbol">((</a><a id="2263" href="Data.AVL.Indexed.html#835" class="Function Operator">K&amp;</a> <a id="2266" href="Data.AVL.html#2131" class="Bound">V</a><a id="2267" class="Symbol">)</a> <a id="2269" href="Data.Product.html#1382" class="Function Operator">×</a> <a id="2271" href="Data.AVL.html#1244" class="Datatype">Tree</a> <a id="2276" href="Data.AVL.html#2131" class="Bound">V</a><a id="2277" class="Symbol">)</a>
  <a id="2281" href="Data.AVL.html#2235" class="Function">headTail</a> <a id="2290" class="Symbol">(</a><a id="2291" href="Data.AVL.html#1297" class="InductiveConstructor">tree</a> <a id="2296" class="Symbol">(</a><a id="2297" href="Data.AVL.Indexed.html#1135" class="InductiveConstructor">Indexed.leaf</a> <a id="2310" class="Symbol">_))</a> <a id="2314" class="Symbol">=</a> <a id="2316" href="Data.Maybe.Base.html#771" class="InductiveConstructor">nothing</a>
  <a id="2326" href="Data.AVL.html#2235" class="CatchallClause Function">headTail</a><a id="2334" class="CatchallClause"> </a><a id="2335" class="CatchallClause Symbol">(</a><a id="2336" href="Data.AVL.html#1297" class="CatchallClause InductiveConstructor">tree</a><a id="2340" class="CatchallClause"> </a><a id="2341" class="CatchallClause Symbol">{</a><a id="2342" class="CatchallClause Argument">h</a><a id="2343" class="CatchallClause"> </a><a id="2344" class="CatchallClause Symbol">=</a><a id="2345" class="CatchallClause"> </a><a id="2346" href="Agda.Builtin.Nat.html#128" class="CatchallClause InductiveConstructor">suc</a><a id="2349" class="CatchallClause"> </a><a id="2350" class="CatchallClause Symbol">_}</a><a id="2352" class="CatchallClause"> </a><a id="2353" href="Data.AVL.html#2353" class="CatchallClause Bound">t</a><a id="2354" class="CatchallClause Symbol">)</a>    <a id="2359" class="Keyword">with</a> <a id="2364" href="Data.AVL.Indexed.html#6342" class="Function">Indexed.headTail</a> <a id="2381" href="Data.AVL.html#2353" class="Bound">t</a>
  <a id="2385" class="Symbol">...</a> <a id="2389" class="Symbol">|</a> <a id="2391" class="Symbol">(</a><a id="2392" href="Data.AVL.html#2392" class="Bound">k</a> <a id="2394" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2396" class="Symbol">_</a> <a id="2398" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2400" class="Symbol">_</a> <a id="2402" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2404" href="Data.AVL.html#2404" class="Bound">t′</a><a id="2406" class="Symbol">)</a> <a id="2408" class="Symbol">=</a> <a id="2410" href="Data.Maybe.Base.html#741" class="InductiveConstructor">just</a> <a id="2415" class="Symbol">(</a><a id="2416" href="Data.AVL.html#2392" class="Bound">k</a> <a id="2418" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2420" href="Data.AVL.html#1297" class="InductiveConstructor">tree</a> <a id="2425" class="Symbol">(</a><a id="2426" href="Data.AVL.Indexed.html#2461" class="Function">Indexed.castˡ</a> <a id="2440" class="Symbol">_</a> <a id="2442" href="Data.AVL.html#2404" class="Bound">t′</a><a id="2444" class="Symbol">))</a>

  <a id="2450" href="Data.AVL.html#2450" class="Function">initLast</a> <a id="2459" class="Symbol">:</a> <a id="2461" href="Data.AVL.html#1244" class="Datatype">Tree</a> <a id="2466" href="Data.AVL.html#2131" class="Bound">V</a> <a id="2468" class="Symbol">→</a> <a id="2470" href="Data.Maybe.Base.html#703" class="Datatype">Maybe</a> <a id="2476" class="Symbol">(</a><a id="2477" href="Data.AVL.html#1244" class="Datatype">Tree</a> <a id="2482" href="Data.AVL.html#2131" class="Bound">V</a> <a id="2484" href="Data.Product.html#1382" class="Function Operator">×</a> <a id="2486" class="Symbol">(</a><a id="2487" href="Data.AVL.Indexed.html#835" class="Function Operator">K&amp;</a> <a id="2490" href="Data.AVL.html#2131" class="Bound">V</a><a id="2491" class="Symbol">))</a>
  <a id="2496" href="Data.AVL.html#2450" class="Function">initLast</a> <a id="2505" class="Symbol">(</a><a id="2506" href="Data.AVL.html#1297" class="InductiveConstructor">tree</a> <a id="2511" class="Symbol">(</a><a id="2512" href="Data.AVL.Indexed.html#1135" class="InductiveConstructor">Indexed.leaf</a> <a id="2525" class="Symbol">_))</a> <a id="2529" class="Symbol">=</a> <a id="2531" href="Data.Maybe.Base.html#771" class="InductiveConstructor">nothing</a>
  <a id="2541" href="Data.AVL.html#2450" class="CatchallClause Function">initLast</a><a id="2549" class="CatchallClause"> </a><a id="2550" class="CatchallClause Symbol">(</a><a id="2551" href="Data.AVL.html#1297" class="CatchallClause InductiveConstructor">tree</a><a id="2555" class="CatchallClause"> </a><a id="2556" class="CatchallClause Symbol">{</a><a id="2557" class="CatchallClause Argument">h</a><a id="2558" class="CatchallClause"> </a><a id="2559" class="CatchallClause Symbol">=</a><a id="2560" class="CatchallClause"> </a><a id="2561" href="Agda.Builtin.Nat.html#128" class="CatchallClause InductiveConstructor">suc</a><a id="2564" class="CatchallClause"> </a><a id="2565" class="CatchallClause Symbol">_}</a><a id="2567" class="CatchallClause"> </a><a id="2568" href="Data.AVL.html#2568" class="CatchallClause Bound">t</a><a id="2569" class="CatchallClause Symbol">)</a>    <a id="2574" class="Keyword">with</a> <a id="2579" href="Data.AVL.Indexed.html#6862" class="Function">Indexed.initLast</a> <a id="2596" href="Data.AVL.html#2568" class="Bound">t</a>
  <a id="2600" class="Symbol">...</a> <a id="2604" class="Symbol">|</a> <a id="2606" class="Symbol">(</a><a id="2607" href="Data.AVL.html#2607" class="Bound">k</a> <a id="2609" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2611" class="Symbol">_</a> <a id="2613" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2615" class="Symbol">_</a> <a id="2617" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2619" href="Data.AVL.html#2619" class="Bound">t′</a><a id="2621" class="Symbol">)</a> <a id="2623" class="Symbol">=</a> <a id="2625" href="Data.Maybe.Base.html#741" class="InductiveConstructor">just</a> <a id="2630" class="Symbol">(</a><a id="2631" href="Data.AVL.html#1297" class="InductiveConstructor">tree</a> <a id="2636" class="Symbol">(</a><a id="2637" href="Data.AVL.Indexed.html#2650" class="Function">Indexed.castʳ</a> <a id="2651" href="Data.AVL.html#2619" class="Bound">t′</a> <a id="2654" class="Symbol">_)</a> <a id="2657" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2659" href="Data.AVL.html#2607" class="Bound">k</a><a id="2660" class="Symbol">)</a>

  <a id="2665" class="Comment">-- The input does not need to be ordered.</a>

  <a id="2710" href="Data.AVL.html#2710" class="Function">fromList</a> <a id="2719" class="Symbol">:</a> <a id="2721" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="2726" class="Symbol">(</a><a id="2727" href="Data.AVL.Indexed.html#835" class="Function Operator">K&amp;</a> <a id="2730" href="Data.AVL.html#2131" class="Bound">V</a><a id="2731" class="Symbol">)</a> <a id="2733" class="Symbol">→</a> <a id="2735" href="Data.AVL.html#1244" class="Datatype">Tree</a> <a id="2740" href="Data.AVL.html#2131" class="Bound">V</a>
  <a id="2744" href="Data.AVL.html#2710" class="Function">fromList</a> <a id="2753" class="Symbol">=</a> <a id="2755" href="Data.List.Base.html#3575" class="Function">List.foldr</a> <a id="2766" class="Symbol">(</a><a id="2767" href="Data.Product.html#3493" class="Function">uncurry</a> <a id="2775" href="Data.AVL.html#1525" class="Function">insert</a><a id="2781" class="Symbol">)</a> <a id="2783" href="Data.AVL.html#1385" class="Function">empty</a>

  <a id="2792" class="Comment">-- Returns an ordered list.</a>

  <a id="2823" href="Data.AVL.html#2823" class="Function">toList</a> <a id="2830" class="Symbol">:</a> <a id="2832" href="Data.AVL.html#1244" class="Datatype">Tree</a> <a id="2837" href="Data.AVL.html#2131" class="Bound">V</a> <a id="2839" class="Symbol">→</a> <a id="2841" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="2846" class="Symbol">(</a><a id="2847" href="Data.AVL.Indexed.html#835" class="Function Operator">K&amp;</a> <a id="2850" href="Data.AVL.html#2131" class="Bound">V</a><a id="2851" class="Symbol">)</a>
  <a id="2855" href="Data.AVL.html#2823" class="Function">toList</a> <a id="2862" class="Symbol">(</a><a id="2863" href="Data.AVL.html#1297" class="InductiveConstructor">tree</a> <a id="2868" href="Data.AVL.html#2868" class="Bound">t</a><a id="2869" class="Symbol">)</a> <a id="2871" class="Symbol">=</a> <a id="2873" href="Data.DifferenceList.html#829" class="Function">DiffList.toList</a> <a id="2889" class="Symbol">(</a><a id="2890" href="Data.AVL.Indexed.html#10054" class="Function">Indexed.toDiffList</a> <a id="2909" href="Data.AVL.html#2868" class="Bound">t</a><a id="2910" class="Symbol">)</a>

  <a id="2915" class="Comment">-- Naive implementations of union.</a>

  <a id="2953" href="Data.AVL.html#2953" class="Function">unionWith</a> <a id="2963" class="Symbol">:</a> <a id="2965" class="Symbol">(∀</a> <a id="2968" class="Symbol">{</a><a id="2969" href="Data.AVL.html#2969" class="Bound">k</a><a id="2970" class="Symbol">}</a> <a id="2972" class="Symbol">→</a> <a id="2974" href="Data.AVL.html#2131" class="Bound">V</a> <a id="2976" href="Data.AVL.html#2969" class="Bound">k</a> <a id="2978" class="Symbol">→</a> <a id="2980" href="Data.AVL.html#2131" class="Bound">V</a> <a id="2982" href="Data.AVL.html#2969" class="Bound">k</a> <a id="2984" class="Symbol">→</a> <a id="2986" href="Data.AVL.html#2131" class="Bound">V</a> <a id="2988" href="Data.AVL.html#2969" class="Bound">k</a><a id="2989" class="Symbol">)</a> <a id="2991" class="Symbol">→</a>
              <a id="3007" class="Comment">-- Left → right → result.</a>
              <a id="3047" href="Data.AVL.html#1244" class="Datatype">Tree</a> <a id="3052" href="Data.AVL.html#2131" class="Bound">V</a> <a id="3054" class="Symbol">→</a> <a id="3056" href="Data.AVL.html#1244" class="Datatype">Tree</a> <a id="3061" href="Data.AVL.html#2131" class="Bound">V</a> <a id="3063" class="Symbol">→</a> <a id="3065" href="Data.AVL.html#1244" class="Datatype">Tree</a> <a id="3070" href="Data.AVL.html#2131" class="Bound">V</a>
  <a id="3074" href="Data.AVL.html#2953" class="Function">unionWith</a> <a id="3084" href="Data.AVL.html#3084" class="Bound">f</a> <a id="3086" href="Data.AVL.html#3086" class="Bound">t₁</a> <a id="3089" href="Data.AVL.html#3089" class="Bound">t₂</a> <a id="3092" class="Symbol">=</a>
    <a id="3098" href="Data.List.Base.html#3575" class="Function">List.foldr</a> <a id="3109" class="Symbol">(λ</a> <a id="3112" class="Symbol">{</a> <a id="3114" class="Symbol">(</a><a id="3115" href="Data.AVL.html#3115" class="Bound">k</a> <a id="3117" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="3119" href="Data.AVL.html#3119" class="Bound">v</a><a id="3120" class="Symbol">)</a> <a id="3122" class="Symbol">→</a> <a id="3124" href="Data.AVL.html#1633" class="Function">insertWith</a> <a id="3135" href="Data.AVL.html#3115" class="Bound">k</a> <a id="3137" href="Data.AVL.html#3119" class="Bound">v</a> <a id="3139" href="Data.AVL.html#3084" class="Bound">f</a> <a id="3141" class="Symbol">})</a> <a id="3144" href="Data.AVL.html#3089" class="Bound">t₂</a> <a id="3147" class="Symbol">(</a><a id="3148" href="Data.AVL.html#2823" class="Function">toList</a> <a id="3155" href="Data.AVL.html#3086" class="Bound">t₁</a><a id="3157" class="Symbol">)</a>

  <a id="3162" class="Comment">-- Left-biased.</a>

  <a id="3181" href="Data.AVL.html#3181" class="Function">union</a> <a id="3187" class="Symbol">:</a> <a id="3189" href="Data.AVL.html#1244" class="Datatype">Tree</a> <a id="3194" href="Data.AVL.html#2131" class="Bound">V</a> <a id="3196" class="Symbol">→</a> <a id="3198" href="Data.AVL.html#1244" class="Datatype">Tree</a> <a id="3203" href="Data.AVL.html#2131" class="Bound">V</a> <a id="3205" class="Symbol">→</a> <a id="3207" href="Data.AVL.html#1244" class="Datatype">Tree</a> <a id="3212" href="Data.AVL.html#2131" class="Bound">V</a>
  <a id="3216" href="Data.AVL.html#3181" class="Function">union</a> <a id="3222" class="Symbol">=</a> <a id="3224" href="Data.AVL.html#2953" class="Function">unionWith</a> <a id="3234" href="Function.html#1138" class="Function">const</a>

  <a id="3243" href="Data.AVL.html#3243" class="Function">unionsWith</a> <a id="3254" class="Symbol">:</a> <a id="3256" class="Symbol">(∀</a> <a id="3259" class="Symbol">{</a><a id="3260" href="Data.AVL.html#3260" class="Bound">k</a><a id="3261" class="Symbol">}</a> <a id="3263" class="Symbol">→</a> <a id="3265" href="Data.AVL.html#2131" class="Bound">V</a> <a id="3267" href="Data.AVL.html#3260" class="Bound">k</a> <a id="3269" class="Symbol">→</a> <a id="3271" href="Data.AVL.html#2131" class="Bound">V</a> <a id="3273" href="Data.AVL.html#3260" class="Bound">k</a> <a id="3275" class="Symbol">→</a> <a id="3277" href="Data.AVL.html#2131" class="Bound">V</a> <a id="3279" href="Data.AVL.html#3260" class="Bound">k</a><a id="3280" class="Symbol">)</a> <a id="3282" class="Symbol">→</a> <a id="3284" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="3289" class="Symbol">(</a><a id="3290" href="Data.AVL.html#1244" class="Datatype">Tree</a> <a id="3295" href="Data.AVL.html#2131" class="Bound">V</a><a id="3296" class="Symbol">)</a> <a id="3298" class="Symbol">→</a> <a id="3300" href="Data.AVL.html#1244" class="Datatype">Tree</a> <a id="3305" href="Data.AVL.html#2131" class="Bound">V</a>
  <a id="3309" href="Data.AVL.html#3243" class="Function">unionsWith</a> <a id="3320" href="Data.AVL.html#3320" class="Bound">f</a> <a id="3322" href="Data.AVL.html#3322" class="Bound">ts</a> <a id="3325" class="Symbol">=</a> <a id="3327" href="Data.List.Base.html#3575" class="Function">List.foldr</a> <a id="3338" class="Symbol">(</a><a id="3339" href="Data.AVL.html#2953" class="Function">unionWith</a> <a id="3349" href="Data.AVL.html#3320" class="Bound">f</a><a id="3350" class="Symbol">)</a> <a id="3352" href="Data.AVL.html#1385" class="Function">empty</a> <a id="3358" href="Data.AVL.html#3322" class="Bound">ts</a>

  <a id="3364" class="Comment">-- Left-biased.</a>

  <a id="3383" href="Data.AVL.html#3383" class="Function">unions</a> <a id="3390" class="Symbol">:</a> <a id="3392" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="3397" class="Symbol">(</a><a id="3398" href="Data.AVL.html#1244" class="Datatype">Tree</a> <a id="3403" href="Data.AVL.html#2131" class="Bound">V</a><a id="3404" class="Symbol">)</a> <a id="3406" class="Symbol">→</a> <a id="3408" href="Data.AVL.html#1244" class="Datatype">Tree</a> <a id="3413" href="Data.AVL.html#2131" class="Bound">V</a>
  <a id="3417" href="Data.AVL.html#3383" class="Function">unions</a> <a id="3424" class="Symbol">=</a> <a id="3426" href="Data.AVL.html#3243" class="Function">unionsWith</a> <a id="3437" href="Function.html#1138" class="Function">const</a>
</pre></body></html>