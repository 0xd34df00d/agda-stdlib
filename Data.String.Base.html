<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.String.Base</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Strings: builtin type and basic operations</a>
<a id="152" class="Comment">------------------------------------------------------------------------</a>

<a id="226" class="Symbol">{-#</a> <a id="230" class="Keyword">OPTIONS</a> <a id="238" class="Pragma">--without-K</a> <a id="250" class="Pragma">--safe</a> <a id="257" class="Symbol">#-}</a>

<a id="262" class="Keyword">module</a> <a id="269" href="Data.String.Base.html" class="Module">Data.String.Base</a> <a id="286" class="Keyword">where</a>

<a id="293" class="Keyword">open</a> <a id="298" class="Keyword">import</a> <a id="305" href="Level.html" class="Module">Level</a> <a id="311" class="Keyword">using</a> <a id="317" class="Symbol">(</a><a id="318" href="Agda.Primitive.html#611" class="Primitive">zero</a><a id="322" class="Symbol">)</a>
<a id="324" class="Keyword">open</a> <a id="329" class="Keyword">import</a> <a id="336" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="350" class="Symbol">as</a> <a id="353" class="Module">ℕ</a> <a id="355" class="Keyword">using</a> <a id="361" class="Symbol">(</a><a id="362" href="Agda.Builtin.Nat.html#165" class="Datatype">ℕ</a><a id="363" class="Symbol">;</a> <a id="365" href="Agda.Builtin.Nat.html#388" class="Primitive Operator">_∸_</a><a id="368" class="Symbol">;</a> <a id="370" href="Data.Nat.Base.html#1859" class="Function Operator">⌊_/2⌋</a><a id="375" class="Symbol">;</a> <a id="377" href="Data.Nat.Base.html#1986" class="Function Operator">⌈_/2⌉</a><a id="382" class="Symbol">)</a>
<a id="384" class="Keyword">import</a> <a id="391" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="411" class="Symbol">as</a> <a id="414" class="Module">ℕₚ</a>
<a id="417" class="Keyword">open</a> <a id="422" class="Keyword">import</a> <a id="429" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="444" class="Symbol">as</a> <a id="447" class="Module">List</a> <a id="452" class="Keyword">using</a> <a id="458" class="Symbol">(</a><a id="459" href="Agda.Builtin.List.html#121" class="Datatype">List</a><a id="463" class="Symbol">;</a> <a id="465" href="Data.List.Base.html#4364" class="Function Operator">[_]</a><a id="468" class="Symbol">)</a>
<a id="470" class="Keyword">open</a> <a id="475" class="Keyword">import</a> <a id="482" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="501" class="Symbol">as</a> <a id="504" class="Module">NE</a> <a id="507" class="Keyword">using</a> <a id="513" class="Symbol">(</a><a id="514" href="Data.List.NonEmpty.html#1295" class="Record">List⁺</a><a id="519" class="Symbol">)</a>
<a id="521" class="Keyword">open</a> <a id="526" class="Keyword">import</a> <a id="533" href="Data.List.Extrema.html" class="Module">Data.List.Extrema</a> <a id="551" href="Data.Nat.Properties.html#5742" class="Function">ℕₚ.≤-totalOrder</a>
<a id="567" class="Keyword">open</a> <a id="572" class="Keyword">import</a> <a id="579" href="Data.List.Relation.Binary.Pointwise.html" class="Module">Data.List.Relation.Binary.Pointwise</a> <a id="615" class="Keyword">using</a> <a id="621" class="Symbol">(</a><a id="622" href="Data.List.Relation.Binary.Pointwise.html#1561" class="Datatype">Pointwise</a><a id="631" class="Symbol">)</a>
<a id="633" class="Keyword">open</a> <a id="638" class="Keyword">import</a> <a id="645" href="Data.List.Relation.Binary.Lex.Strict.html" class="Module">Data.List.Relation.Binary.Lex.Strict</a> <a id="682" class="Keyword">using</a> <a id="688" class="Symbol">(</a><a id="689" href="Data.List.Relation.Binary.Lex.Strict.html#1172" class="Function">Lex-&lt;</a><a id="694" class="Symbol">)</a>
<a id="696" class="Keyword">open</a> <a id="701" class="Keyword">import</a> <a id="708" href="Data.Vec.Base.html" class="Module">Data.Vec.Base</a> <a id="722" class="Symbol">as</a> <a id="725" class="Module">Vec</a> <a id="729" class="Keyword">using</a> <a id="735" class="Symbol">(</a><a id="736" href="Data.Vec.Base.html#959" class="Datatype">Vec</a><a id="739" class="Symbol">)</a>
<a id="741" class="Keyword">open</a> <a id="746" class="Keyword">import</a> <a id="753" href="Data.Char.Base.html" class="Module">Data.Char.Base</a> <a id="768" class="Symbol">as</a> <a id="771" class="Module">Char</a> <a id="776" class="Keyword">using</a> <a id="782" class="Symbol">(</a><a id="783" href="Agda.Builtin.Char.html#200" class="Postulate">Char</a><a id="787" class="Symbol">)</a>
<a id="789" class="Keyword">open</a> <a id="794" class="Keyword">import</a> <a id="801" href="Function.html" class="Module">Function</a>
<a id="810" class="Keyword">open</a> <a id="815" class="Keyword">import</a> <a id="822" href="Relation.Binary.html" class="Module">Relation.Binary</a> <a id="838" class="Keyword">using</a> <a id="844" class="Symbol">(</a><a id="845" href="Relation.Binary.Core.html#845" class="Function">Rel</a><a id="848" class="Symbol">)</a>

<a id="851" class="Comment">------------------------------------------------------------------------</a>
<a id="924" class="Comment">-- From Agda.Builtin: type and renamed primitives</a>

<a id="975" class="Comment">-- Note that we do not re-export primStringAppend because we want to</a>
<a id="1044" class="Comment">-- give it an infix definition and be able to assign it a level.</a>

<a id="1110" class="Keyword">import</a> <a id="1117" href="Agda.Builtin.String.html" class="Module">Agda.Builtin.String</a> <a id="1137" class="Symbol">as</a> <a id="1140" class="Module">String</a>

<a id="1148" class="Keyword">open</a> <a id="1153" href="Agda.Builtin.String.html" class="Module">String</a> <a id="1160" class="Keyword">public</a> <a id="1167" class="Keyword">using</a> <a id="1173" class="Symbol">(</a> <a id="1175" href="Agda.Builtin.String.html#206" class="Postulate">String</a> <a id="1182" class="Symbol">)</a>
  <a id="1186" class="Keyword">renaming</a>
  <a id="1197" class="Symbol">(</a> <a id="1199" href="Agda.Builtin.String.html#262" class="Primitive">primStringToList</a>   <a id="1218" class="Symbol">to</a> <a id="1221" href="Agda.Builtin.String.html#262" class="Primitive">toList</a>
  <a id="1230" class="Symbol">;</a> <a id="1232" href="Agda.Builtin.String.html#304" class="Primitive">primStringFromList</a> <a id="1251" class="Symbol">to</a> <a id="1254" href="Agda.Builtin.String.html#304" class="Primitive">fromList</a>
  <a id="1265" class="Symbol">;</a> <a id="1267" href="Agda.Builtin.String.html#477" class="Primitive">primShowString</a>     <a id="1286" class="Symbol">to</a> <a id="1289" href="Agda.Builtin.String.html#477" class="Primitive">show</a>
  <a id="1296" class="Symbol">)</a>

<a id="1299" class="Comment">------------------------------------------------------------------------</a>
<a id="1372" class="Comment">-- Relations</a>

<a id="1386" class="Comment">-- Pointwise equality on Strings</a>

<a id="1420" class="Keyword">infix</a> <a id="1426" class="Number">4</a> <a id="1428" href="Data.String.Base.html#1432" class="Function Operator">_≈_</a>
<a id="_≈_"></a><a id="1432" href="Data.String.Base.html#1432" class="Function Operator">_≈_</a> <a id="1436" class="Symbol">:</a> <a id="1438" href="Relation.Binary.Core.html#845" class="Function">Rel</a> <a id="1442" href="Agda.Builtin.String.html#206" class="Postulate">String</a> <a id="1449" href="Agda.Primitive.html#611" class="Primitive">zero</a>
<a id="1454" href="Data.String.Base.html#1432" class="Function Operator">_≈_</a> <a id="1458" class="Symbol">=</a> <a id="1460" href="Data.List.Relation.Binary.Pointwise.html#1561" class="Datatype">Pointwise</a> <a id="1470" href="Data.Char.Base.html#1132" class="Function Operator">Char._≈_</a> <a id="1479" href="Function.Base.html#3938" class="Function Operator">on</a> <a id="1482" href="Agda.Builtin.String.html#262" class="Primitive">toList</a>

<a id="1490" class="Comment">-- Lexicographic ordering on Strings</a>

<a id="1528" class="Keyword">infix</a> <a id="1534" class="Number">4</a> <a id="1536" href="Data.String.Base.html#1540" class="Function Operator">_&lt;_</a>
<a id="_&lt;_"></a><a id="1540" href="Data.String.Base.html#1540" class="Function Operator">_&lt;_</a> <a id="1544" class="Symbol">:</a> <a id="1546" href="Relation.Binary.Core.html#845" class="Function">Rel</a> <a id="1550" href="Agda.Builtin.String.html#206" class="Postulate">String</a> <a id="1557" href="Agda.Primitive.html#611" class="Primitive">zero</a>
<a id="1562" href="Data.String.Base.html#1540" class="Function Operator">_&lt;_</a> <a id="1566" class="Symbol">=</a> <a id="1568" href="Data.List.Relation.Binary.Lex.Strict.html#1172" class="Function">Lex-&lt;</a> <a id="1574" href="Data.Char.Base.html#1132" class="Function Operator">Char._≈_</a> <a id="1583" href="Data.Char.Base.html#1182" class="Function Operator">Char._&lt;_</a> <a id="1592" href="Function.Base.html#3938" class="Function Operator">on</a> <a id="1595" href="Agda.Builtin.String.html#262" class="Primitive">toList</a>

<a id="1603" class="Comment">------------------------------------------------------------------------</a>
<a id="1676" class="Comment">-- Operations</a>

<a id="1691" class="Comment">-- Additional conversion functions</a>

<a id="fromChar"></a><a id="1727" href="Data.String.Base.html#1727" class="Function">fromChar</a> <a id="1736" class="Symbol">:</a> <a id="1738" href="Agda.Builtin.Char.html#200" class="Postulate">Char</a> <a id="1743" class="Symbol">→</a> <a id="1745" href="Agda.Builtin.String.html#206" class="Postulate">String</a>
<a id="1752" href="Data.String.Base.html#1727" class="Function">fromChar</a> <a id="1761" class="Symbol">=</a> <a id="1763" href="Agda.Builtin.String.html#304" class="Primitive">fromList</a> <a id="1772" href="Function.Base.html#3193" class="Function Operator">∘′</a> <a id="1775" href="Data.List.Base.html#4364" class="Function Operator">[_]</a>

<a id="fromList⁺"></a><a id="1780" href="Data.String.Base.html#1780" class="Function">fromList⁺</a> <a id="1790" class="Symbol">:</a> <a id="1792" href="Data.List.NonEmpty.html#1295" class="Record">List⁺</a> <a id="1798" href="Agda.Builtin.Char.html#200" class="Postulate">Char</a> <a id="1803" class="Symbol">→</a> <a id="1805" href="Agda.Builtin.String.html#206" class="Postulate">String</a>
<a id="1812" href="Data.String.Base.html#1780" class="Function">fromList⁺</a> <a id="1822" class="Symbol">=</a> <a id="1824" href="Agda.Builtin.String.html#304" class="Primitive">fromList</a> <a id="1833" href="Function.Base.html#3193" class="Function Operator">∘′</a> <a id="1836" href="Data.List.NonEmpty.html#1737" class="Function">NE.toList</a>

<a id="1847" class="Comment">-- List-like functions</a>

<a id="1871" class="Keyword">infixr</a> <a id="1878" class="Number">5</a> <a id="1880" href="Data.String.Base.html#1885" class="Function Operator">_++_</a>
<a id="_++_"></a><a id="1885" href="Data.String.Base.html#1885" class="Function Operator">_++_</a> <a id="1890" class="Symbol">:</a> <a id="1892" href="Agda.Builtin.String.html#206" class="Postulate">String</a> <a id="1899" class="Symbol">→</a> <a id="1901" href="Agda.Builtin.String.html#206" class="Postulate">String</a> <a id="1908" class="Symbol">→</a> <a id="1910" href="Agda.Builtin.String.html#206" class="Postulate">String</a>
<a id="1917" href="Data.String.Base.html#1885" class="Function Operator">_++_</a> <a id="1922" class="Symbol">=</a> <a id="1924" href="Agda.Builtin.String.html#346" class="Primitive">String.primStringAppend</a>

<a id="length"></a><a id="1949" href="Data.String.Base.html#1949" class="Function">length</a> <a id="1956" class="Symbol">:</a> <a id="1958" href="Agda.Builtin.String.html#206" class="Postulate">String</a> <a id="1965" class="Symbol">→</a> <a id="1967" href="Agda.Builtin.Nat.html#165" class="Datatype">ℕ</a>
<a id="1969" href="Data.String.Base.html#1949" class="Function">length</a> <a id="1976" class="Symbol">=</a> <a id="1978" href="Data.List.Base.html#4203" class="Function">List.length</a> <a id="1990" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="1992" href="Agda.Builtin.String.html#262" class="Primitive">toList</a>

<a id="replicate"></a><a id="2000" href="Data.String.Base.html#2000" class="Function">replicate</a> <a id="2010" class="Symbol">:</a> <a id="2012" href="Agda.Builtin.Nat.html#165" class="Datatype">ℕ</a> <a id="2014" class="Symbol">→</a> <a id="2016" href="Agda.Builtin.Char.html#200" class="Postulate">Char</a> <a id="2021" class="Symbol">→</a> <a id="2023" href="Agda.Builtin.String.html#206" class="Postulate">String</a>
<a id="2030" href="Data.String.Base.html#2000" class="Function">replicate</a> <a id="2040" href="Data.String.Base.html#2040" class="Bound">n</a> <a id="2042" class="Symbol">=</a> <a id="2044" href="Agda.Builtin.String.html#304" class="Primitive">fromList</a> <a id="2053" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="2055" href="Data.List.Base.html#4478" class="Function">List.replicate</a> <a id="2070" href="Data.String.Base.html#2040" class="Bound">n</a>

<a id="concat"></a><a id="2073" href="Data.String.Base.html#2073" class="Function">concat</a> <a id="2080" class="Symbol">:</a> <a id="2082" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="2087" href="Agda.Builtin.String.html#206" class="Postulate">String</a> <a id="2094" class="Symbol">→</a> <a id="2096" href="Agda.Builtin.String.html#206" class="Postulate">String</a>
<a id="2103" href="Data.String.Base.html#2073" class="Function">concat</a> <a id="2110" class="Symbol">=</a> <a id="2112" href="Data.List.Base.html#3531" class="Function">List.foldr</a> <a id="2123" href="Data.String.Base.html#1885" class="Function Operator">_++_</a> <a id="2128" class="String">&quot;&quot;</a>

<a id="2132" class="Comment">-- String-specific functions</a>

<a id="unlines"></a><a id="2162" href="Data.String.Base.html#2162" class="Function">unlines</a> <a id="2170" class="Symbol">:</a> <a id="2172" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="2177" href="Agda.Builtin.String.html#206" class="Postulate">String</a> <a id="2184" class="Symbol">→</a> <a id="2186" href="Agda.Builtin.String.html#206" class="Postulate">String</a>
<a id="2193" href="Data.String.Base.html#2162" class="Function">unlines</a> <a id="2201" class="Symbol">=</a> <a id="2203" href="Data.String.Base.html#2073" class="Function">concat</a> <a id="2210" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="2212" href="Data.List.Base.html#1754" class="Function">List.intersperse</a> <a id="2229" class="String">&quot;\n&quot;</a>

<a id="2235" class="Comment">------------------------------------------------------------------------</a>
<a id="2308" class="Comment">-- Padding</a>

<a id="2320" class="Comment">-- Each one of the padding functions should verify the following</a>
<a id="2385" class="Comment">-- invariant:</a>
<a id="2399" class="Comment">--   If length str ≤ n then length (padLeft c n str) ≡ n</a>
<a id="2456" class="Comment">--   and otherwise padLeft c n str ≡ str.</a>

<a id="2499" class="Comment">-- Appending an empty string is expensive (append for Haskell&#39;s</a>
<a id="2563" class="Comment">-- Text creates a fresh Text value in which both contents are</a>
<a id="2625" class="Comment">-- copied) so we precompute `n ∸ length str` and check whether</a>
<a id="2688" class="Comment">-- it is equal to 0.</a>

<a id="padLeft"></a><a id="2710" href="Data.String.Base.html#2710" class="Function">padLeft</a> <a id="2718" class="Symbol">:</a> <a id="2720" href="Agda.Builtin.Char.html#200" class="Postulate">Char</a> <a id="2725" class="Symbol">→</a> <a id="2727" href="Agda.Builtin.Nat.html#165" class="Datatype">ℕ</a> <a id="2729" class="Symbol">→</a> <a id="2731" href="Agda.Builtin.String.html#206" class="Postulate">String</a> <a id="2738" class="Symbol">→</a> <a id="2740" href="Agda.Builtin.String.html#206" class="Postulate">String</a>
<a id="2747" href="Data.String.Base.html#2710" class="Function">padLeft</a> <a id="2755" href="Data.String.Base.html#2755" class="Bound">c</a> <a id="2757" href="Data.String.Base.html#2757" class="Bound">n</a> <a id="2759" href="Data.String.Base.html#2759" class="Bound">str</a> <a id="2763" class="Keyword">with</a> <a id="2768" href="Data.String.Base.html#2757" class="Bound">n</a> <a id="2770" href="Agda.Builtin.Nat.html#388" class="Primitive Operator">∸</a> <a id="2772" href="Data.String.Base.html#1949" class="Function">length</a> <a id="2779" href="Data.String.Base.html#2759" class="Bound">str</a>
<a id="2783" class="Symbol">...</a> <a id="2787" class="Symbol">|</a> <a id="2789" class="Number">0</a> <a id="2791" class="Symbol">=</a> <a id="2793" class="Bound">str</a>
<a id="2797" class="CatchallClause Symbol">...</a><a id="2800" class="CatchallClause"> </a><a id="2801" class="CatchallClause Symbol">|</a><a id="2802" class="CatchallClause"> </a><a id="2803" href="Data.String.Base.html#2803" class="CatchallClause Bound">l</a> <a id="2805" class="Symbol">=</a> <a id="2807" href="Data.String.Base.html#2000" class="Function">replicate</a> <a id="2817" href="Data.String.Base.html#2803" class="Bound">l</a> <a id="2819" class="Bound">c</a> <a id="2821" href="Data.String.Base.html#1885" class="Function Operator">++</a> <a id="2824" class="Bound">str</a>

<a id="padRight"></a><a id="2829" href="Data.String.Base.html#2829" class="Function">padRight</a> <a id="2838" class="Symbol">:</a> <a id="2840" href="Agda.Builtin.Char.html#200" class="Postulate">Char</a> <a id="2845" class="Symbol">→</a> <a id="2847" href="Agda.Builtin.Nat.html#165" class="Datatype">ℕ</a> <a id="2849" class="Symbol">→</a> <a id="2851" href="Agda.Builtin.String.html#206" class="Postulate">String</a> <a id="2858" class="Symbol">→</a> <a id="2860" href="Agda.Builtin.String.html#206" class="Postulate">String</a>
<a id="2867" href="Data.String.Base.html#2829" class="Function">padRight</a> <a id="2876" href="Data.String.Base.html#2876" class="Bound">c</a> <a id="2878" href="Data.String.Base.html#2878" class="Bound">n</a> <a id="2880" href="Data.String.Base.html#2880" class="Bound">str</a> <a id="2884" class="Keyword">with</a> <a id="2889" href="Data.String.Base.html#2878" class="Bound">n</a> <a id="2891" href="Agda.Builtin.Nat.html#388" class="Primitive Operator">∸</a> <a id="2893" href="Data.String.Base.html#1949" class="Function">length</a> <a id="2900" href="Data.String.Base.html#2880" class="Bound">str</a>
<a id="2904" class="Symbol">...</a> <a id="2908" class="Symbol">|</a> <a id="2910" class="Number">0</a> <a id="2912" class="Symbol">=</a> <a id="2914" class="Bound">str</a>
<a id="2918" class="CatchallClause Symbol">...</a><a id="2921" class="CatchallClause"> </a><a id="2922" class="CatchallClause Symbol">|</a><a id="2923" class="CatchallClause"> </a><a id="2924" href="Data.String.Base.html#2924" class="CatchallClause Bound">l</a> <a id="2926" class="Symbol">=</a> <a id="2928" class="Bound">str</a> <a id="2932" href="Data.String.Base.html#1885" class="Function Operator">++</a> <a id="2935" href="Data.String.Base.html#2000" class="Function">replicate</a> <a id="2945" href="Data.String.Base.html#2924" class="Bound">l</a> <a id="2947" class="Bound">c</a>

<a id="padBoth"></a><a id="2950" href="Data.String.Base.html#2950" class="Function">padBoth</a> <a id="2958" class="Symbol">:</a> <a id="2960" href="Agda.Builtin.Char.html#200" class="Postulate">Char</a> <a id="2965" class="Symbol">→</a> <a id="2967" href="Agda.Builtin.Char.html#200" class="Postulate">Char</a> <a id="2972" class="Symbol">→</a> <a id="2974" href="Agda.Builtin.Nat.html#165" class="Datatype">ℕ</a> <a id="2976" class="Symbol">→</a> <a id="2978" href="Agda.Builtin.String.html#206" class="Postulate">String</a> <a id="2985" class="Symbol">→</a> <a id="2987" href="Agda.Builtin.String.html#206" class="Postulate">String</a>
<a id="2994" href="Data.String.Base.html#2950" class="Function">padBoth</a> <a id="3002" href="Data.String.Base.html#3002" class="Bound">cₗ</a> <a id="3005" href="Data.String.Base.html#3005" class="Bound">cᵣ</a> <a id="3008" href="Data.String.Base.html#3008" class="Bound">n</a> <a id="3010" href="Data.String.Base.html#3010" class="Bound">str</a> <a id="3014" class="Keyword">with</a> <a id="3019" href="Data.String.Base.html#3008" class="Bound">n</a> <a id="3021" href="Agda.Builtin.Nat.html#388" class="Primitive Operator">∸</a> <a id="3023" href="Data.String.Base.html#1949" class="Function">length</a> <a id="3030" href="Data.String.Base.html#3010" class="Bound">str</a>
<a id="3034" class="Symbol">...</a> <a id="3038" class="Symbol">|</a> <a id="3040" class="Number">0</a> <a id="3042" class="Symbol">=</a> <a id="3044" class="Bound">str</a>
<a id="3048" class="CatchallClause Symbol">...</a><a id="3051" class="CatchallClause"> </a><a id="3052" class="CatchallClause Symbol">|</a><a id="3053" class="CatchallClause"> </a><a id="3054" href="Data.String.Base.html#3054" class="CatchallClause Bound">l</a> <a id="3056" class="Symbol">=</a> <a id="3058" href="Data.String.Base.html#2000" class="Function">replicate</a> <a id="3068" href="Data.Nat.Base.html#1859" class="Function Operator">⌊</a> <a id="3070" href="Data.String.Base.html#3054" class="Bound">l</a> <a id="3072" href="Data.Nat.Base.html#1859" class="Function Operator">/2⌋</a> <a id="3076" class="Bound">cₗ</a> <a id="3079" href="Data.String.Base.html#1885" class="Function Operator">++</a> <a id="3082" class="Bound">str</a> <a id="3086" href="Data.String.Base.html#1885" class="Function Operator">++</a> <a id="3089" href="Data.String.Base.html#2000" class="Function">replicate</a> <a id="3099" href="Data.Nat.Base.html#1986" class="Function Operator">⌈</a> <a id="3101" href="Data.String.Base.html#3054" class="Bound">l</a> <a id="3103" href="Data.Nat.Base.html#1986" class="Function Operator">/2⌉</a> <a id="3107" class="Bound">cᵣ</a>

<a id="3111" class="Comment">------------------------------------------------------------------------</a>
<a id="3184" class="Comment">-- Alignment</a>

<a id="3198" class="Comment">-- We can align a String left, center or right in a column of a given</a>
<a id="3268" class="Comment">-- width by padding it with whitespace.</a>

<a id="3309" class="Keyword">data</a> <a id="Alignment"></a><a id="3314" href="Data.String.Base.html#3314" class="Datatype">Alignment</a> <a id="3324" class="Symbol">:</a> <a id="3326" class="PrimitiveType">Set</a> <a id="3330" class="Keyword">where</a>
  <a id="Alignment.Left"></a><a id="3338" href="Data.String.Base.html#3338" class="InductiveConstructor">Left</a> <a id="Alignment.Center"></a><a id="3343" href="Data.String.Base.html#3343" class="InductiveConstructor">Center</a> <a id="Alignment.Right"></a><a id="3350" href="Data.String.Base.html#3350" class="InductiveConstructor">Right</a> <a id="3356" class="Symbol">:</a> <a id="3358" href="Data.String.Base.html#3314" class="Datatype">Alignment</a>

<a id="fromAlignment"></a><a id="3369" href="Data.String.Base.html#3369" class="Function">fromAlignment</a> <a id="3383" class="Symbol">:</a> <a id="3385" href="Data.String.Base.html#3314" class="Datatype">Alignment</a> <a id="3395" class="Symbol">→</a> <a id="3397" href="Agda.Builtin.Nat.html#165" class="Datatype">ℕ</a> <a id="3399" class="Symbol">→</a> <a id="3401" href="Agda.Builtin.String.html#206" class="Postulate">String</a> <a id="3408" class="Symbol">→</a> <a id="3410" href="Agda.Builtin.String.html#206" class="Postulate">String</a>
<a id="3417" href="Data.String.Base.html#3369" class="Function">fromAlignment</a> <a id="3431" href="Data.String.Base.html#3338" class="InductiveConstructor">Left</a>   <a id="3438" class="Symbol">=</a> <a id="3440" href="Data.String.Base.html#2829" class="Function">padRight</a> <a id="3449" class="String">&#39; &#39;</a>
<a id="3453" href="Data.String.Base.html#3369" class="Function">fromAlignment</a> <a id="3467" href="Data.String.Base.html#3343" class="InductiveConstructor">Center</a> <a id="3474" class="Symbol">=</a> <a id="3476" href="Data.String.Base.html#2950" class="Function">padBoth</a> <a id="3484" class="String">&#39; &#39;</a> <a id="3488" class="String">&#39; &#39;</a>
<a id="3492" href="Data.String.Base.html#3369" class="Function">fromAlignment</a> <a id="3506" href="Data.String.Base.html#3350" class="InductiveConstructor">Right</a>  <a id="3513" class="Symbol">=</a> <a id="3515" href="Data.String.Base.html#2710" class="Function">padLeft</a> <a id="3523" class="String">&#39; &#39;</a>

<a id="3528" class="Comment">------------------------------------------------------------------------</a>
<a id="3601" class="Comment">-- Rectangle</a>

<a id="3615" class="Comment">-- Build a rectangular column by:</a>
<a id="3649" class="Comment">-- Given a vector of cells and a padding function for each one</a>
<a id="3712" class="Comment">-- Compute the max of the widths, and pad the strings accordingly.</a>

<a id="rectangle"></a><a id="3780" href="Data.String.Base.html#3780" class="Function">rectangle</a> <a id="3790" class="Symbol">:</a> <a id="3792" class="Symbol">∀</a> <a id="3794" class="Symbol">{</a><a id="3795" href="Data.String.Base.html#3795" class="Bound">n</a><a id="3796" class="Symbol">}</a> <a id="3798" class="Symbol">→</a> <a id="3800" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="3804" class="Symbol">(</a><a id="3805" href="Agda.Builtin.Nat.html#165" class="Datatype">ℕ</a> <a id="3807" class="Symbol">→</a> <a id="3809" href="Agda.Builtin.String.html#206" class="Postulate">String</a> <a id="3816" class="Symbol">→</a> <a id="3818" href="Agda.Builtin.String.html#206" class="Postulate">String</a><a id="3824" class="Symbol">)</a> <a id="3826" href="Data.String.Base.html#3795" class="Bound">n</a> <a id="3828" class="Symbol">→</a>
            <a id="3842" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="3846" href="Agda.Builtin.String.html#206" class="Postulate">String</a> <a id="3853" href="Data.String.Base.html#3795" class="Bound">n</a> <a id="3855" class="Symbol">→</a> <a id="3857" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="3861" href="Agda.Builtin.String.html#206" class="Postulate">String</a> <a id="3868" href="Data.String.Base.html#3795" class="Bound">n</a>
<a id="3870" href="Data.String.Base.html#3780" class="Function">rectangle</a> <a id="3880" href="Data.String.Base.html#3880" class="Bound">pads</a> <a id="3885" href="Data.String.Base.html#3885" class="Bound">cells</a> <a id="3891" class="Symbol">=</a> <a id="3893" href="Data.Vec.Base.html#3379" class="Function">Vec.zipWith</a> <a id="3905" class="Symbol">(λ</a> <a id="3908" href="Data.String.Base.html#3908" class="Bound">p</a> <a id="3910" href="Data.String.Base.html#3910" class="Bound">c</a> <a id="3912" class="Symbol">→</a> <a id="3914" href="Data.String.Base.html#3908" class="Bound">p</a> <a id="3916" href="Data.String.Base.html#3990" class="Function">width</a> <a id="3922" href="Data.String.Base.html#3910" class="Bound">c</a><a id="3923" class="Symbol">)</a> <a id="3925" href="Data.String.Base.html#3880" class="Bound">pads</a> <a id="3930" href="Data.String.Base.html#3885" class="Bound">cells</a> <a id="3936" class="Keyword">where</a>

  <a id="3945" href="Data.String.Base.html#3945" class="Function">sizes</a> <a id="3951" class="Symbol">=</a> <a id="3953" href="Data.List.Base.html#1403" class="Function">List.map</a> <a id="3962" href="Data.String.Base.html#1949" class="Function">length</a> <a id="3969" class="Symbol">(</a><a id="3970" href="Data.Vec.Base.html#7328" class="Function">Vec.toList</a> <a id="3981" href="Data.String.Base.html#3885" class="Bound">cells</a><a id="3986" class="Symbol">)</a>
  <a id="3990" href="Data.String.Base.html#3990" class="Function">width</a> <a id="3996" class="Symbol">=</a> <a id="3998" href="Data.List.Extrema.html#1946" class="Function">max</a> <a id="4002" class="Number">0</a> <a id="4004" href="Data.String.Base.html#3945" class="Function">sizes</a>

<a id="4011" class="Comment">-- Special cases for left, center, and right alignment</a>

<a id="rectangleˡ"></a><a id="4067" href="Data.String.Base.html#4067" class="Function">rectangleˡ</a> <a id="4078" class="Symbol">:</a> <a id="4080" class="Symbol">∀</a> <a id="4082" class="Symbol">{</a><a id="4083" href="Data.String.Base.html#4083" class="Bound">n</a><a id="4084" class="Symbol">}</a> <a id="4086" class="Symbol">→</a> <a id="4088" href="Agda.Builtin.Char.html#200" class="Postulate">Char</a> <a id="4093" class="Symbol">→</a> <a id="4095" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="4099" href="Agda.Builtin.String.html#206" class="Postulate">String</a> <a id="4106" href="Data.String.Base.html#4083" class="Bound">n</a> <a id="4108" class="Symbol">→</a> <a id="4110" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="4114" href="Agda.Builtin.String.html#206" class="Postulate">String</a> <a id="4121" href="Data.String.Base.html#4083" class="Bound">n</a>
<a id="4123" href="Data.String.Base.html#4067" class="Function">rectangleˡ</a> <a id="4134" href="Data.String.Base.html#4134" class="Bound">c</a> <a id="4136" class="Symbol">=</a> <a id="4138" href="Data.String.Base.html#3780" class="Function">rectangle</a> <a id="4148" class="Symbol">(</a><a id="4149" href="Data.Vec.Base.html#5745" class="Function">Vec.replicate</a> <a id="4163" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="4165" href="Data.String.Base.html#2710" class="Function">padLeft</a> <a id="4173" href="Data.String.Base.html#4134" class="Bound">c</a><a id="4174" class="Symbol">)</a>

<a id="rectangleʳ"></a><a id="4177" href="Data.String.Base.html#4177" class="Function">rectangleʳ</a> <a id="4188" class="Symbol">:</a> <a id="4190" class="Symbol">∀</a> <a id="4192" class="Symbol">{</a><a id="4193" href="Data.String.Base.html#4193" class="Bound">n</a><a id="4194" class="Symbol">}</a> <a id="4196" class="Symbol">→</a> <a id="4198" href="Agda.Builtin.Char.html#200" class="Postulate">Char</a> <a id="4203" class="Symbol">→</a> <a id="4205" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="4209" href="Agda.Builtin.String.html#206" class="Postulate">String</a> <a id="4216" href="Data.String.Base.html#4193" class="Bound">n</a> <a id="4218" class="Symbol">→</a> <a id="4220" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="4224" href="Agda.Builtin.String.html#206" class="Postulate">String</a> <a id="4231" href="Data.String.Base.html#4193" class="Bound">n</a>
<a id="4233" href="Data.String.Base.html#4177" class="Function">rectangleʳ</a> <a id="4244" href="Data.String.Base.html#4244" class="Bound">c</a> <a id="4246" class="Symbol">=</a> <a id="4248" href="Data.String.Base.html#3780" class="Function">rectangle</a> <a id="4258" class="Symbol">(</a><a id="4259" href="Data.Vec.Base.html#5745" class="Function">Vec.replicate</a> <a id="4273" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="4275" href="Data.String.Base.html#2829" class="Function">padRight</a> <a id="4284" href="Data.String.Base.html#4244" class="Bound">c</a><a id="4285" class="Symbol">)</a>

<a id="rectangleᶜ"></a><a id="4288" href="Data.String.Base.html#4288" class="Function">rectangleᶜ</a> <a id="4299" class="Symbol">:</a> <a id="4301" class="Symbol">∀</a> <a id="4303" class="Symbol">{</a><a id="4304" href="Data.String.Base.html#4304" class="Bound">n</a><a id="4305" class="Symbol">}</a> <a id="4307" class="Symbol">→</a> <a id="4309" href="Agda.Builtin.Char.html#200" class="Postulate">Char</a> <a id="4314" class="Symbol">→</a> <a id="4316" href="Agda.Builtin.Char.html#200" class="Postulate">Char</a> <a id="4321" class="Symbol">→</a> <a id="4323" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="4327" href="Agda.Builtin.String.html#206" class="Postulate">String</a> <a id="4334" href="Data.String.Base.html#4304" class="Bound">n</a> <a id="4336" class="Symbol">→</a> <a id="4338" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="4342" href="Agda.Builtin.String.html#206" class="Postulate">String</a> <a id="4349" href="Data.String.Base.html#4304" class="Bound">n</a>
<a id="4351" href="Data.String.Base.html#4288" class="Function">rectangleᶜ</a> <a id="4362" href="Data.String.Base.html#4362" class="Bound">cₗ</a> <a id="4365" href="Data.String.Base.html#4365" class="Bound">cᵣ</a> <a id="4368" class="Symbol">=</a> <a id="4370" href="Data.String.Base.html#3780" class="Function">rectangle</a> <a id="4380" class="Symbol">(</a><a id="4381" href="Data.Vec.Base.html#5745" class="Function">Vec.replicate</a> <a id="4395" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="4397" href="Data.String.Base.html#2950" class="Function">padBoth</a> <a id="4405" href="Data.String.Base.html#4362" class="Bound">cₗ</a> <a id="4408" href="Data.String.Base.html#4365" class="Bound">cᵣ</a><a id="4410" class="Symbol">)</a>
</pre></body></html>