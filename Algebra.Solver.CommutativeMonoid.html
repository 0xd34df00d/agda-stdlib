<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Algebra.Solver.CommutativeMonoid</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Solver for equations in commutative monoids</a>
<a id="153" class="Comment">--</a>
<a id="156" class="Comment">-- Adapted from Algebra.Monoid-solver</a>
<a id="194" class="Comment">------------------------------------------------------------------------</a>

<a id="268" class="Symbol">{-#</a> <a id="272" class="Keyword">OPTIONS</a> <a id="280" class="Option">--without-K</a> <a id="292" class="Option">--safe</a> <a id="299" class="Symbol">#-}</a>

<a id="304" class="Keyword">open</a> <a id="309" class="Keyword">import</a> <a id="316" href="Algebra.html" class="Module">Algebra</a>

<a id="325" class="Keyword">open</a> <a id="330" class="Keyword">import</a> <a id="337" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="346" class="Keyword">using</a> <a id="352" class="Symbol">(</a><a id="353" href="Data.Fin.Base.html#951" class="Datatype">Fin</a><a id="356" class="Symbol">;</a> <a id="358" href="Data.Fin.Base.html#973" class="InductiveConstructor">zero</a><a id="362" class="Symbol">;</a> <a id="364" href="Data.Fin.Base.html#1004" class="InductiveConstructor">suc</a><a id="367" class="Symbol">)</a>
<a id="369" class="Keyword">open</a> <a id="374" class="Keyword">import</a> <a id="381" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="392" class="Symbol">as</a> <a id="395" class="Module">Maybe</a>
  <a id="403" class="Keyword">using</a> <a id="409" class="Symbol">(</a><a id="410" href="Data.Maybe.Base.html#710" class="Datatype">Maybe</a><a id="415" class="Symbol">;</a> <a id="417" href="Data.Maybe.Base.html#1285" class="Function">decToMaybe</a><a id="427" class="Symbol">;</a> <a id="429" href="Data.Maybe.Base.html#1936" class="Function">From-just</a><a id="438" class="Symbol">;</a> <a id="440" href="Data.Maybe.Base.html#2024" class="Function">from-just</a><a id="449" class="Symbol">)</a>
<a id="451" class="Keyword">open</a> <a id="456" class="Keyword">import</a> <a id="463" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="472" class="Symbol">as</a> <a id="475" class="Module">ℕ</a> <a id="477" class="Keyword">using</a> <a id="483" class="Symbol">(</a><a id="484" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="485" class="Symbol">;</a> <a id="487" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a><a id="491" class="Symbol">;</a> <a id="493" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a><a id="496" class="Symbol">;</a> <a id="498" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">_+_</a><a id="501" class="Symbol">)</a>
<a id="503" class="Keyword">open</a> <a id="508" class="Keyword">import</a> <a id="515" href="Data.Nat.GeneralisedArithmetic.html" class="Module">Data.Nat.GeneralisedArithmetic</a> <a id="546" class="Keyword">using</a> <a id="552" class="Symbol">(</a><a id="553" href="Data.Nat.GeneralisedArithmetic.html#508" class="Function">fold</a><a id="557" class="Symbol">)</a>
<a id="559" class="Keyword">open</a> <a id="564" class="Keyword">import</a> <a id="571" href="Data.Product.html" class="Module">Data.Product</a> <a id="584" class="Keyword">using</a> <a id="590" class="Symbol">(</a><a id="591" href="Data.Product.html#1389" class="Function Operator">_×_</a><a id="594" class="Symbol">;</a> <a id="596" href="Data.Product.html#3500" class="Function">uncurry</a><a id="603" class="Symbol">)</a>
<a id="605" class="Keyword">open</a> <a id="610" class="Keyword">import</a> <a id="617" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="626" class="Keyword">using</a> <a id="632" class="Symbol">(</a><a id="633" href="Data.Vec.html#773" class="Datatype">Vec</a><a id="636" class="Symbol">;</a> <a id="638" href="Data.Vec.html#813" class="InductiveConstructor">[]</a><a id="640" class="Symbol">;</a> <a id="642" href="Data.Vec.html#832" class="InductiveConstructor Operator">_∷_</a><a id="645" class="Symbol">;</a> <a id="647" href="Data.Vec.html#1379" class="Function">lookup</a><a id="653" class="Symbol">;</a> <a id="655" href="Data.Vec.html#5840" class="Function">replicate</a><a id="664" class="Symbol">)</a>

<a id="667" class="Keyword">open</a> <a id="672" class="Keyword">import</a> <a id="679" href="Function.html" class="Module">Function</a> <a id="688" class="Keyword">using</a> <a id="694" class="Symbol">(</a><a id="695" href="Function.html#805" class="Function Operator">_∘_</a><a id="698" class="Symbol">)</a>

<a id="701" class="Keyword">import</a> <a id="708" href="Relation.Binary.EqReasoning.html" class="Module">Relation.Binary.EqReasoning</a>  <a id="737" class="Symbol">as</a> <a id="740" class="Module">EqReasoning</a>
<a id="752" class="Keyword">import</a> <a id="759" href="Relation.Binary.Reflection.html" class="Module">Relation.Binary.Reflection</a>   <a id="788" class="Symbol">as</a> <a id="791" class="Module">Reflection</a>
<a id="802" class="Keyword">import</a> <a id="809" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a>   <a id="838" class="Symbol">as</a> <a id="841" class="Module">Dec</a>
<a id="845" class="Keyword">import</a> <a id="852" href="Data.Vec.Relation.Pointwise.Inductive.html" class="Module">Data.Vec.Relation.Pointwise.Inductive</a> <a id="890" class="Symbol">as</a> <a id="893" class="Module">Pointwise</a>

<a id="904" class="Keyword">open</a> <a id="909" class="Keyword">import</a> <a id="916" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="954" class="Symbol">as</a> <a id="957" class="Module">P</a> <a id="959" class="Keyword">using</a> <a id="965" class="Symbol">(</a><a id="966" href="Agda.Builtin.Equality.html#83" class="Datatype Operator">_≡_</a><a id="969" class="Symbol">;</a> <a id="971" href="Relation.Binary.PropositionalEquality.html#1657" class="Function">decSetoid</a><a id="980" class="Symbol">)</a>
<a id="982" class="Keyword">open</a> <a id="987" class="Keyword">import</a> <a id="994" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="1011" class="Keyword">using</a> <a id="1017" class="Symbol">(</a><a id="1018" href="Relation.Nullary.html#570" class="Datatype">Dec</a><a id="1021" class="Symbol">)</a>

<a id="1024" class="Keyword">module</a> <a id="1031" href="Algebra.Solver.CommutativeMonoid.html" class="Module">Algebra.Solver.CommutativeMonoid</a> <a id="1064" class="Symbol">{</a><a id="1065" href="Algebra.Solver.CommutativeMonoid.html#1065" class="Bound">m₁</a> <a id="1068" href="Algebra.Solver.CommutativeMonoid.html#1068" class="Bound">m₂</a><a id="1070" class="Symbol">}</a> <a id="1072" class="Symbol">(</a><a id="1073" href="Algebra.Solver.CommutativeMonoid.html#1073" class="Bound">M</a> <a id="1075" class="Symbol">:</a> <a id="1077" href="Algebra.html#2994" class="Record">CommutativeMonoid</a> <a id="1095" href="Algebra.Solver.CommutativeMonoid.html#1065" class="Bound">m₁</a> <a id="1098" href="Algebra.Solver.CommutativeMonoid.html#1068" class="Bound">m₂</a><a id="1100" class="Symbol">)</a> <a id="1102" class="Keyword">where</a>

<a id="1109" class="Keyword">open</a> <a id="1114" href="Algebra.html#2994" class="Module">CommutativeMonoid</a> <a id="1132" href="Algebra.Solver.CommutativeMonoid.html#1073" class="Bound">M</a>
<a id="1134" class="Keyword">open</a> <a id="1139" href="Relation.Binary.EqReasoning.html" class="Module">EqReasoning</a> <a id="1151" href="Algebra.Structures.html#935" class="Function">setoid</a>

<a id="1159" class="Comment">------------------------------------------------------------------------</a>
<a id="1232" class="Comment">-- Monoid expressions</a>

<a id="1255" class="Comment">-- There is one constructor for every operation, plus one for</a>
<a id="1317" class="Comment">-- variables; there may be at most n variables.</a>

<a id="1366" class="Keyword">infixr</a> <a id="1373" class="Number">5</a> <a id="1375" href="Algebra.Solver.CommutativeMonoid.html#1464" class="InductiveConstructor Operator">_⊕_</a>
<a id="1379" class="Keyword">infixr</a> <a id="1386" class="Number">10</a> <a id="1389" href="Algebra.Solver.CommutativeMonoid.html#2439" class="Function Operator">_•_</a>

<a id="1394" class="Keyword">data</a> <a id="Expr"></a><a id="1399" href="Algebra.Solver.CommutativeMonoid.html#1399" class="Datatype">Expr</a> <a id="1404" class="Symbol">(</a><a id="1405" href="Algebra.Solver.CommutativeMonoid.html#1405" class="Bound">n</a> <a id="1407" class="Symbol">:</a> <a id="1409" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="1410" class="Symbol">)</a> <a id="1412" class="Symbol">:</a> <a id="1414" class="PrimitiveType">Set</a> <a id="1418" class="Keyword">where</a>
  <a id="Expr.var"></a><a id="1426" href="Algebra.Solver.CommutativeMonoid.html#1426" class="InductiveConstructor">var</a> <a id="1430" class="Symbol">:</a> <a id="1432" href="Data.Fin.Base.html#951" class="Datatype">Fin</a> <a id="1436" href="Algebra.Solver.CommutativeMonoid.html#1405" class="Bound">n</a> <a id="1438" class="Symbol">→</a> <a id="1440" href="Algebra.Solver.CommutativeMonoid.html#1399" class="Datatype">Expr</a> <a id="1445" href="Algebra.Solver.CommutativeMonoid.html#1405" class="Bound">n</a>
  <a id="Expr.id"></a><a id="1449" href="Algebra.Solver.CommutativeMonoid.html#1449" class="InductiveConstructor">id</a>  <a id="1453" class="Symbol">:</a> <a id="1455" href="Algebra.Solver.CommutativeMonoid.html#1399" class="Datatype">Expr</a> <a id="1460" href="Algebra.Solver.CommutativeMonoid.html#1405" class="Bound">n</a>
  <a id="Expr._⊕_"></a><a id="1464" href="Algebra.Solver.CommutativeMonoid.html#1464" class="InductiveConstructor Operator">_⊕_</a> <a id="1468" class="Symbol">:</a> <a id="1470" href="Algebra.Solver.CommutativeMonoid.html#1399" class="Datatype">Expr</a> <a id="1475" href="Algebra.Solver.CommutativeMonoid.html#1405" class="Bound">n</a> <a id="1477" class="Symbol">→</a> <a id="1479" href="Algebra.Solver.CommutativeMonoid.html#1399" class="Datatype">Expr</a> <a id="1484" href="Algebra.Solver.CommutativeMonoid.html#1405" class="Bound">n</a> <a id="1486" class="Symbol">→</a> <a id="1488" href="Algebra.Solver.CommutativeMonoid.html#1399" class="Datatype">Expr</a> <a id="1493" href="Algebra.Solver.CommutativeMonoid.html#1405" class="Bound">n</a>

<a id="1496" class="Comment">-- An environment contains one value for every variable.</a>

<a id="Env"></a><a id="1554" href="Algebra.Solver.CommutativeMonoid.html#1554" class="Function">Env</a> <a id="1558" class="Symbol">:</a> <a id="1560" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="1562" class="Symbol">→</a> <a id="1564" class="PrimitiveType">Set</a> <a id="1568" class="Symbol">_</a>
<a id="1570" href="Algebra.Solver.CommutativeMonoid.html#1554" class="Function">Env</a> <a id="1574" href="Algebra.Solver.CommutativeMonoid.html#1574" class="Bound">n</a> <a id="1576" class="Symbol">=</a> <a id="1578" href="Data.Vec.html#773" class="Datatype">Vec</a> <a id="1582" href="Algebra.html#3084" class="Field">Carrier</a> <a id="1590" href="Algebra.Solver.CommutativeMonoid.html#1574" class="Bound">n</a>

<a id="1593" class="Comment">-- The semantics of an expression is a function from an environment to</a>
<a id="1664" class="Comment">-- a value.</a>

<a id="⟦_⟧"></a><a id="1677" href="Algebra.Solver.CommutativeMonoid.html#1677" class="Function Operator">⟦_⟧</a> <a id="1681" class="Symbol">:</a> <a id="1683" class="Symbol">∀</a> <a id="1685" class="Symbol">{</a><a id="1686" href="Algebra.Solver.CommutativeMonoid.html#1686" class="Bound">n</a><a id="1687" class="Symbol">}</a> <a id="1689" class="Symbol">→</a> <a id="1691" href="Algebra.Solver.CommutativeMonoid.html#1399" class="Datatype">Expr</a> <a id="1696" href="Algebra.Solver.CommutativeMonoid.html#1686" class="Bound">n</a> <a id="1698" class="Symbol">→</a> <a id="1700" href="Algebra.Solver.CommutativeMonoid.html#1554" class="Function">Env</a> <a id="1704" href="Algebra.Solver.CommutativeMonoid.html#1686" class="Bound">n</a> <a id="1706" class="Symbol">→</a> <a id="1708" href="Algebra.html#3084" class="Field">Carrier</a>
<a id="1716" href="Algebra.Solver.CommutativeMonoid.html#1677" class="Function Operator">⟦</a> <a id="1718" href="Algebra.Solver.CommutativeMonoid.html#1426" class="InductiveConstructor">var</a> <a id="1722" href="Algebra.Solver.CommutativeMonoid.html#1722" class="Bound">x</a>   <a id="1726" href="Algebra.Solver.CommutativeMonoid.html#1677" class="Function Operator">⟧</a> <a id="1728" href="Algebra.Solver.CommutativeMonoid.html#1728" class="Bound">ρ</a> <a id="1730" class="Symbol">=</a> <a id="1732" href="Data.Vec.html#1379" class="Function">lookup</a> <a id="1739" href="Algebra.Solver.CommutativeMonoid.html#1722" class="Bound">x</a> <a id="1741" href="Algebra.Solver.CommutativeMonoid.html#1728" class="Bound">ρ</a>
<a id="1743" href="Algebra.Solver.CommutativeMonoid.html#1677" class="Function Operator">⟦</a> <a id="1745" href="Algebra.Solver.CommutativeMonoid.html#1449" class="InductiveConstructor">id</a>      <a id="1753" href="Algebra.Solver.CommutativeMonoid.html#1677" class="Function Operator">⟧</a> <a id="1755" href="Algebra.Solver.CommutativeMonoid.html#1755" class="Bound">ρ</a> <a id="1757" class="Symbol">=</a> <a id="1759" href="Algebra.html#3194" class="Field">ε</a>
<a id="1761" href="Algebra.Solver.CommutativeMonoid.html#1677" class="Function Operator">⟦</a> <a id="1763" href="Algebra.Solver.CommutativeMonoid.html#1763" class="Bound">e₁</a> <a id="1766" href="Algebra.Solver.CommutativeMonoid.html#1464" class="InductiveConstructor Operator">⊕</a> <a id="1768" href="Algebra.Solver.CommutativeMonoid.html#1768" class="Bound">e₂</a> <a id="1771" href="Algebra.Solver.CommutativeMonoid.html#1677" class="Function Operator">⟧</a> <a id="1773" href="Algebra.Solver.CommutativeMonoid.html#1773" class="Bound">ρ</a> <a id="1775" class="Symbol">=</a> <a id="1777" href="Algebra.Solver.CommutativeMonoid.html#1677" class="Function Operator">⟦</a> <a id="1779" href="Algebra.Solver.CommutativeMonoid.html#1763" class="Bound">e₁</a> <a id="1782" href="Algebra.Solver.CommutativeMonoid.html#1677" class="Function Operator">⟧</a> <a id="1784" href="Algebra.Solver.CommutativeMonoid.html#1773" class="Bound">ρ</a> <a id="1786" href="Algebra.html#3156" class="Field Operator">∙</a> <a id="1788" href="Algebra.Solver.CommutativeMonoid.html#1677" class="Function Operator">⟦</a> <a id="1790" href="Algebra.Solver.CommutativeMonoid.html#1768" class="Bound">e₂</a> <a id="1793" href="Algebra.Solver.CommutativeMonoid.html#1677" class="Function Operator">⟧</a> <a id="1795" href="Algebra.Solver.CommutativeMonoid.html#1773" class="Bound">ρ</a>

<a id="1798" class="Comment">------------------------------------------------------------------------</a>
<a id="1871" class="Comment">-- Normal forms</a>

<a id="1888" class="Comment">-- A normal form is a vector of multiplicities (a bag).</a>

<a id="Normal"></a><a id="1945" href="Algebra.Solver.CommutativeMonoid.html#1945" class="Function">Normal</a> <a id="1952" class="Symbol">:</a> <a id="1954" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="1956" class="Symbol">→</a> <a id="1958" class="PrimitiveType">Set</a>
<a id="1962" href="Algebra.Solver.CommutativeMonoid.html#1945" class="Function">Normal</a> <a id="1969" href="Algebra.Solver.CommutativeMonoid.html#1969" class="Bound">n</a> <a id="1971" class="Symbol">=</a> <a id="1973" href="Data.Vec.html#773" class="Datatype">Vec</a> <a id="1977" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="1979" href="Algebra.Solver.CommutativeMonoid.html#1969" class="Bound">n</a>

<a id="1982" class="Comment">-- The semantics of a normal form.</a>

<a id="⟦_⟧⇓"></a><a id="2018" href="Algebra.Solver.CommutativeMonoid.html#2018" class="Function Operator">⟦_⟧⇓</a> <a id="2023" class="Symbol">:</a> <a id="2025" class="Symbol">∀</a> <a id="2027" class="Symbol">{</a><a id="2028" href="Algebra.Solver.CommutativeMonoid.html#2028" class="Bound">n</a><a id="2029" class="Symbol">}</a> <a id="2031" class="Symbol">→</a> <a id="2033" href="Algebra.Solver.CommutativeMonoid.html#1945" class="Function">Normal</a> <a id="2040" href="Algebra.Solver.CommutativeMonoid.html#2028" class="Bound">n</a> <a id="2042" class="Symbol">→</a> <a id="2044" href="Algebra.Solver.CommutativeMonoid.html#1554" class="Function">Env</a> <a id="2048" href="Algebra.Solver.CommutativeMonoid.html#2028" class="Bound">n</a> <a id="2050" class="Symbol">→</a> <a id="2052" href="Algebra.html#3084" class="Field">Carrier</a>
<a id="2060" href="Algebra.Solver.CommutativeMonoid.html#2018" class="Function Operator">⟦</a> <a id="2062" href="Data.Vec.html#813" class="InductiveConstructor">[]</a>    <a id="2068" href="Algebra.Solver.CommutativeMonoid.html#2018" class="Function Operator">⟧⇓</a> <a id="2071" class="Symbol">_</a> <a id="2073" class="Symbol">=</a> <a id="2075" href="Algebra.html#3194" class="Field">ε</a>
<a id="2077" href="Algebra.Solver.CommutativeMonoid.html#2018" class="Function Operator">⟦</a> <a id="2079" href="Algebra.Solver.CommutativeMonoid.html#2079" class="Bound">n</a> <a id="2081" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="2083" href="Algebra.Solver.CommutativeMonoid.html#2083" class="Bound">v</a> <a id="2085" href="Algebra.Solver.CommutativeMonoid.html#2018" class="Function Operator">⟧⇓</a> <a id="2088" class="Symbol">(</a><a id="2089" href="Algebra.Solver.CommutativeMonoid.html#2089" class="Bound">a</a> <a id="2091" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="2093" href="Algebra.Solver.CommutativeMonoid.html#2093" class="Bound">ρ</a><a id="2094" class="Symbol">)</a> <a id="2096" class="Symbol">=</a> <a id="2098" href="Data.Nat.GeneralisedArithmetic.html#508" class="Function">fold</a> <a id="2103" class="Symbol">(</a><a id="2104" href="Algebra.Solver.CommutativeMonoid.html#2018" class="Function Operator">⟦</a> <a id="2106" href="Algebra.Solver.CommutativeMonoid.html#2083" class="Bound">v</a> <a id="2108" href="Algebra.Solver.CommutativeMonoid.html#2018" class="Function Operator">⟧⇓</a> <a id="2111" href="Algebra.Solver.CommutativeMonoid.html#2093" class="Bound">ρ</a><a id="2112" class="Symbol">)</a> <a id="2114" class="Symbol">(λ</a> <a id="2117" href="Algebra.Solver.CommutativeMonoid.html#2117" class="Bound">b</a> <a id="2119" class="Symbol">→</a> <a id="2121" href="Algebra.Solver.CommutativeMonoid.html#2089" class="Bound">a</a> <a id="2123" href="Algebra.html#3156" class="Field Operator">∙</a> <a id="2125" href="Algebra.Solver.CommutativeMonoid.html#2117" class="Bound">b</a><a id="2126" class="Symbol">)</a> <a id="2128" href="Algebra.Solver.CommutativeMonoid.html#2079" class="Bound">n</a>

<a id="2131" class="Comment">------------------------------------------------------------------------</a>
<a id="2204" class="Comment">-- Constructions on normal forms</a>

<a id="2238" class="Comment">-- The empty bag.</a>

<a id="empty"></a><a id="2257" href="Algebra.Solver.CommutativeMonoid.html#2257" class="Function">empty</a> <a id="2263" class="Symbol">:</a> <a id="2265" class="Symbol">∀{</a><a id="2267" href="Algebra.Solver.CommutativeMonoid.html#2267" class="Bound">n</a><a id="2268" class="Symbol">}</a> <a id="2270" class="Symbol">→</a> <a id="2272" href="Algebra.Solver.CommutativeMonoid.html#1945" class="Function">Normal</a> <a id="2279" href="Algebra.Solver.CommutativeMonoid.html#2267" class="Bound">n</a>
<a id="2281" href="Algebra.Solver.CommutativeMonoid.html#2257" class="Function">empty</a> <a id="2287" class="Symbol">=</a> <a id="2289" href="Data.Vec.html#5840" class="Function">replicate</a> <a id="2299" class="Number">0</a>

<a id="2302" class="Comment">-- A singleton bag.</a>

<a id="sg"></a><a id="2323" href="Algebra.Solver.CommutativeMonoid.html#2323" class="Function">sg</a> <a id="2326" class="Symbol">:</a> <a id="2328" class="Symbol">∀{</a><a id="2330" href="Algebra.Solver.CommutativeMonoid.html#2330" class="Bound">n</a><a id="2331" class="Symbol">}</a> <a id="2333" class="Symbol">(</a><a id="2334" href="Algebra.Solver.CommutativeMonoid.html#2334" class="Bound">i</a> <a id="2336" class="Symbol">:</a> <a id="2338" href="Data.Fin.Base.html#951" class="Datatype">Fin</a> <a id="2342" href="Algebra.Solver.CommutativeMonoid.html#2330" class="Bound">n</a><a id="2343" class="Symbol">)</a> <a id="2345" class="Symbol">→</a> <a id="2347" href="Algebra.Solver.CommutativeMonoid.html#1945" class="Function">Normal</a> <a id="2354" href="Algebra.Solver.CommutativeMonoid.html#2330" class="Bound">n</a>
<a id="2356" href="Algebra.Solver.CommutativeMonoid.html#2323" class="Function">sg</a> <a id="2359" href="Data.Fin.Base.html#973" class="InductiveConstructor">zero</a>    <a id="2367" class="Symbol">=</a> <a id="2369" class="Number">1</a> <a id="2371" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="2373" href="Algebra.Solver.CommutativeMonoid.html#2257" class="Function">empty</a>
<a id="2379" href="Algebra.Solver.CommutativeMonoid.html#2323" class="Function">sg</a> <a id="2382" class="Symbol">(</a><a id="2383" href="Data.Fin.Base.html#1004" class="InductiveConstructor">suc</a> <a id="2387" href="Algebra.Solver.CommutativeMonoid.html#2387" class="Bound">i</a><a id="2388" class="Symbol">)</a> <a id="2390" class="Symbol">=</a> <a id="2392" class="Number">0</a> <a id="2394" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="2396" href="Algebra.Solver.CommutativeMonoid.html#2323" class="Function">sg</a> <a id="2399" href="Algebra.Solver.CommutativeMonoid.html#2387" class="Bound">i</a>

<a id="2402" class="Comment">-- The composition of normal forms.</a>

<a id="_•_"></a><a id="2439" href="Algebra.Solver.CommutativeMonoid.html#2439" class="Function Operator">_•_</a>  <a id="2444" class="Symbol">:</a> <a id="2446" class="Symbol">∀{</a><a id="2448" href="Algebra.Solver.CommutativeMonoid.html#2448" class="Bound">n</a><a id="2449" class="Symbol">}</a> <a id="2451" class="Symbol">(</a><a id="2452" href="Algebra.Solver.CommutativeMonoid.html#2452" class="Bound">v</a> <a id="2454" href="Algebra.Solver.CommutativeMonoid.html#2454" class="Bound">w</a> <a id="2456" class="Symbol">:</a> <a id="2458" href="Algebra.Solver.CommutativeMonoid.html#1945" class="Function">Normal</a> <a id="2465" href="Algebra.Solver.CommutativeMonoid.html#2448" class="Bound">n</a><a id="2466" class="Symbol">)</a> <a id="2468" class="Symbol">→</a> <a id="2470" href="Algebra.Solver.CommutativeMonoid.html#1945" class="Function">Normal</a> <a id="2477" href="Algebra.Solver.CommutativeMonoid.html#2448" class="Bound">n</a>
<a id="2479" href="Data.Vec.html#813" class="InductiveConstructor">[]</a>      <a id="2487" href="Algebra.Solver.CommutativeMonoid.html#2439" class="Function Operator">•</a> <a id="2489" href="Data.Vec.html#813" class="InductiveConstructor">[]</a>      <a id="2497" class="Symbol">=</a> <a id="2499" href="Data.Vec.html#813" class="InductiveConstructor">[]</a>
<a id="2502" class="Symbol">(</a><a id="2503" href="Algebra.Solver.CommutativeMonoid.html#2503" class="Bound">l</a> <a id="2505" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="2507" href="Algebra.Solver.CommutativeMonoid.html#2507" class="Bound">v</a><a id="2508" class="Symbol">)</a> <a id="2510" href="Algebra.Solver.CommutativeMonoid.html#2439" class="Function Operator">•</a> <a id="2512" class="Symbol">(</a><a id="2513" href="Algebra.Solver.CommutativeMonoid.html#2513" class="Bound">m</a> <a id="2515" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="2517" href="Algebra.Solver.CommutativeMonoid.html#2517" class="Bound">w</a><a id="2518" class="Symbol">)</a> <a id="2520" class="Symbol">=</a> <a id="2522" href="Algebra.Solver.CommutativeMonoid.html#2503" class="Bound">l</a> <a id="2524" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">+</a> <a id="2526" href="Algebra.Solver.CommutativeMonoid.html#2513" class="Bound">m</a> <a id="2528" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="2530" href="Algebra.Solver.CommutativeMonoid.html#2507" class="Bound">v</a> <a id="2532" href="Algebra.Solver.CommutativeMonoid.html#2439" class="Function Operator">•</a> <a id="2534" href="Algebra.Solver.CommutativeMonoid.html#2517" class="Bound">w</a>

<a id="2537" class="Comment">------------------------------------------------------------------------</a>
<a id="2610" class="Comment">-- Correctness of the constructions on normal forms</a>

<a id="2663" class="Comment">-- The empty bag stands for the unit ε.</a>

<a id="empty-correct"></a><a id="2704" href="Algebra.Solver.CommutativeMonoid.html#2704" class="Function">empty-correct</a> <a id="2718" class="Symbol">:</a> <a id="2720" class="Symbol">∀{</a><a id="2722" href="Algebra.Solver.CommutativeMonoid.html#2722" class="Bound">n</a><a id="2723" class="Symbol">}</a> <a id="2725" class="Symbol">(</a><a id="2726" href="Algebra.Solver.CommutativeMonoid.html#2726" class="Bound">ρ</a> <a id="2728" class="Symbol">:</a> <a id="2730" href="Algebra.Solver.CommutativeMonoid.html#1554" class="Function">Env</a> <a id="2734" href="Algebra.Solver.CommutativeMonoid.html#2722" class="Bound">n</a><a id="2735" class="Symbol">)</a> <a id="2737" class="Symbol">→</a> <a id="2739" href="Algebra.Solver.CommutativeMonoid.html#2018" class="Function Operator">⟦</a> <a id="2741" href="Algebra.Solver.CommutativeMonoid.html#2257" class="Function">empty</a> <a id="2747" href="Algebra.Solver.CommutativeMonoid.html#2018" class="Function Operator">⟧⇓</a> <a id="2750" href="Algebra.Solver.CommutativeMonoid.html#2726" class="Bound">ρ</a> <a id="2752" href="Algebra.html#3116" class="Field Operator">≈</a> <a id="2754" href="Algebra.html#3194" class="Field">ε</a>
<a id="2756" href="Algebra.Solver.CommutativeMonoid.html#2704" class="Function">empty-correct</a> <a id="2770" href="Data.Vec.html#813" class="InductiveConstructor">[]</a> <a id="2773" class="Symbol">=</a> <a id="2775" href="Relation.Binary.Core.html#5808" class="Function">refl</a>
<a id="2780" href="Algebra.Solver.CommutativeMonoid.html#2704" class="Function">empty-correct</a> <a id="2794" class="Symbol">(</a><a id="2795" href="Algebra.Solver.CommutativeMonoid.html#2795" class="Bound">a</a> <a id="2797" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="2799" href="Algebra.Solver.CommutativeMonoid.html#2799" class="Bound">ρ</a><a id="2800" class="Symbol">)</a> <a id="2802" class="Symbol">=</a> <a id="2804" href="Algebra.Solver.CommutativeMonoid.html#2704" class="Function">empty-correct</a> <a id="2818" href="Algebra.Solver.CommutativeMonoid.html#2799" class="Bound">ρ</a>

<a id="2821" class="Comment">-- The singleton bag stands for a single variable.</a>

<a id="sg-correct"></a><a id="2873" href="Algebra.Solver.CommutativeMonoid.html#2873" class="Function">sg-correct</a> <a id="2884" class="Symbol">:</a> <a id="2886" class="Symbol">∀{</a><a id="2888" href="Algebra.Solver.CommutativeMonoid.html#2888" class="Bound">n</a><a id="2889" class="Symbol">}</a> <a id="2891" class="Symbol">(</a><a id="2892" href="Algebra.Solver.CommutativeMonoid.html#2892" class="Bound">x</a> <a id="2894" class="Symbol">:</a> <a id="2896" href="Data.Fin.Base.html#951" class="Datatype">Fin</a> <a id="2900" href="Algebra.Solver.CommutativeMonoid.html#2888" class="Bound">n</a><a id="2901" class="Symbol">)</a> <a id="2903" class="Symbol">(</a><a id="2904" href="Algebra.Solver.CommutativeMonoid.html#2904" class="Bound">ρ</a> <a id="2906" class="Symbol">:</a> <a id="2908" href="Algebra.Solver.CommutativeMonoid.html#1554" class="Function">Env</a> <a id="2912" href="Algebra.Solver.CommutativeMonoid.html#2888" class="Bound">n</a><a id="2913" class="Symbol">)</a> <a id="2915" class="Symbol">→</a>  <a id="2918" href="Algebra.Solver.CommutativeMonoid.html#2018" class="Function Operator">⟦</a> <a id="2920" href="Algebra.Solver.CommutativeMonoid.html#2323" class="Function">sg</a> <a id="2923" href="Algebra.Solver.CommutativeMonoid.html#2892" class="Bound">x</a> <a id="2925" href="Algebra.Solver.CommutativeMonoid.html#2018" class="Function Operator">⟧⇓</a> <a id="2928" href="Algebra.Solver.CommutativeMonoid.html#2904" class="Bound">ρ</a> <a id="2930" href="Algebra.html#3116" class="Field Operator">≈</a> <a id="2932" href="Data.Vec.html#1379" class="Function">lookup</a> <a id="2939" href="Algebra.Solver.CommutativeMonoid.html#2892" class="Bound">x</a> <a id="2941" href="Algebra.Solver.CommutativeMonoid.html#2904" class="Bound">ρ</a>
<a id="2943" href="Algebra.Solver.CommutativeMonoid.html#2873" class="Function">sg-correct</a> <a id="2954" href="Data.Fin.Base.html#973" class="InductiveConstructor">zero</a> <a id="2959" class="Symbol">(</a><a id="2960" href="Algebra.Solver.CommutativeMonoid.html#2960" class="Bound">x</a> <a id="2962" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="2964" href="Algebra.Solver.CommutativeMonoid.html#2964" class="Bound">ρ</a><a id="2965" class="Symbol">)</a> <a id="2967" class="Symbol">=</a> <a id="2969" href="Relation.Binary.PreorderReasoning.html#1264" class="Function Operator">begin</a>
    <a id="2979" href="Algebra.Solver.CommutativeMonoid.html#2960" class="Bound">x</a> <a id="2981" href="Algebra.html#3156" class="Field Operator">∙</a> <a id="2983" href="Algebra.Solver.CommutativeMonoid.html#2018" class="Function Operator">⟦</a> <a id="2985" href="Algebra.Solver.CommutativeMonoid.html#2257" class="Function">empty</a> <a id="2991" href="Algebra.Solver.CommutativeMonoid.html#2018" class="Function Operator">⟧⇓</a> <a id="2994" href="Algebra.Solver.CommutativeMonoid.html#2964" class="Bound">ρ</a>   <a id="2998" href="Relation.Binary.PreorderReasoning.html#1330" class="Function Operator">≈⟨</a> <a id="3001" href="Algebra.Structures.html#860" class="Function">∙-cong</a> <a id="3008" href="Relation.Binary.Core.html#5808" class="Function">refl</a> <a id="3013" class="Symbol">(</a><a id="3014" href="Algebra.Solver.CommutativeMonoid.html#2704" class="Function">empty-correct</a> <a id="3028" href="Algebra.Solver.CommutativeMonoid.html#2964" class="Bound">ρ</a><a id="3029" class="Symbol">)</a> <a id="3031" href="Relation.Binary.PreorderReasoning.html#1330" class="Function Operator">⟩</a>
    <a id="3037" href="Algebra.Solver.CommutativeMonoid.html#2960" class="Bound">x</a> <a id="3039" href="Algebra.html#3156" class="Field Operator">∙</a> <a id="3041" href="Algebra.html#3194" class="Field">ε</a>              <a id="3056" href="Relation.Binary.PreorderReasoning.html#1330" class="Function Operator">≈⟨</a> <a id="3059" href="Algebra.Structures.html#2190" class="Function">identityʳ</a> <a id="3069" class="Symbol">_</a> <a id="3071" href="Relation.Binary.PreorderReasoning.html#1330" class="Function Operator">⟩</a>
    <a id="3077" href="Algebra.Solver.CommutativeMonoid.html#2960" class="Bound">x</a>                  <a id="3096" href="Relation.Binary.PreorderReasoning.html#1717" class="Function Operator">∎</a>
<a id="3098" href="Algebra.Solver.CommutativeMonoid.html#2873" class="Function">sg-correct</a> <a id="3109" class="Symbol">(</a><a id="3110" href="Data.Fin.Base.html#1004" class="InductiveConstructor">suc</a> <a id="3114" href="Algebra.Solver.CommutativeMonoid.html#3114" class="Bound">x</a><a id="3115" class="Symbol">)</a> <a id="3117" class="Symbol">(</a><a id="3118" href="Algebra.Solver.CommutativeMonoid.html#3118" class="Bound">m</a> <a id="3120" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="3122" href="Algebra.Solver.CommutativeMonoid.html#3122" class="Bound">ρ</a><a id="3123" class="Symbol">)</a> <a id="3125" class="Symbol">=</a> <a id="3127" href="Algebra.Solver.CommutativeMonoid.html#2873" class="Function">sg-correct</a> <a id="3138" href="Algebra.Solver.CommutativeMonoid.html#3114" class="Bound">x</a> <a id="3140" href="Algebra.Solver.CommutativeMonoid.html#3122" class="Bound">ρ</a>

<a id="3143" class="Comment">-- Normal form composition corresponds to the composition of the monoid.</a>

<a id="comp-correct"></a><a id="3217" href="Algebra.Solver.CommutativeMonoid.html#3217" class="Function">comp-correct</a> <a id="3230" class="Symbol">:</a> <a id="3232" class="Symbol">∀</a> <a id="3234" class="Symbol">{</a><a id="3235" href="Algebra.Solver.CommutativeMonoid.html#3235" class="Bound">n</a><a id="3236" class="Symbol">}</a> <a id="3238" class="Symbol">(</a><a id="3239" href="Algebra.Solver.CommutativeMonoid.html#3239" class="Bound">v</a> <a id="3241" href="Algebra.Solver.CommutativeMonoid.html#3241" class="Bound">w</a> <a id="3243" class="Symbol">:</a> <a id="3245" href="Algebra.Solver.CommutativeMonoid.html#1945" class="Function">Normal</a> <a id="3252" href="Algebra.Solver.CommutativeMonoid.html#3235" class="Bound">n</a><a id="3253" class="Symbol">)</a> <a id="3255" class="Symbol">(</a><a id="3256" href="Algebra.Solver.CommutativeMonoid.html#3256" class="Bound">ρ</a> <a id="3258" class="Symbol">:</a> <a id="3260" href="Algebra.Solver.CommutativeMonoid.html#1554" class="Function">Env</a> <a id="3264" href="Algebra.Solver.CommutativeMonoid.html#3235" class="Bound">n</a><a id="3265" class="Symbol">)</a> <a id="3267" class="Symbol">→</a>
              <a id="3283" href="Algebra.Solver.CommutativeMonoid.html#2018" class="Function Operator">⟦</a> <a id="3285" href="Algebra.Solver.CommutativeMonoid.html#3239" class="Bound">v</a> <a id="3287" href="Algebra.Solver.CommutativeMonoid.html#2439" class="Function Operator">•</a> <a id="3289" href="Algebra.Solver.CommutativeMonoid.html#3241" class="Bound">w</a> <a id="3291" href="Algebra.Solver.CommutativeMonoid.html#2018" class="Function Operator">⟧⇓</a> <a id="3294" href="Algebra.Solver.CommutativeMonoid.html#3256" class="Bound">ρ</a> <a id="3296" href="Algebra.html#3116" class="Field Operator">≈</a> <a id="3298" class="Symbol">(</a><a id="3299" href="Algebra.Solver.CommutativeMonoid.html#2018" class="Function Operator">⟦</a> <a id="3301" href="Algebra.Solver.CommutativeMonoid.html#3239" class="Bound">v</a> <a id="3303" href="Algebra.Solver.CommutativeMonoid.html#2018" class="Function Operator">⟧⇓</a> <a id="3306" href="Algebra.Solver.CommutativeMonoid.html#3256" class="Bound">ρ</a> <a id="3308" href="Algebra.html#3156" class="Field Operator">∙</a> <a id="3310" href="Algebra.Solver.CommutativeMonoid.html#2018" class="Function Operator">⟦</a> <a id="3312" href="Algebra.Solver.CommutativeMonoid.html#3241" class="Bound">w</a> <a id="3314" href="Algebra.Solver.CommutativeMonoid.html#2018" class="Function Operator">⟧⇓</a> <a id="3317" href="Algebra.Solver.CommutativeMonoid.html#3256" class="Bound">ρ</a><a id="3318" class="Symbol">)</a>
<a id="3320" href="Algebra.Solver.CommutativeMonoid.html#3217" class="Function">comp-correct</a> <a id="3333" href="Data.Vec.html#813" class="InductiveConstructor">[]</a> <a id="3336" href="Data.Vec.html#813" class="InductiveConstructor">[]</a> <a id="3339" href="Algebra.Solver.CommutativeMonoid.html#3339" class="Bound">ρ</a> <a id="3341" class="Symbol">=</a>  <a id="3344" href="Relation.Binary.Core.html#5834" class="Function">sym</a> <a id="3348" class="Symbol">(</a><a id="3349" href="Algebra.Structures.html#2085" class="Function">identityˡ</a> <a id="3359" class="Symbol">_)</a>
<a id="3362" href="Algebra.Solver.CommutativeMonoid.html#3217" class="Function">comp-correct</a> <a id="3375" class="Symbol">(</a><a id="3376" href="Algebra.Solver.CommutativeMonoid.html#3376" class="Bound">l</a> <a id="3378" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="3380" href="Algebra.Solver.CommutativeMonoid.html#3380" class="Bound">v</a><a id="3381" class="Symbol">)</a> <a id="3383" class="Symbol">(</a><a id="3384" href="Algebra.Solver.CommutativeMonoid.html#3384" class="Bound">m</a> <a id="3386" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="3388" href="Algebra.Solver.CommutativeMonoid.html#3388" class="Bound">w</a><a id="3389" class="Symbol">)</a> <a id="3391" class="Symbol">(</a><a id="3392" href="Algebra.Solver.CommutativeMonoid.html#3392" class="Bound">a</a> <a id="3394" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="3396" href="Algebra.Solver.CommutativeMonoid.html#3396" class="Bound">ρ</a><a id="3397" class="Symbol">)</a> <a id="3399" class="Symbol">=</a> <a id="3401" href="Algebra.Solver.CommutativeMonoid.html#3672" class="Function">lemma</a> <a id="3407" href="Algebra.Solver.CommutativeMonoid.html#3376" class="Bound">l</a> <a id="3409" href="Algebra.Solver.CommutativeMonoid.html#3384" class="Bound">m</a> <a id="3411" class="Symbol">(</a><a id="3412" href="Algebra.Solver.CommutativeMonoid.html#3217" class="Function">comp-correct</a> <a id="3425" href="Algebra.Solver.CommutativeMonoid.html#3380" class="Bound">v</a> <a id="3427" href="Algebra.Solver.CommutativeMonoid.html#3388" class="Bound">w</a> <a id="3429" href="Algebra.Solver.CommutativeMonoid.html#3396" class="Bound">ρ</a><a id="3430" class="Symbol">)</a>
  <a id="3434" class="Keyword">where</a>
    <a id="3444" href="Algebra.Solver.CommutativeMonoid.html#3444" class="Function">flip12</a> <a id="3451" class="Symbol">:</a> <a id="3453" class="Symbol">∀</a> <a id="3455" href="Algebra.Solver.CommutativeMonoid.html#3455" class="Bound">a</a> <a id="3457" href="Algebra.Solver.CommutativeMonoid.html#3457" class="Bound">b</a> <a id="3459" href="Algebra.Solver.CommutativeMonoid.html#3459" class="Bound">c</a> <a id="3461" class="Symbol">→</a> <a id="3463" href="Algebra.Solver.CommutativeMonoid.html#3455" class="Bound">a</a> <a id="3465" href="Algebra.html#3156" class="Field Operator">∙</a> <a id="3467" class="Symbol">(</a><a id="3468" href="Algebra.Solver.CommutativeMonoid.html#3457" class="Bound">b</a> <a id="3470" href="Algebra.html#3156" class="Field Operator">∙</a> <a id="3472" href="Algebra.Solver.CommutativeMonoid.html#3459" class="Bound">c</a><a id="3473" class="Symbol">)</a> <a id="3475" href="Algebra.html#3116" class="Field Operator">≈</a> <a id="3477" href="Algebra.Solver.CommutativeMonoid.html#3457" class="Bound">b</a> <a id="3479" href="Algebra.html#3156" class="Field Operator">∙</a> <a id="3481" class="Symbol">(</a><a id="3482" href="Algebra.Solver.CommutativeMonoid.html#3455" class="Bound">a</a> <a id="3484" href="Algebra.html#3156" class="Field Operator">∙</a> <a id="3486" href="Algebra.Solver.CommutativeMonoid.html#3459" class="Bound">c</a><a id="3487" class="Symbol">)</a>
    <a id="3493" href="Algebra.Solver.CommutativeMonoid.html#3444" class="Function">flip12</a> <a id="3500" href="Algebra.Solver.CommutativeMonoid.html#3500" class="Bound">a</a> <a id="3502" href="Algebra.Solver.CommutativeMonoid.html#3502" class="Bound">b</a> <a id="3504" href="Algebra.Solver.CommutativeMonoid.html#3504" class="Bound">c</a> <a id="3506" class="Symbol">=</a> <a id="3508" href="Relation.Binary.PreorderReasoning.html#1264" class="Function Operator">begin</a>
        <a id="3522" href="Algebra.Solver.CommutativeMonoid.html#3500" class="Bound">a</a> <a id="3524" href="Algebra.html#3156" class="Field Operator">∙</a> <a id="3526" class="Symbol">(</a><a id="3527" href="Algebra.Solver.CommutativeMonoid.html#3502" class="Bound">b</a> <a id="3529" href="Algebra.html#3156" class="Field Operator">∙</a> <a id="3531" href="Algebra.Solver.CommutativeMonoid.html#3504" class="Bound">c</a><a id="3532" class="Symbol">)</a>  <a id="3535" href="Relation.Binary.PreorderReasoning.html#1330" class="Function Operator">≈⟨</a> <a id="3538" href="Relation.Binary.Core.html#5834" class="Function">sym</a> <a id="3542" class="Symbol">(</a><a id="3543" href="Algebra.Structures.html#1218" class="Function">assoc</a> <a id="3549" class="Symbol">_</a> <a id="3551" class="Symbol">_</a> <a id="3553" class="Symbol">_)</a> <a id="3556" href="Relation.Binary.PreorderReasoning.html#1330" class="Function Operator">⟩</a>
        <a id="3566" class="Symbol">(</a><a id="3567" href="Algebra.Solver.CommutativeMonoid.html#3500" class="Bound">a</a> <a id="3569" href="Algebra.html#3156" class="Field Operator">∙</a> <a id="3571" href="Algebra.Solver.CommutativeMonoid.html#3502" class="Bound">b</a><a id="3572" class="Symbol">)</a> <a id="3574" href="Algebra.html#3156" class="Field Operator">∙</a> <a id="3576" href="Algebra.Solver.CommutativeMonoid.html#3504" class="Bound">c</a>  <a id="3579" href="Relation.Binary.PreorderReasoning.html#1330" class="Function Operator">≈⟨</a> <a id="3582" href="Algebra.Structures.html#860" class="Function">∙-cong</a> <a id="3589" class="Symbol">(</a><a id="3590" href="Algebra.Structures.html#2120" class="Function">comm</a> <a id="3595" class="Symbol">_</a> <a id="3597" class="Symbol">_)</a> <a id="3600" href="Relation.Binary.Core.html#5808" class="Function">refl</a> <a id="3605" href="Relation.Binary.PreorderReasoning.html#1330" class="Function Operator">⟩</a>
        <a id="3615" class="Symbol">(</a><a id="3616" href="Algebra.Solver.CommutativeMonoid.html#3502" class="Bound">b</a> <a id="3618" href="Algebra.html#3156" class="Field Operator">∙</a> <a id="3620" href="Algebra.Solver.CommutativeMonoid.html#3500" class="Bound">a</a><a id="3621" class="Symbol">)</a> <a id="3623" href="Algebra.html#3156" class="Field Operator">∙</a> <a id="3625" href="Algebra.Solver.CommutativeMonoid.html#3504" class="Bound">c</a>  <a id="3628" href="Relation.Binary.PreorderReasoning.html#1330" class="Function Operator">≈⟨</a> <a id="3631" href="Algebra.Structures.html#1218" class="Function">assoc</a> <a id="3637" class="Symbol">_</a> <a id="3639" class="Symbol">_</a> <a id="3641" class="Symbol">_</a> <a id="3643" href="Relation.Binary.PreorderReasoning.html#1330" class="Function Operator">⟩</a>
        <a id="3653" href="Algebra.Solver.CommutativeMonoid.html#3502" class="Bound">b</a> <a id="3655" href="Algebra.html#3156" class="Field Operator">∙</a> <a id="3657" class="Symbol">(</a><a id="3658" href="Algebra.Solver.CommutativeMonoid.html#3500" class="Bound">a</a> <a id="3660" href="Algebra.html#3156" class="Field Operator">∙</a> <a id="3662" href="Algebra.Solver.CommutativeMonoid.html#3504" class="Bound">c</a><a id="3663" class="Symbol">)</a>  <a id="3666" href="Relation.Binary.PreorderReasoning.html#1717" class="Function Operator">∎</a>
    <a id="3672" href="Algebra.Solver.CommutativeMonoid.html#3672" class="Function">lemma</a> <a id="3678" class="Symbol">:</a> <a id="3680" class="Symbol">∀</a> <a id="3682" href="Algebra.Solver.CommutativeMonoid.html#3682" class="Bound">l</a> <a id="3684" href="Algebra.Solver.CommutativeMonoid.html#3684" class="Bound">m</a> <a id="3686" class="Symbol">{</a><a id="3687" href="Algebra.Solver.CommutativeMonoid.html#3687" class="Bound">d</a> <a id="3689" href="Algebra.Solver.CommutativeMonoid.html#3689" class="Bound">b</a> <a id="3691" href="Algebra.Solver.CommutativeMonoid.html#3691" class="Bound">c</a><a id="3692" class="Symbol">}</a> <a id="3694" class="Symbol">(</a><a id="3695" href="Algebra.Solver.CommutativeMonoid.html#3695" class="Bound">p</a> <a id="3697" class="Symbol">:</a> <a id="3699" href="Algebra.Solver.CommutativeMonoid.html#3687" class="Bound">d</a> <a id="3701" href="Algebra.html#3116" class="Field Operator">≈</a> <a id="3703" href="Algebra.Solver.CommutativeMonoid.html#3689" class="Bound">b</a> <a id="3705" href="Algebra.html#3156" class="Field Operator">∙</a> <a id="3707" href="Algebra.Solver.CommutativeMonoid.html#3691" class="Bound">c</a><a id="3708" class="Symbol">)</a> <a id="3710" class="Symbol">→</a>
      <a id="3718" href="Data.Nat.GeneralisedArithmetic.html#508" class="Function">fold</a> <a id="3723" href="Algebra.Solver.CommutativeMonoid.html#3687" class="Bound">d</a> <a id="3725" class="Symbol">(</a><a id="3726" href="Algebra.Solver.CommutativeMonoid.html#3392" class="Bound">a</a> <a id="3728" href="Algebra.html#3156" class="Field Operator">∙_</a><a id="3730" class="Symbol">)</a> <a id="3732" class="Symbol">(</a><a id="3733" href="Algebra.Solver.CommutativeMonoid.html#3682" class="Bound">l</a> <a id="3735" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">+</a> <a id="3737" href="Algebra.Solver.CommutativeMonoid.html#3684" class="Bound">m</a><a id="3738" class="Symbol">)</a> <a id="3740" href="Algebra.html#3116" class="Field Operator">≈</a> <a id="3742" href="Data.Nat.GeneralisedArithmetic.html#508" class="Function">fold</a> <a id="3747" href="Algebra.Solver.CommutativeMonoid.html#3689" class="Bound">b</a> <a id="3749" class="Symbol">(</a><a id="3750" href="Algebra.Solver.CommutativeMonoid.html#3392" class="Bound">a</a> <a id="3752" href="Algebra.html#3156" class="Field Operator">∙_</a><a id="3754" class="Symbol">)</a> <a id="3756" href="Algebra.Solver.CommutativeMonoid.html#3682" class="Bound">l</a> <a id="3758" href="Algebra.html#3156" class="Field Operator">∙</a> <a id="3760" href="Data.Nat.GeneralisedArithmetic.html#508" class="Function">fold</a> <a id="3765" href="Algebra.Solver.CommutativeMonoid.html#3691" class="Bound">c</a> <a id="3767" class="Symbol">(</a><a id="3768" href="Algebra.Solver.CommutativeMonoid.html#3392" class="Bound">a</a> <a id="3770" href="Algebra.html#3156" class="Field Operator">∙_</a><a id="3772" class="Symbol">)</a> <a id="3774" href="Algebra.Solver.CommutativeMonoid.html#3684" class="Bound">m</a>
    <a id="3780" href="Algebra.Solver.CommutativeMonoid.html#3672" class="Function">lemma</a> <a id="3786" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a> <a id="3791" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a> <a id="3796" href="Algebra.Solver.CommutativeMonoid.html#3796" class="Bound">p</a> <a id="3798" class="Symbol">=</a> <a id="3800" href="Algebra.Solver.CommutativeMonoid.html#3796" class="Bound">p</a>
    <a id="3806" href="Algebra.Solver.CommutativeMonoid.html#3672" class="Function">lemma</a> <a id="3812" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a> <a id="3817" class="Symbol">(</a><a id="3818" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="3822" href="Algebra.Solver.CommutativeMonoid.html#3822" class="Bound">m</a><a id="3823" class="Symbol">)</a> <a id="3825" href="Algebra.Solver.CommutativeMonoid.html#3825" class="Bound">p</a> <a id="3827" class="Symbol">=</a> <a id="3829" href="Relation.Binary.Core.html#5860" class="Function">trans</a> <a id="3835" class="Symbol">(</a><a id="3836" href="Algebra.Structures.html#860" class="Function">∙-cong</a> <a id="3843" href="Relation.Binary.Core.html#5808" class="Function">refl</a> <a id="3848" class="Symbol">(</a><a id="3849" href="Algebra.Solver.CommutativeMonoid.html#3672" class="Function">lemma</a> <a id="3855" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a> <a id="3860" href="Algebra.Solver.CommutativeMonoid.html#3822" class="Bound">m</a> <a id="3862" href="Algebra.Solver.CommutativeMonoid.html#3825" class="Bound">p</a><a id="3863" class="Symbol">))</a> <a id="3866" class="Symbol">(</a><a id="3867" href="Algebra.Solver.CommutativeMonoid.html#3444" class="Function">flip12</a> <a id="3874" class="Symbol">_</a> <a id="3876" class="Symbol">_</a> <a id="3878" class="Symbol">_)</a>
    <a id="3885" href="Algebra.Solver.CommutativeMonoid.html#3672" class="Function">lemma</a> <a id="3891" class="Symbol">(</a><a id="3892" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="3896" href="Algebra.Solver.CommutativeMonoid.html#3896" class="Bound">l</a><a id="3897" class="Symbol">)</a> <a id="3899" href="Algebra.Solver.CommutativeMonoid.html#3899" class="Bound">m</a> <a id="3901" href="Algebra.Solver.CommutativeMonoid.html#3901" class="Bound">p</a> <a id="3903" class="Symbol">=</a> <a id="3905" href="Relation.Binary.Core.html#5860" class="Function">trans</a> <a id="3911" class="Symbol">(</a><a id="3912" href="Algebra.Structures.html#860" class="Function">∙-cong</a> <a id="3919" href="Relation.Binary.Core.html#5808" class="Function">refl</a> <a id="3924" class="Symbol">(</a><a id="3925" href="Algebra.Solver.CommutativeMonoid.html#3672" class="Function">lemma</a> <a id="3931" href="Algebra.Solver.CommutativeMonoid.html#3896" class="Bound">l</a> <a id="3933" href="Algebra.Solver.CommutativeMonoid.html#3899" class="Bound">m</a> <a id="3935" href="Algebra.Solver.CommutativeMonoid.html#3901" class="Bound">p</a><a id="3936" class="Symbol">))</a> <a id="3939" class="Symbol">(</a><a id="3940" href="Relation.Binary.Core.html#5834" class="Function">sym</a> <a id="3944" class="Symbol">(</a><a id="3945" href="Algebra.Structures.html#1218" class="Function">assoc</a> <a id="3951" href="Algebra.Solver.CommutativeMonoid.html#3392" class="Bound">a</a> <a id="3953" class="Symbol">_</a> <a id="3955" class="Symbol">_))</a>

<a id="3960" class="Comment">------------------------------------------------------------------------</a>
<a id="4033" class="Comment">-- Normalization</a>

<a id="4051" class="Comment">-- A normaliser.</a>

<a id="normalise"></a><a id="4069" href="Algebra.Solver.CommutativeMonoid.html#4069" class="Function">normalise</a> <a id="4079" class="Symbol">:</a> <a id="4081" class="Symbol">∀</a> <a id="4083" class="Symbol">{</a><a id="4084" href="Algebra.Solver.CommutativeMonoid.html#4084" class="Bound">n</a><a id="4085" class="Symbol">}</a> <a id="4087" class="Symbol">→</a> <a id="4089" href="Algebra.Solver.CommutativeMonoid.html#1399" class="Datatype">Expr</a> <a id="4094" href="Algebra.Solver.CommutativeMonoid.html#4084" class="Bound">n</a> <a id="4096" class="Symbol">→</a> <a id="4098" href="Algebra.Solver.CommutativeMonoid.html#1945" class="Function">Normal</a> <a id="4105" href="Algebra.Solver.CommutativeMonoid.html#4084" class="Bound">n</a>
<a id="4107" href="Algebra.Solver.CommutativeMonoid.html#4069" class="Function">normalise</a> <a id="4117" class="Symbol">(</a><a id="4118" href="Algebra.Solver.CommutativeMonoid.html#1426" class="InductiveConstructor">var</a> <a id="4122" href="Algebra.Solver.CommutativeMonoid.html#4122" class="Bound">x</a><a id="4123" class="Symbol">)</a>   <a id="4127" class="Symbol">=</a> <a id="4129" href="Algebra.Solver.CommutativeMonoid.html#2323" class="Function">sg</a> <a id="4132" href="Algebra.Solver.CommutativeMonoid.html#4122" class="Bound">x</a>
<a id="4134" href="Algebra.Solver.CommutativeMonoid.html#4069" class="Function">normalise</a> <a id="4144" href="Algebra.Solver.CommutativeMonoid.html#1449" class="InductiveConstructor">id</a>        <a id="4154" class="Symbol">=</a> <a id="4156" href="Algebra.Solver.CommutativeMonoid.html#2257" class="Function">empty</a>
<a id="4162" href="Algebra.Solver.CommutativeMonoid.html#4069" class="Function">normalise</a> <a id="4172" class="Symbol">(</a><a id="4173" href="Algebra.Solver.CommutativeMonoid.html#4173" class="Bound">e₁</a> <a id="4176" href="Algebra.Solver.CommutativeMonoid.html#1464" class="InductiveConstructor Operator">⊕</a> <a id="4178" href="Algebra.Solver.CommutativeMonoid.html#4178" class="Bound">e₂</a><a id="4180" class="Symbol">)</a> <a id="4182" class="Symbol">=</a> <a id="4184" href="Algebra.Solver.CommutativeMonoid.html#4069" class="Function">normalise</a> <a id="4194" href="Algebra.Solver.CommutativeMonoid.html#4173" class="Bound">e₁</a> <a id="4197" href="Algebra.Solver.CommutativeMonoid.html#2439" class="Function Operator">•</a> <a id="4199" href="Algebra.Solver.CommutativeMonoid.html#4069" class="Function">normalise</a> <a id="4209" href="Algebra.Solver.CommutativeMonoid.html#4178" class="Bound">e₂</a>

<a id="4213" class="Comment">-- The normaliser preserves the semantics of the expression.</a>

<a id="normalise-correct"></a><a id="4275" href="Algebra.Solver.CommutativeMonoid.html#4275" class="Function">normalise-correct</a> <a id="4293" class="Symbol">:</a> <a id="4295" class="Symbol">∀</a> <a id="4297" class="Symbol">{</a><a id="4298" href="Algebra.Solver.CommutativeMonoid.html#4298" class="Bound">n</a><a id="4299" class="Symbol">}</a> <a id="4301" class="Symbol">(</a><a id="4302" href="Algebra.Solver.CommutativeMonoid.html#4302" class="Bound">e</a> <a id="4304" class="Symbol">:</a> <a id="4306" href="Algebra.Solver.CommutativeMonoid.html#1399" class="Datatype">Expr</a> <a id="4311" href="Algebra.Solver.CommutativeMonoid.html#4298" class="Bound">n</a><a id="4312" class="Symbol">)</a> <a id="4314" class="Symbol">(</a><a id="4315" href="Algebra.Solver.CommutativeMonoid.html#4315" class="Bound">ρ</a> <a id="4317" class="Symbol">:</a> <a id="4319" href="Algebra.Solver.CommutativeMonoid.html#1554" class="Function">Env</a> <a id="4323" href="Algebra.Solver.CommutativeMonoid.html#4298" class="Bound">n</a><a id="4324" class="Symbol">)</a> <a id="4326" class="Symbol">→</a>
    <a id="4332" href="Algebra.Solver.CommutativeMonoid.html#2018" class="Function Operator">⟦</a> <a id="4334" href="Algebra.Solver.CommutativeMonoid.html#4069" class="Function">normalise</a> <a id="4344" href="Algebra.Solver.CommutativeMonoid.html#4302" class="Bound">e</a> <a id="4346" href="Algebra.Solver.CommutativeMonoid.html#2018" class="Function Operator">⟧⇓</a> <a id="4349" href="Algebra.Solver.CommutativeMonoid.html#4315" class="Bound">ρ</a> <a id="4351" href="Algebra.html#3116" class="Field Operator">≈</a> <a id="4353" href="Algebra.Solver.CommutativeMonoid.html#1677" class="Function Operator">⟦</a> <a id="4355" href="Algebra.Solver.CommutativeMonoid.html#4302" class="Bound">e</a> <a id="4357" href="Algebra.Solver.CommutativeMonoid.html#1677" class="Function Operator">⟧</a> <a id="4359" href="Algebra.Solver.CommutativeMonoid.html#4315" class="Bound">ρ</a>
<a id="4361" href="Algebra.Solver.CommutativeMonoid.html#4275" class="Function">normalise-correct</a> <a id="4379" class="Symbol">(</a><a id="4380" href="Algebra.Solver.CommutativeMonoid.html#1426" class="InductiveConstructor">var</a> <a id="4384" href="Algebra.Solver.CommutativeMonoid.html#4384" class="Bound">x</a><a id="4385" class="Symbol">)</a>   <a id="4389" href="Algebra.Solver.CommutativeMonoid.html#4389" class="Bound">ρ</a> <a id="4391" class="Symbol">=</a> <a id="4393" href="Algebra.Solver.CommutativeMonoid.html#2873" class="Function">sg-correct</a> <a id="4404" href="Algebra.Solver.CommutativeMonoid.html#4384" class="Bound">x</a> <a id="4406" href="Algebra.Solver.CommutativeMonoid.html#4389" class="Bound">ρ</a>
<a id="4408" href="Algebra.Solver.CommutativeMonoid.html#4275" class="Function">normalise-correct</a> <a id="4426" href="Algebra.Solver.CommutativeMonoid.html#1449" class="InductiveConstructor">id</a>        <a id="4436" href="Algebra.Solver.CommutativeMonoid.html#4436" class="Bound">ρ</a> <a id="4438" class="Symbol">=</a> <a id="4440" href="Algebra.Solver.CommutativeMonoid.html#2704" class="Function">empty-correct</a> <a id="4454" href="Algebra.Solver.CommutativeMonoid.html#4436" class="Bound">ρ</a>
<a id="4456" href="Algebra.Solver.CommutativeMonoid.html#4275" class="Function">normalise-correct</a> <a id="4474" class="Symbol">(</a><a id="4475" href="Algebra.Solver.CommutativeMonoid.html#4475" class="Bound">e₁</a> <a id="4478" href="Algebra.Solver.CommutativeMonoid.html#1464" class="InductiveConstructor Operator">⊕</a> <a id="4480" href="Algebra.Solver.CommutativeMonoid.html#4480" class="Bound">e₂</a><a id="4482" class="Symbol">)</a> <a id="4484" href="Algebra.Solver.CommutativeMonoid.html#4484" class="Bound">ρ</a> <a id="4486" class="Symbol">=</a>  <a id="4489" href="Relation.Binary.PreorderReasoning.html#1264" class="Function Operator">begin</a>

    <a id="4500" href="Algebra.Solver.CommutativeMonoid.html#2018" class="Function Operator">⟦</a> <a id="4502" href="Algebra.Solver.CommutativeMonoid.html#4069" class="Function">normalise</a> <a id="4512" href="Algebra.Solver.CommutativeMonoid.html#4475" class="Bound">e₁</a> <a id="4515" href="Algebra.Solver.CommutativeMonoid.html#2439" class="Function Operator">•</a> <a id="4517" href="Algebra.Solver.CommutativeMonoid.html#4069" class="Function">normalise</a> <a id="4527" href="Algebra.Solver.CommutativeMonoid.html#4480" class="Bound">e₂</a> <a id="4530" href="Algebra.Solver.CommutativeMonoid.html#2018" class="Function Operator">⟧⇓</a> <a id="4533" href="Algebra.Solver.CommutativeMonoid.html#4484" class="Bound">ρ</a>

  <a id="4538" href="Relation.Binary.PreorderReasoning.html#1330" class="Function Operator">≈⟨</a> <a id="4541" href="Algebra.Solver.CommutativeMonoid.html#3217" class="Function">comp-correct</a> <a id="4554" class="Symbol">(</a><a id="4555" href="Algebra.Solver.CommutativeMonoid.html#4069" class="Function">normalise</a> <a id="4565" href="Algebra.Solver.CommutativeMonoid.html#4475" class="Bound">e₁</a><a id="4567" class="Symbol">)</a> <a id="4569" class="Symbol">(</a><a id="4570" href="Algebra.Solver.CommutativeMonoid.html#4069" class="Function">normalise</a> <a id="4580" href="Algebra.Solver.CommutativeMonoid.html#4480" class="Bound">e₂</a><a id="4582" class="Symbol">)</a> <a id="4584" href="Algebra.Solver.CommutativeMonoid.html#4484" class="Bound">ρ</a> <a id="4586" href="Relation.Binary.PreorderReasoning.html#1330" class="Function Operator">⟩</a>

    <a id="4593" href="Algebra.Solver.CommutativeMonoid.html#2018" class="Function Operator">⟦</a> <a id="4595" href="Algebra.Solver.CommutativeMonoid.html#4069" class="Function">normalise</a> <a id="4605" href="Algebra.Solver.CommutativeMonoid.html#4475" class="Bound">e₁</a> <a id="4608" href="Algebra.Solver.CommutativeMonoid.html#2018" class="Function Operator">⟧⇓</a> <a id="4611" href="Algebra.Solver.CommutativeMonoid.html#4484" class="Bound">ρ</a> <a id="4613" href="Algebra.html#3156" class="Field Operator">∙</a> <a id="4615" href="Algebra.Solver.CommutativeMonoid.html#2018" class="Function Operator">⟦</a> <a id="4617" href="Algebra.Solver.CommutativeMonoid.html#4069" class="Function">normalise</a> <a id="4627" href="Algebra.Solver.CommutativeMonoid.html#4480" class="Bound">e₂</a> <a id="4630" href="Algebra.Solver.CommutativeMonoid.html#2018" class="Function Operator">⟧⇓</a> <a id="4633" href="Algebra.Solver.CommutativeMonoid.html#4484" class="Bound">ρ</a>

  <a id="4638" href="Relation.Binary.PreorderReasoning.html#1330" class="Function Operator">≈⟨</a> <a id="4641" href="Algebra.Structures.html#860" class="Function">∙-cong</a> <a id="4648" class="Symbol">(</a><a id="4649" href="Algebra.Solver.CommutativeMonoid.html#4275" class="Function">normalise-correct</a> <a id="4667" href="Algebra.Solver.CommutativeMonoid.html#4475" class="Bound">e₁</a> <a id="4670" href="Algebra.Solver.CommutativeMonoid.html#4484" class="Bound">ρ</a><a id="4671" class="Symbol">)</a> <a id="4673" class="Symbol">(</a><a id="4674" href="Algebra.Solver.CommutativeMonoid.html#4275" class="Function">normalise-correct</a> <a id="4692" href="Algebra.Solver.CommutativeMonoid.html#4480" class="Bound">e₂</a> <a id="4695" href="Algebra.Solver.CommutativeMonoid.html#4484" class="Bound">ρ</a><a id="4696" class="Symbol">)</a> <a id="4698" href="Relation.Binary.PreorderReasoning.html#1330" class="Function Operator">⟩</a>

    <a id="4705" href="Algebra.Solver.CommutativeMonoid.html#1677" class="Function Operator">⟦</a> <a id="4707" href="Algebra.Solver.CommutativeMonoid.html#4475" class="Bound">e₁</a> <a id="4710" href="Algebra.Solver.CommutativeMonoid.html#1677" class="Function Operator">⟧</a> <a id="4712" href="Algebra.Solver.CommutativeMonoid.html#4484" class="Bound">ρ</a> <a id="4714" href="Algebra.html#3156" class="Field Operator">∙</a> <a id="4716" href="Algebra.Solver.CommutativeMonoid.html#1677" class="Function Operator">⟦</a> <a id="4718" href="Algebra.Solver.CommutativeMonoid.html#4480" class="Bound">e₂</a> <a id="4721" href="Algebra.Solver.CommutativeMonoid.html#1677" class="Function Operator">⟧</a> <a id="4723" href="Algebra.Solver.CommutativeMonoid.html#4484" class="Bound">ρ</a>
  <a id="4727" href="Relation.Binary.PreorderReasoning.html#1717" class="Function Operator">∎</a>

<a id="4730" class="Comment">------------------------------------------------------------------------</a>
<a id="4803" class="Comment">-- &quot;Tactics&quot;</a>

<a id="4817" class="Keyword">open</a> <a id="4822" class="Keyword">module</a> <a id="R"></a><a id="4829" href="Algebra.Solver.CommutativeMonoid.html#4829" class="Module">R</a> <a id="4831" class="Symbol">=</a> <a id="4833" href="Relation.Binary.Reflection.html" class="Module">Reflection</a>
                  <a id="4862" href="Algebra.Structures.html#935" class="Function">setoid</a> <a id="4869" href="Algebra.Solver.CommutativeMonoid.html#1426" class="InductiveConstructor">var</a> <a id="4873" href="Algebra.Solver.CommutativeMonoid.html#1677" class="Function Operator">⟦_⟧</a> <a id="4877" class="Symbol">(</a><a id="4878" href="Algebra.Solver.CommutativeMonoid.html#2018" class="Function Operator">⟦_⟧⇓</a> <a id="4883" href="Function.html#805" class="Function Operator">∘</a> <a id="4885" href="Algebra.Solver.CommutativeMonoid.html#4069" class="Function">normalise</a><a id="4894" class="Symbol">)</a> <a id="4896" href="Algebra.Solver.CommutativeMonoid.html#4275" class="Function">normalise-correct</a>
  <a id="4916" class="Keyword">public</a> <a id="4923" class="Keyword">using</a> <a id="4929" class="Symbol">(</a><a id="4930" href="Relation.Binary.Reflection.html#2418" class="Function">solve</a><a id="4935" class="Symbol">;</a> <a id="4937" href="Relation.Binary.Reflection.html#3527" class="Function Operator">_⊜_</a><a id="4940" class="Symbol">)</a>

<a id="4943" class="Comment">-- We can decide if two normal forms are /syntactically/ equal.</a>

<a id="5008" class="Keyword">infix</a> <a id="5014" class="Number">5</a> <a id="5016" href="Algebra.Solver.CommutativeMonoid.html#5021" class="Function Operator">_≟_</a>

<a id="_≟_"></a><a id="5021" href="Algebra.Solver.CommutativeMonoid.html#5021" class="Function Operator">_≟_</a> <a id="5025" class="Symbol">:</a> <a id="5027" class="Symbol">∀</a> <a id="5029" class="Symbol">{</a><a id="5030" href="Algebra.Solver.CommutativeMonoid.html#5030" class="Bound">n</a><a id="5031" class="Symbol">}</a> <a id="5033" class="Symbol">(</a><a id="5034" href="Algebra.Solver.CommutativeMonoid.html#5034" class="Bound">nf₁</a> <a id="5038" href="Algebra.Solver.CommutativeMonoid.html#5038" class="Bound">nf₂</a> <a id="5042" class="Symbol">:</a> <a id="5044" href="Algebra.Solver.CommutativeMonoid.html#1945" class="Function">Normal</a> <a id="5051" href="Algebra.Solver.CommutativeMonoid.html#5030" class="Bound">n</a><a id="5052" class="Symbol">)</a> <a id="5054" class="Symbol">→</a> <a id="5056" href="Relation.Nullary.html#570" class="Datatype">Dec</a> <a id="5060" class="Symbol">(</a><a id="5061" href="Algebra.Solver.CommutativeMonoid.html#5034" class="Bound">nf₁</a> <a id="5065" href="Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="5067" href="Algebra.Solver.CommutativeMonoid.html#5038" class="Bound">nf₂</a><a id="5070" class="Symbol">)</a>
<a id="5072" href="Algebra.Solver.CommutativeMonoid.html#5072" class="Bound">nf₁</a> <a id="5076" href="Algebra.Solver.CommutativeMonoid.html#5021" class="Function Operator">≟</a> <a id="5078" href="Algebra.Solver.CommutativeMonoid.html#5078" class="Bound">nf₂</a> <a id="5082" class="Symbol">=</a> <a id="5084" href="Relation.Nullary.Decidable.html#1668" class="Function">Dec.map</a> <a id="5092" href="Data.Vec.Relation.Pointwise.Inductive.html#9108" class="Function">Pointwise-≡↔≡</a> <a id="5106" class="Symbol">(</a><a id="5107" href="Data.Vec.Relation.Pointwise.Inductive.html#3202" class="Function">decidable</a> <a id="5117" href="Data.Nat.Properties.html#1383" class="Function Operator">ℕ._≟_</a> <a id="5123" href="Algebra.Solver.CommutativeMonoid.html#5072" class="Bound">nf₁</a> <a id="5127" href="Algebra.Solver.CommutativeMonoid.html#5078" class="Bound">nf₂</a><a id="5130" class="Symbol">)</a>
  <a id="5134" class="Keyword">where</a> <a id="5140" class="Keyword">open</a> <a id="5145" href="Data.Vec.Relation.Pointwise.Inductive.html" class="Module">Pointwise</a>

<a id="5156" class="Comment">-- We can also give a sound, but not necessarily complete, procedure</a>
<a id="5225" class="Comment">-- for determining if two expressions have the same semantics.</a>

<a id="prove′"></a><a id="5289" href="Algebra.Solver.CommutativeMonoid.html#5289" class="Function">prove′</a> <a id="5296" class="Symbol">:</a> <a id="5298" class="Symbol">∀</a> <a id="5300" class="Symbol">{</a><a id="5301" href="Algebra.Solver.CommutativeMonoid.html#5301" class="Bound">n</a><a id="5302" class="Symbol">}</a> <a id="5304" class="Symbol">(</a><a id="5305" href="Algebra.Solver.CommutativeMonoid.html#5305" class="Bound">e₁</a> <a id="5308" href="Algebra.Solver.CommutativeMonoid.html#5308" class="Bound">e₂</a> <a id="5311" class="Symbol">:</a> <a id="5313" href="Algebra.Solver.CommutativeMonoid.html#1399" class="Datatype">Expr</a> <a id="5318" href="Algebra.Solver.CommutativeMonoid.html#5301" class="Bound">n</a><a id="5319" class="Symbol">)</a> <a id="5321" class="Symbol">→</a> <a id="5323" href="Data.Maybe.Base.html#710" class="Datatype">Maybe</a> <a id="5329" class="Symbol">(∀</a> <a id="5332" href="Algebra.Solver.CommutativeMonoid.html#5332" class="Bound">ρ</a> <a id="5334" class="Symbol">→</a> <a id="5336" href="Algebra.Solver.CommutativeMonoid.html#1677" class="Function Operator">⟦</a> <a id="5338" href="Algebra.Solver.CommutativeMonoid.html#5305" class="Bound">e₁</a> <a id="5341" href="Algebra.Solver.CommutativeMonoid.html#1677" class="Function Operator">⟧</a> <a id="5343" href="Algebra.Solver.CommutativeMonoid.html#5332" class="Bound">ρ</a> <a id="5345" href="Algebra.html#3116" class="Field Operator">≈</a> <a id="5347" href="Algebra.Solver.CommutativeMonoid.html#1677" class="Function Operator">⟦</a> <a id="5349" href="Algebra.Solver.CommutativeMonoid.html#5308" class="Bound">e₂</a> <a id="5352" href="Algebra.Solver.CommutativeMonoid.html#1677" class="Function Operator">⟧</a> <a id="5354" href="Algebra.Solver.CommutativeMonoid.html#5332" class="Bound">ρ</a><a id="5355" class="Symbol">)</a>
<a id="5357" href="Algebra.Solver.CommutativeMonoid.html#5289" class="Function">prove′</a> <a id="5364" href="Algebra.Solver.CommutativeMonoid.html#5364" class="Bound">e₁</a> <a id="5367" href="Algebra.Solver.CommutativeMonoid.html#5367" class="Bound">e₂</a> <a id="5370" class="Symbol">=</a>
  <a id="5374" href="Data.Maybe.Base.html#2139" class="Function">Maybe.map</a> <a id="5384" href="Algebra.Solver.CommutativeMonoid.html#5443" class="Function">lemma</a> <a id="5390" class="Symbol">(</a><a id="5391" href="Data.Maybe.Base.html#1285" class="Function">decToMaybe</a> <a id="5402" class="Symbol">(</a><a id="5403" href="Algebra.Solver.CommutativeMonoid.html#4069" class="Function">normalise</a> <a id="5413" href="Algebra.Solver.CommutativeMonoid.html#5364" class="Bound">e₁</a> <a id="5416" href="Algebra.Solver.CommutativeMonoid.html#5021" class="Function Operator">≟</a> <a id="5418" href="Algebra.Solver.CommutativeMonoid.html#4069" class="Function">normalise</a> <a id="5428" href="Algebra.Solver.CommutativeMonoid.html#5367" class="Bound">e₂</a><a id="5430" class="Symbol">))</a>
  <a id="5435" class="Keyword">where</a>
  <a id="5443" href="Algebra.Solver.CommutativeMonoid.html#5443" class="Function">lemma</a> <a id="5449" class="Symbol">:</a> <a id="5451" href="Algebra.Solver.CommutativeMonoid.html#4069" class="Function">normalise</a> <a id="5461" href="Algebra.Solver.CommutativeMonoid.html#5364" class="Bound">e₁</a> <a id="5464" href="Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="5466" href="Algebra.Solver.CommutativeMonoid.html#4069" class="Function">normalise</a> <a id="5476" href="Algebra.Solver.CommutativeMonoid.html#5367" class="Bound">e₂</a> <a id="5479" class="Symbol">→</a> <a id="5481" class="Symbol">∀</a> <a id="5483" href="Algebra.Solver.CommutativeMonoid.html#5483" class="Bound">ρ</a> <a id="5485" class="Symbol">→</a> <a id="5487" href="Algebra.Solver.CommutativeMonoid.html#1677" class="Function Operator">⟦</a> <a id="5489" href="Algebra.Solver.CommutativeMonoid.html#5364" class="Bound">e₁</a> <a id="5492" href="Algebra.Solver.CommutativeMonoid.html#1677" class="Function Operator">⟧</a> <a id="5494" href="Algebra.Solver.CommutativeMonoid.html#5483" class="Bound">ρ</a> <a id="5496" href="Algebra.html#3116" class="Field Operator">≈</a> <a id="5498" href="Algebra.Solver.CommutativeMonoid.html#1677" class="Function Operator">⟦</a> <a id="5500" href="Algebra.Solver.CommutativeMonoid.html#5367" class="Bound">e₂</a> <a id="5503" href="Algebra.Solver.CommutativeMonoid.html#1677" class="Function Operator">⟧</a> <a id="5505" href="Algebra.Solver.CommutativeMonoid.html#5483" class="Bound">ρ</a>
  <a id="5509" href="Algebra.Solver.CommutativeMonoid.html#5443" class="Function">lemma</a> <a id="5515" href="Algebra.Solver.CommutativeMonoid.html#5515" class="Bound">eq</a> <a id="5518" href="Algebra.Solver.CommutativeMonoid.html#5518" class="Bound">ρ</a> <a id="5520" class="Symbol">=</a>
    <a id="5526" href="Relation.Binary.Reflection.html#1732" class="Function">R.prove</a> <a id="5534" href="Algebra.Solver.CommutativeMonoid.html#5518" class="Bound">ρ</a> <a id="5536" href="Algebra.Solver.CommutativeMonoid.html#5364" class="Bound">e₁</a> <a id="5539" href="Algebra.Solver.CommutativeMonoid.html#5367" class="Bound">e₂</a> <a id="5542" class="Symbol">(</a><a id="5543" href="Relation.Binary.PreorderReasoning.html#1264" class="Function Operator">begin</a>
      <a id="5555" href="Algebra.Solver.CommutativeMonoid.html#2018" class="Function Operator">⟦</a> <a id="5557" href="Algebra.Solver.CommutativeMonoid.html#4069" class="Function">normalise</a> <a id="5567" href="Algebra.Solver.CommutativeMonoid.html#5364" class="Bound">e₁</a> <a id="5570" href="Algebra.Solver.CommutativeMonoid.html#2018" class="Function Operator">⟧⇓</a> <a id="5573" href="Algebra.Solver.CommutativeMonoid.html#5518" class="Bound">ρ</a>  <a id="5576" href="Relation.Binary.PreorderReasoning.html#1560" class="Function Operator">≡⟨</a> <a id="5579" href="Relation.Binary.PropositionalEquality.html#1134" class="Function">P.cong</a> <a id="5586" class="Symbol">(λ</a> <a id="5589" href="Algebra.Solver.CommutativeMonoid.html#5589" class="Bound">e</a> <a id="5591" class="Symbol">→</a> <a id="5593" href="Algebra.Solver.CommutativeMonoid.html#2018" class="Function Operator">⟦</a> <a id="5595" href="Algebra.Solver.CommutativeMonoid.html#5589" class="Bound">e</a> <a id="5597" href="Algebra.Solver.CommutativeMonoid.html#2018" class="Function Operator">⟧⇓</a> <a id="5600" href="Algebra.Solver.CommutativeMonoid.html#5518" class="Bound">ρ</a><a id="5601" class="Symbol">)</a> <a id="5603" href="Algebra.Solver.CommutativeMonoid.html#5515" class="Bound">eq</a> <a id="5606" href="Relation.Binary.PreorderReasoning.html#1560" class="Function Operator">⟩</a>
      <a id="5614" href="Algebra.Solver.CommutativeMonoid.html#2018" class="Function Operator">⟦</a> <a id="5616" href="Algebra.Solver.CommutativeMonoid.html#4069" class="Function">normalise</a> <a id="5626" href="Algebra.Solver.CommutativeMonoid.html#5367" class="Bound">e₂</a> <a id="5629" href="Algebra.Solver.CommutativeMonoid.html#2018" class="Function Operator">⟧⇓</a> <a id="5632" href="Algebra.Solver.CommutativeMonoid.html#5518" class="Bound">ρ</a>  <a id="5635" href="Relation.Binary.PreorderReasoning.html#1717" class="Function Operator">∎</a><a id="5636" class="Symbol">)</a>

<a id="5639" class="Comment">-- This procedure can be combined with from-just.</a>

<a id="prove"></a><a id="5690" href="Algebra.Solver.CommutativeMonoid.html#5690" class="Function">prove</a> <a id="5696" class="Symbol">:</a> <a id="5698" class="Symbol">∀</a> <a id="5700" href="Algebra.Solver.CommutativeMonoid.html#5700" class="Bound">n</a> <a id="5702" class="Symbol">(</a><a id="5703" href="Algebra.Solver.CommutativeMonoid.html#5703" class="Bound">e₁</a> <a id="5706" href="Algebra.Solver.CommutativeMonoid.html#5706" class="Bound">e₂</a> <a id="5709" class="Symbol">:</a> <a id="5711" href="Algebra.Solver.CommutativeMonoid.html#1399" class="Datatype">Expr</a> <a id="5716" href="Algebra.Solver.CommutativeMonoid.html#5700" class="Bound">n</a><a id="5717" class="Symbol">)</a> <a id="5719" class="Symbol">→</a> <a id="5721" href="Data.Maybe.Base.html#1936" class="Function">From-just</a> <a id="5731" class="Symbol">(</a><a id="5732" href="Algebra.Solver.CommutativeMonoid.html#5289" class="Function">prove′</a> <a id="5739" href="Algebra.Solver.CommutativeMonoid.html#5703" class="Bound">e₁</a> <a id="5742" href="Algebra.Solver.CommutativeMonoid.html#5706" class="Bound">e₂</a><a id="5744" class="Symbol">)</a>
<a id="5746" href="Algebra.Solver.CommutativeMonoid.html#5690" class="Function">prove</a> <a id="5752" class="Symbol">_</a> <a id="5754" href="Algebra.Solver.CommutativeMonoid.html#5754" class="Bound">e₁</a> <a id="5757" href="Algebra.Solver.CommutativeMonoid.html#5757" class="Bound">e₂</a> <a id="5760" class="Symbol">=</a> <a id="5762" href="Data.Maybe.Base.html#2024" class="Function">from-just</a> <a id="5772" class="Symbol">(</a><a id="5773" href="Algebra.Solver.CommutativeMonoid.html#5289" class="Function">prove′</a> <a id="5780" href="Algebra.Solver.CommutativeMonoid.html#5754" class="Bound">e₁</a> <a id="5783" href="Algebra.Solver.CommutativeMonoid.html#5757" class="Bound">e₂</a><a id="5785" class="Symbol">)</a>

<a id="5788" class="Comment">-- prove : ∀ n (es : Expr n × Expr n) →</a>
<a id="5828" class="Comment">--         From-just (uncurry prove′ es)</a>
<a id="5869" class="Comment">-- prove _ = from-just ∘ uncurry prove′</a>
</pre></body></html>