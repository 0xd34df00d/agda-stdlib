<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Algebra.Solver.CommutativeMonoid</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Solver for equations in commutative monoids</a>
<a id="153" class="Comment">--</a>
<a id="156" class="Comment">-- Adapted from Algebra.Solver.Monoid</a>
<a id="194" class="Comment">------------------------------------------------------------------------</a>

<a id="268" class="Symbol">{-#</a> <a id="272" class="Keyword">OPTIONS</a> <a id="280" class="Option">--without-K</a> <a id="292" class="Option">--safe</a> <a id="299" class="Symbol">#-}</a>

<a id="304" class="Keyword">open</a> <a id="309" class="Keyword">import</a> <a id="316" href="Algebra.html" class="Module">Algebra</a>

<a id="325" class="Keyword">module</a> <a id="332" href="Algebra.Solver.CommutativeMonoid.html" class="Module">Algebra.Solver.CommutativeMonoid</a> <a id="365" class="Symbol">{</a><a id="366" href="Algebra.Solver.CommutativeMonoid.html#366" class="Bound">m₁</a> <a id="369" href="Algebra.Solver.CommutativeMonoid.html#369" class="Bound">m₂</a><a id="371" class="Symbol">}</a> <a id="373" class="Symbol">(</a><a id="374" href="Algebra.Solver.CommutativeMonoid.html#374" class="Bound">M</a> <a id="376" class="Symbol">:</a> <a id="378" href="Algebra.html#2994" class="Record">CommutativeMonoid</a> <a id="396" href="Algebra.Solver.CommutativeMonoid.html#366" class="Bound">m₁</a> <a id="399" href="Algebra.Solver.CommutativeMonoid.html#369" class="Bound">m₂</a><a id="401" class="Symbol">)</a> <a id="403" class="Keyword">where</a>

<a id="410" class="Keyword">open</a> <a id="415" class="Keyword">import</a> <a id="422" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="431" class="Keyword">using</a> <a id="437" class="Symbol">(</a><a id="438" href="Data.Fin.Base.html#951" class="Datatype">Fin</a><a id="441" class="Symbol">;</a> <a id="443" href="Data.Fin.Base.html#973" class="InductiveConstructor">zero</a><a id="447" class="Symbol">;</a> <a id="449" href="Data.Fin.Base.html#1004" class="InductiveConstructor">suc</a><a id="452" class="Symbol">)</a>
<a id="454" class="Keyword">open</a> <a id="459" class="Keyword">import</a> <a id="466" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="477" class="Symbol">as</a> <a id="480" class="Module">Maybe</a>
  <a id="488" class="Keyword">using</a> <a id="494" class="Symbol">(</a><a id="495" href="Data.Maybe.Base.html#710" class="Datatype">Maybe</a><a id="500" class="Symbol">;</a> <a id="502" href="Data.Maybe.Base.html#1285" class="Function">decToMaybe</a><a id="512" class="Symbol">;</a> <a id="514" href="Data.Maybe.Base.html#1936" class="Function">From-just</a><a id="523" class="Symbol">;</a> <a id="525" href="Data.Maybe.Base.html#2024" class="Function">from-just</a><a id="534" class="Symbol">)</a>
<a id="536" class="Keyword">open</a> <a id="541" class="Keyword">import</a> <a id="548" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="557" class="Symbol">as</a> <a id="560" class="Module">ℕ</a> <a id="562" class="Keyword">using</a> <a id="568" class="Symbol">(</a><a id="569" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="570" class="Symbol">;</a> <a id="572" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a><a id="576" class="Symbol">;</a> <a id="578" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a><a id="581" class="Symbol">;</a> <a id="583" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">_+_</a><a id="586" class="Symbol">)</a>
<a id="588" class="Keyword">open</a> <a id="593" class="Keyword">import</a> <a id="600" href="Data.Nat.GeneralisedArithmetic.html" class="Module">Data.Nat.GeneralisedArithmetic</a> <a id="631" class="Keyword">using</a> <a id="637" class="Symbol">(</a><a id="638" href="Data.Nat.GeneralisedArithmetic.html#508" class="Function">fold</a><a id="642" class="Symbol">)</a>
<a id="644" class="Keyword">open</a> <a id="649" class="Keyword">import</a> <a id="656" href="Data.Product.html" class="Module">Data.Product</a> <a id="669" class="Keyword">using</a> <a id="675" class="Symbol">(</a><a id="676" href="Data.Product.html#1389" class="Function Operator">_×_</a><a id="679" class="Symbol">;</a> <a id="681" href="Data.Product.html#3500" class="Function">uncurry</a><a id="688" class="Symbol">)</a>
<a id="690" class="Keyword">open</a> <a id="695" class="Keyword">import</a> <a id="702" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="711" class="Keyword">using</a> <a id="717" class="Symbol">(</a><a id="718" href="Data.Vec.html#773" class="Datatype">Vec</a><a id="721" class="Symbol">;</a> <a id="723" href="Data.Vec.html#813" class="InductiveConstructor">[]</a><a id="725" class="Symbol">;</a> <a id="727" href="Data.Vec.html#832" class="InductiveConstructor Operator">_∷_</a><a id="730" class="Symbol">;</a> <a id="732" href="Data.Vec.html#1379" class="Function">lookup</a><a id="738" class="Symbol">;</a> <a id="740" href="Data.Vec.html#5840" class="Function">replicate</a><a id="749" class="Symbol">)</a>

<a id="752" class="Keyword">open</a> <a id="757" class="Keyword">import</a> <a id="764" href="Function.html" class="Module">Function</a> <a id="773" class="Keyword">using</a> <a id="779" class="Symbol">(</a><a id="780" href="Function.html#805" class="Function Operator">_∘_</a><a id="783" class="Symbol">)</a>

<a id="786" class="Keyword">import</a> <a id="793" href="Relation.Binary.Reasoning.Setoid.html" class="Module">Relation.Binary.Reasoning.Setoid</a>  <a id="827" class="Symbol">as</a> <a id="830" class="Module">EqReasoning</a>
<a id="842" class="Keyword">import</a> <a id="849" href="Relation.Binary.Reflection.html" class="Module">Relation.Binary.Reflection</a>            <a id="887" class="Symbol">as</a> <a id="890" class="Module">Reflection</a>
<a id="901" class="Keyword">import</a> <a id="908" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a>            <a id="946" class="Symbol">as</a> <a id="949" class="Module">Dec</a>
<a id="953" class="Keyword">import</a> <a id="960" href="Data.Vec.Relation.Pointwise.Inductive.html" class="Module">Data.Vec.Relation.Pointwise.Inductive</a> <a id="998" class="Symbol">as</a> <a id="1001" class="Module">Pointwise</a>

<a id="1012" class="Keyword">open</a> <a id="1017" class="Keyword">import</a> <a id="1024" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="1062" class="Symbol">as</a> <a id="1065" class="Module">P</a> <a id="1067" class="Keyword">using</a> <a id="1073" class="Symbol">(</a><a id="1074" href="Agda.Builtin.Equality.html#83" class="Datatype Operator">_≡_</a><a id="1077" class="Symbol">;</a> <a id="1079" href="Relation.Binary.PropositionalEquality.html#1657" class="Function">decSetoid</a><a id="1088" class="Symbol">)</a>
<a id="1090" class="Keyword">open</a> <a id="1095" class="Keyword">import</a> <a id="1102" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="1119" class="Keyword">using</a> <a id="1125" class="Symbol">(</a><a id="1126" href="Relation.Nullary.html#570" class="Datatype">Dec</a><a id="1129" class="Symbol">)</a>

<a id="1132" class="Keyword">open</a> <a id="1137" href="Algebra.html#2994" class="Module">CommutativeMonoid</a> <a id="1155" href="Algebra.Solver.CommutativeMonoid.html#374" class="Bound">M</a>
<a id="1157" class="Keyword">open</a> <a id="1162" href="Relation.Binary.Reasoning.Setoid.html" class="Module">EqReasoning</a> <a id="1174" href="Algebra.Structures.html#935" class="Function">setoid</a>

<a id="1182" class="Comment">------------------------------------------------------------------------</a>
<a id="1255" class="Comment">-- Monoid expressions</a>

<a id="1278" class="Comment">-- There is one constructor for every operation, plus one for</a>
<a id="1340" class="Comment">-- variables; there may be at most n variables.</a>

<a id="1389" class="Keyword">infixr</a> <a id="1396" class="Number">5</a> <a id="1398" href="Algebra.Solver.CommutativeMonoid.html#1487" class="InductiveConstructor Operator">_⊕_</a>
<a id="1402" class="Keyword">infixr</a> <a id="1409" class="Number">10</a> <a id="1412" href="Algebra.Solver.CommutativeMonoid.html#2462" class="Function Operator">_•_</a>

<a id="1417" class="Keyword">data</a> <a id="Expr"></a><a id="1422" href="Algebra.Solver.CommutativeMonoid.html#1422" class="Datatype">Expr</a> <a id="1427" class="Symbol">(</a><a id="1428" href="Algebra.Solver.CommutativeMonoid.html#1428" class="Bound">n</a> <a id="1430" class="Symbol">:</a> <a id="1432" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="1433" class="Symbol">)</a> <a id="1435" class="Symbol">:</a> <a id="1437" class="PrimitiveType">Set</a> <a id="1441" class="Keyword">where</a>
  <a id="Expr.var"></a><a id="1449" href="Algebra.Solver.CommutativeMonoid.html#1449" class="InductiveConstructor">var</a> <a id="1453" class="Symbol">:</a> <a id="1455" href="Data.Fin.Base.html#951" class="Datatype">Fin</a> <a id="1459" href="Algebra.Solver.CommutativeMonoid.html#1428" class="Bound">n</a> <a id="1461" class="Symbol">→</a> <a id="1463" href="Algebra.Solver.CommutativeMonoid.html#1422" class="Datatype">Expr</a> <a id="1468" href="Algebra.Solver.CommutativeMonoid.html#1428" class="Bound">n</a>
  <a id="Expr.id"></a><a id="1472" href="Algebra.Solver.CommutativeMonoid.html#1472" class="InductiveConstructor">id</a>  <a id="1476" class="Symbol">:</a> <a id="1478" href="Algebra.Solver.CommutativeMonoid.html#1422" class="Datatype">Expr</a> <a id="1483" href="Algebra.Solver.CommutativeMonoid.html#1428" class="Bound">n</a>
  <a id="Expr._⊕_"></a><a id="1487" href="Algebra.Solver.CommutativeMonoid.html#1487" class="InductiveConstructor Operator">_⊕_</a> <a id="1491" class="Symbol">:</a> <a id="1493" href="Algebra.Solver.CommutativeMonoid.html#1422" class="Datatype">Expr</a> <a id="1498" href="Algebra.Solver.CommutativeMonoid.html#1428" class="Bound">n</a> <a id="1500" class="Symbol">→</a> <a id="1502" href="Algebra.Solver.CommutativeMonoid.html#1422" class="Datatype">Expr</a> <a id="1507" href="Algebra.Solver.CommutativeMonoid.html#1428" class="Bound">n</a> <a id="1509" class="Symbol">→</a> <a id="1511" href="Algebra.Solver.CommutativeMonoid.html#1422" class="Datatype">Expr</a> <a id="1516" href="Algebra.Solver.CommutativeMonoid.html#1428" class="Bound">n</a>

<a id="1519" class="Comment">-- An environment contains one value for every variable.</a>

<a id="Env"></a><a id="1577" href="Algebra.Solver.CommutativeMonoid.html#1577" class="Function">Env</a> <a id="1581" class="Symbol">:</a> <a id="1583" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="1585" class="Symbol">→</a> <a id="1587" class="PrimitiveType">Set</a> <a id="1591" class="Symbol">_</a>
<a id="1593" href="Algebra.Solver.CommutativeMonoid.html#1577" class="Function">Env</a> <a id="1597" href="Algebra.Solver.CommutativeMonoid.html#1597" class="Bound">n</a> <a id="1599" class="Symbol">=</a> <a id="1601" href="Data.Vec.html#773" class="Datatype">Vec</a> <a id="1605" href="Algebra.html#3084" class="Field">Carrier</a> <a id="1613" href="Algebra.Solver.CommutativeMonoid.html#1597" class="Bound">n</a>

<a id="1616" class="Comment">-- The semantics of an expression is a function from an environment to</a>
<a id="1687" class="Comment">-- a value.</a>

<a id="⟦_⟧"></a><a id="1700" href="Algebra.Solver.CommutativeMonoid.html#1700" class="Function Operator">⟦_⟧</a> <a id="1704" class="Symbol">:</a> <a id="1706" class="Symbol">∀</a> <a id="1708" class="Symbol">{</a><a id="1709" href="Algebra.Solver.CommutativeMonoid.html#1709" class="Bound">n</a><a id="1710" class="Symbol">}</a> <a id="1712" class="Symbol">→</a> <a id="1714" href="Algebra.Solver.CommutativeMonoid.html#1422" class="Datatype">Expr</a> <a id="1719" href="Algebra.Solver.CommutativeMonoid.html#1709" class="Bound">n</a> <a id="1721" class="Symbol">→</a> <a id="1723" href="Algebra.Solver.CommutativeMonoid.html#1577" class="Function">Env</a> <a id="1727" href="Algebra.Solver.CommutativeMonoid.html#1709" class="Bound">n</a> <a id="1729" class="Symbol">→</a> <a id="1731" href="Algebra.html#3084" class="Field">Carrier</a>
<a id="1739" href="Algebra.Solver.CommutativeMonoid.html#1700" class="Function Operator">⟦</a> <a id="1741" href="Algebra.Solver.CommutativeMonoid.html#1449" class="InductiveConstructor">var</a> <a id="1745" href="Algebra.Solver.CommutativeMonoid.html#1745" class="Bound">x</a>   <a id="1749" href="Algebra.Solver.CommutativeMonoid.html#1700" class="Function Operator">⟧</a> <a id="1751" href="Algebra.Solver.CommutativeMonoid.html#1751" class="Bound">ρ</a> <a id="1753" class="Symbol">=</a> <a id="1755" href="Data.Vec.html#1379" class="Function">lookup</a> <a id="1762" href="Algebra.Solver.CommutativeMonoid.html#1745" class="Bound">x</a> <a id="1764" href="Algebra.Solver.CommutativeMonoid.html#1751" class="Bound">ρ</a>
<a id="1766" href="Algebra.Solver.CommutativeMonoid.html#1700" class="Function Operator">⟦</a> <a id="1768" href="Algebra.Solver.CommutativeMonoid.html#1472" class="InductiveConstructor">id</a>      <a id="1776" href="Algebra.Solver.CommutativeMonoid.html#1700" class="Function Operator">⟧</a> <a id="1778" href="Algebra.Solver.CommutativeMonoid.html#1778" class="Bound">ρ</a> <a id="1780" class="Symbol">=</a> <a id="1782" href="Algebra.html#3194" class="Field">ε</a>
<a id="1784" href="Algebra.Solver.CommutativeMonoid.html#1700" class="Function Operator">⟦</a> <a id="1786" href="Algebra.Solver.CommutativeMonoid.html#1786" class="Bound">e₁</a> <a id="1789" href="Algebra.Solver.CommutativeMonoid.html#1487" class="InductiveConstructor Operator">⊕</a> <a id="1791" href="Algebra.Solver.CommutativeMonoid.html#1791" class="Bound">e₂</a> <a id="1794" href="Algebra.Solver.CommutativeMonoid.html#1700" class="Function Operator">⟧</a> <a id="1796" href="Algebra.Solver.CommutativeMonoid.html#1796" class="Bound">ρ</a> <a id="1798" class="Symbol">=</a> <a id="1800" href="Algebra.Solver.CommutativeMonoid.html#1700" class="Function Operator">⟦</a> <a id="1802" href="Algebra.Solver.CommutativeMonoid.html#1786" class="Bound">e₁</a> <a id="1805" href="Algebra.Solver.CommutativeMonoid.html#1700" class="Function Operator">⟧</a> <a id="1807" href="Algebra.Solver.CommutativeMonoid.html#1796" class="Bound">ρ</a> <a id="1809" href="Algebra.html#3156" class="Field Operator">∙</a> <a id="1811" href="Algebra.Solver.CommutativeMonoid.html#1700" class="Function Operator">⟦</a> <a id="1813" href="Algebra.Solver.CommutativeMonoid.html#1791" class="Bound">e₂</a> <a id="1816" href="Algebra.Solver.CommutativeMonoid.html#1700" class="Function Operator">⟧</a> <a id="1818" href="Algebra.Solver.CommutativeMonoid.html#1796" class="Bound">ρ</a>

<a id="1821" class="Comment">------------------------------------------------------------------------</a>
<a id="1894" class="Comment">-- Normal forms</a>

<a id="1911" class="Comment">-- A normal form is a vector of multiplicities (a bag).</a>

<a id="Normal"></a><a id="1968" href="Algebra.Solver.CommutativeMonoid.html#1968" class="Function">Normal</a> <a id="1975" class="Symbol">:</a> <a id="1977" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="1979" class="Symbol">→</a> <a id="1981" class="PrimitiveType">Set</a>
<a id="1985" href="Algebra.Solver.CommutativeMonoid.html#1968" class="Function">Normal</a> <a id="1992" href="Algebra.Solver.CommutativeMonoid.html#1992" class="Bound">n</a> <a id="1994" class="Symbol">=</a> <a id="1996" href="Data.Vec.html#773" class="Datatype">Vec</a> <a id="2000" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="2002" href="Algebra.Solver.CommutativeMonoid.html#1992" class="Bound">n</a>

<a id="2005" class="Comment">-- The semantics of a normal form.</a>

<a id="⟦_⟧⇓"></a><a id="2041" href="Algebra.Solver.CommutativeMonoid.html#2041" class="Function Operator">⟦_⟧⇓</a> <a id="2046" class="Symbol">:</a> <a id="2048" class="Symbol">∀</a> <a id="2050" class="Symbol">{</a><a id="2051" href="Algebra.Solver.CommutativeMonoid.html#2051" class="Bound">n</a><a id="2052" class="Symbol">}</a> <a id="2054" class="Symbol">→</a> <a id="2056" href="Algebra.Solver.CommutativeMonoid.html#1968" class="Function">Normal</a> <a id="2063" href="Algebra.Solver.CommutativeMonoid.html#2051" class="Bound">n</a> <a id="2065" class="Symbol">→</a> <a id="2067" href="Algebra.Solver.CommutativeMonoid.html#1577" class="Function">Env</a> <a id="2071" href="Algebra.Solver.CommutativeMonoid.html#2051" class="Bound">n</a> <a id="2073" class="Symbol">→</a> <a id="2075" href="Algebra.html#3084" class="Field">Carrier</a>
<a id="2083" href="Algebra.Solver.CommutativeMonoid.html#2041" class="Function Operator">⟦</a> <a id="2085" href="Data.Vec.html#813" class="InductiveConstructor">[]</a>    <a id="2091" href="Algebra.Solver.CommutativeMonoid.html#2041" class="Function Operator">⟧⇓</a> <a id="2094" class="Symbol">_</a> <a id="2096" class="Symbol">=</a> <a id="2098" href="Algebra.html#3194" class="Field">ε</a>
<a id="2100" href="Algebra.Solver.CommutativeMonoid.html#2041" class="Function Operator">⟦</a> <a id="2102" href="Algebra.Solver.CommutativeMonoid.html#2102" class="Bound">n</a> <a id="2104" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="2106" href="Algebra.Solver.CommutativeMonoid.html#2106" class="Bound">v</a> <a id="2108" href="Algebra.Solver.CommutativeMonoid.html#2041" class="Function Operator">⟧⇓</a> <a id="2111" class="Symbol">(</a><a id="2112" href="Algebra.Solver.CommutativeMonoid.html#2112" class="Bound">a</a> <a id="2114" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="2116" href="Algebra.Solver.CommutativeMonoid.html#2116" class="Bound">ρ</a><a id="2117" class="Symbol">)</a> <a id="2119" class="Symbol">=</a> <a id="2121" href="Data.Nat.GeneralisedArithmetic.html#508" class="Function">fold</a> <a id="2126" class="Symbol">(</a><a id="2127" href="Algebra.Solver.CommutativeMonoid.html#2041" class="Function Operator">⟦</a> <a id="2129" href="Algebra.Solver.CommutativeMonoid.html#2106" class="Bound">v</a> <a id="2131" href="Algebra.Solver.CommutativeMonoid.html#2041" class="Function Operator">⟧⇓</a> <a id="2134" href="Algebra.Solver.CommutativeMonoid.html#2116" class="Bound">ρ</a><a id="2135" class="Symbol">)</a> <a id="2137" class="Symbol">(λ</a> <a id="2140" href="Algebra.Solver.CommutativeMonoid.html#2140" class="Bound">b</a> <a id="2142" class="Symbol">→</a> <a id="2144" href="Algebra.Solver.CommutativeMonoid.html#2112" class="Bound">a</a> <a id="2146" href="Algebra.html#3156" class="Field Operator">∙</a> <a id="2148" href="Algebra.Solver.CommutativeMonoid.html#2140" class="Bound">b</a><a id="2149" class="Symbol">)</a> <a id="2151" href="Algebra.Solver.CommutativeMonoid.html#2102" class="Bound">n</a>

<a id="2154" class="Comment">------------------------------------------------------------------------</a>
<a id="2227" class="Comment">-- Constructions on normal forms</a>

<a id="2261" class="Comment">-- The empty bag.</a>

<a id="empty"></a><a id="2280" href="Algebra.Solver.CommutativeMonoid.html#2280" class="Function">empty</a> <a id="2286" class="Symbol">:</a> <a id="2288" class="Symbol">∀{</a><a id="2290" href="Algebra.Solver.CommutativeMonoid.html#2290" class="Bound">n</a><a id="2291" class="Symbol">}</a> <a id="2293" class="Symbol">→</a> <a id="2295" href="Algebra.Solver.CommutativeMonoid.html#1968" class="Function">Normal</a> <a id="2302" href="Algebra.Solver.CommutativeMonoid.html#2290" class="Bound">n</a>
<a id="2304" href="Algebra.Solver.CommutativeMonoid.html#2280" class="Function">empty</a> <a id="2310" class="Symbol">=</a> <a id="2312" href="Data.Vec.html#5840" class="Function">replicate</a> <a id="2322" class="Number">0</a>

<a id="2325" class="Comment">-- A singleton bag.</a>

<a id="sg"></a><a id="2346" href="Algebra.Solver.CommutativeMonoid.html#2346" class="Function">sg</a> <a id="2349" class="Symbol">:</a> <a id="2351" class="Symbol">∀{</a><a id="2353" href="Algebra.Solver.CommutativeMonoid.html#2353" class="Bound">n</a><a id="2354" class="Symbol">}</a> <a id="2356" class="Symbol">(</a><a id="2357" href="Algebra.Solver.CommutativeMonoid.html#2357" class="Bound">i</a> <a id="2359" class="Symbol">:</a> <a id="2361" href="Data.Fin.Base.html#951" class="Datatype">Fin</a> <a id="2365" href="Algebra.Solver.CommutativeMonoid.html#2353" class="Bound">n</a><a id="2366" class="Symbol">)</a> <a id="2368" class="Symbol">→</a> <a id="2370" href="Algebra.Solver.CommutativeMonoid.html#1968" class="Function">Normal</a> <a id="2377" href="Algebra.Solver.CommutativeMonoid.html#2353" class="Bound">n</a>
<a id="2379" href="Algebra.Solver.CommutativeMonoid.html#2346" class="Function">sg</a> <a id="2382" href="Data.Fin.Base.html#973" class="InductiveConstructor">zero</a>    <a id="2390" class="Symbol">=</a> <a id="2392" class="Number">1</a> <a id="2394" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="2396" href="Algebra.Solver.CommutativeMonoid.html#2280" class="Function">empty</a>
<a id="2402" href="Algebra.Solver.CommutativeMonoid.html#2346" class="Function">sg</a> <a id="2405" class="Symbol">(</a><a id="2406" href="Data.Fin.Base.html#1004" class="InductiveConstructor">suc</a> <a id="2410" href="Algebra.Solver.CommutativeMonoid.html#2410" class="Bound">i</a><a id="2411" class="Symbol">)</a> <a id="2413" class="Symbol">=</a> <a id="2415" class="Number">0</a> <a id="2417" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="2419" href="Algebra.Solver.CommutativeMonoid.html#2346" class="Function">sg</a> <a id="2422" href="Algebra.Solver.CommutativeMonoid.html#2410" class="Bound">i</a>

<a id="2425" class="Comment">-- The composition of normal forms.</a>

<a id="_•_"></a><a id="2462" href="Algebra.Solver.CommutativeMonoid.html#2462" class="Function Operator">_•_</a>  <a id="2467" class="Symbol">:</a> <a id="2469" class="Symbol">∀{</a><a id="2471" href="Algebra.Solver.CommutativeMonoid.html#2471" class="Bound">n</a><a id="2472" class="Symbol">}</a> <a id="2474" class="Symbol">(</a><a id="2475" href="Algebra.Solver.CommutativeMonoid.html#2475" class="Bound">v</a> <a id="2477" href="Algebra.Solver.CommutativeMonoid.html#2477" class="Bound">w</a> <a id="2479" class="Symbol">:</a> <a id="2481" href="Algebra.Solver.CommutativeMonoid.html#1968" class="Function">Normal</a> <a id="2488" href="Algebra.Solver.CommutativeMonoid.html#2471" class="Bound">n</a><a id="2489" class="Symbol">)</a> <a id="2491" class="Symbol">→</a> <a id="2493" href="Algebra.Solver.CommutativeMonoid.html#1968" class="Function">Normal</a> <a id="2500" href="Algebra.Solver.CommutativeMonoid.html#2471" class="Bound">n</a>
<a id="2502" href="Data.Vec.html#813" class="InductiveConstructor">[]</a>      <a id="2510" href="Algebra.Solver.CommutativeMonoid.html#2462" class="Function Operator">•</a> <a id="2512" href="Data.Vec.html#813" class="InductiveConstructor">[]</a>      <a id="2520" class="Symbol">=</a> <a id="2522" href="Data.Vec.html#813" class="InductiveConstructor">[]</a>
<a id="2525" class="Symbol">(</a><a id="2526" href="Algebra.Solver.CommutativeMonoid.html#2526" class="Bound">l</a> <a id="2528" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="2530" href="Algebra.Solver.CommutativeMonoid.html#2530" class="Bound">v</a><a id="2531" class="Symbol">)</a> <a id="2533" href="Algebra.Solver.CommutativeMonoid.html#2462" class="Function Operator">•</a> <a id="2535" class="Symbol">(</a><a id="2536" href="Algebra.Solver.CommutativeMonoid.html#2536" class="Bound">m</a> <a id="2538" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="2540" href="Algebra.Solver.CommutativeMonoid.html#2540" class="Bound">w</a><a id="2541" class="Symbol">)</a> <a id="2543" class="Symbol">=</a> <a id="2545" href="Algebra.Solver.CommutativeMonoid.html#2526" class="Bound">l</a> <a id="2547" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">+</a> <a id="2549" href="Algebra.Solver.CommutativeMonoid.html#2536" class="Bound">m</a> <a id="2551" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="2553" href="Algebra.Solver.CommutativeMonoid.html#2530" class="Bound">v</a> <a id="2555" href="Algebra.Solver.CommutativeMonoid.html#2462" class="Function Operator">•</a> <a id="2557" href="Algebra.Solver.CommutativeMonoid.html#2540" class="Bound">w</a>

<a id="2560" class="Comment">------------------------------------------------------------------------</a>
<a id="2633" class="Comment">-- Correctness of the constructions on normal forms</a>

<a id="2686" class="Comment">-- The empty bag stands for the unit ε.</a>

<a id="empty-correct"></a><a id="2727" href="Algebra.Solver.CommutativeMonoid.html#2727" class="Function">empty-correct</a> <a id="2741" class="Symbol">:</a> <a id="2743" class="Symbol">∀{</a><a id="2745" href="Algebra.Solver.CommutativeMonoid.html#2745" class="Bound">n</a><a id="2746" class="Symbol">}</a> <a id="2748" class="Symbol">(</a><a id="2749" href="Algebra.Solver.CommutativeMonoid.html#2749" class="Bound">ρ</a> <a id="2751" class="Symbol">:</a> <a id="2753" href="Algebra.Solver.CommutativeMonoid.html#1577" class="Function">Env</a> <a id="2757" href="Algebra.Solver.CommutativeMonoid.html#2745" class="Bound">n</a><a id="2758" class="Symbol">)</a> <a id="2760" class="Symbol">→</a> <a id="2762" href="Algebra.Solver.CommutativeMonoid.html#2041" class="Function Operator">⟦</a> <a id="2764" href="Algebra.Solver.CommutativeMonoid.html#2280" class="Function">empty</a> <a id="2770" href="Algebra.Solver.CommutativeMonoid.html#2041" class="Function Operator">⟧⇓</a> <a id="2773" href="Algebra.Solver.CommutativeMonoid.html#2749" class="Bound">ρ</a> <a id="2775" href="Algebra.html#3116" class="Field Operator">≈</a> <a id="2777" href="Algebra.html#3194" class="Field">ε</a>
<a id="2779" href="Algebra.Solver.CommutativeMonoid.html#2727" class="Function">empty-correct</a> <a id="2793" href="Data.Vec.html#813" class="InductiveConstructor">[]</a> <a id="2796" class="Symbol">=</a> <a id="2798" href="Relation.Binary.Core.html#5808" class="Function">refl</a>
<a id="2803" href="Algebra.Solver.CommutativeMonoid.html#2727" class="Function">empty-correct</a> <a id="2817" class="Symbol">(</a><a id="2818" href="Algebra.Solver.CommutativeMonoid.html#2818" class="Bound">a</a> <a id="2820" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="2822" href="Algebra.Solver.CommutativeMonoid.html#2822" class="Bound">ρ</a><a id="2823" class="Symbol">)</a> <a id="2825" class="Symbol">=</a> <a id="2827" href="Algebra.Solver.CommutativeMonoid.html#2727" class="Function">empty-correct</a> <a id="2841" href="Algebra.Solver.CommutativeMonoid.html#2822" class="Bound">ρ</a>

<a id="2844" class="Comment">-- The singleton bag stands for a single variable.</a>

<a id="sg-correct"></a><a id="2896" href="Algebra.Solver.CommutativeMonoid.html#2896" class="Function">sg-correct</a> <a id="2907" class="Symbol">:</a> <a id="2909" class="Symbol">∀{</a><a id="2911" href="Algebra.Solver.CommutativeMonoid.html#2911" class="Bound">n</a><a id="2912" class="Symbol">}</a> <a id="2914" class="Symbol">(</a><a id="2915" href="Algebra.Solver.CommutativeMonoid.html#2915" class="Bound">x</a> <a id="2917" class="Symbol">:</a> <a id="2919" href="Data.Fin.Base.html#951" class="Datatype">Fin</a> <a id="2923" href="Algebra.Solver.CommutativeMonoid.html#2911" class="Bound">n</a><a id="2924" class="Symbol">)</a> <a id="2926" class="Symbol">(</a><a id="2927" href="Algebra.Solver.CommutativeMonoid.html#2927" class="Bound">ρ</a> <a id="2929" class="Symbol">:</a> <a id="2931" href="Algebra.Solver.CommutativeMonoid.html#1577" class="Function">Env</a> <a id="2935" href="Algebra.Solver.CommutativeMonoid.html#2911" class="Bound">n</a><a id="2936" class="Symbol">)</a> <a id="2938" class="Symbol">→</a>  <a id="2941" href="Algebra.Solver.CommutativeMonoid.html#2041" class="Function Operator">⟦</a> <a id="2943" href="Algebra.Solver.CommutativeMonoid.html#2346" class="Function">sg</a> <a id="2946" href="Algebra.Solver.CommutativeMonoid.html#2915" class="Bound">x</a> <a id="2948" href="Algebra.Solver.CommutativeMonoid.html#2041" class="Function Operator">⟧⇓</a> <a id="2951" href="Algebra.Solver.CommutativeMonoid.html#2927" class="Bound">ρ</a> <a id="2953" href="Algebra.html#3116" class="Field Operator">≈</a> <a id="2955" href="Data.Vec.html#1379" class="Function">lookup</a> <a id="2962" href="Algebra.Solver.CommutativeMonoid.html#2915" class="Bound">x</a> <a id="2964" href="Algebra.Solver.CommutativeMonoid.html#2927" class="Bound">ρ</a>
<a id="2966" href="Algebra.Solver.CommutativeMonoid.html#2896" class="Function">sg-correct</a> <a id="2977" href="Data.Fin.Base.html#973" class="InductiveConstructor">zero</a> <a id="2982" class="Symbol">(</a><a id="2983" href="Algebra.Solver.CommutativeMonoid.html#2983" class="Bound">x</a> <a id="2985" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="2987" href="Algebra.Solver.CommutativeMonoid.html#2987" class="Bound">ρ</a><a id="2988" class="Symbol">)</a> <a id="2990" class="Symbol">=</a> <a id="2992" href="Relation.Binary.Reasoning.Preorder.html#1266" class="Function Operator">begin</a>
    <a id="3002" href="Algebra.Solver.CommutativeMonoid.html#2983" class="Bound">x</a> <a id="3004" href="Algebra.html#3156" class="Field Operator">∙</a> <a id="3006" href="Algebra.Solver.CommutativeMonoid.html#2041" class="Function Operator">⟦</a> <a id="3008" href="Algebra.Solver.CommutativeMonoid.html#2280" class="Function">empty</a> <a id="3014" href="Algebra.Solver.CommutativeMonoid.html#2041" class="Function Operator">⟧⇓</a> <a id="3017" href="Algebra.Solver.CommutativeMonoid.html#2987" class="Bound">ρ</a>   <a id="3021" href="Relation.Binary.Reasoning.Preorder.html#1332" class="Function Operator">≈⟨</a> <a id="3024" href="Algebra.Structures.html#860" class="Function">∙-cong</a> <a id="3031" href="Relation.Binary.Core.html#5808" class="Function">refl</a> <a id="3036" class="Symbol">(</a><a id="3037" href="Algebra.Solver.CommutativeMonoid.html#2727" class="Function">empty-correct</a> <a id="3051" href="Algebra.Solver.CommutativeMonoid.html#2987" class="Bound">ρ</a><a id="3052" class="Symbol">)</a> <a id="3054" href="Relation.Binary.Reasoning.Preorder.html#1332" class="Function Operator">⟩</a>
    <a id="3060" href="Algebra.Solver.CommutativeMonoid.html#2983" class="Bound">x</a> <a id="3062" href="Algebra.html#3156" class="Field Operator">∙</a> <a id="3064" href="Algebra.html#3194" class="Field">ε</a>              <a id="3079" href="Relation.Binary.Reasoning.Preorder.html#1332" class="Function Operator">≈⟨</a> <a id="3082" href="Algebra.Structures.html#2190" class="Function">identityʳ</a> <a id="3092" class="Symbol">_</a> <a id="3094" href="Relation.Binary.Reasoning.Preorder.html#1332" class="Function Operator">⟩</a>
    <a id="3100" href="Algebra.Solver.CommutativeMonoid.html#2983" class="Bound">x</a>                  <a id="3119" href="Relation.Binary.Reasoning.Preorder.html#1719" class="Function Operator">∎</a>
<a id="3121" href="Algebra.Solver.CommutativeMonoid.html#2896" class="Function">sg-correct</a> <a id="3132" class="Symbol">(</a><a id="3133" href="Data.Fin.Base.html#1004" class="InductiveConstructor">suc</a> <a id="3137" href="Algebra.Solver.CommutativeMonoid.html#3137" class="Bound">x</a><a id="3138" class="Symbol">)</a> <a id="3140" class="Symbol">(</a><a id="3141" href="Algebra.Solver.CommutativeMonoid.html#3141" class="Bound">m</a> <a id="3143" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="3145" href="Algebra.Solver.CommutativeMonoid.html#3145" class="Bound">ρ</a><a id="3146" class="Symbol">)</a> <a id="3148" class="Symbol">=</a> <a id="3150" href="Algebra.Solver.CommutativeMonoid.html#2896" class="Function">sg-correct</a> <a id="3161" href="Algebra.Solver.CommutativeMonoid.html#3137" class="Bound">x</a> <a id="3163" href="Algebra.Solver.CommutativeMonoid.html#3145" class="Bound">ρ</a>

<a id="3166" class="Comment">-- Normal form composition corresponds to the composition of the monoid.</a>

<a id="comp-correct"></a><a id="3240" href="Algebra.Solver.CommutativeMonoid.html#3240" class="Function">comp-correct</a> <a id="3253" class="Symbol">:</a> <a id="3255" class="Symbol">∀</a> <a id="3257" class="Symbol">{</a><a id="3258" href="Algebra.Solver.CommutativeMonoid.html#3258" class="Bound">n</a><a id="3259" class="Symbol">}</a> <a id="3261" class="Symbol">(</a><a id="3262" href="Algebra.Solver.CommutativeMonoid.html#3262" class="Bound">v</a> <a id="3264" href="Algebra.Solver.CommutativeMonoid.html#3264" class="Bound">w</a> <a id="3266" class="Symbol">:</a> <a id="3268" href="Algebra.Solver.CommutativeMonoid.html#1968" class="Function">Normal</a> <a id="3275" href="Algebra.Solver.CommutativeMonoid.html#3258" class="Bound">n</a><a id="3276" class="Symbol">)</a> <a id="3278" class="Symbol">(</a><a id="3279" href="Algebra.Solver.CommutativeMonoid.html#3279" class="Bound">ρ</a> <a id="3281" class="Symbol">:</a> <a id="3283" href="Algebra.Solver.CommutativeMonoid.html#1577" class="Function">Env</a> <a id="3287" href="Algebra.Solver.CommutativeMonoid.html#3258" class="Bound">n</a><a id="3288" class="Symbol">)</a> <a id="3290" class="Symbol">→</a>
              <a id="3306" href="Algebra.Solver.CommutativeMonoid.html#2041" class="Function Operator">⟦</a> <a id="3308" href="Algebra.Solver.CommutativeMonoid.html#3262" class="Bound">v</a> <a id="3310" href="Algebra.Solver.CommutativeMonoid.html#2462" class="Function Operator">•</a> <a id="3312" href="Algebra.Solver.CommutativeMonoid.html#3264" class="Bound">w</a> <a id="3314" href="Algebra.Solver.CommutativeMonoid.html#2041" class="Function Operator">⟧⇓</a> <a id="3317" href="Algebra.Solver.CommutativeMonoid.html#3279" class="Bound">ρ</a> <a id="3319" href="Algebra.html#3116" class="Field Operator">≈</a> <a id="3321" class="Symbol">(</a><a id="3322" href="Algebra.Solver.CommutativeMonoid.html#2041" class="Function Operator">⟦</a> <a id="3324" href="Algebra.Solver.CommutativeMonoid.html#3262" class="Bound">v</a> <a id="3326" href="Algebra.Solver.CommutativeMonoid.html#2041" class="Function Operator">⟧⇓</a> <a id="3329" href="Algebra.Solver.CommutativeMonoid.html#3279" class="Bound">ρ</a> <a id="3331" href="Algebra.html#3156" class="Field Operator">∙</a> <a id="3333" href="Algebra.Solver.CommutativeMonoid.html#2041" class="Function Operator">⟦</a> <a id="3335" href="Algebra.Solver.CommutativeMonoid.html#3264" class="Bound">w</a> <a id="3337" href="Algebra.Solver.CommutativeMonoid.html#2041" class="Function Operator">⟧⇓</a> <a id="3340" href="Algebra.Solver.CommutativeMonoid.html#3279" class="Bound">ρ</a><a id="3341" class="Symbol">)</a>
<a id="3343" href="Algebra.Solver.CommutativeMonoid.html#3240" class="Function">comp-correct</a> <a id="3356" href="Data.Vec.html#813" class="InductiveConstructor">[]</a> <a id="3359" href="Data.Vec.html#813" class="InductiveConstructor">[]</a> <a id="3362" href="Algebra.Solver.CommutativeMonoid.html#3362" class="Bound">ρ</a> <a id="3364" class="Symbol">=</a>  <a id="3367" href="Relation.Binary.Core.html#5834" class="Function">sym</a> <a id="3371" class="Symbol">(</a><a id="3372" href="Algebra.Structures.html#2085" class="Function">identityˡ</a> <a id="3382" class="Symbol">_)</a>
<a id="3385" href="Algebra.Solver.CommutativeMonoid.html#3240" class="Function">comp-correct</a> <a id="3398" class="Symbol">(</a><a id="3399" href="Algebra.Solver.CommutativeMonoid.html#3399" class="Bound">l</a> <a id="3401" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="3403" href="Algebra.Solver.CommutativeMonoid.html#3403" class="Bound">v</a><a id="3404" class="Symbol">)</a> <a id="3406" class="Symbol">(</a><a id="3407" href="Algebra.Solver.CommutativeMonoid.html#3407" class="Bound">m</a> <a id="3409" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="3411" href="Algebra.Solver.CommutativeMonoid.html#3411" class="Bound">w</a><a id="3412" class="Symbol">)</a> <a id="3414" class="Symbol">(</a><a id="3415" href="Algebra.Solver.CommutativeMonoid.html#3415" class="Bound">a</a> <a id="3417" href="Data.Vec.html#832" class="InductiveConstructor Operator">∷</a> <a id="3419" href="Algebra.Solver.CommutativeMonoid.html#3419" class="Bound">ρ</a><a id="3420" class="Symbol">)</a> <a id="3422" class="Symbol">=</a> <a id="3424" href="Algebra.Solver.CommutativeMonoid.html#3695" class="Function">lemma</a> <a id="3430" href="Algebra.Solver.CommutativeMonoid.html#3399" class="Bound">l</a> <a id="3432" href="Algebra.Solver.CommutativeMonoid.html#3407" class="Bound">m</a> <a id="3434" class="Symbol">(</a><a id="3435" href="Algebra.Solver.CommutativeMonoid.html#3240" class="Function">comp-correct</a> <a id="3448" href="Algebra.Solver.CommutativeMonoid.html#3403" class="Bound">v</a> <a id="3450" href="Algebra.Solver.CommutativeMonoid.html#3411" class="Bound">w</a> <a id="3452" href="Algebra.Solver.CommutativeMonoid.html#3419" class="Bound">ρ</a><a id="3453" class="Symbol">)</a>
  <a id="3457" class="Keyword">where</a>
    <a id="3467" href="Algebra.Solver.CommutativeMonoid.html#3467" class="Function">flip12</a> <a id="3474" class="Symbol">:</a> <a id="3476" class="Symbol">∀</a> <a id="3478" href="Algebra.Solver.CommutativeMonoid.html#3478" class="Bound">a</a> <a id="3480" href="Algebra.Solver.CommutativeMonoid.html#3480" class="Bound">b</a> <a id="3482" href="Algebra.Solver.CommutativeMonoid.html#3482" class="Bound">c</a> <a id="3484" class="Symbol">→</a> <a id="3486" href="Algebra.Solver.CommutativeMonoid.html#3478" class="Bound">a</a> <a id="3488" href="Algebra.html#3156" class="Field Operator">∙</a> <a id="3490" class="Symbol">(</a><a id="3491" href="Algebra.Solver.CommutativeMonoid.html#3480" class="Bound">b</a> <a id="3493" href="Algebra.html#3156" class="Field Operator">∙</a> <a id="3495" href="Algebra.Solver.CommutativeMonoid.html#3482" class="Bound">c</a><a id="3496" class="Symbol">)</a> <a id="3498" href="Algebra.html#3116" class="Field Operator">≈</a> <a id="3500" href="Algebra.Solver.CommutativeMonoid.html#3480" class="Bound">b</a> <a id="3502" href="Algebra.html#3156" class="Field Operator">∙</a> <a id="3504" class="Symbol">(</a><a id="3505" href="Algebra.Solver.CommutativeMonoid.html#3478" class="Bound">a</a> <a id="3507" href="Algebra.html#3156" class="Field Operator">∙</a> <a id="3509" href="Algebra.Solver.CommutativeMonoid.html#3482" class="Bound">c</a><a id="3510" class="Symbol">)</a>
    <a id="3516" href="Algebra.Solver.CommutativeMonoid.html#3467" class="Function">flip12</a> <a id="3523" href="Algebra.Solver.CommutativeMonoid.html#3523" class="Bound">a</a> <a id="3525" href="Algebra.Solver.CommutativeMonoid.html#3525" class="Bound">b</a> <a id="3527" href="Algebra.Solver.CommutativeMonoid.html#3527" class="Bound">c</a> <a id="3529" class="Symbol">=</a> <a id="3531" href="Relation.Binary.Reasoning.Preorder.html#1266" class="Function Operator">begin</a>
        <a id="3545" href="Algebra.Solver.CommutativeMonoid.html#3523" class="Bound">a</a> <a id="3547" href="Algebra.html#3156" class="Field Operator">∙</a> <a id="3549" class="Symbol">(</a><a id="3550" href="Algebra.Solver.CommutativeMonoid.html#3525" class="Bound">b</a> <a id="3552" href="Algebra.html#3156" class="Field Operator">∙</a> <a id="3554" href="Algebra.Solver.CommutativeMonoid.html#3527" class="Bound">c</a><a id="3555" class="Symbol">)</a>  <a id="3558" href="Relation.Binary.Reasoning.Preorder.html#1332" class="Function Operator">≈⟨</a> <a id="3561" href="Relation.Binary.Core.html#5834" class="Function">sym</a> <a id="3565" class="Symbol">(</a><a id="3566" href="Algebra.Structures.html#1218" class="Function">assoc</a> <a id="3572" class="Symbol">_</a> <a id="3574" class="Symbol">_</a> <a id="3576" class="Symbol">_)</a> <a id="3579" href="Relation.Binary.Reasoning.Preorder.html#1332" class="Function Operator">⟩</a>
        <a id="3589" class="Symbol">(</a><a id="3590" href="Algebra.Solver.CommutativeMonoid.html#3523" class="Bound">a</a> <a id="3592" href="Algebra.html#3156" class="Field Operator">∙</a> <a id="3594" href="Algebra.Solver.CommutativeMonoid.html#3525" class="Bound">b</a><a id="3595" class="Symbol">)</a> <a id="3597" href="Algebra.html#3156" class="Field Operator">∙</a> <a id="3599" href="Algebra.Solver.CommutativeMonoid.html#3527" class="Bound">c</a>  <a id="3602" href="Relation.Binary.Reasoning.Preorder.html#1332" class="Function Operator">≈⟨</a> <a id="3605" href="Algebra.Structures.html#860" class="Function">∙-cong</a> <a id="3612" class="Symbol">(</a><a id="3613" href="Algebra.Structures.html#2120" class="Function">comm</a> <a id="3618" class="Symbol">_</a> <a id="3620" class="Symbol">_)</a> <a id="3623" href="Relation.Binary.Core.html#5808" class="Function">refl</a> <a id="3628" href="Relation.Binary.Reasoning.Preorder.html#1332" class="Function Operator">⟩</a>
        <a id="3638" class="Symbol">(</a><a id="3639" href="Algebra.Solver.CommutativeMonoid.html#3525" class="Bound">b</a> <a id="3641" href="Algebra.html#3156" class="Field Operator">∙</a> <a id="3643" href="Algebra.Solver.CommutativeMonoid.html#3523" class="Bound">a</a><a id="3644" class="Symbol">)</a> <a id="3646" href="Algebra.html#3156" class="Field Operator">∙</a> <a id="3648" href="Algebra.Solver.CommutativeMonoid.html#3527" class="Bound">c</a>  <a id="3651" href="Relation.Binary.Reasoning.Preorder.html#1332" class="Function Operator">≈⟨</a> <a id="3654" href="Algebra.Structures.html#1218" class="Function">assoc</a> <a id="3660" class="Symbol">_</a> <a id="3662" class="Symbol">_</a> <a id="3664" class="Symbol">_</a> <a id="3666" href="Relation.Binary.Reasoning.Preorder.html#1332" class="Function Operator">⟩</a>
        <a id="3676" href="Algebra.Solver.CommutativeMonoid.html#3525" class="Bound">b</a> <a id="3678" href="Algebra.html#3156" class="Field Operator">∙</a> <a id="3680" class="Symbol">(</a><a id="3681" href="Algebra.Solver.CommutativeMonoid.html#3523" class="Bound">a</a> <a id="3683" href="Algebra.html#3156" class="Field Operator">∙</a> <a id="3685" href="Algebra.Solver.CommutativeMonoid.html#3527" class="Bound">c</a><a id="3686" class="Symbol">)</a>  <a id="3689" href="Relation.Binary.Reasoning.Preorder.html#1719" class="Function Operator">∎</a>
    <a id="3695" href="Algebra.Solver.CommutativeMonoid.html#3695" class="Function">lemma</a> <a id="3701" class="Symbol">:</a> <a id="3703" class="Symbol">∀</a> <a id="3705" href="Algebra.Solver.CommutativeMonoid.html#3705" class="Bound">l</a> <a id="3707" href="Algebra.Solver.CommutativeMonoid.html#3707" class="Bound">m</a> <a id="3709" class="Symbol">{</a><a id="3710" href="Algebra.Solver.CommutativeMonoid.html#3710" class="Bound">d</a> <a id="3712" href="Algebra.Solver.CommutativeMonoid.html#3712" class="Bound">b</a> <a id="3714" href="Algebra.Solver.CommutativeMonoid.html#3714" class="Bound">c</a><a id="3715" class="Symbol">}</a> <a id="3717" class="Symbol">(</a><a id="3718" href="Algebra.Solver.CommutativeMonoid.html#3718" class="Bound">p</a> <a id="3720" class="Symbol">:</a> <a id="3722" href="Algebra.Solver.CommutativeMonoid.html#3710" class="Bound">d</a> <a id="3724" href="Algebra.html#3116" class="Field Operator">≈</a> <a id="3726" href="Algebra.Solver.CommutativeMonoid.html#3712" class="Bound">b</a> <a id="3728" href="Algebra.html#3156" class="Field Operator">∙</a> <a id="3730" href="Algebra.Solver.CommutativeMonoid.html#3714" class="Bound">c</a><a id="3731" class="Symbol">)</a> <a id="3733" class="Symbol">→</a>
      <a id="3741" href="Data.Nat.GeneralisedArithmetic.html#508" class="Function">fold</a> <a id="3746" href="Algebra.Solver.CommutativeMonoid.html#3710" class="Bound">d</a> <a id="3748" class="Symbol">(</a><a id="3749" href="Algebra.Solver.CommutativeMonoid.html#3415" class="Bound">a</a> <a id="3751" href="Algebra.html#3156" class="Field Operator">∙_</a><a id="3753" class="Symbol">)</a> <a id="3755" class="Symbol">(</a><a id="3756" href="Algebra.Solver.CommutativeMonoid.html#3705" class="Bound">l</a> <a id="3758" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">+</a> <a id="3760" href="Algebra.Solver.CommutativeMonoid.html#3707" class="Bound">m</a><a id="3761" class="Symbol">)</a> <a id="3763" href="Algebra.html#3116" class="Field Operator">≈</a> <a id="3765" href="Data.Nat.GeneralisedArithmetic.html#508" class="Function">fold</a> <a id="3770" href="Algebra.Solver.CommutativeMonoid.html#3712" class="Bound">b</a> <a id="3772" class="Symbol">(</a><a id="3773" href="Algebra.Solver.CommutativeMonoid.html#3415" class="Bound">a</a> <a id="3775" href="Algebra.html#3156" class="Field Operator">∙_</a><a id="3777" class="Symbol">)</a> <a id="3779" href="Algebra.Solver.CommutativeMonoid.html#3705" class="Bound">l</a> <a id="3781" href="Algebra.html#3156" class="Field Operator">∙</a> <a id="3783" href="Data.Nat.GeneralisedArithmetic.html#508" class="Function">fold</a> <a id="3788" href="Algebra.Solver.CommutativeMonoid.html#3714" class="Bound">c</a> <a id="3790" class="Symbol">(</a><a id="3791" href="Algebra.Solver.CommutativeMonoid.html#3415" class="Bound">a</a> <a id="3793" href="Algebra.html#3156" class="Field Operator">∙_</a><a id="3795" class="Symbol">)</a> <a id="3797" href="Algebra.Solver.CommutativeMonoid.html#3707" class="Bound">m</a>
    <a id="3803" href="Algebra.Solver.CommutativeMonoid.html#3695" class="Function">lemma</a> <a id="3809" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a> <a id="3814" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a> <a id="3819" href="Algebra.Solver.CommutativeMonoid.html#3819" class="Bound">p</a> <a id="3821" class="Symbol">=</a> <a id="3823" href="Algebra.Solver.CommutativeMonoid.html#3819" class="Bound">p</a>
    <a id="3829" href="Algebra.Solver.CommutativeMonoid.html#3695" class="Function">lemma</a> <a id="3835" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a> <a id="3840" class="Symbol">(</a><a id="3841" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="3845" href="Algebra.Solver.CommutativeMonoid.html#3845" class="Bound">m</a><a id="3846" class="Symbol">)</a> <a id="3848" href="Algebra.Solver.CommutativeMonoid.html#3848" class="Bound">p</a> <a id="3850" class="Symbol">=</a> <a id="3852" href="Relation.Binary.Core.html#5860" class="Function">trans</a> <a id="3858" class="Symbol">(</a><a id="3859" href="Algebra.Structures.html#860" class="Function">∙-cong</a> <a id="3866" href="Relation.Binary.Core.html#5808" class="Function">refl</a> <a id="3871" class="Symbol">(</a><a id="3872" href="Algebra.Solver.CommutativeMonoid.html#3695" class="Function">lemma</a> <a id="3878" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a> <a id="3883" href="Algebra.Solver.CommutativeMonoid.html#3845" class="Bound">m</a> <a id="3885" href="Algebra.Solver.CommutativeMonoid.html#3848" class="Bound">p</a><a id="3886" class="Symbol">))</a> <a id="3889" class="Symbol">(</a><a id="3890" href="Algebra.Solver.CommutativeMonoid.html#3467" class="Function">flip12</a> <a id="3897" class="Symbol">_</a> <a id="3899" class="Symbol">_</a> <a id="3901" class="Symbol">_)</a>
    <a id="3908" href="Algebra.Solver.CommutativeMonoid.html#3695" class="Function">lemma</a> <a id="3914" class="Symbol">(</a><a id="3915" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="3919" href="Algebra.Solver.CommutativeMonoid.html#3919" class="Bound">l</a><a id="3920" class="Symbol">)</a> <a id="3922" href="Algebra.Solver.CommutativeMonoid.html#3922" class="Bound">m</a> <a id="3924" href="Algebra.Solver.CommutativeMonoid.html#3924" class="Bound">p</a> <a id="3926" class="Symbol">=</a> <a id="3928" href="Relation.Binary.Core.html#5860" class="Function">trans</a> <a id="3934" class="Symbol">(</a><a id="3935" href="Algebra.Structures.html#860" class="Function">∙-cong</a> <a id="3942" href="Relation.Binary.Core.html#5808" class="Function">refl</a> <a id="3947" class="Symbol">(</a><a id="3948" href="Algebra.Solver.CommutativeMonoid.html#3695" class="Function">lemma</a> <a id="3954" href="Algebra.Solver.CommutativeMonoid.html#3919" class="Bound">l</a> <a id="3956" href="Algebra.Solver.CommutativeMonoid.html#3922" class="Bound">m</a> <a id="3958" href="Algebra.Solver.CommutativeMonoid.html#3924" class="Bound">p</a><a id="3959" class="Symbol">))</a> <a id="3962" class="Symbol">(</a><a id="3963" href="Relation.Binary.Core.html#5834" class="Function">sym</a> <a id="3967" class="Symbol">(</a><a id="3968" href="Algebra.Structures.html#1218" class="Function">assoc</a> <a id="3974" href="Algebra.Solver.CommutativeMonoid.html#3415" class="Bound">a</a> <a id="3976" class="Symbol">_</a> <a id="3978" class="Symbol">_))</a>

<a id="3983" class="Comment">------------------------------------------------------------------------</a>
<a id="4056" class="Comment">-- Normalization</a>

<a id="4074" class="Comment">-- A normaliser.</a>

<a id="normalise"></a><a id="4092" href="Algebra.Solver.CommutativeMonoid.html#4092" class="Function">normalise</a> <a id="4102" class="Symbol">:</a> <a id="4104" class="Symbol">∀</a> <a id="4106" class="Symbol">{</a><a id="4107" href="Algebra.Solver.CommutativeMonoid.html#4107" class="Bound">n</a><a id="4108" class="Symbol">}</a> <a id="4110" class="Symbol">→</a> <a id="4112" href="Algebra.Solver.CommutativeMonoid.html#1422" class="Datatype">Expr</a> <a id="4117" href="Algebra.Solver.CommutativeMonoid.html#4107" class="Bound">n</a> <a id="4119" class="Symbol">→</a> <a id="4121" href="Algebra.Solver.CommutativeMonoid.html#1968" class="Function">Normal</a> <a id="4128" href="Algebra.Solver.CommutativeMonoid.html#4107" class="Bound">n</a>
<a id="4130" href="Algebra.Solver.CommutativeMonoid.html#4092" class="Function">normalise</a> <a id="4140" class="Symbol">(</a><a id="4141" href="Algebra.Solver.CommutativeMonoid.html#1449" class="InductiveConstructor">var</a> <a id="4145" href="Algebra.Solver.CommutativeMonoid.html#4145" class="Bound">x</a><a id="4146" class="Symbol">)</a>   <a id="4150" class="Symbol">=</a> <a id="4152" href="Algebra.Solver.CommutativeMonoid.html#2346" class="Function">sg</a> <a id="4155" href="Algebra.Solver.CommutativeMonoid.html#4145" class="Bound">x</a>
<a id="4157" href="Algebra.Solver.CommutativeMonoid.html#4092" class="Function">normalise</a> <a id="4167" href="Algebra.Solver.CommutativeMonoid.html#1472" class="InductiveConstructor">id</a>        <a id="4177" class="Symbol">=</a> <a id="4179" href="Algebra.Solver.CommutativeMonoid.html#2280" class="Function">empty</a>
<a id="4185" href="Algebra.Solver.CommutativeMonoid.html#4092" class="Function">normalise</a> <a id="4195" class="Symbol">(</a><a id="4196" href="Algebra.Solver.CommutativeMonoid.html#4196" class="Bound">e₁</a> <a id="4199" href="Algebra.Solver.CommutativeMonoid.html#1487" class="InductiveConstructor Operator">⊕</a> <a id="4201" href="Algebra.Solver.CommutativeMonoid.html#4201" class="Bound">e₂</a><a id="4203" class="Symbol">)</a> <a id="4205" class="Symbol">=</a> <a id="4207" href="Algebra.Solver.CommutativeMonoid.html#4092" class="Function">normalise</a> <a id="4217" href="Algebra.Solver.CommutativeMonoid.html#4196" class="Bound">e₁</a> <a id="4220" href="Algebra.Solver.CommutativeMonoid.html#2462" class="Function Operator">•</a> <a id="4222" href="Algebra.Solver.CommutativeMonoid.html#4092" class="Function">normalise</a> <a id="4232" href="Algebra.Solver.CommutativeMonoid.html#4201" class="Bound">e₂</a>

<a id="4236" class="Comment">-- The normaliser preserves the semantics of the expression.</a>

<a id="normalise-correct"></a><a id="4298" href="Algebra.Solver.CommutativeMonoid.html#4298" class="Function">normalise-correct</a> <a id="4316" class="Symbol">:</a> <a id="4318" class="Symbol">∀</a> <a id="4320" class="Symbol">{</a><a id="4321" href="Algebra.Solver.CommutativeMonoid.html#4321" class="Bound">n</a><a id="4322" class="Symbol">}</a> <a id="4324" class="Symbol">(</a><a id="4325" href="Algebra.Solver.CommutativeMonoid.html#4325" class="Bound">e</a> <a id="4327" class="Symbol">:</a> <a id="4329" href="Algebra.Solver.CommutativeMonoid.html#1422" class="Datatype">Expr</a> <a id="4334" href="Algebra.Solver.CommutativeMonoid.html#4321" class="Bound">n</a><a id="4335" class="Symbol">)</a> <a id="4337" class="Symbol">(</a><a id="4338" href="Algebra.Solver.CommutativeMonoid.html#4338" class="Bound">ρ</a> <a id="4340" class="Symbol">:</a> <a id="4342" href="Algebra.Solver.CommutativeMonoid.html#1577" class="Function">Env</a> <a id="4346" href="Algebra.Solver.CommutativeMonoid.html#4321" class="Bound">n</a><a id="4347" class="Symbol">)</a> <a id="4349" class="Symbol">→</a>
    <a id="4355" href="Algebra.Solver.CommutativeMonoid.html#2041" class="Function Operator">⟦</a> <a id="4357" href="Algebra.Solver.CommutativeMonoid.html#4092" class="Function">normalise</a> <a id="4367" href="Algebra.Solver.CommutativeMonoid.html#4325" class="Bound">e</a> <a id="4369" href="Algebra.Solver.CommutativeMonoid.html#2041" class="Function Operator">⟧⇓</a> <a id="4372" href="Algebra.Solver.CommutativeMonoid.html#4338" class="Bound">ρ</a> <a id="4374" href="Algebra.html#3116" class="Field Operator">≈</a> <a id="4376" href="Algebra.Solver.CommutativeMonoid.html#1700" class="Function Operator">⟦</a> <a id="4378" href="Algebra.Solver.CommutativeMonoid.html#4325" class="Bound">e</a> <a id="4380" href="Algebra.Solver.CommutativeMonoid.html#1700" class="Function Operator">⟧</a> <a id="4382" href="Algebra.Solver.CommutativeMonoid.html#4338" class="Bound">ρ</a>
<a id="4384" href="Algebra.Solver.CommutativeMonoid.html#4298" class="Function">normalise-correct</a> <a id="4402" class="Symbol">(</a><a id="4403" href="Algebra.Solver.CommutativeMonoid.html#1449" class="InductiveConstructor">var</a> <a id="4407" href="Algebra.Solver.CommutativeMonoid.html#4407" class="Bound">x</a><a id="4408" class="Symbol">)</a>   <a id="4412" href="Algebra.Solver.CommutativeMonoid.html#4412" class="Bound">ρ</a> <a id="4414" class="Symbol">=</a> <a id="4416" href="Algebra.Solver.CommutativeMonoid.html#2896" class="Function">sg-correct</a> <a id="4427" href="Algebra.Solver.CommutativeMonoid.html#4407" class="Bound">x</a> <a id="4429" href="Algebra.Solver.CommutativeMonoid.html#4412" class="Bound">ρ</a>
<a id="4431" href="Algebra.Solver.CommutativeMonoid.html#4298" class="Function">normalise-correct</a> <a id="4449" href="Algebra.Solver.CommutativeMonoid.html#1472" class="InductiveConstructor">id</a>        <a id="4459" href="Algebra.Solver.CommutativeMonoid.html#4459" class="Bound">ρ</a> <a id="4461" class="Symbol">=</a> <a id="4463" href="Algebra.Solver.CommutativeMonoid.html#2727" class="Function">empty-correct</a> <a id="4477" href="Algebra.Solver.CommutativeMonoid.html#4459" class="Bound">ρ</a>
<a id="4479" href="Algebra.Solver.CommutativeMonoid.html#4298" class="Function">normalise-correct</a> <a id="4497" class="Symbol">(</a><a id="4498" href="Algebra.Solver.CommutativeMonoid.html#4498" class="Bound">e₁</a> <a id="4501" href="Algebra.Solver.CommutativeMonoid.html#1487" class="InductiveConstructor Operator">⊕</a> <a id="4503" href="Algebra.Solver.CommutativeMonoid.html#4503" class="Bound">e₂</a><a id="4505" class="Symbol">)</a> <a id="4507" href="Algebra.Solver.CommutativeMonoid.html#4507" class="Bound">ρ</a> <a id="4509" class="Symbol">=</a>  <a id="4512" href="Relation.Binary.Reasoning.Preorder.html#1266" class="Function Operator">begin</a>

    <a id="4523" href="Algebra.Solver.CommutativeMonoid.html#2041" class="Function Operator">⟦</a> <a id="4525" href="Algebra.Solver.CommutativeMonoid.html#4092" class="Function">normalise</a> <a id="4535" href="Algebra.Solver.CommutativeMonoid.html#4498" class="Bound">e₁</a> <a id="4538" href="Algebra.Solver.CommutativeMonoid.html#2462" class="Function Operator">•</a> <a id="4540" href="Algebra.Solver.CommutativeMonoid.html#4092" class="Function">normalise</a> <a id="4550" href="Algebra.Solver.CommutativeMonoid.html#4503" class="Bound">e₂</a> <a id="4553" href="Algebra.Solver.CommutativeMonoid.html#2041" class="Function Operator">⟧⇓</a> <a id="4556" href="Algebra.Solver.CommutativeMonoid.html#4507" class="Bound">ρ</a>

  <a id="4561" href="Relation.Binary.Reasoning.Preorder.html#1332" class="Function Operator">≈⟨</a> <a id="4564" href="Algebra.Solver.CommutativeMonoid.html#3240" class="Function">comp-correct</a> <a id="4577" class="Symbol">(</a><a id="4578" href="Algebra.Solver.CommutativeMonoid.html#4092" class="Function">normalise</a> <a id="4588" href="Algebra.Solver.CommutativeMonoid.html#4498" class="Bound">e₁</a><a id="4590" class="Symbol">)</a> <a id="4592" class="Symbol">(</a><a id="4593" href="Algebra.Solver.CommutativeMonoid.html#4092" class="Function">normalise</a> <a id="4603" href="Algebra.Solver.CommutativeMonoid.html#4503" class="Bound">e₂</a><a id="4605" class="Symbol">)</a> <a id="4607" href="Algebra.Solver.CommutativeMonoid.html#4507" class="Bound">ρ</a> <a id="4609" href="Relation.Binary.Reasoning.Preorder.html#1332" class="Function Operator">⟩</a>

    <a id="4616" href="Algebra.Solver.CommutativeMonoid.html#2041" class="Function Operator">⟦</a> <a id="4618" href="Algebra.Solver.CommutativeMonoid.html#4092" class="Function">normalise</a> <a id="4628" href="Algebra.Solver.CommutativeMonoid.html#4498" class="Bound">e₁</a> <a id="4631" href="Algebra.Solver.CommutativeMonoid.html#2041" class="Function Operator">⟧⇓</a> <a id="4634" href="Algebra.Solver.CommutativeMonoid.html#4507" class="Bound">ρ</a> <a id="4636" href="Algebra.html#3156" class="Field Operator">∙</a> <a id="4638" href="Algebra.Solver.CommutativeMonoid.html#2041" class="Function Operator">⟦</a> <a id="4640" href="Algebra.Solver.CommutativeMonoid.html#4092" class="Function">normalise</a> <a id="4650" href="Algebra.Solver.CommutativeMonoid.html#4503" class="Bound">e₂</a> <a id="4653" href="Algebra.Solver.CommutativeMonoid.html#2041" class="Function Operator">⟧⇓</a> <a id="4656" href="Algebra.Solver.CommutativeMonoid.html#4507" class="Bound">ρ</a>

  <a id="4661" href="Relation.Binary.Reasoning.Preorder.html#1332" class="Function Operator">≈⟨</a> <a id="4664" href="Algebra.Structures.html#860" class="Function">∙-cong</a> <a id="4671" class="Symbol">(</a><a id="4672" href="Algebra.Solver.CommutativeMonoid.html#4298" class="Function">normalise-correct</a> <a id="4690" href="Algebra.Solver.CommutativeMonoid.html#4498" class="Bound">e₁</a> <a id="4693" href="Algebra.Solver.CommutativeMonoid.html#4507" class="Bound">ρ</a><a id="4694" class="Symbol">)</a> <a id="4696" class="Symbol">(</a><a id="4697" href="Algebra.Solver.CommutativeMonoid.html#4298" class="Function">normalise-correct</a> <a id="4715" href="Algebra.Solver.CommutativeMonoid.html#4503" class="Bound">e₂</a> <a id="4718" href="Algebra.Solver.CommutativeMonoid.html#4507" class="Bound">ρ</a><a id="4719" class="Symbol">)</a> <a id="4721" href="Relation.Binary.Reasoning.Preorder.html#1332" class="Function Operator">⟩</a>

    <a id="4728" href="Algebra.Solver.CommutativeMonoid.html#1700" class="Function Operator">⟦</a> <a id="4730" href="Algebra.Solver.CommutativeMonoid.html#4498" class="Bound">e₁</a> <a id="4733" href="Algebra.Solver.CommutativeMonoid.html#1700" class="Function Operator">⟧</a> <a id="4735" href="Algebra.Solver.CommutativeMonoid.html#4507" class="Bound">ρ</a> <a id="4737" href="Algebra.html#3156" class="Field Operator">∙</a> <a id="4739" href="Algebra.Solver.CommutativeMonoid.html#1700" class="Function Operator">⟦</a> <a id="4741" href="Algebra.Solver.CommutativeMonoid.html#4503" class="Bound">e₂</a> <a id="4744" href="Algebra.Solver.CommutativeMonoid.html#1700" class="Function Operator">⟧</a> <a id="4746" href="Algebra.Solver.CommutativeMonoid.html#4507" class="Bound">ρ</a>
  <a id="4750" href="Relation.Binary.Reasoning.Preorder.html#1719" class="Function Operator">∎</a>

<a id="4753" class="Comment">------------------------------------------------------------------------</a>
<a id="4826" class="Comment">-- &quot;Tactics&quot;</a>

<a id="4840" class="Keyword">open</a> <a id="4845" class="Keyword">module</a> <a id="R"></a><a id="4852" href="Algebra.Solver.CommutativeMonoid.html#4852" class="Module">R</a> <a id="4854" class="Symbol">=</a> <a id="4856" href="Relation.Binary.Reflection.html" class="Module">Reflection</a>
                  <a id="4885" href="Algebra.Structures.html#935" class="Function">setoid</a> <a id="4892" href="Algebra.Solver.CommutativeMonoid.html#1449" class="InductiveConstructor">var</a> <a id="4896" href="Algebra.Solver.CommutativeMonoid.html#1700" class="Function Operator">⟦_⟧</a> <a id="4900" class="Symbol">(</a><a id="4901" href="Algebra.Solver.CommutativeMonoid.html#2041" class="Function Operator">⟦_⟧⇓</a> <a id="4906" href="Function.html#805" class="Function Operator">∘</a> <a id="4908" href="Algebra.Solver.CommutativeMonoid.html#4092" class="Function">normalise</a><a id="4917" class="Symbol">)</a> <a id="4919" href="Algebra.Solver.CommutativeMonoid.html#4298" class="Function">normalise-correct</a>
  <a id="4939" class="Keyword">public</a> <a id="4946" class="Keyword">using</a> <a id="4952" class="Symbol">(</a><a id="4953" href="Relation.Binary.Reflection.html#2423" class="Function">solve</a><a id="4958" class="Symbol">;</a> <a id="4960" href="Relation.Binary.Reflection.html#3532" class="Function Operator">_⊜_</a><a id="4963" class="Symbol">)</a>

<a id="4966" class="Comment">-- We can decide if two normal forms are /syntactically/ equal.</a>

<a id="5031" class="Keyword">infix</a> <a id="5037" class="Number">5</a> <a id="5039" href="Algebra.Solver.CommutativeMonoid.html#5044" class="Function Operator">_≟_</a>

<a id="_≟_"></a><a id="5044" href="Algebra.Solver.CommutativeMonoid.html#5044" class="Function Operator">_≟_</a> <a id="5048" class="Symbol">:</a> <a id="5050" class="Symbol">∀</a> <a id="5052" class="Symbol">{</a><a id="5053" href="Algebra.Solver.CommutativeMonoid.html#5053" class="Bound">n</a><a id="5054" class="Symbol">}</a> <a id="5056" class="Symbol">(</a><a id="5057" href="Algebra.Solver.CommutativeMonoid.html#5057" class="Bound">nf₁</a> <a id="5061" href="Algebra.Solver.CommutativeMonoid.html#5061" class="Bound">nf₂</a> <a id="5065" class="Symbol">:</a> <a id="5067" href="Algebra.Solver.CommutativeMonoid.html#1968" class="Function">Normal</a> <a id="5074" href="Algebra.Solver.CommutativeMonoid.html#5053" class="Bound">n</a><a id="5075" class="Symbol">)</a> <a id="5077" class="Symbol">→</a> <a id="5079" href="Relation.Nullary.html#570" class="Datatype">Dec</a> <a id="5083" class="Symbol">(</a><a id="5084" href="Algebra.Solver.CommutativeMonoid.html#5057" class="Bound">nf₁</a> <a id="5088" href="Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="5090" href="Algebra.Solver.CommutativeMonoid.html#5061" class="Bound">nf₂</a><a id="5093" class="Symbol">)</a>
<a id="5095" href="Algebra.Solver.CommutativeMonoid.html#5095" class="Bound">nf₁</a> <a id="5099" href="Algebra.Solver.CommutativeMonoid.html#5044" class="Function Operator">≟</a> <a id="5101" href="Algebra.Solver.CommutativeMonoid.html#5101" class="Bound">nf₂</a> <a id="5105" class="Symbol">=</a> <a id="5107" href="Relation.Nullary.Decidable.html#1668" class="Function">Dec.map</a> <a id="5115" href="Data.Vec.Relation.Pointwise.Inductive.html#9108" class="Function">Pointwise-≡↔≡</a> <a id="5129" class="Symbol">(</a><a id="5130" href="Data.Vec.Relation.Pointwise.Inductive.html#3202" class="Function">decidable</a> <a id="5140" href="Data.Nat.Properties.html#1383" class="Function Operator">ℕ._≟_</a> <a id="5146" href="Algebra.Solver.CommutativeMonoid.html#5095" class="Bound">nf₁</a> <a id="5150" href="Algebra.Solver.CommutativeMonoid.html#5101" class="Bound">nf₂</a><a id="5153" class="Symbol">)</a>
  <a id="5157" class="Keyword">where</a> <a id="5163" class="Keyword">open</a> <a id="5168" href="Data.Vec.Relation.Pointwise.Inductive.html" class="Module">Pointwise</a>

<a id="5179" class="Comment">-- We can also give a sound, but not necessarily complete, procedure</a>
<a id="5248" class="Comment">-- for determining if two expressions have the same semantics.</a>

<a id="prove′"></a><a id="5312" href="Algebra.Solver.CommutativeMonoid.html#5312" class="Function">prove′</a> <a id="5319" class="Symbol">:</a> <a id="5321" class="Symbol">∀</a> <a id="5323" class="Symbol">{</a><a id="5324" href="Algebra.Solver.CommutativeMonoid.html#5324" class="Bound">n</a><a id="5325" class="Symbol">}</a> <a id="5327" class="Symbol">(</a><a id="5328" href="Algebra.Solver.CommutativeMonoid.html#5328" class="Bound">e₁</a> <a id="5331" href="Algebra.Solver.CommutativeMonoid.html#5331" class="Bound">e₂</a> <a id="5334" class="Symbol">:</a> <a id="5336" href="Algebra.Solver.CommutativeMonoid.html#1422" class="Datatype">Expr</a> <a id="5341" href="Algebra.Solver.CommutativeMonoid.html#5324" class="Bound">n</a><a id="5342" class="Symbol">)</a> <a id="5344" class="Symbol">→</a> <a id="5346" href="Data.Maybe.Base.html#710" class="Datatype">Maybe</a> <a id="5352" class="Symbol">(∀</a> <a id="5355" href="Algebra.Solver.CommutativeMonoid.html#5355" class="Bound">ρ</a> <a id="5357" class="Symbol">→</a> <a id="5359" href="Algebra.Solver.CommutativeMonoid.html#1700" class="Function Operator">⟦</a> <a id="5361" href="Algebra.Solver.CommutativeMonoid.html#5328" class="Bound">e₁</a> <a id="5364" href="Algebra.Solver.CommutativeMonoid.html#1700" class="Function Operator">⟧</a> <a id="5366" href="Algebra.Solver.CommutativeMonoid.html#5355" class="Bound">ρ</a> <a id="5368" href="Algebra.html#3116" class="Field Operator">≈</a> <a id="5370" href="Algebra.Solver.CommutativeMonoid.html#1700" class="Function Operator">⟦</a> <a id="5372" href="Algebra.Solver.CommutativeMonoid.html#5331" class="Bound">e₂</a> <a id="5375" href="Algebra.Solver.CommutativeMonoid.html#1700" class="Function Operator">⟧</a> <a id="5377" href="Algebra.Solver.CommutativeMonoid.html#5355" class="Bound">ρ</a><a id="5378" class="Symbol">)</a>
<a id="5380" href="Algebra.Solver.CommutativeMonoid.html#5312" class="Function">prove′</a> <a id="5387" href="Algebra.Solver.CommutativeMonoid.html#5387" class="Bound">e₁</a> <a id="5390" href="Algebra.Solver.CommutativeMonoid.html#5390" class="Bound">e₂</a> <a id="5393" class="Symbol">=</a>
  <a id="5397" href="Data.Maybe.Base.html#2139" class="Function">Maybe.map</a> <a id="5407" href="Algebra.Solver.CommutativeMonoid.html#5466" class="Function">lemma</a> <a id="5413" class="Symbol">(</a><a id="5414" href="Data.Maybe.Base.html#1285" class="Function">decToMaybe</a> <a id="5425" class="Symbol">(</a><a id="5426" href="Algebra.Solver.CommutativeMonoid.html#4092" class="Function">normalise</a> <a id="5436" href="Algebra.Solver.CommutativeMonoid.html#5387" class="Bound">e₁</a> <a id="5439" href="Algebra.Solver.CommutativeMonoid.html#5044" class="Function Operator">≟</a> <a id="5441" href="Algebra.Solver.CommutativeMonoid.html#4092" class="Function">normalise</a> <a id="5451" href="Algebra.Solver.CommutativeMonoid.html#5390" class="Bound">e₂</a><a id="5453" class="Symbol">))</a>
  <a id="5458" class="Keyword">where</a>
  <a id="5466" href="Algebra.Solver.CommutativeMonoid.html#5466" class="Function">lemma</a> <a id="5472" class="Symbol">:</a> <a id="5474" href="Algebra.Solver.CommutativeMonoid.html#4092" class="Function">normalise</a> <a id="5484" href="Algebra.Solver.CommutativeMonoid.html#5387" class="Bound">e₁</a> <a id="5487" href="Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="5489" href="Algebra.Solver.CommutativeMonoid.html#4092" class="Function">normalise</a> <a id="5499" href="Algebra.Solver.CommutativeMonoid.html#5390" class="Bound">e₂</a> <a id="5502" class="Symbol">→</a> <a id="5504" class="Symbol">∀</a> <a id="5506" href="Algebra.Solver.CommutativeMonoid.html#5506" class="Bound">ρ</a> <a id="5508" class="Symbol">→</a> <a id="5510" href="Algebra.Solver.CommutativeMonoid.html#1700" class="Function Operator">⟦</a> <a id="5512" href="Algebra.Solver.CommutativeMonoid.html#5387" class="Bound">e₁</a> <a id="5515" href="Algebra.Solver.CommutativeMonoid.html#1700" class="Function Operator">⟧</a> <a id="5517" href="Algebra.Solver.CommutativeMonoid.html#5506" class="Bound">ρ</a> <a id="5519" href="Algebra.html#3116" class="Field Operator">≈</a> <a id="5521" href="Algebra.Solver.CommutativeMonoid.html#1700" class="Function Operator">⟦</a> <a id="5523" href="Algebra.Solver.CommutativeMonoid.html#5390" class="Bound">e₂</a> <a id="5526" href="Algebra.Solver.CommutativeMonoid.html#1700" class="Function Operator">⟧</a> <a id="5528" href="Algebra.Solver.CommutativeMonoid.html#5506" class="Bound">ρ</a>
  <a id="5532" href="Algebra.Solver.CommutativeMonoid.html#5466" class="Function">lemma</a> <a id="5538" href="Algebra.Solver.CommutativeMonoid.html#5538" class="Bound">eq</a> <a id="5541" href="Algebra.Solver.CommutativeMonoid.html#5541" class="Bound">ρ</a> <a id="5543" class="Symbol">=</a>
    <a id="5549" href="Relation.Binary.Reflection.html#1737" class="Function">R.prove</a> <a id="5557" href="Algebra.Solver.CommutativeMonoid.html#5541" class="Bound">ρ</a> <a id="5559" href="Algebra.Solver.CommutativeMonoid.html#5387" class="Bound">e₁</a> <a id="5562" href="Algebra.Solver.CommutativeMonoid.html#5390" class="Bound">e₂</a> <a id="5565" class="Symbol">(</a><a id="5566" href="Relation.Binary.Reasoning.Preorder.html#1266" class="Function Operator">begin</a>
      <a id="5578" href="Algebra.Solver.CommutativeMonoid.html#2041" class="Function Operator">⟦</a> <a id="5580" href="Algebra.Solver.CommutativeMonoid.html#4092" class="Function">normalise</a> <a id="5590" href="Algebra.Solver.CommutativeMonoid.html#5387" class="Bound">e₁</a> <a id="5593" href="Algebra.Solver.CommutativeMonoid.html#2041" class="Function Operator">⟧⇓</a> <a id="5596" href="Algebra.Solver.CommutativeMonoid.html#5541" class="Bound">ρ</a>  <a id="5599" href="Relation.Binary.Reasoning.Preorder.html#1562" class="Function Operator">≡⟨</a> <a id="5602" href="Relation.Binary.PropositionalEquality.html#1134" class="Function">P.cong</a> <a id="5609" class="Symbol">(λ</a> <a id="5612" href="Algebra.Solver.CommutativeMonoid.html#5612" class="Bound">e</a> <a id="5614" class="Symbol">→</a> <a id="5616" href="Algebra.Solver.CommutativeMonoid.html#2041" class="Function Operator">⟦</a> <a id="5618" href="Algebra.Solver.CommutativeMonoid.html#5612" class="Bound">e</a> <a id="5620" href="Algebra.Solver.CommutativeMonoid.html#2041" class="Function Operator">⟧⇓</a> <a id="5623" href="Algebra.Solver.CommutativeMonoid.html#5541" class="Bound">ρ</a><a id="5624" class="Symbol">)</a> <a id="5626" href="Algebra.Solver.CommutativeMonoid.html#5538" class="Bound">eq</a> <a id="5629" href="Relation.Binary.Reasoning.Preorder.html#1562" class="Function Operator">⟩</a>
      <a id="5637" href="Algebra.Solver.CommutativeMonoid.html#2041" class="Function Operator">⟦</a> <a id="5639" href="Algebra.Solver.CommutativeMonoid.html#4092" class="Function">normalise</a> <a id="5649" href="Algebra.Solver.CommutativeMonoid.html#5390" class="Bound">e₂</a> <a id="5652" href="Algebra.Solver.CommutativeMonoid.html#2041" class="Function Operator">⟧⇓</a> <a id="5655" href="Algebra.Solver.CommutativeMonoid.html#5541" class="Bound">ρ</a>  <a id="5658" href="Relation.Binary.Reasoning.Preorder.html#1719" class="Function Operator">∎</a><a id="5659" class="Symbol">)</a>

<a id="5662" class="Comment">-- This procedure can be combined with from-just.</a>

<a id="prove"></a><a id="5713" href="Algebra.Solver.CommutativeMonoid.html#5713" class="Function">prove</a> <a id="5719" class="Symbol">:</a> <a id="5721" class="Symbol">∀</a> <a id="5723" href="Algebra.Solver.CommutativeMonoid.html#5723" class="Bound">n</a> <a id="5725" class="Symbol">(</a><a id="5726" href="Algebra.Solver.CommutativeMonoid.html#5726" class="Bound">e₁</a> <a id="5729" href="Algebra.Solver.CommutativeMonoid.html#5729" class="Bound">e₂</a> <a id="5732" class="Symbol">:</a> <a id="5734" href="Algebra.Solver.CommutativeMonoid.html#1422" class="Datatype">Expr</a> <a id="5739" href="Algebra.Solver.CommutativeMonoid.html#5723" class="Bound">n</a><a id="5740" class="Symbol">)</a> <a id="5742" class="Symbol">→</a> <a id="5744" href="Data.Maybe.Base.html#1936" class="Function">From-just</a> <a id="5754" class="Symbol">(</a><a id="5755" href="Algebra.Solver.CommutativeMonoid.html#5312" class="Function">prove′</a> <a id="5762" href="Algebra.Solver.CommutativeMonoid.html#5726" class="Bound">e₁</a> <a id="5765" href="Algebra.Solver.CommutativeMonoid.html#5729" class="Bound">e₂</a><a id="5767" class="Symbol">)</a>
<a id="5769" href="Algebra.Solver.CommutativeMonoid.html#5713" class="Function">prove</a> <a id="5775" class="Symbol">_</a> <a id="5777" href="Algebra.Solver.CommutativeMonoid.html#5777" class="Bound">e₁</a> <a id="5780" href="Algebra.Solver.CommutativeMonoid.html#5780" class="Bound">e₂</a> <a id="5783" class="Symbol">=</a> <a id="5785" href="Data.Maybe.Base.html#2024" class="Function">from-just</a> <a id="5795" class="Symbol">(</a><a id="5796" href="Algebra.Solver.CommutativeMonoid.html#5312" class="Function">prove′</a> <a id="5803" href="Algebra.Solver.CommutativeMonoid.html#5777" class="Bound">e₁</a> <a id="5806" href="Algebra.Solver.CommutativeMonoid.html#5780" class="Bound">e₂</a><a id="5808" class="Symbol">)</a>

<a id="5811" class="Comment">-- prove : ∀ n (es : Expr n × Expr n) →</a>
<a id="5851" class="Comment">--         From-just (uncurry prove′ es)</a>
<a id="5892" class="Comment">-- prove _ = from-just ∘ uncurry prove′</a>
</pre></body></html>