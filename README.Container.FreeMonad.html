<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>README.Container.FreeMonad</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Example showing how the free monad construction on containers can be</a>
<a id="178" class="Comment">-- used</a>
<a id="186" class="Comment">------------------------------------------------------------------------</a>

<a id="260" class="Keyword">module</a> <a id="267" href="README.Container.FreeMonad.html" class="Module">README.Container.FreeMonad</a> <a id="294" class="Keyword">where</a>

<a id="301" class="Keyword">open</a> <a id="306" class="Keyword">import</a> <a id="313" href="Category.Monad.html" class="Module">Category.Monad</a>
<a id="328" class="Keyword">open</a> <a id="333" class="Keyword">import</a> <a id="340" href="Data.Empty.html" class="Module">Data.Empty</a>
<a id="351" class="Keyword">open</a> <a id="356" class="Keyword">import</a> <a id="363" href="Data.Unit.html" class="Module">Data.Unit</a>
<a id="373" class="Keyword">open</a> <a id="378" class="Keyword">import</a> <a id="385" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a> <a id="400" class="Keyword">using</a> <a id="406" class="Symbol">(</a><a id="407" href="Agda.Builtin.Bool.html#67" class="Datatype">Bool</a><a id="411" class="Symbol">;</a> <a id="413" href="Agda.Builtin.Bool.html#92" class="InductiveConstructor">true</a><a id="417" class="Symbol">)</a>
<a id="419" class="Keyword">open</a> <a id="424" class="Keyword">import</a> <a id="431" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="440" class="Keyword">open</a> <a id="445" class="Keyword">import</a> <a id="452" href="Data.Sum.html" class="Module">Data.Sum</a> <a id="461" class="Keyword">using</a> <a id="467" class="Symbol">(</a><a id="468" href="Data.Sum.Base.html#475" class="InductiveConstructor">inj₁</a><a id="472" class="Symbol">;</a> <a id="474" href="Data.Sum.Base.html#500" class="InductiveConstructor">inj₂</a><a id="478" class="Symbol">)</a>
<a id="480" class="Keyword">open</a> <a id="485" class="Keyword">import</a> <a id="492" href="Data.Product.html" class="Module">Data.Product</a> <a id="505" class="Keyword">renaming</a> <a id="514" class="Symbol">(</a><a id="515" href="Data.Product.html#1353" class="Function Operator">_×_</a> <a id="519" class="Symbol">to</a> <a id="522" href="Data.Product.html#1353" class="Function Operator">_⟨×⟩_</a><a id="527" class="Symbol">)</a>
<a id="529" class="Keyword">open</a> <a id="534" class="Keyword">import</a> <a id="541" href="Data.Container.html" class="Module">Data.Container</a>
<a id="556" class="Keyword">open</a> <a id="561" class="Keyword">import</a> <a id="568" href="Data.Container.Combinator.html" class="Module">Data.Container.Combinator</a>
<a id="594" class="Keyword">open</a> <a id="599" class="Keyword">import</a> <a id="606" href="Data.Container.FreeMonad.html" class="Module">Data.Container.FreeMonad</a>
<a id="631" class="Keyword">open</a> <a id="636" class="Keyword">import</a> <a id="643" href="Data.W.html" class="Module">Data.W</a>
<a id="650" class="Keyword">open</a> <a id="655" class="Keyword">import</a> <a id="662" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a>

<a id="701" class="Comment">------------------------------------------------------------------------</a>

<a id="775" class="Comment">-- The signature of state and its (generic) operations.</a>

<a id="State"></a><a id="832" href="README.Container.FreeMonad.html#832" class="Function">State</a> <a id="838" class="Symbol">:</a> <a id="840" class="PrimitiveType">Set</a> <a id="844" class="Symbol">→</a> <a id="846" href="Data.Container.Core.html#296" class="Record">Container</a> <a id="856" class="Symbol">_</a> <a id="858" class="Symbol">_</a>
<a id="860" href="README.Container.FreeMonad.html#832" class="Function">State</a> <a id="866" href="README.Container.FreeMonad.html#866" class="Bound">S</a> <a id="868" class="Symbol">=</a> <a id="870" href="Agda.Builtin.Unit.html#69" class="Record">⊤</a> <a id="872" href="README.Container.FreeMonad.html#894" class="Function Operator">⟶</a> <a id="874" href="README.Container.FreeMonad.html#866" class="Bound">S</a> <a id="876" href="Data.Container.Combinator.html#1662" class="Function Operator">⊎</a> <a id="878" href="README.Container.FreeMonad.html#866" class="Bound">S</a> <a id="880" href="README.Container.FreeMonad.html#894" class="Function Operator">⟶</a> <a id="882" href="Agda.Builtin.Unit.html#69" class="Record">⊤</a>
  <a id="886" class="Keyword">where</a>
  <a id="894" href="README.Container.FreeMonad.html#894" class="Function Operator">_⟶_</a> <a id="898" class="Symbol">:</a> <a id="900" class="PrimitiveType">Set</a> <a id="904" class="Symbol">→</a> <a id="906" class="PrimitiveType">Set</a> <a id="910" class="Symbol">→</a> <a id="912" href="Data.Container.Core.html#296" class="Record">Container</a> <a id="922" class="Symbol">_</a> <a id="924" class="Symbol">_</a>
  <a id="928" href="README.Container.FreeMonad.html#928" class="Bound">I</a> <a id="930" href="README.Container.FreeMonad.html#894" class="Function Operator">⟶</a> <a id="932" href="README.Container.FreeMonad.html#932" class="Bound">O</a> <a id="934" class="Symbol">=</a> <a id="936" href="README.Container.FreeMonad.html#928" class="Bound">I</a> <a id="938" href="Data.Container.Core.html#360" class="InductiveConstructor Operator">▷</a> <a id="940" class="Symbol">λ</a> <a id="942" href="README.Container.FreeMonad.html#942" class="Bound">_</a> <a id="944" class="Symbol">→</a> <a id="946" href="README.Container.FreeMonad.html#932" class="Bound">O</a>

<a id="get"></a><a id="949" href="README.Container.FreeMonad.html#949" class="Function">get</a> <a id="953" class="Symbol">:</a> <a id="955" class="Symbol">∀</a> <a id="957" class="Symbol">{</a><a id="958" href="README.Container.FreeMonad.html#958" class="Bound">S</a><a id="959" class="Symbol">}</a> <a id="961" class="Symbol">→</a> <a id="963" href="README.Container.FreeMonad.html#832" class="Function">State</a> <a id="969" href="README.Container.FreeMonad.html#958" class="Bound">S</a> <a id="971" href="Data.Container.FreeMonad.html#1532" class="Function Operator">⋆</a> <a id="973" href="README.Container.FreeMonad.html#958" class="Bound">S</a>
<a id="975" href="README.Container.FreeMonad.html#949" class="Function">get</a> <a id="979" class="Symbol">=</a> <a id="981" href="Data.Container.FreeMonad.html#1654" class="Function">inn</a> <a id="985" class="Symbol">(</a><a id="986" href="Data.Sum.Base.html#475" class="InductiveConstructor">inj₁</a> <a id="991" class="Symbol">_</a> <a id="993" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="995" href="Category.Monad.Indexed.html#533" class="Function">return</a><a id="1001" class="Symbol">)</a>
  <a id="1005" class="Keyword">where</a>
  <a id="1013" class="Keyword">open</a> <a id="1018" href="Category.Monad.html#652" class="Module">RawMonad</a> <a id="1027" href="Data.Container.FreeMonad.html#1736" class="Function">rawMonad</a>

<a id="put"></a><a id="1037" href="README.Container.FreeMonad.html#1037" class="Function">put</a> <a id="1041" class="Symbol">:</a> <a id="1043" class="Symbol">∀</a> <a id="1045" class="Symbol">{</a><a id="1046" href="README.Container.FreeMonad.html#1046" class="Bound">S</a><a id="1047" class="Symbol">}</a> <a id="1049" class="Symbol">→</a> <a id="1051" href="README.Container.FreeMonad.html#1046" class="Bound">S</a> <a id="1053" class="Symbol">→</a> <a id="1055" href="README.Container.FreeMonad.html#832" class="Function">State</a> <a id="1061" href="README.Container.FreeMonad.html#1046" class="Bound">S</a> <a id="1063" href="Data.Container.FreeMonad.html#1532" class="Function Operator">⋆</a> <a id="1065" href="Agda.Builtin.Unit.html#69" class="Record">⊤</a>
<a id="1067" href="README.Container.FreeMonad.html#1037" class="Function">put</a> <a id="1071" href="README.Container.FreeMonad.html#1071" class="Bound">s</a> <a id="1073" class="Symbol">=</a> <a id="1075" href="Data.Container.FreeMonad.html#1654" class="Function">inn</a> <a id="1079" class="Symbol">(</a><a id="1080" href="Data.Sum.Base.html#500" class="InductiveConstructor">inj₂</a> <a id="1085" href="README.Container.FreeMonad.html#1071" class="Bound">s</a> <a id="1087" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1089" href="Category.Monad.Indexed.html#533" class="Function">return</a><a id="1095" class="Symbol">)</a>
  <a id="1099" class="Keyword">where</a>
  <a id="1107" class="Keyword">open</a> <a id="1112" href="Category.Monad.html#652" class="Module">RawMonad</a> <a id="1121" href="Data.Container.FreeMonad.html#1736" class="Function">rawMonad</a>

<a id="1131" class="Comment">-- Using the above we can, for example, write a stateful program that</a>
<a id="1201" class="Comment">-- delivers a boolean.</a>
<a id="prog"></a><a id="1224" href="README.Container.FreeMonad.html#1224" class="Function">prog</a> <a id="1229" class="Symbol">:</a> <a id="1231" href="README.Container.FreeMonad.html#832" class="Function">State</a> <a id="1237" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="1239" href="Data.Container.FreeMonad.html#1532" class="Function Operator">⋆</a> <a id="1241" href="Agda.Builtin.Bool.html#67" class="Datatype">Bool</a>
<a id="1246" href="README.Container.FreeMonad.html#1224" class="Function">prog</a> <a id="1251" class="Symbol">=</a>
  <a id="1255" href="README.Container.FreeMonad.html#949" class="Function">get</a>         <a id="1267" href="Category.Monad.Indexed.html#568" class="Function Operator">&gt;&gt;=</a> <a id="1271" class="Symbol">λ</a> <a id="1273" href="README.Container.FreeMonad.html#1273" class="Bound">n</a> <a id="1275" class="Symbol">→</a>
  <a id="1279" href="README.Container.FreeMonad.html#1037" class="Function">put</a> <a id="1283" class="Symbol">(</a><a id="1284" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="1288" href="README.Container.FreeMonad.html#1273" class="Bound">n</a><a id="1289" class="Symbol">)</a> <a id="1291" href="Category.Monad.Indexed.html#630" class="Function Operator">&gt;&gt;</a>
  <a id="1296" href="Category.Monad.Indexed.html#533" class="Function">return</a> <a id="1303" href="Agda.Builtin.Bool.html#92" class="InductiveConstructor">true</a>
  <a id="1310" class="Keyword">where</a>
  <a id="1318" class="Keyword">open</a> <a id="1323" href="Category.Monad.html#652" class="Module">RawMonad</a> <a id="1332" href="Data.Container.FreeMonad.html#1736" class="Function">rawMonad</a>

<a id="runState"></a><a id="1342" href="README.Container.FreeMonad.html#1342" class="Function">runState</a> <a id="1351" class="Symbol">:</a> <a id="1353" class="Symbol">{</a><a id="1354" href="README.Container.FreeMonad.html#1354" class="Bound">S</a> <a id="1356" href="README.Container.FreeMonad.html#1356" class="Bound">X</a> <a id="1358" class="Symbol">:</a> <a id="1360" class="PrimitiveType">Set</a><a id="1363" class="Symbol">}</a> <a id="1365" class="Symbol">→</a> <a id="1367" href="README.Container.FreeMonad.html#832" class="Function">State</a> <a id="1373" href="README.Container.FreeMonad.html#1354" class="Bound">S</a> <a id="1375" href="Data.Container.FreeMonad.html#1532" class="Function Operator">⋆</a> <a id="1377" href="README.Container.FreeMonad.html#1356" class="Bound">X</a> <a id="1379" class="Symbol">→</a> <a id="1381" class="Symbol">(</a><a id="1382" href="README.Container.FreeMonad.html#1354" class="Bound">S</a> <a id="1384" class="Symbol">→</a> <a id="1386" href="README.Container.FreeMonad.html#1356" class="Bound">X</a> <a id="1388" href="Data.Product.html#1353" class="Function Operator">⟨×⟩</a> <a id="1392" href="README.Container.FreeMonad.html#1354" class="Bound">S</a><a id="1393" class="Symbol">)</a>
<a id="1395" href="README.Container.FreeMonad.html#1342" class="Function">runState</a> <a id="1404" class="Symbol">(</a><a id="1405" href="Data.W.html#467" class="InductiveConstructor">sup</a> <a id="1409" class="Symbol">(</a><a id="1410" href="Data.Sum.Base.html#475" class="InductiveConstructor">inj₁</a> <a id="1415" href="README.Container.FreeMonad.html#1415" class="Bound">x</a><a id="1416" class="Symbol">)</a> <a id="1418" class="Symbol">_)</a>        <a id="1428" class="Symbol">=</a> <a id="1430" class="Symbol">λ</a> <a id="1432" href="README.Container.FreeMonad.html#1432" class="Bound">s</a> <a id="1434" class="Symbol">→</a> <a id="1436" href="README.Container.FreeMonad.html#1415" class="Bound">x</a> <a id="1438" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1440" href="README.Container.FreeMonad.html#1432" class="Bound">s</a>
<a id="1442" href="README.Container.FreeMonad.html#1342" class="Function">runState</a> <a id="1451" class="Symbol">(</a><a id="1452" href="Data.W.html#467" class="InductiveConstructor">sup</a> <a id="1456" class="Symbol">(</a><a id="1457" href="Data.Sum.Base.html#500" class="InductiveConstructor">inj₂</a> <a id="1462" class="Symbol">(</a><a id="1463" href="Data.Sum.Base.html#475" class="InductiveConstructor">inj₁</a> <a id="1468" class="Symbol">_))</a> <a id="1472" href="README.Container.FreeMonad.html#1472" class="Bound">k</a><a id="1473" class="Symbol">)</a> <a id="1475" class="Symbol">=</a> <a id="1477" class="Symbol">λ</a> <a id="1479" href="README.Container.FreeMonad.html#1479" class="Bound">s</a> <a id="1481" class="Symbol">→</a> <a id="1483" href="README.Container.FreeMonad.html#1342" class="Function">runState</a> <a id="1492" class="Symbol">(</a><a id="1493" href="README.Container.FreeMonad.html#1472" class="Bound">k</a> <a id="1495" href="README.Container.FreeMonad.html#1479" class="Bound">s</a><a id="1496" class="Symbol">)</a> <a id="1498" href="README.Container.FreeMonad.html#1479" class="Bound">s</a>
<a id="1500" href="README.Container.FreeMonad.html#1342" class="Function">runState</a> <a id="1509" class="Symbol">(</a><a id="1510" href="Data.W.html#467" class="InductiveConstructor">sup</a> <a id="1514" class="Symbol">(</a><a id="1515" href="Data.Sum.Base.html#500" class="InductiveConstructor">inj₂</a> <a id="1520" class="Symbol">(</a><a id="1521" href="Data.Sum.Base.html#500" class="InductiveConstructor">inj₂</a> <a id="1526" href="README.Container.FreeMonad.html#1526" class="Bound">s</a><a id="1527" class="Symbol">))</a> <a id="1530" href="README.Container.FreeMonad.html#1530" class="Bound">k</a><a id="1531" class="Symbol">)</a> <a id="1533" class="Symbol">=</a> <a id="1535" class="Symbol">λ</a> <a id="1537" href="README.Container.FreeMonad.html#1537" class="Bound">_</a> <a id="1539" class="Symbol">→</a> <a id="1541" href="README.Container.FreeMonad.html#1342" class="Function">runState</a> <a id="1550" class="Symbol">(</a><a id="1551" href="README.Container.FreeMonad.html#1530" class="Bound">k</a> <a id="1553" class="Symbol">_)</a> <a id="1556" href="README.Container.FreeMonad.html#1526" class="Bound">s</a>

<a id="test"></a><a id="1559" href="README.Container.FreeMonad.html#1559" class="Function">test</a> <a id="1564" class="Symbol">:</a> <a id="1566" href="README.Container.FreeMonad.html#1342" class="Function">runState</a> <a id="1575" href="README.Container.FreeMonad.html#1224" class="Function">prog</a> <a id="1580" class="Number">0</a> <a id="1582" href="Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="1584" class="Symbol">(</a><a id="1585" href="Agda.Builtin.Bool.html#92" class="InductiveConstructor">true</a> <a id="1590" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1592" class="Number">1</a><a id="1593" class="Symbol">)</a>
<a id="1595" href="README.Container.FreeMonad.html#1559" class="Function">test</a> <a id="1600" class="Symbol">=</a> <a id="1602" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>

<a id="1608" class="Comment">-- It should be noted that @State S ⋆ X@ is not the state monad. If we</a>
<a id="1679" class="Comment">-- could quotient @State S ⋆ X@ by the seven axioms of state (see</a>
<a id="1745" class="Comment">-- Plotkin and Power&#39;s &quot;Notions of Computation Determine Monads&quot;, 2002)</a>
<a id="1817" class="Comment">-- then we would get the state monad.</a>
</pre></body></html>