<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>README.Container.FreeMonad</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Example showing how the free monad construction on containers can be</a>
<a id="178" class="Comment">-- used</a>
<a id="186" class="Comment">------------------------------------------------------------------------</a>

<a id="260" class="Symbol">{-#</a> <a id="264" class="Keyword">OPTIONS</a> <a id="272" class="Option">--without-K</a> <a id="284" class="Option">--safe</a> <a id="291" class="Symbol">#-}</a>

<a id="296" class="Keyword">module</a> <a id="303" href="README.Container.FreeMonad.html" class="Module">README.Container.FreeMonad</a> <a id="330" class="Keyword">where</a>

<a id="337" class="Keyword">open</a> <a id="342" class="Keyword">import</a> <a id="349" href="Category.Monad.html" class="Module">Category.Monad</a>
<a id="364" class="Keyword">open</a> <a id="369" class="Keyword">import</a> <a id="376" href="Data.Empty.html" class="Module">Data.Empty</a>
<a id="387" class="Keyword">open</a> <a id="392" class="Keyword">import</a> <a id="399" href="Data.Unit.html" class="Module">Data.Unit</a>
<a id="409" class="Keyword">open</a> <a id="414" class="Keyword">import</a> <a id="421" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a> <a id="436" class="Keyword">using</a> <a id="442" class="Symbol">(</a><a id="443" href="Agda.Builtin.Bool.html#67" class="Datatype">Bool</a><a id="447" class="Symbol">;</a> <a id="449" href="Agda.Builtin.Bool.html#92" class="InductiveConstructor">true</a><a id="453" class="Symbol">)</a>
<a id="455" class="Keyword">open</a> <a id="460" class="Keyword">import</a> <a id="467" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="476" class="Keyword">open</a> <a id="481" class="Keyword">import</a> <a id="488" href="Data.Sum.html" class="Module">Data.Sum</a> <a id="497" class="Keyword">using</a> <a id="503" class="Symbol">(</a><a id="504" href="Data.Sum.Base.html#565" class="InductiveConstructor">inj₁</a><a id="508" class="Symbol">;</a> <a id="510" href="Data.Sum.Base.html#590" class="InductiveConstructor">inj₂</a><a id="514" class="Symbol">)</a>
<a id="516" class="Keyword">open</a> <a id="521" class="Keyword">import</a> <a id="528" href="Data.Product.html" class="Module">Data.Product</a> <a id="541" class="Keyword">renaming</a> <a id="550" class="Symbol">(</a><a id="551" href="Data.Product.html#1389" class="Function Operator">_×_</a> <a id="555" class="Symbol">to</a> <a id="558" href="Data.Product.html#1389" class="Function Operator">_⟨×⟩_</a><a id="563" class="Symbol">)</a>
<a id="565" class="Keyword">open</a> <a id="570" class="Keyword">import</a> <a id="577" href="Data.Container.html" class="Module">Data.Container</a>
<a id="592" class="Keyword">open</a> <a id="597" class="Keyword">import</a> <a id="604" href="Data.Container.Combinator.html" class="Module">Data.Container.Combinator</a>
<a id="630" class="Keyword">open</a> <a id="635" class="Keyword">import</a> <a id="642" href="Data.Container.FreeMonad.html" class="Module">Data.Container.FreeMonad</a>
<a id="667" class="Keyword">open</a> <a id="672" class="Keyword">import</a> <a id="679" href="Data.W.html" class="Module">Data.W</a>
<a id="686" class="Keyword">open</a> <a id="691" class="Keyword">import</a> <a id="698" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="736" class="Symbol">as</a> <a id="739" class="Module">P</a>

<a id="742" class="Comment">------------------------------------------------------------------------</a>

<a id="816" class="Comment">-- The signature of state and its (generic) operations.</a>

<a id="State"></a><a id="873" href="README.Container.FreeMonad.html#873" class="Function">State</a> <a id="879" class="Symbol">:</a> <a id="881" class="PrimitiveType">Set</a> <a id="885" class="Symbol">→</a> <a id="887" href="Data.Container.Core.html#553" class="Record">Container</a> <a id="897" class="Symbol">_</a> <a id="899" class="Symbol">_</a>
<a id="901" href="README.Container.FreeMonad.html#873" class="Function">State</a> <a id="907" href="README.Container.FreeMonad.html#907" class="Bound">S</a> <a id="909" class="Symbol">=</a> <a id="911" href="Agda.Builtin.Unit.html#69" class="Record">⊤</a> <a id="913" href="README.Container.FreeMonad.html#935" class="Function Operator">⟶</a> <a id="915" href="README.Container.FreeMonad.html#907" class="Bound">S</a> <a id="917" href="Data.Container.Combinator.html#1968" class="Function Operator">⊎</a> <a id="919" href="README.Container.FreeMonad.html#907" class="Bound">S</a> <a id="921" href="README.Container.FreeMonad.html#935" class="Function Operator">⟶</a> <a id="923" href="Agda.Builtin.Unit.html#69" class="Record">⊤</a>
  <a id="927" class="Keyword">where</a>
  <a id="935" href="README.Container.FreeMonad.html#935" class="Function Operator">_⟶_</a> <a id="939" class="Symbol">:</a> <a id="941" class="PrimitiveType">Set</a> <a id="945" class="Symbol">→</a> <a id="947" class="PrimitiveType">Set</a> <a id="951" class="Symbol">→</a> <a id="953" href="Data.Container.Core.html#553" class="Record">Container</a> <a id="963" class="Symbol">_</a> <a id="965" class="Symbol">_</a>
  <a id="969" href="README.Container.FreeMonad.html#969" class="Bound">I</a> <a id="971" href="README.Container.FreeMonad.html#935" class="Function Operator">⟶</a> <a id="973" href="README.Container.FreeMonad.html#973" class="Bound">O</a> <a id="975" class="Symbol">=</a> <a id="977" href="README.Container.FreeMonad.html#969" class="Bound">I</a> <a id="979" href="Data.Container.Core.html#617" class="InductiveConstructor Operator">▷</a> <a id="981" class="Symbol">λ</a> <a id="983" href="README.Container.FreeMonad.html#983" class="Bound">_</a> <a id="985" class="Symbol">→</a> <a id="987" href="README.Container.FreeMonad.html#973" class="Bound">O</a>

<a id="get"></a><a id="990" href="README.Container.FreeMonad.html#990" class="Function">get</a> <a id="994" class="Symbol">:</a> <a id="996" class="Symbol">∀</a> <a id="998" class="Symbol">{</a><a id="999" href="README.Container.FreeMonad.html#999" class="Bound">S</a><a id="1000" class="Symbol">}</a> <a id="1002" class="Symbol">→</a> <a id="1004" href="README.Container.FreeMonad.html#873" class="Function">State</a> <a id="1010" href="README.Container.FreeMonad.html#999" class="Bound">S</a> <a id="1012" href="Data.Container.FreeMonad.html#1506" class="Function Operator">⋆</a> <a id="1014" href="README.Container.FreeMonad.html#999" class="Bound">S</a>
<a id="1016" href="README.Container.FreeMonad.html#990" class="Function">get</a> <a id="1020" class="Symbol">=</a> <a id="1022" href="Data.Container.FreeMonad.html#1628" class="Function">inn</a> <a id="1026" class="Symbol">(</a><a id="1027" href="Data.Sum.Base.html#565" class="InductiveConstructor">inj₁</a> <a id="1032" class="Symbol">_</a> <a id="1034" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1036" href="Category.Monad.Indexed.html#569" class="Function">return</a><a id="1042" class="Symbol">)</a>
  <a id="1046" class="Keyword">where</a>
  <a id="1054" class="Keyword">open</a> <a id="1059" href="Category.Monad.html#810" class="Module">RawMonad</a> <a id="1068" href="Data.Container.FreeMonad.html#1712" class="Function">rawMonad</a>

<a id="put"></a><a id="1078" href="README.Container.FreeMonad.html#1078" class="Function">put</a> <a id="1082" class="Symbol">:</a> <a id="1084" class="Symbol">∀</a> <a id="1086" class="Symbol">{</a><a id="1087" href="README.Container.FreeMonad.html#1087" class="Bound">S</a><a id="1088" class="Symbol">}</a> <a id="1090" class="Symbol">→</a> <a id="1092" href="README.Container.FreeMonad.html#1087" class="Bound">S</a> <a id="1094" class="Symbol">→</a> <a id="1096" href="README.Container.FreeMonad.html#873" class="Function">State</a> <a id="1102" href="README.Container.FreeMonad.html#1087" class="Bound">S</a> <a id="1104" href="Data.Container.FreeMonad.html#1506" class="Function Operator">⋆</a> <a id="1106" href="Agda.Builtin.Unit.html#69" class="Record">⊤</a>
<a id="1108" href="README.Container.FreeMonad.html#1078" class="Function">put</a> <a id="1112" href="README.Container.FreeMonad.html#1112" class="Bound">s</a> <a id="1114" class="Symbol">=</a> <a id="1116" href="Data.Container.FreeMonad.html#1628" class="Function">inn</a> <a id="1120" class="Symbol">(</a><a id="1121" href="Data.Sum.Base.html#590" class="InductiveConstructor">inj₂</a> <a id="1126" href="README.Container.FreeMonad.html#1112" class="Bound">s</a> <a id="1128" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1130" href="Category.Monad.Indexed.html#569" class="Function">return</a><a id="1136" class="Symbol">)</a>
  <a id="1140" class="Keyword">where</a>
  <a id="1148" class="Keyword">open</a> <a id="1153" href="Category.Monad.html#810" class="Module">RawMonad</a> <a id="1162" href="Data.Container.FreeMonad.html#1712" class="Function">rawMonad</a>

<a id="1172" class="Comment">-- Using the above we can, for example, write a stateful program that</a>
<a id="1242" class="Comment">-- delivers a boolean.</a>
<a id="prog"></a><a id="1265" href="README.Container.FreeMonad.html#1265" class="Function">prog</a> <a id="1270" class="Symbol">:</a> <a id="1272" href="README.Container.FreeMonad.html#873" class="Function">State</a> <a id="1278" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="1280" href="Data.Container.FreeMonad.html#1506" class="Function Operator">⋆</a> <a id="1282" href="Agda.Builtin.Bool.html#67" class="Datatype">Bool</a>
<a id="1287" href="README.Container.FreeMonad.html#1265" class="Function">prog</a> <a id="1292" class="Symbol">=</a>
  <a id="1296" href="README.Container.FreeMonad.html#990" class="Function">get</a>         <a id="1308" href="Category.Monad.Indexed.html#604" class="Function Operator">&gt;&gt;=</a> <a id="1312" class="Symbol">λ</a> <a id="1314" href="README.Container.FreeMonad.html#1314" class="Bound">n</a> <a id="1316" class="Symbol">→</a>
  <a id="1320" href="README.Container.FreeMonad.html#1078" class="Function">put</a> <a id="1324" class="Symbol">(</a><a id="1325" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="1329" href="README.Container.FreeMonad.html#1314" class="Bound">n</a><a id="1330" class="Symbol">)</a> <a id="1332" href="Category.Monad.Indexed.html#666" class="Function Operator">&gt;&gt;</a>
  <a id="1337" href="Category.Monad.Indexed.html#569" class="Function">return</a> <a id="1344" href="Agda.Builtin.Bool.html#92" class="InductiveConstructor">true</a>
  <a id="1351" class="Keyword">where</a>
  <a id="1359" class="Keyword">open</a> <a id="1364" href="Category.Monad.html#810" class="Module">RawMonad</a> <a id="1373" href="Data.Container.FreeMonad.html#1712" class="Function">rawMonad</a>

<a id="runState"></a><a id="1383" href="README.Container.FreeMonad.html#1383" class="Function">runState</a> <a id="1392" class="Symbol">:</a> <a id="1394" class="Symbol">{</a><a id="1395" href="README.Container.FreeMonad.html#1395" class="Bound">S</a> <a id="1397" href="README.Container.FreeMonad.html#1397" class="Bound">X</a> <a id="1399" class="Symbol">:</a> <a id="1401" class="PrimitiveType">Set</a><a id="1404" class="Symbol">}</a> <a id="1406" class="Symbol">→</a> <a id="1408" href="README.Container.FreeMonad.html#873" class="Function">State</a> <a id="1414" href="README.Container.FreeMonad.html#1395" class="Bound">S</a> <a id="1416" href="Data.Container.FreeMonad.html#1506" class="Function Operator">⋆</a> <a id="1418" href="README.Container.FreeMonad.html#1397" class="Bound">X</a> <a id="1420" class="Symbol">→</a> <a id="1422" class="Symbol">(</a><a id="1423" href="README.Container.FreeMonad.html#1395" class="Bound">S</a> <a id="1425" class="Symbol">→</a> <a id="1427" href="README.Container.FreeMonad.html#1397" class="Bound">X</a> <a id="1429" href="Data.Product.html#1389" class="Function Operator">⟨×⟩</a> <a id="1433" href="README.Container.FreeMonad.html#1395" class="Bound">S</a><a id="1434" class="Symbol">)</a>
<a id="1436" href="README.Container.FreeMonad.html#1383" class="Function">runState</a> <a id="1445" class="Symbol">(</a><a id="1446" href="Data.W.html#577" class="InductiveConstructor">sup</a> <a id="1450" class="Symbol">(</a><a id="1451" href="Data.Sum.Base.html#565" class="InductiveConstructor">inj₁</a> <a id="1456" href="README.Container.FreeMonad.html#1456" class="Bound">x</a> <a id="1458" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1460" class="Symbol">_))</a>        <a id="1471" class="Symbol">=</a> <a id="1473" class="Symbol">λ</a> <a id="1475" href="README.Container.FreeMonad.html#1475" class="Bound">s</a> <a id="1477" class="Symbol">→</a> <a id="1479" href="README.Container.FreeMonad.html#1456" class="Bound">x</a> <a id="1481" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1483" href="README.Container.FreeMonad.html#1475" class="Bound">s</a>
<a id="1485" href="README.Container.FreeMonad.html#1383" class="Function">runState</a> <a id="1494" class="Symbol">(</a><a id="1495" href="Data.W.html#577" class="InductiveConstructor">sup</a> <a id="1499" class="Symbol">(</a><a id="1500" href="Data.Sum.Base.html#590" class="InductiveConstructor">inj₂</a> <a id="1505" class="Symbol">(</a><a id="1506" href="Data.Sum.Base.html#565" class="InductiveConstructor">inj₁</a> <a id="1511" class="Symbol">_)</a> <a id="1514" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1516" href="README.Container.FreeMonad.html#1516" class="Bound">k</a><a id="1517" class="Symbol">))</a> <a id="1520" class="Symbol">=</a> <a id="1522" class="Symbol">λ</a> <a id="1524" href="README.Container.FreeMonad.html#1524" class="Bound">s</a> <a id="1526" class="Symbol">→</a> <a id="1528" href="README.Container.FreeMonad.html#1383" class="Function">runState</a> <a id="1537" class="Symbol">(</a><a id="1538" href="README.Container.FreeMonad.html#1516" class="Bound">k</a> <a id="1540" href="README.Container.FreeMonad.html#1524" class="Bound">s</a><a id="1541" class="Symbol">)</a> <a id="1543" href="README.Container.FreeMonad.html#1524" class="Bound">s</a>
<a id="1545" href="README.Container.FreeMonad.html#1383" class="Function">runState</a> <a id="1554" class="Symbol">(</a><a id="1555" href="Data.W.html#577" class="InductiveConstructor">sup</a> <a id="1559" class="Symbol">(</a><a id="1560" href="Data.Sum.Base.html#590" class="InductiveConstructor">inj₂</a> <a id="1565" class="Symbol">(</a><a id="1566" href="Data.Sum.Base.html#590" class="InductiveConstructor">inj₂</a> <a id="1571" href="README.Container.FreeMonad.html#1571" class="Bound">s</a><a id="1572" class="Symbol">)</a> <a id="1574" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1576" href="README.Container.FreeMonad.html#1576" class="Bound">k</a><a id="1577" class="Symbol">))</a> <a id="1580" class="Symbol">=</a> <a id="1582" class="Symbol">λ</a> <a id="1584" href="README.Container.FreeMonad.html#1584" class="Bound">_</a> <a id="1586" class="Symbol">→</a> <a id="1588" href="README.Container.FreeMonad.html#1383" class="Function">runState</a> <a id="1597" class="Symbol">(</a><a id="1598" href="README.Container.FreeMonad.html#1576" class="Bound">k</a> <a id="1600" class="Symbol">_)</a> <a id="1603" href="README.Container.FreeMonad.html#1571" class="Bound">s</a>

<a id="test"></a><a id="1606" href="README.Container.FreeMonad.html#1606" class="Function">test</a> <a id="1611" class="Symbol">:</a> <a id="1613" href="README.Container.FreeMonad.html#1383" class="Function">runState</a> <a id="1622" href="README.Container.FreeMonad.html#1265" class="Function">prog</a> <a id="1627" class="Number">0</a> <a id="1629" href="Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="1631" class="Symbol">(</a><a id="1632" href="Agda.Builtin.Bool.html#92" class="InductiveConstructor">true</a> <a id="1637" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1639" class="Number">1</a><a id="1640" class="Symbol">)</a>
<a id="1642" href="README.Container.FreeMonad.html#1606" class="Function">test</a> <a id="1647" class="Symbol">=</a> <a id="1649" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">P.refl</a>

<a id="1657" class="Comment">-- It should be noted that @State S ⋆ X@ is not the state monad. If we</a>
<a id="1728" class="Comment">-- could quotient @State S ⋆ X@ by the seven axioms of state (see</a>
<a id="1794" class="Comment">-- Plotkin and Power&#39;s &quot;Notions of Computation Determine Monads&quot;, 2002)</a>
<a id="1866" class="Comment">-- then we would get the state monad.</a>
</pre></body></html>