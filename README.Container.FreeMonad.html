<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>README.Container.FreeMonad</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Example showing how the free monad construction on containers can be</a>
<a id="178" class="Comment">-- used</a>
<a id="186" class="Comment">------------------------------------------------------------------------</a>

<a id="260" class="Symbol">{-#</a> <a id="264" class="Keyword">OPTIONS</a> <a id="272" class="Option">--without-K</a> <a id="284" class="Option">--safe</a> <a id="291" class="Symbol">#-}</a>

<a id="296" class="Keyword">module</a> <a id="303" href="README.Container.FreeMonad.html" class="Module">README.Container.FreeMonad</a> <a id="330" class="Keyword">where</a>

<a id="337" class="Keyword">open</a> <a id="342" class="Keyword">import</a> <a id="349" href="Category.Monad.html" class="Module">Category.Monad</a>
<a id="364" class="Keyword">open</a> <a id="369" class="Keyword">import</a> <a id="376" href="Data.Empty.html" class="Module">Data.Empty</a>
<a id="387" class="Keyword">open</a> <a id="392" class="Keyword">import</a> <a id="399" href="Data.Unit.html" class="Module">Data.Unit</a>
<a id="409" class="Keyword">open</a> <a id="414" class="Keyword">import</a> <a id="421" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a> <a id="436" class="Keyword">using</a> <a id="442" class="Symbol">(</a><a id="443" href="Agda.Builtin.Bool.html#67" class="Datatype">Bool</a><a id="447" class="Symbol">;</a> <a id="449" href="Agda.Builtin.Bool.html#92" class="InductiveConstructor">true</a><a id="453" class="Symbol">)</a>
<a id="455" class="Keyword">open</a> <a id="460" class="Keyword">import</a> <a id="467" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="476" class="Keyword">open</a> <a id="481" class="Keyword">import</a> <a id="488" href="Data.Sum.html" class="Module">Data.Sum</a> <a id="497" class="Keyword">using</a> <a id="503" class="Symbol">(</a><a id="504" href="Data.Sum.Base.html#565" class="InductiveConstructor">inj₁</a><a id="508" class="Symbol">;</a> <a id="510" href="Data.Sum.Base.html#590" class="InductiveConstructor">inj₂</a><a id="514" class="Symbol">)</a>
<a id="516" class="Keyword">open</a> <a id="521" class="Keyword">import</a> <a id="528" href="Data.Product.html" class="Module">Data.Product</a> <a id="541" class="Keyword">renaming</a> <a id="550" class="Symbol">(</a><a id="551" href="Data.Product.html#1389" class="Function Operator">_×_</a> <a id="555" class="Symbol">to</a> <a id="558" href="Data.Product.html#1389" class="Function Operator">_⟨×⟩_</a><a id="563" class="Symbol">)</a>
<a id="565" class="Keyword">open</a> <a id="570" class="Keyword">import</a> <a id="577" href="Data.Container.html" class="Module">Data.Container</a> <a id="592" class="Keyword">hiding</a> <a id="599" class="Symbol">(</a><a id="600" href="Data.Container.html#1804" class="Function">refl</a><a id="604" class="Symbol">)</a>
<a id="606" class="Keyword">open</a> <a id="611" class="Keyword">import</a> <a id="618" href="Data.Container.Combinator.html" class="Module">Data.Container.Combinator</a>
<a id="644" class="Keyword">open</a> <a id="649" class="Keyword">import</a> <a id="656" href="Data.Container.FreeMonad.html" class="Module">Data.Container.FreeMonad</a>
<a id="681" class="Keyword">open</a> <a id="686" class="Keyword">import</a> <a id="693" href="Data.W.html" class="Module">Data.W</a>
<a id="700" class="Keyword">open</a> <a id="705" class="Keyword">import</a> <a id="712" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a>

<a id="751" class="Comment">------------------------------------------------------------------------</a>

<a id="825" class="Comment">-- The signature of state and its (generic) operations.</a>

<a id="State"></a><a id="882" href="README.Container.FreeMonad.html#882" class="Function">State</a> <a id="888" class="Symbol">:</a> <a id="890" class="PrimitiveType">Set</a> <a id="894" class="Symbol">→</a> <a id="896" href="Data.Container.Core.html#422" class="Record">Container</a> <a id="906" class="Symbol">_</a> <a id="908" class="Symbol">_</a>
<a id="910" href="README.Container.FreeMonad.html#882" class="Function">State</a> <a id="916" href="README.Container.FreeMonad.html#916" class="Bound">S</a> <a id="918" class="Symbol">=</a> <a id="920" href="Agda.Builtin.Unit.html#69" class="Record">⊤</a> <a id="922" href="README.Container.FreeMonad.html#944" class="Function Operator">⟶</a> <a id="924" href="README.Container.FreeMonad.html#916" class="Bound">S</a> <a id="926" href="Data.Container.Combinator.html#1704" class="Function Operator">⊎</a> <a id="928" href="README.Container.FreeMonad.html#916" class="Bound">S</a> <a id="930" href="README.Container.FreeMonad.html#944" class="Function Operator">⟶</a> <a id="932" href="Agda.Builtin.Unit.html#69" class="Record">⊤</a>
  <a id="936" class="Keyword">where</a>
  <a id="944" href="README.Container.FreeMonad.html#944" class="Function Operator">_⟶_</a> <a id="948" class="Symbol">:</a> <a id="950" class="PrimitiveType">Set</a> <a id="954" class="Symbol">→</a> <a id="956" class="PrimitiveType">Set</a> <a id="960" class="Symbol">→</a> <a id="962" href="Data.Container.Core.html#422" class="Record">Container</a> <a id="972" class="Symbol">_</a> <a id="974" class="Symbol">_</a>
  <a id="978" href="README.Container.FreeMonad.html#978" class="Bound">I</a> <a id="980" href="README.Container.FreeMonad.html#944" class="Function Operator">⟶</a> <a id="982" href="README.Container.FreeMonad.html#982" class="Bound">O</a> <a id="984" class="Symbol">=</a> <a id="986" href="README.Container.FreeMonad.html#978" class="Bound">I</a> <a id="988" href="Data.Container.Core.html#486" class="InductiveConstructor Operator">▷</a> <a id="990" class="Symbol">λ</a> <a id="992" href="README.Container.FreeMonad.html#992" class="Bound">_</a> <a id="994" class="Symbol">→</a> <a id="996" href="README.Container.FreeMonad.html#982" class="Bound">O</a>

<a id="get"></a><a id="999" href="README.Container.FreeMonad.html#999" class="Function">get</a> <a id="1003" class="Symbol">:</a> <a id="1005" class="Symbol">∀</a> <a id="1007" class="Symbol">{</a><a id="1008" href="README.Container.FreeMonad.html#1008" class="Bound">S</a><a id="1009" class="Symbol">}</a> <a id="1011" class="Symbol">→</a> <a id="1013" href="README.Container.FreeMonad.html#882" class="Function">State</a> <a id="1019" href="README.Container.FreeMonad.html#1008" class="Bound">S</a> <a id="1021" href="Data.Container.FreeMonad.html#1506" class="Function Operator">⋆</a> <a id="1023" href="README.Container.FreeMonad.html#1008" class="Bound">S</a>
<a id="1025" href="README.Container.FreeMonad.html#999" class="Function">get</a> <a id="1029" class="Symbol">=</a> <a id="1031" href="Data.Container.FreeMonad.html#1628" class="Function">inn</a> <a id="1035" class="Symbol">(</a><a id="1036" href="Data.Sum.Base.html#565" class="InductiveConstructor">inj₁</a> <a id="1041" class="Symbol">_</a> <a id="1043" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1045" href="Category.Monad.Indexed.html#569" class="Function">return</a><a id="1051" class="Symbol">)</a>
  <a id="1055" class="Keyword">where</a>
  <a id="1063" class="Keyword">open</a> <a id="1068" href="Category.Monad.html#810" class="Module">RawMonad</a> <a id="1077" href="Data.Container.FreeMonad.html#1712" class="Function">rawMonad</a>

<a id="put"></a><a id="1087" href="README.Container.FreeMonad.html#1087" class="Function">put</a> <a id="1091" class="Symbol">:</a> <a id="1093" class="Symbol">∀</a> <a id="1095" class="Symbol">{</a><a id="1096" href="README.Container.FreeMonad.html#1096" class="Bound">S</a><a id="1097" class="Symbol">}</a> <a id="1099" class="Symbol">→</a> <a id="1101" href="README.Container.FreeMonad.html#1096" class="Bound">S</a> <a id="1103" class="Symbol">→</a> <a id="1105" href="README.Container.FreeMonad.html#882" class="Function">State</a> <a id="1111" href="README.Container.FreeMonad.html#1096" class="Bound">S</a> <a id="1113" href="Data.Container.FreeMonad.html#1506" class="Function Operator">⋆</a> <a id="1115" href="Agda.Builtin.Unit.html#69" class="Record">⊤</a>
<a id="1117" href="README.Container.FreeMonad.html#1087" class="Function">put</a> <a id="1121" href="README.Container.FreeMonad.html#1121" class="Bound">s</a> <a id="1123" class="Symbol">=</a> <a id="1125" href="Data.Container.FreeMonad.html#1628" class="Function">inn</a> <a id="1129" class="Symbol">(</a><a id="1130" href="Data.Sum.Base.html#590" class="InductiveConstructor">inj₂</a> <a id="1135" href="README.Container.FreeMonad.html#1121" class="Bound">s</a> <a id="1137" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1139" href="Category.Monad.Indexed.html#569" class="Function">return</a><a id="1145" class="Symbol">)</a>
  <a id="1149" class="Keyword">where</a>
  <a id="1157" class="Keyword">open</a> <a id="1162" href="Category.Monad.html#810" class="Module">RawMonad</a> <a id="1171" href="Data.Container.FreeMonad.html#1712" class="Function">rawMonad</a>

<a id="1181" class="Comment">-- Using the above we can, for example, write a stateful program that</a>
<a id="1251" class="Comment">-- delivers a boolean.</a>
<a id="prog"></a><a id="1274" href="README.Container.FreeMonad.html#1274" class="Function">prog</a> <a id="1279" class="Symbol">:</a> <a id="1281" href="README.Container.FreeMonad.html#882" class="Function">State</a> <a id="1287" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="1289" href="Data.Container.FreeMonad.html#1506" class="Function Operator">⋆</a> <a id="1291" href="Agda.Builtin.Bool.html#67" class="Datatype">Bool</a>
<a id="1296" href="README.Container.FreeMonad.html#1274" class="Function">prog</a> <a id="1301" class="Symbol">=</a>
  <a id="1305" href="README.Container.FreeMonad.html#999" class="Function">get</a>         <a id="1317" href="Category.Monad.Indexed.html#604" class="Function Operator">&gt;&gt;=</a> <a id="1321" class="Symbol">λ</a> <a id="1323" href="README.Container.FreeMonad.html#1323" class="Bound">n</a> <a id="1325" class="Symbol">→</a>
  <a id="1329" href="README.Container.FreeMonad.html#1087" class="Function">put</a> <a id="1333" class="Symbol">(</a><a id="1334" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="1338" href="README.Container.FreeMonad.html#1323" class="Bound">n</a><a id="1339" class="Symbol">)</a> <a id="1341" href="Category.Monad.Indexed.html#666" class="Function Operator">&gt;&gt;</a>
  <a id="1346" href="Category.Monad.Indexed.html#569" class="Function">return</a> <a id="1353" href="Agda.Builtin.Bool.html#92" class="InductiveConstructor">true</a>
  <a id="1360" class="Keyword">where</a>
  <a id="1368" class="Keyword">open</a> <a id="1373" href="Category.Monad.html#810" class="Module">RawMonad</a> <a id="1382" href="Data.Container.FreeMonad.html#1712" class="Function">rawMonad</a>

<a id="runState"></a><a id="1392" href="README.Container.FreeMonad.html#1392" class="Function">runState</a> <a id="1401" class="Symbol">:</a> <a id="1403" class="Symbol">{</a><a id="1404" href="README.Container.FreeMonad.html#1404" class="Bound">S</a> <a id="1406" href="README.Container.FreeMonad.html#1406" class="Bound">X</a> <a id="1408" class="Symbol">:</a> <a id="1410" class="PrimitiveType">Set</a><a id="1413" class="Symbol">}</a> <a id="1415" class="Symbol">→</a> <a id="1417" href="README.Container.FreeMonad.html#882" class="Function">State</a> <a id="1423" href="README.Container.FreeMonad.html#1404" class="Bound">S</a> <a id="1425" href="Data.Container.FreeMonad.html#1506" class="Function Operator">⋆</a> <a id="1427" href="README.Container.FreeMonad.html#1406" class="Bound">X</a> <a id="1429" class="Symbol">→</a> <a id="1431" class="Symbol">(</a><a id="1432" href="README.Container.FreeMonad.html#1404" class="Bound">S</a> <a id="1434" class="Symbol">→</a> <a id="1436" href="README.Container.FreeMonad.html#1406" class="Bound">X</a> <a id="1438" href="Data.Product.html#1389" class="Function Operator">⟨×⟩</a> <a id="1442" href="README.Container.FreeMonad.html#1404" class="Bound">S</a><a id="1443" class="Symbol">)</a>
<a id="1445" href="README.Container.FreeMonad.html#1392" class="Function">runState</a> <a id="1454" class="Symbol">(</a><a id="1455" href="Data.W.html#503" class="InductiveConstructor">sup</a> <a id="1459" class="Symbol">(</a><a id="1460" href="Data.Sum.Base.html#565" class="InductiveConstructor">inj₁</a> <a id="1465" href="README.Container.FreeMonad.html#1465" class="Bound">x</a> <a id="1467" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1469" class="Symbol">_))</a>        <a id="1480" class="Symbol">=</a> <a id="1482" class="Symbol">λ</a> <a id="1484" href="README.Container.FreeMonad.html#1484" class="Bound">s</a> <a id="1486" class="Symbol">→</a> <a id="1488" href="README.Container.FreeMonad.html#1465" class="Bound">x</a> <a id="1490" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1492" href="README.Container.FreeMonad.html#1484" class="Bound">s</a>
<a id="1494" href="README.Container.FreeMonad.html#1392" class="Function">runState</a> <a id="1503" class="Symbol">(</a><a id="1504" href="Data.W.html#503" class="InductiveConstructor">sup</a> <a id="1508" class="Symbol">(</a><a id="1509" href="Data.Sum.Base.html#590" class="InductiveConstructor">inj₂</a> <a id="1514" class="Symbol">(</a><a id="1515" href="Data.Sum.Base.html#565" class="InductiveConstructor">inj₁</a> <a id="1520" class="Symbol">_)</a> <a id="1523" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1525" href="README.Container.FreeMonad.html#1525" class="Bound">k</a><a id="1526" class="Symbol">))</a> <a id="1529" class="Symbol">=</a> <a id="1531" class="Symbol">λ</a> <a id="1533" href="README.Container.FreeMonad.html#1533" class="Bound">s</a> <a id="1535" class="Symbol">→</a> <a id="1537" href="README.Container.FreeMonad.html#1392" class="Function">runState</a> <a id="1546" class="Symbol">(</a><a id="1547" href="README.Container.FreeMonad.html#1525" class="Bound">k</a> <a id="1549" href="README.Container.FreeMonad.html#1533" class="Bound">s</a><a id="1550" class="Symbol">)</a> <a id="1552" href="README.Container.FreeMonad.html#1533" class="Bound">s</a>
<a id="1554" href="README.Container.FreeMonad.html#1392" class="Function">runState</a> <a id="1563" class="Symbol">(</a><a id="1564" href="Data.W.html#503" class="InductiveConstructor">sup</a> <a id="1568" class="Symbol">(</a><a id="1569" href="Data.Sum.Base.html#590" class="InductiveConstructor">inj₂</a> <a id="1574" class="Symbol">(</a><a id="1575" href="Data.Sum.Base.html#590" class="InductiveConstructor">inj₂</a> <a id="1580" href="README.Container.FreeMonad.html#1580" class="Bound">s</a><a id="1581" class="Symbol">)</a> <a id="1583" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1585" href="README.Container.FreeMonad.html#1585" class="Bound">k</a><a id="1586" class="Symbol">))</a> <a id="1589" class="Symbol">=</a> <a id="1591" class="Symbol">λ</a> <a id="1593" href="README.Container.FreeMonad.html#1593" class="Bound">_</a> <a id="1595" class="Symbol">→</a> <a id="1597" href="README.Container.FreeMonad.html#1392" class="Function">runState</a> <a id="1606" class="Symbol">(</a><a id="1607" href="README.Container.FreeMonad.html#1585" class="Bound">k</a> <a id="1609" class="Symbol">_)</a> <a id="1612" href="README.Container.FreeMonad.html#1580" class="Bound">s</a>

<a id="test"></a><a id="1615" href="README.Container.FreeMonad.html#1615" class="Function">test</a> <a id="1620" class="Symbol">:</a> <a id="1622" href="README.Container.FreeMonad.html#1392" class="Function">runState</a> <a id="1631" href="README.Container.FreeMonad.html#1274" class="Function">prog</a> <a id="1636" class="Number">0</a> <a id="1638" href="Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="1640" class="Symbol">(</a><a id="1641" href="Agda.Builtin.Bool.html#92" class="InductiveConstructor">true</a> <a id="1646" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1648" class="Number">1</a><a id="1649" class="Symbol">)</a>
<a id="1651" href="README.Container.FreeMonad.html#1615" class="Function">test</a> <a id="1656" class="Symbol">=</a> <a id="1658" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>

<a id="1664" class="Comment">-- It should be noted that @State S ⋆ X@ is not the state monad. If we</a>
<a id="1735" class="Comment">-- could quotient @State S ⋆ X@ by the seven axioms of state (see</a>
<a id="1801" class="Comment">-- Plotkin and Power&#39;s &quot;Notions of Computation Determine Monads&quot;, 2002)</a>
<a id="1873" class="Comment">-- then we would get the state monad.</a>
</pre></body></html>