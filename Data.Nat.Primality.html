<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.Nat.Primality</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Primality</a>
<a id="119" class="Comment">------------------------------------------------------------------------</a>

<a id="193" class="Symbol">{-#</a> <a id="197" class="Keyword">OPTIONS</a> <a id="205" class="Option">--without-K</a> <a id="217" class="Symbol">#-}</a>

<a id="222" class="Keyword">module</a> <a id="229" href="Data.Nat.Primality.html" class="Module">Data.Nat.Primality</a> <a id="248" class="Keyword">where</a>

<a id="255" class="Keyword">open</a> <a id="260" class="Keyword">import</a> <a id="267" href="Data.Empty.html" class="Module">Data.Empty</a> <a id="278" class="Keyword">using</a> <a id="284" class="Symbol">(</a><a id="285" href="Data.Empty.html#272" class="Datatype">⊥</a><a id="286" class="Symbol">)</a>
<a id="288" class="Keyword">open</a> <a id="293" class="Keyword">import</a> <a id="300" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="309" class="Keyword">using</a> <a id="315" class="Symbol">(</a><a id="316" href="Data.Fin.Base.html#944" class="Datatype">Fin</a><a id="319" class="Symbol">;</a> <a id="321" href="Data.Fin.Base.html#1070" class="Function">toℕ</a><a id="324" class="Symbol">)</a>
<a id="326" class="Keyword">open</a> <a id="331" class="Keyword">import</a> <a id="338" href="Data.Fin.Properties.html" class="Module">Data.Fin.Properties</a> <a id="358" class="Keyword">using</a> <a id="364" class="Symbol">(</a><a id="365" href="Data.Fin.Properties.html#16993" class="Function">all?</a><a id="369" class="Symbol">)</a>
<a id="371" class="Keyword">open</a> <a id="376" class="Keyword">import</a> <a id="383" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="392" class="Keyword">using</a> <a id="398" class="Symbol">(</a><a id="399" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="400" class="Symbol">;</a> <a id="402" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a><a id="405" class="Symbol">;</a> <a id="407" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">_+_</a><a id="410" class="Symbol">)</a>
<a id="412" class="Keyword">open</a> <a id="417" class="Keyword">import</a> <a id="424" href="Data.Nat.Divisibility.html" class="Module">Data.Nat.Divisibility</a> <a id="446" class="Keyword">using</a> <a id="452" class="Symbol">(</a><a id="453" href="Data.Nat.Divisibility.html#1433" class="Function Operator">_∤_</a><a id="456" class="Symbol">;</a> <a id="458" href="Data.Nat.Divisibility.html#6209" class="Function Operator">_∣?_</a><a id="462" class="Symbol">)</a>
<a id="464" class="Keyword">open</a> <a id="469" class="Keyword">import</a> <a id="476" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="493" class="Keyword">using</a> <a id="499" class="Symbol">(</a><a id="500" href="Relation.Nullary.html#599" class="InductiveConstructor">yes</a><a id="503" class="Symbol">;</a> <a id="505" href="Relation.Nullary.html#626" class="InductiveConstructor">no</a><a id="507" class="Symbol">)</a>
<a id="509" class="Keyword">open</a> <a id="514" class="Keyword">import</a> <a id="521" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="548" class="Keyword">using</a> <a id="554" class="Symbol">(</a><a id="555" href="Relation.Nullary.Decidable.html#2789" class="Function">from-yes</a><a id="563" class="Symbol">)</a>
<a id="565" class="Keyword">open</a> <a id="570" class="Keyword">import</a> <a id="577" href="Relation.Nullary.Negation.html" class="Module">Relation.Nullary.Negation</a> <a id="603" class="Keyword">using</a> <a id="609" class="Symbol">(</a><a id="610" href="Relation.Nullary.Negation.html#1046" class="Function">¬?</a><a id="612" class="Symbol">)</a>
<a id="614" class="Keyword">open</a> <a id="619" class="Keyword">import</a> <a id="626" href="Relation.Unary.html" class="Module">Relation.Unary</a> <a id="641" class="Keyword">using</a> <a id="647" class="Symbol">(</a><a id="648" href="Relation.Unary.html#3342" class="Function">Decidable</a><a id="657" class="Symbol">)</a>

<a id="660" class="Comment">-- Definition of primality.</a>

<a id="Prime"></a><a id="689" href="Data.Nat.Primality.html#689" class="Function">Prime</a> <a id="695" class="Symbol">:</a> <a id="697" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="699" class="Symbol">→</a> <a id="701" class="PrimitiveType">Set</a>
<a id="705" href="Data.Nat.Primality.html#689" class="Function">Prime</a> <a id="711" class="Number">0</a>             <a id="725" class="Symbol">=</a> <a id="727" href="Data.Empty.html#272" class="Datatype">⊥</a>
<a id="729" href="Data.Nat.Primality.html#689" class="Function">Prime</a> <a id="735" class="Number">1</a>             <a id="749" class="Symbol">=</a> <a id="751" href="Data.Empty.html#272" class="Datatype">⊥</a>
<a id="753" href="Data.Nat.Primality.html#689" class="Function">Prime</a> <a id="759" class="Symbol">(</a><a id="760" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="764" class="Symbol">(</a><a id="765" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="769" href="Data.Nat.Primality.html#769" class="Bound">n</a><a id="770" class="Symbol">))</a> <a id="773" class="Symbol">=</a> <a id="775" class="Symbol">(</a><a id="776" href="Data.Nat.Primality.html#776" class="Bound">i</a> <a id="778" class="Symbol">:</a> <a id="780" href="Data.Fin.Base.html#944" class="Datatype">Fin</a> <a id="784" href="Data.Nat.Primality.html#769" class="Bound">n</a><a id="785" class="Symbol">)</a> <a id="787" class="Symbol">→</a> <a id="789" class="Number">2</a> <a id="791" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">+</a> <a id="793" href="Data.Fin.Base.html#1070" class="Function">toℕ</a> <a id="797" href="Data.Nat.Primality.html#776" class="Bound">i</a> <a id="799" href="Data.Nat.Divisibility.html#1433" class="Function Operator">∤</a> <a id="801" class="Number">2</a> <a id="803" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">+</a> <a id="805" href="Data.Nat.Primality.html#769" class="Bound">n</a>

<a id="808" class="Comment">-- Decision procedure for primality.</a>

<a id="prime?"></a><a id="846" href="Data.Nat.Primality.html#846" class="Function">prime?</a> <a id="853" class="Symbol">:</a> <a id="855" href="Relation.Unary.html#3342" class="Function">Decidable</a> <a id="865" href="Data.Nat.Primality.html#689" class="Function">Prime</a>
<a id="871" href="Data.Nat.Primality.html#846" class="Function">prime?</a> <a id="878" class="Number">0</a>             <a id="892" class="Symbol">=</a> <a id="894" href="Relation.Nullary.html#626" class="InductiveConstructor">no</a> <a id="897" class="Symbol">λ()</a>
<a id="901" href="Data.Nat.Primality.html#846" class="Function">prime?</a> <a id="908" class="Number">1</a>             <a id="922" class="Symbol">=</a> <a id="924" href="Relation.Nullary.html#626" class="InductiveConstructor">no</a> <a id="927" class="Symbol">λ()</a>
<a id="931" href="Data.Nat.Primality.html#846" class="Function">prime?</a> <a id="938" class="Symbol">(</a><a id="939" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="943" class="Symbol">(</a><a id="944" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="948" href="Data.Nat.Primality.html#948" class="Bound">n</a><a id="949" class="Symbol">))</a> <a id="952" class="Symbol">=</a> <a id="954" href="Data.Fin.Properties.html#16993" class="Function">all?</a> <a id="959" class="Symbol">(λ</a> <a id="962" href="Data.Nat.Primality.html#962" class="Bound">_</a> <a id="964" class="Symbol">→</a> <a id="966" href="Relation.Nullary.Negation.html#1046" class="Function">¬?</a> <a id="969" class="Symbol">(_</a> <a id="972" href="Data.Nat.Divisibility.html#6209" class="Function Operator">∣?</a> <a id="975" class="Symbol">_))</a>

<a id="980" class="Keyword">private</a>

  <a id="991" class="Comment">-- Example: 2 is prime.</a>

  <a id="2-is-prime"></a><a id="1018" href="Data.Nat.Primality.html#1018" class="Function">2-is-prime</a> <a id="1029" class="Symbol">:</a> <a id="1031" href="Data.Nat.Primality.html#689" class="Function">Prime</a> <a id="1037" class="Number">2</a>
  <a id="1041" href="Data.Nat.Primality.html#1018" class="Function">2-is-prime</a> <a id="1052" class="Symbol">=</a> <a id="1054" href="Relation.Nullary.Decidable.html#2789" class="Function">from-yes</a> <a id="1063" class="Symbol">(</a><a id="1064" href="Data.Nat.Primality.html#846" class="Function">prime?</a> <a id="1071" class="Number">2</a><a id="1072" class="Symbol">)</a>
</pre></body></html>